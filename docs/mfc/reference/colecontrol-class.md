---
title: COleControl 类 |Microsoft Docs
ms.custom: ''
ms.date: 08/27/2018
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
dev_langs:
- C++
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: d3c5f68d35c4cf77073de3f8d2e6090f62a6dae2
ms.sourcegitcommit: 913c3bf23937b64b90ac05181fdff3df947d9f1c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/18/2018
ms.locfileid: "46050094"
---
# <a name="colecontrol-class"></a>COleControl 类
用于开发 OLE 控件的重要基类。

## <a name="syntax"></a>语法

```
class COleControl : public CWnd
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|描述|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|创建一个 `COleControl` 对象。|

### <a name="public-methods"></a>公共方法

|名称|描述|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|检索当前控件的外观。|
|[COleControl::AmbientBackColor](#ambientbackcolor)|返回环境 BackColor 属性的值。|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|按容器返回指定控件的名称。|
|[COleControl::AmbientFont](#ambientfont)|返回环境字体属性的值。|
|[COleControl::AmbientForeColor](#ambientforecolor)|返回环境前景色属性的值。|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|返回容器的区域设置 id。|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|返回由容器所用的单位类型。|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|确定是否应显示握柄。|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|确定是否应显示阴影。|
|[COleControl::AmbientTextAlign](#ambienttextalign)|返回指定的容器的文本对齐方式的类型。|
|[COleControl::AmbientUIDead](#ambientuidead)|确定是否控件应响应用户界面操作。|
|[COleControl::AmbientUserMode](#ambientusermode)|确定容器的模式。|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|通知容器绑定的属性已更改。|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|若要编辑的属性值的请求权限。|
|[COleControl::ClientToParent](#clienttoparent)|将转换为相对于控件的原点到点相对于其容器的源点。|
|[COleControl::ClipCaretRect](#clipcaretrect)|如果它由控件重叠，请调整一个插入符号的矩形。|
|[COleControl::ControlInfoChanged](#controlinfochanged)|调用此函数后已更改的处理由控件的助记键集。|
|[COleControl::DisplayError](#displayerror)|为控件的用户显示常用的错误事件。|
|[COleControl::DoClick](#doclick)|实现的股票`DoClick`方法。|
|[COleControl::DoPropExchange](#dopropexchange)|序列化的属性`COleControl`对象。|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|重绘 OLE 控件的 Windows 控件子类别。|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|控件支持简单框架。|
|[COleControl::ExchangeExtent](#exchangeextent)|序列化该控件的宽度和高度。|
|[COleControl::ExchangeStockProps](#exchangestockprops)|序列化该控件的常用属性。|
|[COleControl::ExchangeVersion](#exchangeversion)|序列化该控件的版本号。|
|[COleControl::FireClick](#fireclick)|触发股票`Click`事件。|
|[COleControl::FireDblClick](#firedblclick)|触发股票`DblClick`事件。|
|[COleControl::FireError](#fireerror)|触发股票`Error`事件。|
|[COleControl::FireEvent](#fireevent)|触发自定义事件。|
|[COleControl::FireKeyDown](#firekeydown)|触发股票`KeyDown`事件。|
|[COleControl::FireKeyPress](#firekeypress)|触发股票`KeyPress`事件。|
|[COleControl::FireKeyUp](#firekeyup)|触发股票`KeyUp`事件。|
|[COleControl::FireMouseDown](#firemousedown)|触发股票`MouseDown`事件。|
|[COleControl::FireMouseMove](#firemousemove)|触发股票`MouseMove`事件。|
|[COleControl::FireMouseUp](#firemouseup)|触发股票`MouseUp`事件。|
|[COleControl::FireReadyStateChange](#firereadystatechange)|触发事件时该控件的就绪状态更改。|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|更改支持的控件的默认激活行为`IPointerInactive`接口。|
|[COleControl::GetAmbientProperty](#getambientproperty)|返回指定的环境属性的值。|
|[COleControl::GetAppearance](#getappearance)|返回常用的外观属性的值。|
|[COleControl::GetBackColor](#getbackcolor)|返回股票 BackColor 属性的值。|
|[COleControl::GetBorderStyle](#getborderstyle)|返回常用的边框样式属性的值。|
|[COleControl::GetCapture](#getcapture)|确定一个无窗口激活的控件对象是否具有鼠标捕获。|
|[COleControl::GetClassID](#getclassid)|检索控件的 OLE 类 ID。|
|[COleControl::GetClientOffset](#getclientoffset)|检索控件的矩形区域左上的角和其工作区的左上的角的区别。|
|[COleControl::GetClientRect](#getclientrect)|检索控件的工作区的大小。|
|[COleControl::GetClientSite](#getclientsite)|将查询一个对象，用于指向其当前的客户端站点，在其容器内的指针。|
|[COleControl::GetControlFlags](#getcontrolflags)|检索控制标志设置。|
|[COleControl::GetControlSize](#getcontrolsize)|返回的位置和 OLE 控件的大小。|
|[COleControl::GetDC](#getdc)|提供一种无窗口控件从其容器中获取的设备上下文。|
|[COleControl::GetEnabled](#getenabled)|返回股票 Enabled 属性的值。|
|[COleControl::GetExtendedControl](#getextendedcontrol)|检索指向属于容器的扩展的控件对象的指针。|
|[COleControl::GetFocus](#getfocus)|确定控件是否具有焦点。|
|[COleControl::GetFont](#getfont)|返回常用字体属性的值。|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|返回的度量值`CFontHolder`对象。|
|[COleControl::GetForeColor](#getforecolor)|返回股票 ForeColor 属性的值。|
|[COleControl::GetHwnd](#gethwnd)|返回股票 hWnd 属性的值。|
|[COleControl::GetMessageString](#getmessagestring)|菜单项提供的状态栏文本。|
|[COleControl::GetNotSupported](#getnotsupported)|可防止对用户控件的属性值的访问。|
|[COleControl::GetReadyState](#getreadystate)|返回控件的就绪状态。|
|[COleControl::GetRectInContainer](#getrectincontainer)|返回相对于其容器的控件的矩形。|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|返回常用字体属性的度量的值。|
|[COleControl::GetText](#gettext)|返回常用的文本或标题属性的值。|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|重写以允许无窗口控件作为目标的拖放操作。|
|[COleControl::InitializeIIDs](#initializeiids)|通知控件将使用的 Iid 的基类。|
|[COleControl::InternalGetFont](#internalgetfont)|返回`CFontHolder`常用字体属性的对象。|
|[COleControl::InternalGetText](#internalgettext)|检索股票的标题或文本属性。|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|设置控件的准备情况状态并触发就绪状态更改事件。|
|[COleControl::InvalidateControl](#invalidatecontrol)|使显示的控件，从而导致重绘该区域无效。|
|[COleControl::InvalidateRgn](#invalidatergn)|使给定区域内的容器窗口的客户端区域无效。 可以使用重绘的区域中的无窗口控件。|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|允许 OLE 控件的专用的加载。|
|[COleControl::IsModified](#ismodified)|确定是否已更改的控件状态。|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|指示容器是否为当前的绘制操作支持优化的绘图。|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|调用以确定是否控件子类 Windows 控制。|
|[COleControl::Load](#load)|重置所有以前的异步数据，并启动新的控件的异步属性加载。|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|确定是否控件可以停用的容器。|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|环境属性更改时调用。|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|常用的外观属性更改时调用。|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|常用的 BackColor 属性更改时调用。|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|常用 BorderStyle 属性更改时调用。|
|[COleControl::OnClick](#onclick)|调用以触发常用 Click 事件。|
|[COleControl::OnClose](#onclose)|通知控件的`IOleControl::Close`已调用。|
|[COleControl::OnDoVerb](#ondoverb)|在执行控制谓词后调用。|
|[COleControl::OnDraw](#ondraw)|当请求控件重绘自身时调用。|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|当请求控件重绘自身使用图元文件设备上下文时，由容器调用。|
|[COleControl::OnEdit](#onedit)|调用到用户界面激活容器 OLE 控件。|
|[COleControl::OnEnabledChanged](#onenabledchanged)|Stock Enabled 属性更改时调用。|
|[COleControl::OnEnumVerbs](#onenumverbs)|调用由容器以枚举控件的谓词。|
|[COleControl::OnEventAdvise](#oneventadvise)|当连接或从控件断开连接事件处理程序时调用。|
|[COleControl::OnFontChanged](#onfontchanged)|常用字体属性更改时调用。|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|常用的前景色属性更改时调用。|
|[COleControl::OnFreezeEvents](#onfreezeevents)|控件的事件是冻结或解冻时调用。|
|[COleControl::OnGetColorSet](#ongetcolorset)|通知控件的`IOleObject::GetColorSet`已调用。|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|提供对容器的助记键信息。|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|调用以获取表示属性值的字符串。|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|请求容器菜单上控件的菜单将合并的句的柄。|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|重写以检索控件的显示大小最接近的建议的大小和扩展盘区模式。|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|返回表示属性的可能值的字符串。|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|返回对应于预定义的字符串的值。|
|[COleControl::OnGetViewExtent](#ongetviewextent)|重写以检索控件的显示区域 （可用于启用两次绘图） 的大小。|
|[COleControl::OnGetViewRect](#ongetviewrect)|重写控件的大小转换为特定的位置开始的矩形。|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|重写以检索控件的视图状态。|
|[COleControl::OnHideToolBars](#onhidetoolbars)|当控件处于用户界面已停用时，由容器调用。|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|重写以拥有在鼠标指针调度 WM_MOUSEMOVE 消息到该控件处于非活动状态的控件的容器。|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|重写以拥有在鼠标指针调度 WM_SETCURSOR 消息到该控件处于非活动状态的控件的容器。|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|已激发股票的 KeyDown 事件之后调用。|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|已激发股票的 KeyPress 事件之后调用。|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|已激发常用的 KeyUp 事件后调用。|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|指示要用于编辑属性的属性页。|
|[COleControl::OnMnemonic](#onmnemonic)|当按下控件的助记键时调用。|
|[COleControl::OnProperties](#onproperties)|当调用控件的"属性"谓词时调用。|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|控件的显示重叠给的定点是否重写查询。|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|控件的显示重叠给定矩形中的任何点是否重写查询。|
|[COleControl::OnRenderData](#onrenderdata)|由框架调用以检索指定格式的数据。|
|[COleControl::OnRenderFileData](#onrenderfiledata)|由框架调用以从文件中指定的格式检索数据。|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|由框架调用以从共用内存中指定的格式检索数据。|
|[COleControl::OnResetState](#onresetstate)|将控件的属性重置为默认值。|
|[COleControl::OnSetClientSite](#onsetclientsite)|通知控件的`IOleControl::SetClientSite`已调用。|
|[COleControl::OnSetData](#onsetdata)|控件的数据替换为另一个值。|
|[COleControl::OnSetExtent](#onsetextent)|控件的大小时发生更改后调用。|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|调用后已更改控件的维度。|
|[COleControl::OnShowToolBars](#onshowtoolbars)|当控件已处于用户界面激活时调用。|
|[COleControl::OnTextChanged](#ontextchanged)|Stock Text 或 Caption 属性更改时调用。|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|无窗口控件处理窗口消息 （而不是鼠标和键盘消息）。|
|[COleControl::ParentToClient](#parenttoclient)|将转换为相对于容器的原点到点相对于控件的原点的点。|
|[COleControl::PostModalDialog](#postmodaldialog)|通知容器模式对话框已关闭。|
|[COleControl::PreModalDialog](#premodaldialog)|通知即将显示模式对话框中的容器。|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|销毁并重新创建控件的窗口。|
|[COleControl::Refresh](#refresh)|强制重新绘制的控件的外观。|
|[COleControl::ReleaseCapture](#releasecapture)|释放鼠标捕获。|
|[COleControl::ReleaseDC](#releasedc)|释放显示设备上下文的无窗口控件的容器。|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|重置控件窗口的父级。|
|[COleControl::ResetStockProps](#resetstockprops)|初始化`COleControl`常用属性为其默认值。|
|[COleControl::ResetVersion](#resetversion)|初始化为给定值的版本号。|
|[COleControl::ScrollWindow](#scrollwindow)|允许无窗口控件滚动显示其就地活动图像内的某个区域。|
|[COleControl::SelectFontObject](#selectfontobject)|选择到设备上下文的自定义的字体属性。|
|[COleControl::SelectStockFont](#selectstockfont)|选择到设备上下文的常用字体属性。|
|[COleControl::SerializeExtent](#serializeextent)|序列化或初始化该控件的显示空间。|
|[COleControl::SerializeStockProps](#serializestockprops)|序列化或初始化`COleControl`常用属性。|
|[COleControl::SerializeVersion](#serializeversion)|序列化或初始化该控件的版本信息。|
|[COleControl::SetAppearance](#setappearance)|设置常用的外观属性的值。|
|[COleControl::SetBackColor](#setbackcolor)|设置常用 BackColor 属性的值。|
|[COleControl::SetBorderStyle](#setborderstyle)|设置常用的边框样式属性的值。|
|[COleControl::SetCapture](#setcapture)|使控件的容器窗口控件的代表需要拥有鼠标捕获。|
|[COleControl::SetControlSize](#setcontrolsize)|设置位置和 OLE 控件的大小。|
|[COleControl::SetEnabled](#setenabled)|设置股票 Enabled 属性的值。|
|[COleControl::SetFocus](#setfocus)|使控件的容器窗口控件的代表需要拥有输入焦点。|
|[COleControl::SetFont](#setfont)|设置常用字体属性的值。|
|[COleControl::SetForeColor](#setforecolor)|设置常用 ForeColor 属性值。|
|[COleControl::SetInitialSize](#setinitialsize)|设置 OLE 控件容器中首次显示时的大小。|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|更改控件的已修改的状态。|
|[COleControl::SetNotPermitted](#setnotpermitted)|指示的编辑请求已失败。|
|[COleControl::SetNotSupported](#setnotsupported)|防止修改为用户控件的属性值。|
|[COleControl::SetRectInContainer](#setrectincontainer)|设置相对于其容器的控件的矩形。|
|[COleControl::SetText](#settext)|设置常用的文本或标题属性的值。|
|[COleControl::ThrowError](#throwerror)|出现错误中 OLE 控件的信号。|
|[COleControl::TransformCoords](#transformcoords)|转换协调容器与控件之间的值。|
|[COleControl::TranslateColor](#translatecolor)|将 OLE_COLOR 值转换为 COLORREF 值。|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|确定是否环境属性可在下次加载控件。|
|[COleControl::WindowProc](#windowproc)|提供有关 Windows 过程`COleControl`对象。|

### <a name="protected-methods"></a>受保护的方法

|名称|描述|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|当控件的外观需要更新时由框架调用。|
|[COleControl::DrawMetafile](#drawmetafile)|在使用图元文件设备上下文时由框架调用。|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|启用自动化方法调用。|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|由框架调用以初始化控件支持的数据格式的列表。|

## <a name="remarks"></a>备注

派生自`CWnd`，此类继承的 Windows 窗口对象的所有功能以及其他功能特定于 OLE，如事件触发和支持方法和属性的能力。

OLE 控件可以插入到 OLE 容器应用程序，并使用双向系统的事件激发和公开方法和属性添加到容器与容器通信。 请注意，标准 OLE 容器仅支持 OLE 控件的基本功能。 它们不能支持 OLE 控件的扩展的功能。 当事件被发送到控件中发生某些操作，由于容器时发生事件触发。 反过来，容器与控件通信通过使用一组公开的方法和属性类似于成员函数和 c + + 类的数据成员。 此方法允许开发人员控制控件的外观和特定操作发生时通知该容器。

## <a name="windowless-controls"></a>无窗口控件

OLE 控件可以是无窗口使用处于就地活动状态。 无窗口控件有明显的优点：

- 无窗口控件可以是透明的并且非矩形

- 无窗口控件减少对象的实例大小和创建时间

控件不需要一个窗口。 窗口提供的服务可以轻松地通过单个共享的窗口 （通常是容器的） 和一些调度代码提供。 具有一个窗口是主要对象上的不必要复杂性。

使用无窗口激活时，是负责提供服务，否则将由控件自己的窗口提供的容器 （它具有一个窗口）。 例如，如果您的控件需要查询键盘焦点、 查询鼠标捕获，或获取设备上下文，由容器管理这些操作。 `COleControl`无窗口操作成员函数将调用这些操作在容器上的。

启用无窗口激活后，容器委托输入到控件的消息`IOleInPlaceObjectWindowless`接口 (的扩展[IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject)无窗口支持)。 `COleControl`适当地调整鼠标坐标后，此接口的实现将调度通过控件的消息映射，这些消息。 可以通过将相应的条目添加到消息映射来处理这些消息与普通窗口消息一样。

在无窗口控件中，始终应使用`COleControl`成员函数而不是相应`CWnd`成员函数或其相关的 Windows API 函数。

仅当它们变为活动状态，但处于非活动状态处于活动状态转换所需的工作量将向上转和过渡的速度发生故障时，OLE 控件对象还可以创建一个窗口。 有些情况下这是一个问题： 作为示例，请考虑一个文本框中的网格。 当列通过向上和向下的指针，每个控件必须就地激活，然后停用。 非活动/活动过渡的速度会直接影响滚动速度。

开发 OLE 控件框架的详细信息，请参阅文章[MFC ActiveX 控件](../../mfc/mfc-activex-controls.md)并[概述： 创建 MFC ActiveX 控件程序](../../mfc/reference/mfc-activex-control-wizard.md)。 有关优化 OLE 控件，包括无窗口并且无闪烁控件，请参阅[MFC ActiveX 控件： 优化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>要求

**标头：** afxctl.h

##  <a name="ambientbackcolor"></a>  COleControl::AmbientBackColor

返回环境 BackColor 属性的值。

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>返回值

容器的环境 BackColor 属性，如果有当前值。 如果不支持的属性，此函数返回的系统定义的 Windows 背景色。

### <a name="remarks"></a>备注

环境的 BackColor 属性可供所有控件，并且由容器定义。 请注意该容器不需要支持此属性。

##  <a name="ambientdisplayname"></a>  COleControl::AmbientDisplayName

可以向用户显示的错误消息中使用该容器已分配给控件的名称。

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>返回值

OLE 控件的名称。 默认值为零长度字符串。

### <a name="remarks"></a>备注

请注意该容器不需要支持此属性。

##  <a name="ambientfont"></a>  COleControl::AmbientFont

返回环境字体属性的值。

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>返回值

指向容器的环境字体调度接口的指针。 默认值为 NULL。 返回不等于 NULL，如果您是负责释放字体通过调用其[iunknown:: Release](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release)成员函数。

### <a name="remarks"></a>备注

环境字体属性是由容器定义并可供所有控件。请注意该容器不需要支持此属性。

##  <a name="ambientforecolor"></a>  COleControl::AmbientForeColor

返回环境前景色属性的值。

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>返回值

容器的环境前景色属性，如果有当前值。 如果不支持，此函数返回的系统定义的 Windows 文本颜色。

### <a name="remarks"></a>备注

环境前景色属性可供所有控件，并且由容器定义。 请注意该容器不需要支持此属性。

##  <a name="ambientlocaleid"></a>  COleControl::AmbientLocaleID

返回容器的区域设置 id。

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>返回值

容器的 LocaleID 属性 （如果有） 的值。 如果不支持此属性，则此函数将返回 0。

### <a name="remarks"></a>备注

该控件可以使用 LocaleID 以适应特定区域设置其用户界面。 请注意该容器不需要支持此属性。

##  <a name="ambientappearance"></a>  COleControl::AmbientAppearance

检索控件对象的当前外观设置。

```
short AmbientAppearance();
```

### <a name="return-value"></a>返回值

控件的外观：

- **0**平面外观

- **1**三维外观

### <a name="remarks"></a>备注

调用此函数可检索控件的 DISPID_AMBIENT_APPEARANCE 属性的当前值。

##  <a name="ambientscaleunits"></a>  COleControl::AmbientScaleUnits

返回由容器所用的单位类型。

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>返回值

包含容器的环境 ScaleUnits 的字符串。 如果不支持此属性，则此函数将返回一个零长度字符串。

### <a name="remarks"></a>备注

容器的环境 ScaleUnits 属性可以用于位置或维度，标记为与所选单元，如缇还是按厘米显示。 请注意该容器不需要支持此属性。

##  <a name="ambientshowgrabhandles"></a>  COleControl::AmbientShowGrabHandles

确定容器是否允许要为其自身活动时显示握柄的控件。

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>返回值

如果应显示握柄，则非零值否则为 0。 如果不支持此属性，则此函数返回非零值。

### <a name="remarks"></a>备注

请注意该容器不需要支持此属性。

##  <a name="ambientshowhatching"></a>  COleControl::AmbientShowHatching

确定容器是否允许该控件以将它与阴影线显示模式 UI 处于活动状态。

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>返回值

非零值是否应显示阴影的模式;否则为 0。 如果不支持此属性，则此函数返回非零值。

### <a name="remarks"></a>备注

请注意该容器不需要支持此属性。

##  <a name="ambienttextalign"></a>  COleControl::AmbientTextAlign

确定首选的控件容器的环境的文本对齐方式。

```
short AmbientTextAlign();
```

### <a name="return-value"></a>返回值

容器的环境 TextAlign 属性的状态。 如果不支持此属性，则此函数将返回 0。

下面是有效的返回值的列表：

|返回值|含义|
|------------------|-------------|
|0|常规的对齐方式 （数字转换为左侧的右，文本）。|
|1|左对齐|
|2|居中|
|3|右对齐|

### <a name="remarks"></a>备注

此属性可供所有嵌入的控件，由容器定义。 请注意该容器不需要支持此属性。

##  <a name="ambientuidead"></a>  COleControl::AmbientUIDead

确定容器是否想要响应用户界面操作的控件。

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>返回值

如果控件应响应用户界面操作; 非零值否则为 0。 如果不支持此属性，则此函数将返回 0。

### <a name="remarks"></a>备注

例如，容器可能会将此项设置为 TRUE 以设计模式。

##  <a name="ambientusermode"></a>  COleControl::AmbientUserMode

确定容器是否在设计模式或用户模式。

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>返回值

如果容器是在用户模式，则为非零值否则为 0 （在设计模式下）。 如果不支持此属性，则此函数将返回 TRUE。

### <a name="remarks"></a>备注

例如，容器可能会将此项设置为 FALSE 在设计模式下。

##  <a name="boundpropertychanged"></a>  COleControl::BoundPropertyChanged

绑定的属性值已更改的信号。

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>参数

*dispid*<br/>
控件的绑定属性的调度 ID。

### <a name="remarks"></a>备注

这必须在每次属性更改，甚至在其中通过属性不进行了更改的情况下的值设置方法调用。 请特别注意的绑定属性映射到成员变量。 任何此类成员变量次发生更改时，`BoundPropertyChanged`必须调用。

##  <a name="boundpropertyrequestedit"></a>  COleControl::BoundPropertyRequestEdit

请求权限从`IPropertyNotifySink`接口来更改该控件提供的绑定的属性值。

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>参数

*dispid*<br/>
控件的绑定属性的调度 ID。

### <a name="return-value"></a>返回值

如果允许此更改; 非零值否则为 0。 默认值为非零值。

### <a name="remarks"></a>备注

如果权限被拒绝，控件必须允许属性更改的值。 这可以通过其中忽略或失败的尝试将属性值更改的操作。

##  <a name="clienttoparent"></a>  COleControl::ClientToParent

将转换的坐标*pPoint*父级坐标。

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>参数

*lprcBounds*<br/>
指向 OLE 控件在容器内的边界。 不是工作区，但整个控件包括边框及滚动条的区域。

*pPoint*<br/>
指向 OLE 客户端区域点转换为父 （容器） 的坐标。

### <a name="remarks"></a>备注

在输入*pPoint*是相对于 OLE 控件 （左上角的控件的客户端区域） 的客户端区域的原点。 在输出*pPoint*是相对于父级 （左上角的容器） 的源。

##  <a name="clipcaretrect"></a>  COleControl::ClipCaretRect

如果它完全或部分涵盖重叠的、 不透明对象，调整一个插入符号的矩形。

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>参数

*lpRect*<br/>
在输入一个指向[RECT](../../mfc/reference/rect-structure1.md)结构，其中包含要进行调整的插入点区域。 在输出中，调整后的插入符号的区域中，或如果脱字号矩形完全覆盖，则为 NULL。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

插入符号是闪烁的行、 块或位图，通常指示在其中插入文本或图形。

无窗口对象无法安全地显示插入符号，而无需先检查是否将插入符号被部分或完全隐藏重叠的对象。 若要实现这一点，可以使用对象`ClipCaretRect`以获取插入符号调整 （减少） 以确保它适合的剪辑区域。

创建一个插入符号的对象应提交到的插入符号矩形`ClipCaretRect`和用于插入符号的调整后的矩形。 如果将插入符号完全隐藏的此方法将返回 FALSE 并将插入符号显示时不应在所有这种情况下。

##  <a name="colecontrol"></a>  COleControl::COleControl

构造 `COleControl` 对象。

```
COleControl();
```

### <a name="remarks"></a>备注

通常不直接调用此函数。 而是 OLE 控件通常由其类工厂创建。

##  <a name="controlinfochanged"></a>  COleControl::ControlInfoChanged

支持的控件的助记键集发生更改时调用此函数。

```
void ControlInfoChanged();
```

### <a name="remarks"></a>备注

收到此通知时，该控件的容器获取一组新的助记键对的调用，从而[IOleControl::GetControlInfo](/windows/desktop/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo)。 请注意，该容器不需要响应此通知。

##  <a name="displayerror"></a>  COleControl::DisplayError

常用的错误事件处理 （除非事件处理程序已禁止显示的错误） 后，由框架调用。

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>参数

*scode*<br/>
要报告的状态代码值。 可能的代码的完整列表，请参阅文章[ActiveX 控件： 高级主题](../../mfc/mfc-activex-controls-advanced-topics.md)。

*lpszDescription*<br/>
正在报告的错误的说明。

*lpszSource*<br/>
生成错误 （通常情况下，OLE 控件模块的名称） 的模块的名称。

*lpszHelpFile*<br/>
包含说明的错误的帮助文件的名称。

*nHelpID*<br/>
正在报告的错误的帮助上下文 ID。

### <a name="remarks"></a>备注

默认行为是显示一个消息框包含中包含错误的说明*lpszDescription*。

重写此函数可自定义错误的显示方式。

##  <a name="doclick"></a>  COleControl::DoClick

模拟鼠标单击控件上的操作。

```
void DoClick();
```

### <a name="remarks"></a>备注

可重写`COleControl::OnClick`将调用成员函数，和常用 Click 事件将触发，如果控件支持。

支持此函数`COleControl`基类作为调用 DoClick 常用方法。 有关详细信息，请参阅文章[ActiveX 控件： 方法](../../mfc/mfc-activex-controls-methods.md)。

##  <a name="dopropexchange"></a>  COleControl::DoPropExchange

由框架加载或存储的持久性存储区表示形式，如流或属性组中的一个控件时调用。

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>参数

*pPX*<br/>
一个指向`CPropExchange`对象。 框架提供了此对象以建立的上下文属性 exchange，包括其方向。

### <a name="remarks"></a>备注

此函数通常会调用**PX_** 系列函数以加载或存储的 OLE 控件特定的用户定义的属性。

如果控件向导用于创建 OLE 控件项目，此函数的重写的版本将序列化支持的常用属性`COleControl`通过调用基类函数， `COleControl::DoPropExchange`。 在您向 OLE 控件将需要修改此函数可序列化新属性添加用户定义的属性。 序列化的详细信息，请参阅文章[ActiveX 控件： 序列化](../../mfc/mfc-activex-controls-serializing.md)。

##  <a name="dosuperclasspaint"></a>  COleControl::DoSuperclassPaint

重绘 OLE 控件的 Windows 控件子类别。

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>参数

*pDC*<br/>
指向控件容器的设备上下文的指针。

*rcBounds*<br/>
控件将绘制区域。

### <a name="remarks"></a>备注

调用此函数可正确处理的非活动的 OLE 控件绘制。 如果 OLE 控件的 Windows 控件的子类，应调用，仅应使用此函数`OnDraw`控件的函数。

此函数和 Windows 控件子类化的详细信息，请参阅文章[ActiveX 控件： 子类化 Windows 控件](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)。

##  <a name="drawcontent"></a>  COleControl::DrawContent

当控件的外观需要更新时由框架调用。

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>参数

*pDC*<br/>
指向设备上下文指针。

*rc*<br/>
要在中绘制的矩形区域。

### <a name="remarks"></a>备注

此函数将直接调用可重写`OnDraw`函数。

##  <a name="drawmetafile"></a>  COleControl::DrawMetafile

在使用图元文件设备上下文时由框架调用。

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>参数

*pDC*<br/>
图元文件设备上下文的指针。

*rc*<br/>
要在中绘制的矩形区域。

##  <a name="enablesimpleframe"></a>  COleControl::EnableSimpleFrame

允许 OLE 控件的简单框架特性。

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>备注

此特性允许控件用来支持 visual 包含其他控件，但事实并非如此 OLE 包容。 示例是具有多个控件内的组框。 这些控件不是 OLE 包含，但它们是在同一组中。

##  <a name="exchangeextent"></a>  COleControl::ExchangeExtent

序列化或初始化该控件的作用域 （其维度以 HIMETRIC 为单位） 的状态。

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>参数

*pPX*<br/>
一个指向[CPropExchange](../../mfc/reference/cpropexchange-class.md)对象。 框架提供了此对象以建立的上下文属性 exchange，包括其方向。

### <a name="return-value"></a>返回值

如果函数成功，则非零值否则为 0。

### <a name="remarks"></a>备注

默认实现通常情况下调用此函数`COleControl::DoPropExchange`。

##  <a name="exchangestockprops"></a>  COleControl::ExchangeStockProps

序列化或初始化该控件的常用属性的状态。

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>参数

*pPX*<br/>
一个指向[CPropExchange](../../mfc/reference/cpropexchange-class.md)对象。 框架提供了此对象以建立的上下文属性 exchange，包括其方向。

### <a name="remarks"></a>备注

默认实现通常情况下调用此函数`COleControl::DoPropExchange`。

##  <a name="exchangeversion"></a>  COleControl::ExchangeVersion

序列化或初始化控件的版本信息的状态。

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>参数

*pPX*<br/>
一个指向`CPropExchange`对象。 框架提供了此对象以建立的上下文属性 exchange，包括其方向。

*dwVersionDefault*<br/>
控件的当前版本号。

*bConvert*<br/>
指示永久性数据是否应转换为最新格式保存，或保留在相同的格式加载时。

### <a name="return-value"></a>返回值

成功，则该函数的非零值否则为 0。

### <a name="remarks"></a>备注

通常，这将是第一个函数调用的控件的重写`COleControl::DoPropExchange`。 在加载时，此函数读取永久性数据的版本号，并设置的 version 属性[CPropExchange](../../mfc/reference/cpropexchange-class.md)相应对象。 保存时，此函数将写入持久性数据的版本号。

持久性和版本控制的详细信息，请参阅文章[ActiveX 控件： 序列化](../../mfc/mfc-activex-controls-serializing.md)。

##  <a name="fireclick"></a>  COleControl::FireClick

鼠标单击活动控件上方时由框架调用。

```
void FireClick();
```

### <a name="remarks"></a>备注

如果此事件定义为自定义事件，您可以确定在激发事件时。

对于自动触发 Click 事件发生，该控件的事件映射必须具有常用 Click 事件定义的。

##  <a name="firedblclick"></a>  COleControl::FireDblClick

当鼠标位于双击活动控件上方时由框架调用。

```
void FireDblClick();
```

### <a name="remarks"></a>备注

如果此事件定义为自定义事件，您可以确定在激发事件时。

对于自动触发 DblClick 事件的发生，控件的事件映射必须具有定义的常用 DblClick 事件。

##  <a name="fireerror"></a>  COleControl::FireError

触发股票的错误事件。

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>参数

*scode*<br/>
要报告的状态代码值。 可能的代码的完整列表，请参阅文章[ActiveX 控件： 高级主题](../../mfc/mfc-activex-controls-advanced-topics.md)。

*lpszDescription*<br/>
正在报告的错误的说明。

*nHelpID*<br/>
报告的错误的帮助 ID。

### <a name="remarks"></a>备注

此事件提供一种信令错误发生在控件内，在你的代码中的相应位置。 与其他常用事件，例如，单击或 MouseMove 不同错误永远不会引发由框架中。

若要报告的属性 get 函数、 属性集函数或自动化方法过程中发生错误，请调用[colecontrol:: Throwerror](#throwerror)。

OLE 控件的股票错误事件的实现使用 SCODE 值。 如果您的控件使用此事件，并且打算在 Visual Basic 4.0 中使用，你将收到错误，因为在 Visual Basic 中不支持 SCODE 值。

若要解决此问题，手动更改该控件中的 SCODE 参数。ODL 文件**长**。 此外，任何自定义事件、 方法或属性，可使用 SCODE 参数还会导致相同的问题。

##  <a name="fireevent"></a>  COleControl::FireEvent

触发从您的控件与任意数量的可选自变量，为用户定义的事件。

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>参数

*dispid*<br/>
要触发的事件的调度 ID。

*pbParams*<br/>
事件的参数类型描述符。

### <a name="remarks"></a>备注

通常应不直接调用此函数。 而是将事件映射部分中的控件的类声明中调用事件触发函数。

*PbParams*参数是以空格分隔的列表**VTS_**。 其中一个或多个值（由空格（而不是逗号）分隔）指定函数的参数列表。 可能的值如下：

|符号|参数类型|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE *|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  其他变体常量已定义的所有变量的类型，除 VTS_FONT 和 VTS_PICTURE，提供变量数据常量的指针。 使用命名这些常量**VTS_P** `constantname`约定。 例如，VTS_PCOLOR 是指向 VTS_COLOR 常量的指针。

##  <a name="firekeydown"></a>  COleControl::FireKeyDown

当控件处于活动状态的用户界面按下某个键时由框架调用。

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>参数

*pnChar*<br/>
为虚拟键代码值的按下的键的指针。 标准虚拟键代码的列表，请参见 Winuser.h

*nShiftState*<br/>
包含以下标志的组合：

- 在操作期间按下了 SHIFT_MASK SHIFT 键。

- 在操作期间按下了 CTRL_MASK CTRL 键。

- 在操作期间按下 ALT_MASK ALT 键。

### <a name="remarks"></a>备注

如果此事件定义为自定义事件，您可以确定在激发事件时。

对于自动触发 KeyDown 事件的发生，控件的事件映射必须具有定义的常用 KeyDown 事件。

##  <a name="firekeypress"></a>  COleControl::FireKeyPress

当按下某个键并将其释放自定义控件处于 UI 活动状态的容器内时由框架调用。

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>参数

*pnChar*<br/>
指向所按的键的字符值的指针。

### <a name="remarks"></a>备注

如果此事件定义为自定义事件，您可以确定在激发事件时。

事件的接收方可能会修改*pnChar*，例如，将所有小写字符转换为大写。 如果你想要检查修改后的字符，重写`OnKeyPressEvent`。

对于自动触发 KeyPress 事件的发生，控件的事件映射必须具有定义的常用 KeyPress 事件。

##  <a name="firekeyup"></a>  COleControl::FireKeyUp

自定义控件处于 UI 活动状态的容器内时松开某个键时由框架调用。

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>参数

*pnChar*<br/>
指向已发布的项的虚拟键代码值。 标准虚拟键代码的列表，请参见 Winuser.h

*nShiftState*<br/>
包含以下标志的组合：

- 在操作期间按下了 SHIFT_MASK SHIFT 键。

- 在操作期间按下了 CTRL_MASK CTRL 键。

- 在操作期间按下 ALT_MASK ALT 键。

### <a name="remarks"></a>备注

如果此事件定义为自定义事件，您可以确定在激发事件时。

对于自动触发的 KeyUp 事件发生的控件的事件映射必须具有定义的常用 KeyUp 事件。

##  <a name="firemousedown"></a>  COleControl::FireMouseDown

活动的自定义控件上按鼠标按钮时由框架调用。

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>参数

*n 按钮*<br/>
按下鼠标按钮的数值。 它可以包含以下值之一：

- LEFT_BUTTON 鼠标左键已按下。

- MIDDLE_BUTTON 鼠标中键已按下。

- RIGHT_BUTTON 鼠标右键已按下。

*nShiftState*<br/>
包含以下标志的组合：

- 在操作期间按下了 SHIFT_MASK SHIFT 键。

- 在操作期间按下了 CTRL_MASK CTRL 键。

- 在操作期间按下 ALT_MASK ALT 键。

*x*<br/>
鼠标左键已按下时，光标 x 坐标。 坐标是相对于控件窗口的左上角。

*y*<br/>
鼠标左键已按下时，光标的 y 坐标。 坐标是相对于控件窗口的左上角。

### <a name="remarks"></a>备注

如果此事件定义为自定义事件，您可以确定在激发事件时。

对于自动触发鼠标按下事件的发生，控件的事件映射必须具有定义的常用 MouseDown 事件。

##  <a name="firemousemove"></a>  COleControl::FireMouseMove

当光标移到活动的自定义控件上，由框架调用。

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>参数

*n 按钮*<br/>
按下鼠标按钮的数值。 包含以下值的组合：

- 在操作期间按下鼠标左键了 LEFT_BUTTON。

- MIDDLE_BUTTON 操作期间按下鼠标中按钮了。

- RIGHT_BUTTON 操作期间按下鼠标右键按钮了。

*nShiftState*<br/>
包含以下标志的组合：

- 在操作期间按下了 SHIFT_MASK SHIFT 键。

- 在操作期间按下了 CTRL_MASK CTRL 键。

- 在操作期间按下 ALT_MASK ALT 键。

*x*<br/>
光标的 x 坐标。 坐标是相对于控件窗口的左上角。

*y*<br/>
光标的 y 坐标。 坐标是相对于控件窗口的左上角。

### <a name="remarks"></a>备注

如果此事件定义为自定义事件，您可以确定在激发事件时。

对于自动触发 MouseMove 事件的发生，控件的事件映射必须具有定义的常用 MouseMove 事件。

##  <a name="firemouseup"></a>  COleControl::FireMouseUp

当在活动的自定义控件上释放鼠标按钮时由框架调用。

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>参数

*n 按钮*<br/>
释放鼠标按钮的数值。 它可以具有以下值之一：

- LEFT_BUTTON 鼠标左键已释放。

- 发布 MIDDLE_BUTTON 鼠标中键。

- RIGHT_BUTTON 鼠标右键已释放。

*nShiftState*<br/>
包含以下标志的组合：

- 在操作期间按下了 SHIFT_MASK SHIFT 键。

- 在操作期间按下了 CTRL_MASK CTRL 键。

- 在操作期间按下 ALT_MASK ALT 键。

*x*<br/>
游标已释放鼠标左键时的 x 坐标。 坐标是相对于控件窗口的左上角。

*y*<br/>
游标已释放鼠标左键时的 y 坐标。 坐标是相对于控件窗口的左上角。

### <a name="remarks"></a>备注

如果此事件定义为自定义事件，您可以确定在激发事件时。

对于自动触发 MouseUp 事件的发生，控件的事件映射必须具有定义的常用 MouseUp 事件。

##  <a name="firereadystatechange"></a>  COleControl::FireReadyStateChange

触发事件与就绪状态的控件的当前值。

```
void FireReadyStateChange();
```

### <a name="remarks"></a>备注

就绪状态可以是下列值之一：

READYSTATE_UNINITIALIZED 默认初始化状态

READYSTATE_LOADING 控件当前正在加载其属性

READYSTATE_LOADED 控件已经初始化

READYSTATE_INTERACTIVE 控件有数据不足，无法进行交互，但尚未加载不全都是异步的数据

READYSTATE_COMPLETE 控件具有其所有数据

使用[GetReadyState](#getreadystate)来确定控件的当前的准备情况。

[InternalSetReadyState](#internalsetreadystate)就绪状态更改为值提供，然后调用`FireReadyStateChange`。

##  <a name="getactivationpolicy"></a>  COleControl::GetActivationPolicy

更改支持的控件的默认激活行为`IPointerInactive`接口。

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>返回值

POINTERINACTIVE 枚举中的标志的组合。 可能的标志包括：

POINTERINACTIVE_ACTIVATEONENTRY 对象应该是就地激活时在鼠标移动操作期间鼠标进入它。

POINTERINACTIVE_DEACTIVATEONLEAVE 应停用该对象，当鼠标离开对象期间鼠标移动操作。

POINTERINACTIVE_ACTIVATEONDRAG 对象应就地激活期间将它上拖动鼠标时，并删除操作。

### <a name="remarks"></a>备注

当`IPointerInactive`启用接口，容器将委托 WM_SETCURSOR 和 WM_MOUSEMOVE 消息到它。 `COleControl`适当地调整鼠标坐标后，此接口的实现将调度通过控件的消息映射，这些消息。

每当容器将通过非活动状态的对象支持接收 WM_SETCURSOR 或 WM_MOUSEMOVE 消息使用鼠标指针`IPointerInactive`，则应调用`GetActivationPolicy`上的接口和 POINTERINACTIVE 枚举中返回的标志。

可以通过将相应的条目添加到消息映射处理这些消息就像普通的窗口消息一样。 在您的处理程序，避免使用`m_hWnd`成员变量 （或使用它的任何成员函数） 而不必首先检查其值为非 NULL。

用于执行多个设置鼠标光标和/或触发鼠标移动事件，例如任何对象提供特殊可视反馈、 应返回 POINTERINACTIVE_ACTIVATEONENTRY 标志和绘制活动时仅的反馈。 如果此标志返回的对象，应立即将其在就地激活，然后将其转发触发对调用的同一消息容器`GetActivationPolicy`。

如果返回 POINTERINACTIVE_ACTIVATEONENTRY 和 POINTERINACTIVE_DEACTIVATEONLEAVE 标志，然后该对象将仅被激活，当鼠标位于对象时。 如果只返回 POINTERINACTIVE_ACTIVATEONENTRY 标志，然后该对象将才会激活鼠标首次进入该对象。

您可能想要作为目标的 OLE 拖放操作的非活动控件。 这要求用户将对象拖到它，此时激活控件，以便可以将控件的窗口注册为放置目标。 若要使以在拖动过程进行激活，请返回 POINTERINACTIVE_ACTIVATEONDRAG 标志：

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

信息传达的信息`GetActivationPolicy`容器不应缓存。 相反，每次鼠标进入非活动状态的对象时，应调用此方法。

如果处于非活动状态的对象未请求要就地激活当鼠标进入它时，其容器应后续 WM_SETCURSOR 将消息调度到此对象通过调用[OnInactiveSetCursor](#oninactivesetcursor)只要鼠标指针上的对象保持不变。

启用`IPointerInactive`接口通常表示你希望控件，使其能够在任何时候处理鼠标消息。 若要在不支持的容器中获取此行为`IPointerInactive`接口，您将需要具有控件始终激活时可见，这意味着该控件应具有在其各种标志 OLEMISC_ACTIVATEWHENVISIBLE 标志。 但是，若要防止从此标志，并且在容器中的生效支持`IPointerInactive`，还可以指定 OLEMISC_IGNOREACTIVATEWHENVISIBLE 标志：

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>  COleControl::GetAmbientProperty

获取容器的环境属性的值。

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>参数

*dwDispid*<br/>
所需的环境属性的调度 ID。

*vtProp*<br/>
指定要在中返回的值的类型的变体类型标记*pvProp*。

*pvProp*<br/>
指向将接收的属性值或返回值的变量的地址的指针。 This 指针的实际类型必须匹配指定的类型*vtProp*。

|vtProp|PvProp 的类型|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>返回值

如果支持环境的属性，则非零值否则为 0。

### <a name="remarks"></a>备注

如果您使用`GetAmbientProperty`若要检索的环境的 DisplayName 和 ScaleUnits 属性，设置*vtProp*为 VT_BSTR 和*pvProp*到`CString*`。 如果要检索环境字体属性，设置*vtProp*到 VT_FONT 和*pvProp*到 LPFONTDISP *。

请注意，函数已提供常见的环境属性，如[AmbientBackColor](#ambientbackcolor)并[AmbientFont](#ambientfont)。

##  <a name="getappearance"></a>  COleControl::GetAppearance

实现控件的外观的常用属性的 Get 函数。

```
short GetAppearance ();
```

### <a name="return-value"></a>返回值

返回的值指定为当前的外观设置**短**(VT_I2) 值，如果成功。 如果控件的外观是平面，1，则该控件的外观是 3D，此值为零。

##  <a name="getbackcolor"></a>  COleControl::GetBackColor

实现控件的背景色的常用属性的 Get 函数。

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>返回值

如果成功，返回值为 OLE_COLOR 值，指定当前的背景色。 此值可以通过调用转换为 COLORREF 值`TranslateColor`。

##  <a name="getborderstyle"></a>  COleControl::GetBorderStyle

实现控件的边框样式的常用属性的 Get 函数。

```
short GetBorderStyle();
```

### <a name="return-value"></a>返回值

如果控件具有正常的边框;，1如果控件具有没有边框，则为 0。

##  <a name="getcapture"></a>  COleControl::GetCapture

确定是否`COleControl`对象具有鼠标捕获。

```
CWnd* GetCapture();
```

### <a name="return-value"></a>返回值

如果该控件已激活并无窗口，将返回**这**如果该控件当前具有鼠标捕获 （作为由控件的容器），或如果它不具有捕获，则为 NULL。

否则，返回`CWnd`具有鼠标捕获的对象 (与相同`CWnd::GetCapture`)。

### <a name="remarks"></a>备注

已激活的无窗口控件在接收到鼠标捕获时[SetCapture](#setcapture)调用。

##  <a name="getclassid"></a>  COleControl::GetClassID

由框架调用以检索 OLE 类 ID 的控件。

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>参数

*pclsid*<br/>
指向的位置的类 id。

### <a name="return-value"></a>返回值

如果该调用未成功，则非零值否则为 0。

### <a name="remarks"></a>备注

通常由实现[IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)。

##  <a name="getclientoffset"></a>  COleControl::GetClientOffset

检索控件的矩形区域左上的角和其工作区的左上的角的区别。

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>参数

*pdxOffset*<br/>
指向 OLE 控件的客户端区域的水平偏移量。

*pdyOffset*<br/>
指向 OLE 控件的客户端区域的垂直偏移量。

### <a name="remarks"></a>备注

OLE 控件具有在其容器内的矩形区域。 控件的客户端区域是不包括边框及滚动条的控件区域。 偏移量来检索`GetClientOffset`是控件的矩形区域左上的角和其工作区的左上的角的区别。 如果控件有非客户端元素而非标准边框和滚动条，重写此成员函数以指定偏移量。

##  <a name="getclientrect"></a>  COleControl::GetClientRect

检索控件的工作区的大小。

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>参数

*lpRect*<br/>
指向`RECT`结构，它包含无窗口控件的客户端区域的尺寸; 即，该控件的大小减去窗口边框、 帧、 滚动条和等等。 *LpRect*参数指示该控件的客户端矩形，而非其位置的大小。

##  <a name="getclientsite"></a>  COleControl::GetClientSite

将查询一个对象，用于指向其当前的客户端站点，在其容器内的指针。

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>返回值

在容器中控件的当前客户端站点指向的指针。

### <a name="remarks"></a>备注

返回的指针指向的实例`IOleClientSite`。 `IOleClientSite`由容器实现的接口是其上下文的对象的视图： 其定位在文档中，其中它将获取其存储、 用户界面和其他资源。

##  <a name="getcontrolflags"></a>  COleControl::GetControlFlags

检索控制标志设置。

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>返回值

ControlFlags 枚举中的标志或运算组合：

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>备注

默认情况下`GetControlFlags`返回`fastBeginPaint | clipPaintDC`。

|||
|-|-|
|`fastBeginPaint`|如果设置，请使用 begin 画图函数定制而不是 OLE 控件的[BeginPaint](/windows/desktop/api/winuser/nf-winuser-beginpaint) API （默认设置）。|
|`clipPaintDC`|如果未设置，禁用对`IntersectClipRect`所做的`COleControl`和获得小的速度优势。 如果使用无窗口激活，则该标志无效。|
|`pointerInactive`|如果设置，提供鼠标交互，而您的控件处于非活动状态，从而`COleControl`的实现`IPointerInactive`接口，它默认处于禁用状态。|
|`noFlickerActivate`|如果设置，又能避免额外绘制操作和伴随的可视闪烁。 当您的控件绘制自身相同处于非活动和活动状态时使用。 如果使用无窗口激活，则该标志无效。|
|`windowlessActivate`|如果设置，则表示您的控件使用无窗口激活。|
|`canOptimizeDraw`|如果设置，则指示该控件将执行优化的绘图，如果该容器支持它。|

有关详细信息`GetControlFlags`和其他优化 OLE 控件，请参阅[ActiveX 控件： 优化](../../mfc/mfc-activex-controls-optimization.md)。

##  <a name="getcontrolsize"></a>  COleControl::GetControlSize

检索 OLE 控件窗口的大小。

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>参数

*pcx*<br/>
以像素为单位指定控件的宽度。

*pcy*<br/>
以像素为单位指定控件的高度。

### <a name="remarks"></a>备注

请注意，用于控制 windows 的所有坐标都都相对于控件的左上角。

##  <a name="getdc"></a>  COleControl::GetDC

从其容器为无窗口对象提供到 get 屏幕 （或兼容） 的设备上下文。

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>参数

*lprcRect*<br/>
无窗口控件的矩形的指针想要重绘控件的工作区中。 NULL 表示完整对象的范围。

*dwFlags*<br/>
绘制的设备上下文的属性。 选项包括：

- OLEDC_NODRAW 指示，该对象不会使用设备上下文以执行任何绘图但只以获取有关显示设备的信息。 容器应只需传入窗口的 DC，而无需进一步处理。

- OLEDC_PAINTBKGND 请求容器返回 DC 之前绘制背景。 对象应使用此标志，如果它请求 DC 绘制带有透明背景的区域。

- OLEDC_OFFSCREEN 通知对象想要呈现到屏幕外位图，然后复制到屏幕的容器。 对象应使用此标志时它将执行绘制操作会生成大量闪烁。 容器是免费可以或不接受此请求。 但是，如果未设置此标志，容器必须退回屏幕 DC。 这允许执行直接屏幕操作，例如显示选择的对象 (通过**XOR**操作)。

### <a name="return-value"></a>返回值

为容器的显示设备上下文指针`CWnd`工作区如果成功; 否则为返回值为 NULL。 显示设备上下文可以在后续的 GDI 函数，用于在容器的窗口的客户端区域中绘制。

### <a name="remarks"></a>备注

[ReleaseDC](#releasedc)必须调用成员函数来绘制后释放上下文。 调用时`GetDC`，对象将传递者想要在其自己的工作区坐标中绘制到的矩形。 `GetDC` 将转换到的容器工作区的坐标。 该对象应该不会请求所需的绘制矩形大于其自己的客户端区域矩形，可通过检索它的大小[GetClientRect](#getclientrect)。 这可以防止无意中绘制，它们不应为对象。

##  <a name="getenabled"></a>  COleControl::GetEnabled

实现控件的股票 Enabled 属性的 Get 函数。

```
BOOL GetEnabled();
```

### <a name="return-value"></a>返回值

如果启用控件，则非零值否则为 0。

##  <a name="getextendedcontrol"></a>  COleControl::GetExtendedControl

获取指向表示具有一组扩展的属性的控件的容器所维护的对象的指针。

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>返回值

指向容器的扩展控件对象。 如果没有可用的对象，则该值为 NULL。

此对象可能会通过操作其`IDispatch`接口。 此外可以使用`QueryInterface`获取对象提供的其他可用接口。 但是，该对象不需要支持一组特定的接口。 请注意，依赖于容器的扩展的控件对象的特定功能限制到其他任意容器控件的可移植性。

### <a name="remarks"></a>备注

调用此函数的函数会释放时已完成，但该对象的指针。 请注意，不需要容器为支持此对象。

##  <a name="getfocus"></a>  COleControl::GetFocus

确定是否`COleControl`对象具有焦点。

```
CWnd* GetFocus();
```

### <a name="return-value"></a>返回值

如果该控件已激活并无窗口，将返回**这**如果该控件当前具有键盘焦点 （作为由控件的容器），或如果它不具有焦点，则为 NULL。

否则，返回`CWnd`具有焦点的对象 (与相同`CWnd::GetFocus`)。

### <a name="remarks"></a>备注

已激活的无窗口控件接收焦点时[SetFocus](#setfocus)调用。

##  <a name="getfont"></a>  COleControl::GetFont

实现常用字体属性的 Get 函数。

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>返回值

指向控件的常用字体属性的字体调度接口的指针。

### <a name="remarks"></a>备注

请注意，调用方必须释放对象时完成。 在控件实现中，使用`InternalGetFont`访问控件的常用字体对象。 使用您的控件中的字体的详细信息，请参阅文章[ActiveX 控件： 在 ActiveX 控件中使用字体](../../mfc/mfc-activex-controls-using-fonts.md)。

##  <a name="getfonttextmetrics"></a>  COleControl::GetFontTextMetrics

度量值的文本指标，针对任何`CFontHolder`所拥有的控件对象。

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>参数

*lptm*<br/>
指向[TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica)结构。

*fontHolder*<br/>
引用[CFontHolder](../../mfc/reference/cfontholder-class.md)对象。

### <a name="remarks"></a>备注

可以使用选择这种字体[COleControl::SelectFontObject](#selectfontobject)函数。 `GetFontTextMetrics` 将初始化`TEXTMETRIC`指向结构*lptm*有效指标有关的信息`fontHolder`的字体，如果成功，或如果不成功，则用零填充结构。 应使用此函数，而不是[GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics)时绘制控件，因为控件，像任何嵌入 OLE 对象，可能需要自行呈现到图元文件。

`TEXTMETRIC`结构的默认字体为刷新时[SelectFontObject](#selectfontobject)调用函数。 应调用`GetFontTextMetrics`唯一后选择常用的字体属性，以确保它提供的信息是否有效。

##  <a name="getforecolor"></a>  COleControl::GetForeColor

实现常用的前景色属性的 Get 函数。

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>返回值

如果成功，返回值为 OLE_COLOR 值，指定的当前前景色。 此值可以转换为[COLORREF](/windows/desktop/gdi/colorref)值，该值具有调用`TranslateColor`。

##  <a name="gethwnd"></a>  COleControl::GetHwnd

实现常用 hWnd 属性的 Get 函数。

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>返回值

OLE 控件的窗口句柄，如果有的话;否则为，为 NULL。

##  <a name="getmessagestring"></a>  COleControl::GetMessageString

由框架调用以获取短字符串，描述由标识的菜单项的目的*nID*。

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>参数

*nID*<br/>
菜单项 id。

*rMessage*<br/>
对引用[CString](../../atl-mfc-shared/reference/cstringt-class.md)对象通过返回的字符串。

### <a name="remarks"></a>备注

这可以用于获取在状态栏中显示一条消息，而突出显示的菜单项。 尝试加载由标识的字符串资源的默认实现*nID*。

##  <a name="getnotsupported"></a>  COleControl::GetNotSupported

可防止对用户控件的属性值的访问。

```
void GetNotSupported();
```

### <a name="remarks"></a>备注

调用此函数来代替任何属性的 Get 函数不支持的控件的用户属性检索的。 例如，可以是只写的属性。

##  <a name="getreadystate"></a>  COleControl::GetReadyState

返回控件的就绪状态。

```
long GetReadyState();
```

### <a name="return-value"></a>返回值

就绪状态为控件，下列值之一：

READYSTATE_UNINITIALIZED 默认初始化状态

READYSTATE_LOADING 控件当前正在加载其属性

READYSTATE_LOADED 控件已经初始化

READYSTATE_INTERACTIVE 控件有数据不足，无法进行交互，但尚未加载不全都是异步的数据

READYSTATE_COMPLETE 控件具有其所有数据

### <a name="remarks"></a>备注

大多数简单控件永远不需要区分 LOADED 和交互。 但是，支持数据路径属性的控件可能不是准备好进行交互，直到异步接收到至少某些数据。 控件应尝试尽可能快地变为交互模式。

##  <a name="getrectincontainer"></a>  COleControl::GetRectInContainer

获取相对于容器，以设备单位表示控件的矩形的坐标。

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>参数

*lpRect*<br/>
指向控件的坐标将复制到其中的矩形结构的指针。

### <a name="return-value"></a>返回值

如果控件是处于就地活动状态; 非零值否则为 0。

### <a name="remarks"></a>备注

矩形才有效的控件是处于就地活动状态。

##  <a name="getstocktextmetrics"></a>  COleControl::GetStockTextMetrics

测量控件的常用字体属性，这可以使用所选文本规格[SelectStockFont](#selectstockfont)函数。

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>参数

*lptm*<br/>
一个指向[TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica)结构。

### <a name="remarks"></a>备注

`GetStockTextMetrics`函数将初始化`TEXTMETRIC`指向结构*lptm*带有效指标信息如果成功或填充零，如果不成功，则该结构。 使用此函数，而不是[GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics)时绘制控件，因为控件，像任何嵌入 OLE 对象，可能需要自行呈现到图元文件。

`TEXTMETRIC`结构的默认字体为刷新时`SelectStockFont`调用函数。 仅选择常用的字体，以确保它提供的信息有效之后，应调用此函数。

##  <a name="gettext"></a>  COleControl::GetText

实现常用的文本或标题属性的 Get 函数。

```
BSTR GetText();
```

### <a name="return-value"></a>返回值

控件的文本字符串或如果不有任何字符串的长度为零的字符串的当前值。

> [!NOTE]
>  BSTR 数据类型的详细信息，请参阅[数据类型](../../mfc/reference/data-types-mfc.md)宏和全局函数部分中。

### <a name="remarks"></a>备注

请注意，此函数的调用方必须调用`SysFreeString`对字符串返回以便免费资源。 在控件实现中，使用`InternalGetText`访问控件的常用文本或标题属性。

##  <a name="getwindowlessdroptarget"></a>  COleControl::GetWindowlessDropTarget

重写`GetWindowlessDropTarget`时您希望无窗口控件为目标的 OLE 拖放操作。

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>返回值

指向对象的指针`IDropTarget`接口。 因为它不会在窗口中，无窗口对象无法注册`IDropTarget`接口。 但是，若要参与拖放功能，无窗口对象可以仍实现接口并返回它在`GetWindowlessDropTarget`。

### <a name="remarks"></a>备注

通常，这需要将该控件的窗口注册为放置目标。 但由于该控件没有自己的窗口，该容器将使用其自己的窗口，为放置目标。 该控件只是需要提供的一个实现`IDropTarget`接口到的容器可以委托的调用在适当的时间。 例如：

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>  COleControl::InitializeIIDs

通知控件将使用的 Iid 的基类。

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>参数

*piidPrimary*<br/>
为控件的主调度接口的接口 ID 的指针。

*piidEvents*<br/>
为控件的事件接口的接口 ID 的指针。

### <a name="remarks"></a>备注

控件的构造函数来通知的接口 Id，将使用您的控件的基类中调用此函数。

##  <a name="internalgetfont"></a>  COleControl::InternalGetFont

访问您的控件的堆栈 Font 属性

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>返回值

对引用[CFontHolder](../../mfc/reference/cfontholder-class.md)对象，其中包含常用字体对象。

##  <a name="internalgettext"></a>  COleControl::InternalGetText

访问控件的常用的文本或标题属性。

```
const CString& InternalGetText();
```

### <a name="return-value"></a>返回值

对控件的文本字符串的引用。

##  <a name="internalsetreadystate"></a>  COleControl::InternalSetReadyState

设置控件的就绪状态。

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>参数

*lNewReadyState*<br/>
要设置进行控制，以下值之一的准备情况状态：

READYSTATE_UNINITIALIZED 默认初始化状态

READYSTATE_LOADING 控件当前正在加载其属性

READYSTATE_LOADED 控件已经初始化

READYSTATE_INTERACTIVE 控件有数据不足，无法进行交互，但尚未加载不全都是异步的数据

READYSTATE_COMPLETE 控件具有其所有数据

### <a name="remarks"></a>备注

大多数简单控件永远不需要区分 LOADED 和交互。 但是，支持数据路径属性的控件可能不是准备好进行交互，直到异步接收到至少某些数据。 控件应尝试尽可能快地变为交互模式。

##  <a name="invalidatecontrol"></a>  COleControl::InvalidateControl

强制控件重绘自身。

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>参数

*lpRect*<br/>
指向要失效的控件的区域的指针。

*bErase*<br/>
指定是否要清除时处理更新区域中更新区域的背景。

### <a name="remarks"></a>备注

如果*lpRect*具有 NULL 值，将重新绘制整个控件。 如果*lpRect*不为 NULL，这表示的是无效的控件的矩形部分。 在其中控件没有窗口或当前未处于活动状态，该矩形忽略，并且调用客户端站点的情况下[IAdviseSink::OnViewChange](/windows/desktop/api/objidl/nf-objidl-iadvisesink-onviewchange)成员函数。 使用此函数，而不是`CWnd::InvalidateRect`或`InvalidateRect`。

##  <a name="invalidatergn"></a>  COleControl::InvalidateRgn

使给定区域内的容器窗口的客户端区域无效。

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>参数

*pRgn*<br/>
一个指向[CRgn](../../mfc/reference/crgn-class.md)对象，用于标识要使之无效，在包含窗口的工作区中的 OLE 对象的显示区域。 如果此参数为 NULL，范围是整个对象。

*bErase*<br/>
指定是否要清除无效的区域中的背景。 如果为 TRUE，将清除背景。 如果为 FALSE，则在后台保持不变。

### <a name="remarks"></a>备注

这可用来重绘无窗口控件容器中。 无效的区域，以及更新区域中的所有其他区域标记为进行绘制时的下一步[WM_PAINT](/windows/desktop/gdi/wm-paint)发送消息。

如果*bErase*是 TRUE 的清除更新区域，而不仅仅是在给定部件的整个区域中的背景的任意部分。

##  <a name="isconvertingvbx"></a>  COleControl::IsConvertingVBX

允许 OLE 控件的专用的加载。

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>返回值

如果控件正在转换; 非零值否则为 0。

### <a name="remarks"></a>备注

当转换使用 VBX 的窗体控件添加到另一个使用 OLE 控件时，可能需要 OLE 控件的特殊加载代码。 例如，如果你加载的 OLE 控件的实例，则可能必须调用[PX_Font](persistence-of-ole-controls.md#px_font)在你`DoPropExchange`:

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

但是，VBX 控件没有字体对象;单独保存每个字体属性。 在这种情况下，将使用`IsConvertingVBX`来区分这两种情况：

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

如果将 VBX 控件保存专有二进制数据 （在其 VBM_SAVEPROPERTY 消息处理程序），并且 OLE 控件将其二进制数据保存在不同的格式是另一种情况。 如果您希望 OLE 控件要与该 VBX 控件向后兼容，无法读取使用的这两种旧的和新格式`IsConvertingVBX`通过区分是否正在加载 VBX 控件或 OLE 控件的函数。

在控件的`DoPropExchange`函数，您可以检查此条件并如果为 true，执行加载代码特定于此的转换，（如前面的示例）。 如果控件不会被转换，可以执行正常的负载的代码。 此功能才适用于从 VBX 对应项要转换的控件。

##  <a name="isinvokeallowed"></a>  COleControl::IsInvokeAllowed

启用自动化方法调用。

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>返回值

如果控件已初始化; 非零值否则为 0。

### <a name="remarks"></a>备注

框架的实现`IDispatch::Invoke`调用`IsInvokeAllowed`若要确定给定的函数 (由标识`dispid`) 可能会调用。 OLE 控件的默认行为是允许仅当控件已初始化; 调用自动化方法但是，`IsInvokeAllowed`是虚拟函数，可以被重写如有必要 （例如，当控件用作自动化服务器）。 有关详细信息，请参阅知识库文章 Q166472，"如何： 使用 OLE 控件作为自动化服务器。" 知识库文章位于[ http://support.microsoft.com ](http://support.microsoft.com/)。

##  <a name="ismodified"></a>  COleControl::IsModified

确定控件的状态已被修改。

```
BOOL IsModified();
```

### <a name="return-value"></a>返回值

如果自上次保存; 控件的状态已被修改，非零值否则为 0。

### <a name="remarks"></a>备注

当属性值更改时，则修改控件的状态。

##  <a name="isoptimizeddraw"></a>  Colecontrol:: Isoptimizeddraw

确定容器是否为当前的绘制操作支持优化的绘图。

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>返回值

如果该容器支持优化的绘图当前绘图操作; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

如果支持优化的绘图，然后该控件需要时，选择旧的对象 （钢笔、 画笔、 字体、 等） 设备上下文中完成绘图。

##  <a name="issubclassedcontrol"></a>  COleControl::IsSubclassedControl

由框架调用以确定是否控件子类 Windows 控制。

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>返回值

如果该控件进行了子类化; 非零值否则为 0。

### <a name="remarks"></a>备注

必须重写此函数并返回 TRUE，如果你 OLE 控制 Windows 控件子类。

##  <a name="load"></a>  COleControl::Load

重置以异步方式加载所有以前的数据，并启动新加载的控件的异步属性。

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>参数

*strNewPath*<br/>
指向包含引用异步控件属性的绝对位置路径的字符串的指针。

*属性*<br/>
一个[CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md)实现异步控件属性的对象。

##  <a name="lockinplaceactive"></a>  COleControl::LockInPlaceActive

可防止容器停用您的控件。

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>参数

*块*<br/>
如果该控件的就地活动状态将被锁定; 则为 TRUE如果它是将其解锁，则为 FALSE。

### <a name="return-value"></a>返回值

如果锁定成功，则非零值否则为 0。

### <a name="remarks"></a>备注

请注意必须与控件完成解锁成对每个控件的锁定。 你应仅锁定您的控件短时间内，如触发事件时。

##  <a name="onambientpropertychange"></a>  COleControl::OnAmbientPropertyChange

当容器的环境属性已更改值时由框架调用。

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>参数

*dispID*<br/>
发生更改时，环境属性的调度 ID 或 DISPID_UNKNOWN 如果多个属性已更改。

##  <a name="onappearancechanged"></a>  COleControl::OnAppearanceChanged

股票的外观属性值发生更改时由框架调用。

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>备注

如果希望在此属性更改后的通知，重写此函数。 默认实现将调用`InvalidateControl`。

##  <a name="onbackcolorchanged"></a>  COleControl::OnBackColorChanged

股票 BackColor 属性值发生更改时由框架调用。

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>备注

如果希望在此属性更改后的通知，重写此函数。 默认实现将调用`InvalidateControl`。

##  <a name="onborderstylechanged"></a>  COleControl::OnBorderStyleChanged

股票 BorderStyle 属性值发生更改时由框架调用。

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>备注

默认实现将调用`InvalidateControl`。

如果希望在此属性更改后的通知，重写此函数。

##  <a name="onclick"></a>  COleControl::OnClick

已单击鼠标按钮或调用 DoClick 常用方法时由框架调用。

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>参数

*iButton*<br/>
鼠标按钮的索引。 可以具有以下值之一：

- LEFT_BUTTON 单击了鼠标左键。

- 单击 MIDDLE_BUTTON 鼠标中键。

- 单击了鼠标右键按钮 RIGHT_BUTTON。

### <a name="remarks"></a>备注

默认实现将调用`COleControl::FireClick`。

重写此成员函数以修改或扩展的默认处理。

##  <a name="onclose"></a>  COleControl::OnClose

当容器已调用该控件时由框架调用`IOleControl::Close`函数。

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>参数

*dwSaveOption*<br/>
该标志指示是否应在加载之前保存对象。 有效值为：

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>备注

默认情况下`OnClose`将保存的控件对象，如果已修改并*dwSaveOption* OLECLOSE_SAVEIFDIRTY 或 OLECLOSE_PROMPTSAVE。

##  <a name="ondoverb"></a>  COleControl::OnDoVerb

当容器调用时由框架调用`IOleObject::DoVerb`成员函数。

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>参数

*iVerb*<br/>
要调用中控制谓词的索引。

*lpMsg*<br/>
导致要调用的谓词的 Windows 消息指向的指针。

*hWndParent*<br/>
向控件的父窗口句柄。 如果谓词的执行将创建一个窗口 （或 windows） *hWndParent*应作为父级。

*lpRect*<br/>
指向的控件，相对于容器的工作将复制到其中的 RECT 结构的指针。

### <a name="return-value"></a>返回值

如果调用成功，则非零值否则为 0。

### <a name="remarks"></a>备注

默认实现使用 ON_OLEVERB 和 ON_STDOLEVERB 消息映射条目来确定要调用的适当函数。

重写此函数可更改默认的处理的谓词。

##  <a name="ondraw"></a>  COleControl::OnDraw

由框架调用以使用指定的设备上下文的指定边框内绘制 OLE 控件。

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>参数

*pDC*<br/>
绘图发生在其中的设备上下文。

*rcBounds*<br/>
控件，包括边框的矩形区域。

*rcInvalid*<br/>
是无效的控件的矩形区域。

### <a name="remarks"></a>备注

`OnDraw` 通常用于屏幕显示，并传递作为屏幕设备上下文调用*pDC*。 *RcBounds*参数标识的目标设备上下文 （相对于当前映射模式下） 中的矩形。 *RcInvalid*参数是无效的实际矩形。 在某些情况下，这将是比较小的区域*rcBounds*。

##  <a name="ondrawmetafile"></a>  COleControl::OnDrawMetafile

由框架调用以使用指定的图元文件设备上下文的指定边框内绘制 OLE 控件。

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>参数

*pDC*<br/>
绘图发生在其中的设备上下文。

*rcBounds*<br/>
控件，包括边框的矩形区域。

### <a name="remarks"></a>备注

默认实现调用[OnDraw](#ondraw)函数。

##  <a name="onedit"></a>  COleControl::OnEdit

导致是 UI 激活的控件。

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>参数

*lpMsg*<br/>
指向调用此谓词的 Windows 消息的指针。

*hWndParent*<br/>
控件的父窗口的句柄。

*lpRect*<br/>
指向由容器中控件的矩形的指针。

### <a name="return-value"></a>返回值

如果调用成功，则非零值否则为 0。

### <a name="remarks"></a>备注

这与调用控件的 OLEIVERB_UIACTIVATE 谓词的效果相同。

此函数通常用作 ON_OLEVERB 消息映射条目的处理程序函数。 这使"编辑"谓词出现在控件的"对象"菜单。 例如：

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>  COleControl::OnEnabledChanged

Stock Enabled 属性值发生更改时由框架调用。

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>备注

如果希望在此属性更改后的通知，重写此函数。 默认实现调用[InvalidateControl](#invalidatecontrol)。

##  <a name="onenumverbs"></a>  COleControl::OnEnumVerbs

当容器调用时由框架调用`IOleObject::EnumVerbs`成员函数。

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>参数

*ppenumOleVerb*<br/>
一个指向`IEnumOLEVERB`枚举控件的谓词的对象。

### <a name="return-value"></a>返回值

如果谓词是可用，则非零值否则为 0。

### <a name="remarks"></a>备注

默认实现枚举中的消息映射的 ON_OLEVERB 条目。

重写此函数可更改枚举谓词的默认方式。

##  <a name="oneventadvise"></a>  COleControl::OnEventAdvise

连接到或断开连接来自 OLE 控件的事件处理程序时由框架调用。

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>参数

*bAdvise*<br/>
TRUE 表示一个事件处理程序已连接到控件。 FALSE 表示从控件断开连接事件处理程序。

##  <a name="onfontchanged"></a>  COleControl::OnFontChanged

常用字体属性值发生更改时由框架调用。

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>备注

默认实现将调用`COleControl::InvalidateControl`。 如果控件子类化 Windows 控件，则默认实现还将 WM_SETFONT 消息发送到控件的窗口。

如果希望在此属性更改后的通知，重写此函数。

### <a name="example"></a>示例

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>  COleControl::OnForeColorChanged

股票 ForeColor 属性值发生更改时由框架调用。

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>备注

默认实现将调用`InvalidateControl`。

如果希望在此属性更改后的通知，重写此函数。

##  <a name="onfreezeevents"></a>  COleControl::OnFreezeEvents

由框架调用后容器调用`IOleControl::FreezeEvents`。

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>参数

*bFreeze*<br/>
如果控件的事件处理处于冻结状态;否则为 FALSE。

### <a name="remarks"></a>备注

默认实现不执行任何操作。

重写此函数，如果冻结或解冻事件处理时需要其他行为。

##  <a name="ongetcolorset"></a>  COleControl::OnGetColorSet

当容器调用时由框架调用`IViewObject::GetColorSet`成员函数。

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>参数

*ptd*<br/>
指向目标设备应为其呈现图片。 如果此值为 NULL，则应为默认目标设备，通常显示设备呈现图片。

*hicTargetDev*<br/>
指示在目标设备上指定的信息上下文*ptd*。 此参数可以是设备上下文，但不一定。 如果*ptd*为 NULL， *hicTargetDev*还应为 NULL。

*ppColorSet*<br/>
指向将使用的颜色集应该复制到其中的位置的指针。 如果该函数不返回颜色集，则返回 NULL。

### <a name="return-value"></a>返回值

返回有效的颜色集; 如果非零值否则为 0。

### <a name="remarks"></a>备注

容器调用此函数可获取所有所需绘制 OLE 控件的颜色。 容器可以使用获取它需要设置整个调色板的颜色与结合使用的颜色集。 默认实现将返回 FALSE。

重写此函数可执行此请求的任何特殊处理。

##  <a name="ongetcontrolinfo"></a>  COleControl::OnGetControlInfo

当控件的容器已请求有关控件的信息时由框架调用。

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>参数

*pControlInfo*<br/>
指向[CONTROLINFO](/windows/desktop/api/ocidl/ns-ocidl-tagcontrolinfo)要填充的结构。

### <a name="remarks"></a>备注

此信息主要由控件的助记键的说明。 默认实现填充*pControlInfo*与默认的信息。

如果您的控件需要处理助记键，重写此函数。

##  <a name="ongetdisplaystring"></a>  COleControl::OnGetDisplayString

由框架调用以获取一个字符串，表示通过标识的属性的当前值*dispid*。

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>参数

*dispid*<br/>
该控件的属性的调度 ID。

*strValue*<br/>
对引用[CString](../../atl-mfc-shared/reference/cstringt-class.md)对象通过返回的字符串。

### <a name="return-value"></a>返回值

如果已在返回的字符串的非零*strValue;* 否则为 0。

### <a name="remarks"></a>备注

如果您的控件具有其值不能直接转换为字符串的属性，并且你想要在容器提供属性浏览器中显示的属性的值来覆盖此函数。

##  <a name="ongetinplacemenu"></a>  COleControl::OnGetInPlaceMenu

当控件处于用户界面激活以获取要合并到容器的现有菜单的菜单时由框架调用。

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>返回值

控件的菜单中或如果该控件具有 none，则为 NULL 的句柄。 默认实现返回 NULL。

### <a name="remarks"></a>备注

合并 OLE 资源的详细信息，请参阅文章[菜单和资源 (OLE)](../../mfc/menus-and-resources-ole.md)。

##  <a name="ongetnaturalextent"></a>  COleControl::OnGetNaturalExtent

在响应容器的框架调用`IViewObjectEx::GetNaturalExtent`请求。

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>参数

*dwAspect*<br/>
指定要如何表示该对象。 表示形式包含内容、 图标、 缩略图或打印的文档。 有效的值取自枚举[DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)或 DVASPECT2。

*lindex*<br/>
感兴趣的是对象的部分。 当前仅为-1 是有效的。

*ptd*<br/>
指向[DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice)结构定义应当为其返回对象的大小的目标设备。

*hicTargetDev*<br/>
指定由目标设备的信息上下文*ptd*参数对象从其提取设备量度并测试设备的功能。 如果*ptd*为 NULL，该对象应忽略中的值*hicTargetDev*参数。

*pExtentInfo*<br/>
指向`DVEXTENTINFO`结构，它指定大小调整数据。 `DVEXTENTINFO`结构是：

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

结构成员`dwExtentMode`可以采用两个值之一：

- DVEXTENT_CONTENT 查询控件应该有多大以完全适合内容 （管理单元大小）

- DVEXTENT_INTEGRAL 在调整大小时，将建议的大小传递到控件

*psizel*<br/>
指向大小控制返回的数据。 返回的大小调整数据设置为-1，表示未经过调整的任何维度。

### <a name="return-value"></a>返回值

如果成功返回，或调整大小; 非零值否则为 0。

### <a name="remarks"></a>备注

重写此函数可返回对象的显示大小接近中建议的大小和扩展盘区模式`DVEXTENTINFO`结构。 默认实现返回 FALSE，并不将任何调整大小。

##  <a name="ongetpredefinedstrings"></a>  COleControl::OnGetPredefinedStrings

由框架调用以获取一组预定义的字符串表示一个属性的可能值。

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>参数

*dispid*<br/>
该控件的属性的调度 ID。

*pStringArray*<br/>
一个字符串数组中用来填充返回的值。

*pCookieArray*<br/>
一个双字节数组中用来填充返回的值。

### <a name="return-value"></a>返回值

如果元素已添加到非零*pStringArray*并*pCookieArray*。

### <a name="remarks"></a>备注

如果控件有具有一组可由字符串表示的可能值的属性，重写此函数。 添加到每个元素*pStringArray*，应添加到相应的"cookie"元素*pCookieArray。* 这些"cookie"值可能会更高版本传递到框架`COleControl::OnGetPredefinedValue`函数。

##  <a name="ongetpredefinedvalue"></a>  COleControl::OnGetPredefinedValue

由框架调用以获取对应于一个以前返回的重写的预定义字符串值`COleControl::OnGetPredefinedStrings`。

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>参数

*dispid*<br/>
该控件的属性的调度 ID。

*dwCookie*<br/>
重写以前返回的 cookie 值`COleControl::OnGetPredefinedStrings`。

*lpvarOut*<br/>
指向`VARIANT`结构，通过将其返回属性值。

### <a name="return-value"></a>返回值

如果已在返回的值非零*lpvarOut*; 否则为 0。

##  <a name="ongetviewextent"></a>  COleControl::OnGetViewExtent

调用以响应容器的框架[IViewObject2::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-iviewobject2-getextent)请求。

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>参数

*dwDrawAspect*<br/>
描述的窗体中或对象的方位，DWORD 是显示。 有效的值取自枚举[DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)或 DVASPECT2。

*lindex*<br/>
感兴趣的是对象的部分。 当前仅为-1 是有效的。

*ptd*<br/>
指向[DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice)结构定义应当为其返回对象的大小的目标设备。

*lpsizel*<br/>
指向将返回对象的大小的位置。

### <a name="return-value"></a>返回值

如果成功返回扩展盘区信息; 非零值否则为 0。

### <a name="remarks"></a>备注

如果您的控件使用两次绘图，并且其不透明和透明的部件具有不同的维度，重写此函数。

##  <a name="ongetviewrect"></a>  COleControl::OnGetViewRect

在响应容器的框架调用`IViewObjectEx::GetRect`请求。

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>参数

*dwAspect*<br/>
描述的窗体中或对象的方位，DWORD 是显示。 有效的值取自枚举[DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)或 DVASPECT2:

- DVASPECT_CONTENT 边界矩形的整个对象。 对象的源和大小相等的范围内返回的左上角`GetViewExtent` *。*

- 使用不透明的矩形区域的 DVASPECT_OPAQUE 对象返回该矩形。 其他失败。

- 覆盖透明或不定期各个 DVASPECT_TRANSPARENT 矩形。

*pRect*<br/>
指向[RECTL](https://msdn.microsoft.com/library/windows/desktop/dd162907)结构，它指定应在其中绘制该对象的矩形。 此参数控制的定位和拉伸的对象。

### <a name="return-value"></a>返回值

成功地返回矩形的大小调整为该对象; 如果非零值否则为 0。

### <a name="remarks"></a>备注

对象的大小来转换`OnGetViewRect`在一个矩形的 （默认为显示的左上的角） 的特定位置开始。 如果您的控件使用两次绘图，并且其不透明和透明的部件具有不同的维度，重写此函数。

##  <a name="ongetviewstatus"></a>  COleControl::OnGetViewStatus

在响应容器的框架调用`IViewObjectEx::GetViewStatus`请求。

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>返回值

如果成功，则 VIEWSTATUS 枚举值之一否则为 0。 可能的值为以下任意组合：

VIEWSTATUS_OPAQUE 对象是完全不透明的。 如果未设置此位，该对象包含透明部分。 此位仅适用于与内容相关的方面和不适用于 DVASPECT_ICON 或 DVASPECT_DOCPRINT。

VIEWSTATUS_SOLIDBKGND 对象具有纯色背景 （包含在纯色，而非画笔图案中）。 仅当 VIEWSTATUS_OPAQUE 设置且仅适用于与内容相关的方面和不适用于 DVASPECT_ICON 或 DVASPECT_DOCPRINT 此位为有意义。

VIEWSTATUS_DVASPECTOPAQUE 对象支持 DVASPECT_OPAQUE。 可以使用此方面调用参数时所采取的绘图方位的所有 IViewObjectEx 方法。

VIEWSTATUS_DVASPECTTRANSPARENT 对象支持 DVASPECT_TRANSPARENT。 所有`IViewObjectEx`方法可以对此调用参数时所采取的绘图方位。

### <a name="remarks"></a>备注

如果您的控件使用两次绘图，重写此函数。 默认实现返回 VIEWSTATUS_OPAQUE。

##  <a name="onhidetoolbars"></a>  COleControl::OnHideToolBars

当控件处于用户界面已停用时由框架调用。

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>备注

实现应隐藏所有情况下显示的工具栏`OnShowToolbars`。

##  <a name="oninactivemousemove"></a>  COleControl::OnInactiveMouseMove

名为按下鼠标指针在收到 WM_MOUSEMOVE 消息处于非活动状态的对象的容器。

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>参数

*lprcBounds*<br/>
边界矩形，在包含窗口的工作区中的对象。 告知对象其准确位置和大小在屏幕上收到 WM_MOUSEMOVE 消息时。

*x*<br/>
包含窗口工作区坐标中鼠标位置的 x 坐标。

*y*<br/>
包含窗口工作区坐标中鼠标位置的 y 坐标。

*dwKeyState*<br/>
标识在键盘上的键盘修改键的当前状态。 有效的值可以是任何 MK_CONTROL、 MK_SHIFT、 MK_ALT、 MK_BUTTON、 MK_LBUTTON、 MK_MBUTTON 和 MK_RBUTTON 的标志的组合。

### <a name="remarks"></a>备注

请注意窗口工作区坐标 （像素），用于传递鼠标光标位置。 这是通过实现同时传递该对象的边界矩形相同的坐标系统中。

##  <a name="oninactivesetcursor"></a>  COleControl::OnInactiveSetCursor

在将鼠标指针悬停在接收 WM_SETCURSOR 消息处于非活动状态的对象的容器由调用。

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>参数

*lprcBounds*<br/>
边界矩形，在包含窗口的工作区中的对象。 告知对象其准确位置和大小在屏幕上时接收 WM_SETCURSOR 消息。

*x*<br/>
包含窗口工作区坐标中鼠标位置的 x 坐标。

*y*<br/>
包含窗口工作区坐标中鼠标位置的 y 坐标。

*dwMouseMsg*<br/>
WM_SETCURSOR 发生鼠标消息的标识符。

*bSetAlways*<br/>
指定必须设置光标的对象。 如果为 TRUE，该对象必须设置游标;如果为 FALSE，光标没有义务将光标放置，并且应在这种情况下返回 S_FALSE。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

请注意窗口工作区坐标 （像素），用于传递鼠标光标位置。 这是通过实现同时传递该对象的边界矩形相同的坐标系统中。

##  <a name="onkeydownevent"></a>  COleControl::OnKeyDownEvent

在处理常用的 KeyDown 事件之后，由框架调用。

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>参数

*NChar*<br/>
按下的键虚拟键代码值。 标准虚拟键代码的列表，请参见 Winuser.h

*nShiftState*<br/>
包含以下标志的组合：

- 在操作期间按下了 SHIFT_MASK SHIFT 键。

- 在操作期间按下了 CTRL_MASK CTRL 键。

- 在操作期间按下 ALT_MASK ALT 键。

### <a name="remarks"></a>备注

如果您的控件需要访问密钥信息后触发了事件，重写此函数。

##  <a name="onkeypressevent"></a>  COleControl::OnKeyPressEvent

由框架调用之后引发 KeyPress 事件的股票。

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>参数

*NChar*<br/>
包含虚拟键代码值的按下的键。 标准虚拟键代码的列表，请参见 Winuser.h

### <a name="remarks"></a>备注

请注意， *nChar*值可能已被修改的容器。

如果希望通知此事件发生后，重写此函数。

##  <a name="onkeyupevent"></a>  COleControl::OnKeyUpEvent

在处理常用的 KeyDown 事件之后，由框架调用。

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>参数

*NChar*<br/>
按下的键虚拟键代码值。 标准虚拟键代码的列表，请参见 Winuser.h

*nShiftState*<br/>
包含以下标志的组合：

- 在操作期间按下了 SHIFT_MASK SHIFT 键。

- 在操作期间按下了 CTRL_MASK CTRL 键。

- 在操作期间按下 ALT_MASK ALT 键。

### <a name="remarks"></a>备注

如果您的控件需要访问密钥信息后触发了事件，重写此函数。

##  <a name="onmappropertytopage"></a>  COleControl::OnMapPropertyToPage

由框架调用以获取实现编辑指定的属性的属性页的类 ID。

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>参数

*dispid*<br/>
该控件的属性的调度 ID。

*lpclsid*<br/>
指向`CLSID`结构，通过返回的类 ID。

*pbPageOptional*<br/>
返回指示是否指定的属性页的使用是可选的。

### <a name="return-value"></a>返回值

如果类 ID 已在返回非零*lpclsid*; 否则为 0。

### <a name="remarks"></a>备注

重写此函数可提供一种方法来调用从容器的属性浏览器控件的属性页。

##  <a name="onmnemonic"></a>  COleControl::OnMnemonic

容器已检测到 OLE 控件的助记键已按下时，由框架调用。

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>参数

*pMsg*<br/>
一个指针，指向由助记键按键操作生成的 Windows 消息。

##  <a name="onproperties"></a>  COleControl::OnProperties

当已由容器调用控件的属性谓词时由框架调用。

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>参数

*lpMsg*<br/>
指向调用此谓词的 Windows 消息的指针。

*hWndParent*<br/>
控件的父窗口的句柄。

*lpRect*<br/>
指向由容器中控件的矩形的指针。

### <a name="return-value"></a>返回值

如果调用成功，则非零值否则为 0。

### <a name="remarks"></a>备注

默认实现将显示一个模式属性对话框。

此外可以使用此函数会导致控件的属性页的显示。 调用`OnProperties`函数，传递中的控件的父级的句柄*hWndParent*参数。 在本示例中的值*lpMsg*并*lpRect*参数将被忽略。

##  <a name="onqueryhitpoint"></a>  COleControl::OnQueryHitPoint

在响应容器的框架调用`IViewObjectEx::QueryHitPoint`请求。

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>参数

*dwAspect*<br/>
指定如何表示的对象。 有效的值取自枚举[DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)或 DVASPECT2。

*pRectBounds*<br/>
指向`RECT`结构，它指定 OLE 控件客户端区域的边框。

*ptlLoc*<br/>
指向`POINT`结构，它指定要检查的一次点击的点。 OLE 客户端区域坐标中指定点。

*lCloseHint*<br/>
定义"关闭"到点检查命中的距离。

*pHitResult*<br/>
指向命中查询的结果。 以下值之一：

- HITRESULT_OUTSIDE *ptlLoc*是外部 OLE 对象，并不会关闭。

- HITRESULT_TRANSPARENT *ptlLoc*的 OLE 对象，但不是接近图像的边界内。 例如，中间透明圆点可能是 HITRESULT_TRANSPARENT。

- HITRESULT_CLOSE *ptlLoc*是内部或外部的 OLE 对象但还不够接近要被视为内部的对象。 小型、 精简，或详细对象可以使用此值。 即使点位于外部的边界矩形对象可能仍然会关闭 （这所需达到的小型对象）。

- HITRESULT_HIT *ptlLoc*内对象的图像。

### <a name="return-value"></a>返回值

非零，如果成功地返回命中的结果;否则为 0。 命中数是与 OLE 控件显示区域重叠。

### <a name="remarks"></a>备注

查询对象的显示矩形是否与给定的点重叠 （达到该点）。 `QueryHitPoint` 可以重写以测试非矩形对象的命中数。

##  <a name="onqueryhitrect"></a>  COleControl::OnQueryHitRect

在响应容器的框架调用`IViewObjectEx::QueryHitRect`请求。

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>参数

*dwAspect*<br/>
指定要如何表示该对象。 有效的值取自枚举[DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)或 DVASPECT2。

*pRectBounds*<br/>
指向`RECT`结构，它指定 OLE 控件客户端区域的边框。

*prcLoc*<br/>
指向`RECT`结构，它指定要检查的命中 （与对象矩形的重叠），相对于对象的左上角的矩形。

*lCloseHint*<br/>
未使用。

*pHitResult*<br/>
指向命中查询的结果。 以下值之一：

- HITRESULT_OUTSIDE OLE 对象被命中的矩形中的任何点。

- HITRESULT_HIT 的矩形中的至少一个点是在对象上的命中。

### <a name="return-value"></a>返回值

非零，如果成功地返回命中的结果;否则为 0。

### <a name="remarks"></a>备注

查询对象的显示矩形是否与给定矩形中的任意点 （达到该矩形） 重叠。 `QueryHitRect` 可以重写以测试非矩形对象的命中数。

##  <a name="onrenderdata"></a>  COleControl::OnRenderData

由框架调用以检索指定格式的数据。

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>参数

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)结构，它指定为请求信息的格式。

*lpStgMedium*<br/>
指向[STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium) ，数据将返回的结构。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

指定的格式是以前使用控件对象中放置[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)或[DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata)成员函数被延迟呈现的。 此函数的默认实现调用`OnRenderFileData`或`OnRenderGlobalData`分别，如果提供的存储介质是文件或内存。 如果请求的格式，CF_METAFILEPICT 或持久属性设置格式的默认实现将呈现相应的数据，并返回非零值。 否则为它将返回 0，并且不执行任何操作。

如果*lpStgMedium-> tymed*是 TYMED_NULL，应分配并由指定填充 STGMEDIUM *lpFormatEtc-> tymed*。 如果不应在具有数据的位置填充 TYMED_NULL、 STGMEDIUM。

重写此函数可提供请求的格式和介质中的数据。 具体取决于你的数据，你可能想要改为重写此函数的其他版本之一。 如果你的数据较小且大小固定，重写`OnRenderGlobalData`。 如果数据是在文件中，或者是大小可变的重写`OnRenderFileData`。

有关详细信息，请参阅`FORMATETC`和`STGMEDIUM`Windows SDK 中的结构。

##  <a name="onrenderfiledata"></a>  COleControl::OnRenderFileData

由框架调用以检索指定格式的数据的存储介质是文件时。

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>参数

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)结构，它指定为请求信息的格式。

*pFile*<br/>
指向[CFile](../../mfc/reference/cfile-class.md) ，数据将呈现的对象。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

指定的格式是以前使用控件对象中放置[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)延迟呈现的成员函数。 此函数的默认实现只是返回 FALSE。

重写此函数可提供请求的格式和介质中的数据。 具体取决于你的数据，你可能想要改为重写此函数的其他版本之一。 如果你想要处理多个存储媒介，重写`OnRenderData`。 如果数据是在文件中，或者是大小可变的重写`OnRenderFileData`。

有关详细信息，请参阅`FORMATETC`Windows SDK 中的结构。

##  <a name="onrenderglobaldata"></a>  COleControl::OnRenderGlobalData

由框架调用以检索指定格式的数据时指定的存储介质是全局内存。

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>参数

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)结构，它指定为请求信息的格式。

*phGlobal*<br/>
指向全局内存，数据将返回的句柄。 如果已不分配任何内存，则此参数可以为 NULL。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

指定的格式是以前使用控件对象中放置[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)延迟呈现的成员函数。 此函数的默认实现只是返回 FALSE。

如果*phGlobal*为 NULL，则应分配并返回新 HGLOBAL *phGlobal*。 否则，HGLOBAL 指定*phGlobal*应填充数据。 在 HGLOBAL 中放置的数据量不能超过内存块的当前大小。 此外，块不能重新分配给较大的大小。

重写此函数可提供请求的格式和介质中的数据。 具体取决于你的数据，你可能想要改为重写此函数的其他版本之一。 如果你想要处理多个存储媒介，重写`OnRenderData`。 如果数据是在文件中，或者是大小可变的重写`OnRenderFileData`。

有关详细信息，请参阅`FORMATETC`Windows SDK 中的结构。

##  <a name="onresetstate"></a>  COleControl::OnResetState

当控件的属性应设置为其默认值时由框架调用。

```
virtual void OnResetState();
```

### <a name="remarks"></a>备注

默认实现调用[DoPropExchange](#dopropexchange)，并传递`CPropExchange`导致要为其默认值设置的属性的对象。

控制编写器可以在此插入 OLE 控件的初始化代码可重写。 当调用此函数[IPersistStream::Load](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load)或[ipersiststorage:: Load](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load)发生故障，或[IPersistStreamInit::InitNew](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew)或[IPersistStorage:： 丢失](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-initnew)调用，而不会第一个调用任一`IPersistStream::Load`或`IPersistStorage::Load`。

##  <a name="onsetclientsite"></a>  COleControl::OnSetClientSite

当容器已调用该控件时由框架调用`IOleControl::SetClientSite`函数。

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>备注

默认情况下`OnSetClientSite`检查是否加载数据路径属性，并且如果它们是调用`DoDataPathPropExchange`。

重写此函数可执行此通知的任何特殊处理。 具体而言，此函数的重写应调用的基类。

##  <a name="onsetdata"></a>  COleControl::OnSetData

由框架调用以控件的数据替换为指定的数据。

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>参数

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)结构，它指定数据的格式。

*lpStgMedium*<br/>
指向[STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium)所在数据结构。

*bRelease*<br/>
如果控件应释放存储介质中; 则为 TRUE如果控件不应释放存储介质，则为 FALSE。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果数据的持久性属性中设置格式的默认实现将进行相应修改控件的状态。 否则，默认实现没有任何影响。 如果*bRelease*为 TRUE，则调用`ReleaseStgMedium`进行; 否则为 not。

重写此函数使用指定的数据替换控件的数据。

有关详细信息，请参阅`FORMATETC`和`STGMEDIUM`Windows SDK 中的结构。

##  <a name="onsetextent"></a>  COleControl::OnSetExtent

当控件的大小时需要因调用而更改时由框架调用[IOleObject::SetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setextent)。

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>参数

*lpSizeL*<br/>
一个指向`SIZEL`使用长整数来表示的宽度和高度的控制，以 HIMETRIC 为单位表示的结构。

### <a name="return-value"></a>返回值

如果已接受的大小更改; 非零值否则为 0。

### <a name="remarks"></a>备注

默认实现可处理的控件的大小时重设大小。 如果控件是处于就地活动状态，调用容器的`OnPosRectChanged`再进行。

重写此函数可更改您的控件的默认大小调整。

##  <a name="onsetobjectrects"></a>  COleControl::OnSetObjectRects

由框架调用以实现调用[IOleInPlaceObject::SetObjectRects](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects)。

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>参数

*lpRectPos*<br/>
一个指向`RECT`结构，指示控件的新位置和相对于容器的大小。

*lpRectClip*<br/>
一个指向`RECT`结构，指示该控件是要剪裁的矩形区域。

### <a name="return-value"></a>返回值

如果接受重新定位，;，非零值否则为 0。

### <a name="remarks"></a>备注

默认实现自动处理的重新定位和调整大小的控制窗口，并返回 TRUE。

重写此函数可更改此函数的默认行为。

##  <a name="onshowtoolbars"></a>  COleControl::OnShowToolBars

当控件已激活的 UI 时由框架调用。

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>备注

默认实现不执行任何操作。

##  <a name="ontextchanged"></a>  COleControl::OnTextChanged

股票的标题或文本属性值发生更改时由框架调用。

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>备注

默认实现将调用`InvalidateControl`。

如果希望在此属性更改后的通知，重写此函数。

##  <a name="onwindowlessmessage"></a>  COleControl::OnWindowlessMessage

在响应容器的框架调用`IOleInPlaceObjectWindowless::OnWindowMessage`请求。

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>参数

*消息*<br/>
所传递的 Windows 消息标识符。

*wParam*<br/>
所传递的 Windows。 指定其他特定于消息的信息。 此参数的内容取决于的值*msg*参数。

*lParam*<br/>
所传递的 Windows。 指定其他特定于消息的信息。 此参数的内容取决于的值*msg*参数。

*plResult*<br/>
Windows 结果代码。 指定的消息处理结果，并取决于发送的消息。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

处理无窗口控件的窗口消息。 `COleControl``OnWindowlessMessage`应该用于鼠标消息和键盘消息以外的窗口消息。 `COleControl` 提供了[SetCapture](#setcapture)并[SetFocus](#setfocus)专门用于获取鼠标捕获和键盘焦点的无窗口的 OLE 对象。

无窗口对象不具有一个窗口，因为它们需要一种机制，以便发送到它们的容器调度消息。 无窗口的 OLE 对象从其容器中获取消息通过`OnWindowMessage`方法`IOleInPlaceObjectWindowless`接口 (的扩展[IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject)无窗口支持)。 `OnWindowMessage` 不采用`HWND`参数。

##  <a name="parenttoclient"></a>  COleControl::ParentToClient

将转换的坐标*pPoint*成工作区坐标。

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>参数

*lprcBounds*<br/>
指向 OLE 控件在容器内的边界。 不是工作区，但整个控件包括边框及滚动条的区域。

*pPoint*<br/>
指向父 （容器） 的点转换为控件的客户端区域的坐标。

*bHitTest*<br/>
指定命中测试，以在点上完成。

### <a name="return-value"></a>返回值

如果*bHitTest*为 FALSE，则返回 HTNOWHERE。 如果*bHitTest*为 TRUE，返回父 （容器） 中的点的位置登录到 OLE 控件的客户端区域，命中测试的值是以下鼠标之一：

- HTBORDER 不具有大小调整边框的窗口边框中。

- HTBOTTOM 较低水平边框的窗口中。

- HTBOTTOMLEFT 在左下角的窗口边框。

- HTBOTTOMRIGHT 窗口的边框右下角中。

- HTCAPTION 标题栏区域中。

- HTCLIENT 中的工作区中。

- HTERROR 屏幕背景上或在 windows 之间的分隔线 (HTNOWHERE 相同只不过`DefWndProc`Windows 函数生成系统提示音表示出现错误)。

- HTGROWBOX 大小框中。

- HTHSCROLL 水平滚动条中。

- HTLEFT 中窗口的左边框。

- HTMAXBUTTON 中最大化按钮。

- HTMENU 菜单区域中。

- HTMINBUTTON 中最小化按钮。

- 在屏幕背景 HTNOWHERE 上或在 windows 之间的分隔线。

- HTREDUCE 中最小化按钮。

- HTRIGHT 右边框的窗口中。

- HTSIZE 大小框 （与 HTGROWBOX 相同） 中。

- HTSYSMENU 中控件菜单或关闭按钮中的子窗口中。

- HTTOP 上部水平边框的窗口中。

- HTTOPLEFT 窗口边框的左上角中。

- HTTOPRIGHT 窗口边框的右上角中。

- HTTRANSPARENT 当前受另一个窗口的窗口中。

- HTVSCROLL 垂直滚动条中。

- HTZOOM 中最大化按钮。

### <a name="remarks"></a>备注

在输入*pPoint*是相对于父级 （左上角的容器） 的源。 在输出*pPoint*是相对于 OLE 控件 （左上角的控件的客户端区域） 的客户端区域的原点。

##  <a name="postmodaldialog"></a>  COleControl::PostModalDialog

通知容器模式对话框已关闭。

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>参数

*hWndParent*<br/>
模式对话框的父窗口的句柄。

### <a name="remarks"></a>备注

在显示任何模式对话框之后调用此函数。 您必须调用此函数，以便容器可以启用禁用的任何顶级窗口`PreModalDialog`。 此函数应通过调用配对`PreModalDialog`。

##  <a name="premodaldialog"></a>  COleControl::PreModalDialog

通知即将显示模式对话框中的容器。

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>参数

*hWndParent*<br/>
模式对话框的父窗口的句柄。

### <a name="remarks"></a>备注

显示任何模式对话框之前调用此函数。 您必须调用此函数，以便容器可以禁用所有顶级窗口。 显示模式对话框后，必须调用`PostModalDialog`。

##  <a name="recreatecontrolwindow"></a>  COleControl::RecreateControlWindow

销毁并重新创建控件的窗口。

```
void RecreateControlWindow();
```

### <a name="remarks"></a>备注

这可能有必要，如果需要更改窗口的样式位。

##  <a name="refresh"></a>  COleControl::Refresh

强制重新绘制的 OLE 控件。

```
void Refresh();
```

### <a name="remarks"></a>备注

支持此函数`COleControl`基类作为一个名为刷新的常用方法。 这允许 OLE 控件的用户在特定的时间重新绘制控件。 此方法的详细信息，请参阅文章[ActiveX 控件： 方法](../../mfc/mfc-activex-controls-methods.md)。

##  <a name="releasecapture"></a>  COleControl::ReleaseCapture

释放鼠标捕获。

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果该控件当前具有鼠标捕获，释放该捕获。 否则，此函数不起作用。

##  <a name="releasedc"></a>  COleControl::ReleaseDC

释放由其他应用程序释放使用的设备上下文的无窗口控件的容器的显示设备上下文。

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>参数

*pDC*<br/>
标识要释放的容器设备上下文。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

应用程序必须调用`ReleaseDC`每次调用[GetDC](#getdc)。

##  <a name="reparentcontrolwindow"></a>  COleControl::ReparentControlWindow

设置控件的父级。

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>参数

*hWndOuter*<br/>
控制窗口的句柄。

*hWndParent*<br/>
新的父窗口的句柄。

### <a name="remarks"></a>备注

调用此函数可重置控件窗口的父级。

##  <a name="resetstockprops"></a>  COleControl::ResetStockProps

初始化的状态`COleControl`常用属性为其默认值。

```
void ResetStockProps();
```

### <a name="remarks"></a>备注

属性是： 外观、 背景色、 边框样式、 标题、 已启用、 字体、 前景色、 hWnd 和文本。 常用属性的说明，请参阅[ActiveX 控件： 添加常用属性](../../mfc/mfc-activex-controls-adding-stock-properties.md)。

可以通过使用提高控件的二进制初始化性能`ResetStockProps`并`ResetVersion`重写`COleControl::OnResetState`。 请参见下面的示例。 有关优化初始化的详细信息，请参阅[ActiveX 控件： 优化](../../mfc/mfc-activex-controls-optimization.md)。

### <a name="example"></a>示例

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>  COleControl::ResetVersion

初始化为指定的值的版本号。

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>参数

*dwVersionDefault*<br/>
要分配给控件的版本号。

### <a name="remarks"></a>备注

可以通过使用提高控件的二进制初始化性能`ResetVersion`并`ResetStockProps`重写`COleControl::OnResetState`。 在示例，请参阅[ResetStockProps](#resetstockprops)。 有关优化初始化的详细信息，请参阅[ActiveX 控件： 优化](../../mfc/mfc-activex-controls-optimization.md)。

##  <a name="scrollwindow"></a>  COleControl::ScrollWindow

允许无窗口的 OLE 对象滚动屏幕上其就地活动图像内的某个区域。

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>参数

*xAmount*<br/>
指定量，以设备为单位，水平滚动。 此参数必须为负值可向左滚动。

*yAmount*<br/>
指定量，以设备为单位的垂直滚动。 此参数必须是负值将向上滚动。

*lpRect*<br/>
指向[CRect](../../atl-mfc-shared/reference/crect-class.md)对象或 RECT 结构，它包含窗口的工作区坐标中指定要向下滚动，OLE 对象的客户端区域的部分。 如果*lpRect*为 NULL，滚动整个 OLE 对象的客户端区域。

*lpClipRect*<br/>
指向`CRect`对象或`RECT`结构，它指定到向剪辑矩形。 只有在矩形内的像素的滚动量。 矩形外的 bits 不会受到影响，即使它们位于*lpRect*矩形。 如果*lpClipRect*为 NULL，不存在修剪执行滚动矩形上。

##  <a name="selectfontobject"></a>  COleControl::SelectFontObject

选择到设备上下文的字体。

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>参数

*pDC*<br/>
指向设备上下文对象的指针。

*fontHolder*<br/>
引用[CFontHolder](../../mfc/reference/cfontholder-class.md)对象，表示要选择的字体。

### <a name="return-value"></a>返回值

一个指向以前选择的字体。 调用方何时完成，使用所有绘制操作*fontHolder，* 它应重新以前选择的字体选择作为参数进行传递[cdc:: selectobject](../../mfc/reference/cdc-class.md#selectobject)。

##  <a name="selectstockfont"></a>  COleControl::SelectStockFont

选择到设备上下文的常用字体属性。

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>参数

*pDC*<br/>
将在其中选择字体的设备上下文。

### <a name="return-value"></a>返回值

指向之前选择的`CFont`对象。 应使用[cdc:: selectobject](../../mfc/reference/cdc-class.md#selectobject)完成后恢复到的设备上下文选择此字体。

##  <a name="serializeextent"></a>  COleControl::SerializeExtent

序列化或初始化分配给控件的显示空间的状态。

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>参数

*ar*<br/>
一个`CArchive`要面向或源自序列化对象。

### <a name="remarks"></a>备注

可以通过使用提高控件的二进制暂留性能`SerializeExtent`， `SerializeStockProps`，并`SerializeVersion`重写`COleControl::Serialize`。 请参见下面的示例。 有关优化初始化的详细信息，请参阅[ActiveX 控件： 优化](../../mfc/mfc-activex-controls-optimization.md)。

### <a name="example"></a>示例

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>  COleControl::SerializeStockProps

序列化或初始化的状态`COleControl`常用属性： 外观、 背景色、 边框样式、 标题、 已启用、 字体、 前景色和文本。

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>参数

*ar*<br/>
一个`CArchive`要面向或源自序列化对象。

### <a name="remarks"></a>备注

常用属性的说明，请参阅[ActiveX 控件： 添加常用属性](../../mfc/mfc-activex-controls-adding-stock-properties.md)。

可以通过使用提高控件的二进制暂留性能`SerializeStockProps`， `SerializeExtent`，并`SerializeVersion`重写`COleControl::Serialize`。 有关示例，请参阅处的代码[SerializeExtent](#serializeextent)。 有关优化初始化的详细信息，请参阅[ActiveX 控件： 优化](../../mfc/mfc-activex-controls-optimization.md)。

##  <a name="serializeversion"></a>  COleControl::SerializeVersion

序列化或初始化控件的版本信息的状态。

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>参数

*ar*<br/>
一个`CArchive`要面向或源自序列化对象。

*dwVersionDefault*<br/>
控件的当前版本号。

*bConvert*<br/>
指示永久性数据是否应为最新格式保存，或在相同的格式中维护时加载它时转换。

### <a name="return-value"></a>返回值

控件的版本号。 如果加载指定的存档，`SerializeVersion`返回该存档中加载的版本。 否则，它返回当前加载的版本。

### <a name="remarks"></a>备注

可以通过使用提高控件的二进制暂留性能`SerializeVersion`， `SerializeExtent`，并`SerializeStockProps`重写`COleControl::Serialize`。 有关示例，请参阅处的代码[SerializeExtent](#serializeextent)。 有关优化初始化的详细信息，请参阅[ActiveX 控件： 优化](../../mfc/mfc-activex-controls-optimization.md)。

##  <a name="setappearance"></a>  COleControl::SetAppearance

设置控件的股票的外观属性值。

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>参数

*sAppearance*<br/>
一个**短**要使用的控件的外观 (VT_I2) 值。 值为零设置控件的外观为平面和 1 的值设置为三维控件的外观。

### <a name="remarks"></a>备注

有关常用属性的详细信息，请参阅[ActiveX 控件： 属性](../../mfc/mfc-activex-controls-properties.md)。

##  <a name="setbackcolor"></a>  COleControl::SetBackColor

设置控件的股票的 BackColor 属性值。

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>参数

*dwBackColor*<br/>
要用于绘制控件的背景 OLE_COLOR 值。

### <a name="remarks"></a>备注

有关详细信息使用此属性和其他相关属性，请参阅文章[ActiveX 控件： 属性](../../mfc/mfc-activex-controls-properties.md)。

##  <a name="setborderstyle"></a>  COleControl::SetBorderStyle

设置控件的股票 BorderStyle 属性值。

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>参数

*sBorderStyle*<br/>
控件; 的新边框样式0 表示没有边框，1 表示正常的边框。

### <a name="remarks"></a>备注

控制窗口将重新创建和`OnBorderStyleChanged`调用。

##  <a name="setcapture"></a>  COleControl::SetCapture

使控件的容器窗口控件的代表需要拥有鼠标捕获。

```
CWnd* SetCapture();
```

### <a name="return-value"></a>返回值

一个指向`CWnd`以前接收到鼠标输入的窗口对象。

### <a name="remarks"></a>备注

如果该控件已激活并无窗口，此函数会导致控件的容器窗口，才能拥有鼠标捕获，控件的代表。 否则，此函数时，控件会本身才能拥有鼠标捕获 (与相同`CWnd::SetCapture`)。

##  <a name="setcontrolsize"></a>  COleControl::SetControlSize

设置 OLE 控件窗口的大小，并通知更改控件站点的容器。

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>参数

*cx*<br/>
以像素为单位指定控件的新宽度。

*cy*<br/>
以像素为单位指定控件的新高度。

### <a name="return-value"></a>返回值

如果调用成功，则非零值否则为 0。

### <a name="remarks"></a>备注

此函数不应在控件的构造函数中使用。

请注意，用于控制 windows 的所有坐标都都相对于控件的左上角。

##  <a name="setenabled"></a>  COleControl::SetEnabled

设置常用控件的 Enabled 属性值。

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>参数

*bEnabled*<br/>
如果控件将启用，则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

设置此属性后`OnEnabledChange`调用。

##  <a name="setfocus"></a>  COleControl::SetFocus

使控件的容器窗口控件的代表需要拥有输入焦点。

```
CWnd* SetFocus();
```

### <a name="return-value"></a>返回值

一个指向`CWnd`以前具有输入焦点，则为 NULL，如果没有此类窗口的窗口对象。

### <a name="remarks"></a>备注

如果该控件已激活并无窗口，此函数会导致该控件的容器窗口，才能拥有输入焦点的控件的代表。 输入的焦点将定向到容器的窗口的键盘输入，并在容器将调度到调用该 OLE 对象的所有后续的键盘消息`SetFocus`。 任何以前具有输入的焦点的窗口失去它。

如果控件不是无窗口，此函数时，控件会本身才能拥有输入焦点 (与相同`CWnd::SetFocus`)。

##  <a name="setfont"></a>  COleControl::SetFont

设置控件的常用字体属性。

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>参数

*pFontDisp*<br/>
指向字体调度接口的指针。

##  <a name="setforecolor"></a>  COleControl::SetForeColor

设置控件的股票 ForeColor 属性值。

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>参数

*dwForeColor*<br/>
要用于绘制控件的前景色 OLE_COLOR 值。

### <a name="remarks"></a>备注

有关详细信息使用此属性和其他相关属性，请参阅文章[ActiveX 控件： 属性](../../mfc/mfc-activex-controls-properties.md)。

##  <a name="setinitialdataformats"></a>  COleControl::SetInitialDataFormats

由框架调用以初始化控件支持的数据格式的列表。

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>备注

默认实现指定这两种格式： CF_METAFILEPICT 和持久性属性。

##  <a name="setinitialsize"></a>  COleControl::SetInitialSize

设置 OLE 控件容器中首次显示时的大小。

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>参数

*cx*<br/>
以像素为单位的 OLE 控件初始宽度。

*cy*<br/>
以像素为单位的 OLE 控件的初始高度。

### <a name="remarks"></a>备注

若要设置控件的初始大小在构造函数中调用此函数。 以设备单位或像素为单位的初始大小。 建议在控件的构造函数中进行此调用。

##  <a name="setmodifiedflag"></a>  COleControl::SetModifiedFlag

更改控件的已修改的状态。

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>参数

*bModified*<br/>
控件的新值的修改标志。 TRUE 表示已修改控件的状态;FALSE 表示只需保存控件的状态。

### <a name="remarks"></a>备注

调用此函数，每当发生的更改会影响控件的持久状态。 例如，如果持久性的属性的值发生更改，调用此函数带*bModified* **TRUE**。

##  <a name="setnotpermitted"></a>  COleControl::SetNotPermitted

指示的编辑请求已失败。

```
void SetNotPermitted();
```

### <a name="remarks"></a>备注

调用此函数时`BoundPropertyRequestEdit`失败。 此函数将引发类型的异常`COleDispScodeException`以指示不允许设置操作。

##  <a name="setnotsupported"></a>  COleControl::SetNotSupported

防止修改为用户控件的属性值。

```
void SetNotSupported();
```

### <a name="remarks"></a>备注

调用此函数来代替任何属性的 Set 函数不支持修改由该控件的用户的属性值的。 一个示例是一个属性，它只读的。

##  <a name="setrectincontainer"></a>  COleControl::SetRectInContainer

设置相对于容器，以设备单位表示控件的矩形的坐标。

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>参数

*lpRect*<br/>
指向包含新的控件的坐标，相对于容器的矩形的指针。

### <a name="return-value"></a>返回值

如果调用成功，则非零值否则为 0。

### <a name="remarks"></a>备注

如果控件处于打开状态，它是调整大小;否则为容器的`OnPosRectChanged`调用函数。

##  <a name="settext"></a>  COleControl::SetText

设置控件的常用标题或文本属性的值。

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>参数

*pszText*<br/>
指向字符字符串的指针。

### <a name="remarks"></a>备注

请注意，常用的标题和文本属性映射到相同的值。 这意味着对这两个属性所做的任何更改将自动更改这两个属性。 一般情况下，控件应支持股票标题或文本属性，但不可同时使用两者。

##  <a name="throwerror"></a>  Colecontrol:: Throwerror

发出信号的匹配项在控件中的错误。

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);


void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>参数

*sc*<br/>
要报告的状态代码值。 可能的代码的完整列表，请参阅文章[ActiveX 控件： 高级主题](../../mfc/mfc-activex-controls-advanced-topics.md)。

*nDescriptionID*<br/>
字符串资源 ID 的异常报告。

*nHelpID*<br/>
要报告上本主题的帮助 ID。

*pszDescription*<br/>
包含要报告的异常的说明的字符串。

### <a name="remarks"></a>备注

此函数应仅从调用 Get 或 Set 函数中用于 OLE 属性或 OLE 自动化方法的实现。 如果需要以指示错误发生在其他情况下，应触发常用的错误事件。

##  <a name="transformcoords"></a>  COleControl::TransformCoords

转换坐标 HIMETRIC 单位和容器的本机单位之间的值。

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>参数

*lpptlHimetric*<br/>
指向`POINTL`结构，它包含以 HIMETRIC 为单位的坐标。

*lpptfContainer*<br/>
指向`POINTF`结构，它包含坐标以容器的单元大小。

*flags*<br/>
以下值的组合：

- XFORMCOORDS_POSITION 一个容器中的位置。

- XFORMCOORDS_SIZE 容器中的大小。

- XFORMCOORDS_HIMETRICTOCONTAINER 转换 HIMETRIC 到容器的单位为单位。

- XFORMCOORDS_CONTAINERTOHIMETRIC 转换到 HIMETRIC 为单位的容器的单位。

### <a name="remarks"></a>备注

前两个标志 XFORMCOORDS_POSITION 和 XFORMCOORDS_SIZE，指示是否应作为一个位置或大小处理坐标。 剩余的两个标志指示转换的方向。

##  <a name="translatecolor"></a>  COleControl::TranslateColor

颜色值将从 OLE_COLOR 数据类型转换到[COLORREF](/windows/desktop/gdi/colorref)数据类型。

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>参数

*clrColor*<br/>
OLE_COLOR 数据类型。 有关详细信息，请参阅 Windows [OleTranslateColor](/windows/desktop/api/olectl/nf-olectl-oletranslatecolor)函数。

*hpal*<br/>
可选的调色板; 的句柄可以为 NULL。

### <a name="return-value"></a>返回值

RGB （红色、 绿色、 蓝色） 32 位颜色值，用于定义实体的颜色最接近*clrColor*设备可以表示的值。

### <a name="remarks"></a>备注

此函数可用于将转换为 COLORREF 类型使用的常用的前景色和背景色属性[CDC](../../mfc/reference/cdc-class.md)成员函数。

##  <a name="willambientsbevalidduringload"></a>  COleControl::WillAmbientsBeValidDuringLoad

确定控件是否应作为默认值中使用的环境属性的值时从其持久性状态随后加载它。

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>返回值

Nonzero 指示会有效，则为环境属性否则环境属性将不再有效。

### <a name="remarks"></a>备注

在某些容器控件可能没有对其环境属性的访问在首次调用的重写期间`COleControl::DoPropExchange`。 这是这种情况，如果容器调用[IPersistStreamInit::Load](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-load)或[ipersiststorage:: Load](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load)之前调用[IOleObject::SetClientSite](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setclientsite) （即，如果不是遵循 OLEMISC_SETCLIENTSITEFIRST 状态位）。

##  <a name="windowproc"></a>  COleControl::WindowProc

提供有关 Windows 过程`COleControl`对象。

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>参数

*message*<br/>
指定要处理的 Windows 消息。

*wParam*<br/>
提供使用在处理消息的其他信息。 参数值取决于消息。

*lParam*<br/>
提供使用在处理消息的其他信息。 参数值取决于消息。

### <a name="return-value"></a>返回值

调度消息的返回值。

### <a name="remarks"></a>备注

调用此函数可将特定消息通过控件的消息映射调度。

## <a name="see-also"></a>请参阅

[MFC 示例 CIRC3](../../visual-cpp-samples.md)<br/>
[MFC 示例 TESTHELP](../../visual-cpp-samples.md)<br/>
[COlePropertyPage 类](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd 类](../../mfc/reference/cwnd-class.md)<br/>
[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder 类](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder 类](../../mfc/reference/cpictureholder-class.md)<br/>

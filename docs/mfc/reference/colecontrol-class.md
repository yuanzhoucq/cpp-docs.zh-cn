---
title: COleControl 类
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 97c605426ed0ac869714f0f83d4957f7f6ce7d87
ms.sourcegitcommit: 7ecd91d8ce18088a956917cdaf3a3565bd128510
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/16/2020
ms.locfileid: "79426911"
---
# <a name="colecontrol-class"></a>COleControl 类

用于开发 OLE 控件的重要基类。

## <a name="syntax"></a>语法

```
class COleControl : public CWnd
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|说明|
|----------|-----------------|
|[COleControl：： COleControl](#colecontrol)|创建一个 `COleControl` 对象。|

### <a name="public-methods"></a>公共方法

|名称|说明|
|----------|-----------------|
|[COleControl：： AmbientAppearance](#ambientappearance)|检索控件当前的外观。|
|[COleControl：： AmbientBackColor](#ambientbackcolor)|返回环境背景值属性的值。|
|[COleControl：： AmbientDisplayName](#ambientdisplayname)|返回由容器指定的控件的名称。|
|[COleControl：： AmbientFont](#ambientfont)|返回环境字体属性的值。|
|[COleControl：： AmbientForeColor](#ambientforecolor)|返回环境前景色属性的值。|
|[COleControl：： AmbientLocaleID](#ambientlocaleid)|返回容器的区域设置 ID。|
|[COleControl：： AmbientScaleUnits](#ambientscaleunits)|返回容器使用的单位类型。|
|[COleControl：： AmbientShowGrabHandles](#ambientshowgrabhandles)|确定是否应显示抓取柄。|
|[COleControl：： AmbientShowHatching](#ambientshowhatching)|确定是否应显示阴影。|
|[COleControl：： AmbientTextAlign](#ambienttextalign)|返回由容器指定的文本对齐方式的类型。|
|[COleControl：： AmbientUIDead](#ambientuidead)|确定控件是否应响应用户界面操作。|
|[COleControl：： AmbientUserMode](#ambientusermode)|确定容器的模式。|
|[COleControl：： BoundPropertyChanged](#boundpropertychanged)|通知容器绑定属性已更改。|
|[COleControl：： BoundPropertyRequestEdit](#boundpropertyrequestedit)|请求权限以编辑属性值。|
|[COleControl：： ClientToParent](#clienttoparent)|将相对于控件原点的点转换为相对于其容器原点的点。|
|[COleControl：： ClipCaretRect](#clipcaretrect)|如果插入符号矩形与控件重叠，则调整它。|
|[COleControl：： ControlInfoChanged](#controlinfochanged)|在控件处理的助记键集更改后调用此函数。|
|[COleControl：:D isplayError](#displayerror)|向控件的用户显示 stock 错误事件。|
|[COleControl：:D oClick](#doclick)|Stock `DoClick` 方法的实现。|
|[COleControl：:D oPropExchange](#dopropexchange)|序列化 `COleControl` 对象的属性。|
|[COleControl：:D oSuperclassPaint](#dosuperclasspaint)|重绘已从 Windows 控件中产生子类的 OLE 控件。|
|[COleControl：： EnableSimpleFrame](#enablesimpleframe)|启用控件的简单帧支持。|
|[COleControl：： ExchangeExtent](#exchangeextent)|序列化控件的宽度和高度。|
|[COleControl：： ExchangeStockProps](#exchangestockprops)|序列化控件的常用属性。|
|[COleControl：： ExchangeVersion](#exchangeversion)|序列化控件的版本号。|
|[COleControl：： FireClick](#fireclick)|激发股票 `Click` 事件。|
|[COleControl：： FireDblClick](#firedblclick)|激发股票 `DblClick` 事件。|
|[COleControl：： FireError](#fireerror)|激发股票 `Error` 事件。|
|[COleControl：： FireEvent](#fireevent)|引发自定义事件。|
|[COleControl：： FireKeyDown](#firekeydown)|激发股票 `KeyDown` 事件。|
|[COleControl：： FireKeyPress](#firekeypress)|激发股票 `KeyPress` 事件。|
|[COleControl：： FireKeyUp](#firekeyup)|激发股票 `KeyUp` 事件。|
|[COleControl：： FireMouseDown](#firemousedown)|激发股票 `MouseDown` 事件。|
|[COleControl：： FireMouseMove](#firemousemove)|激发股票 `MouseMove` 事件。|
|[COleControl：： FireMouseUp](#firemouseup)|激发股票 `MouseUp` 事件。|
|[COleControl：： FireReadyStateChange](#firereadystatechange)|当控件的就绪状态发生更改时，引发事件。|
|[COleControl：： GetActivationPolicy](#getactivationpolicy)|更改支持 `IPointerInactive` 接口的控件的默认激活行为。|
|[COleControl：： GetAmbientProperty](#getambientproperty)|返回指定环境属性的值。|
|[COleControl：： GetAppearance](#getappearance)|返回 stock 外观属性的值。|
|[COleControl：： GetBackColor](#getbackcolor)|返回 stock 背景色属性的值。|
|[COleControl：： GetBorderStyle](#getborderstyle)|返回 stock BorderStyle 属性的值。|
|[COleControl：： GetCapture](#getcapture)|确定无窗口、已激活的控件对象是否具有鼠标捕获。|
|[COleControl：： GetClassID](#getclassid)|检索控件的 OLE 类 ID。|
|[COleControl：： GetClientOffset](#getclientoffset)|检索控件的矩形区域的左上角与其工作区左上角之间的差异。|
|[COleControl：： GetClientRect](#getclientrect)|检索控件的工作区的大小。|
|[COleControl：： GetClientSite](#getclientsite)|查询对象，以便指针指向其容器中的当前客户端站点。|
|[COleControl：： GetControlFlags](#getcontrolflags)|检索控件标志设置。|
|[COleControl：： GetControlSize](#getcontrolsize)|返回 OLE 控件的位置和大小。|
|[COleControl：： GetDC](#getdc)|为无窗口控件提供从其容器获取设备上下文的方法。|
|[COleControl：： GetEnabled](#getenabled)|返回启用了库存的属性的值。|
|[COleControl：： GetExtendedControl](#getextendedcontrol)|检索指向属于容器的扩展控件对象的指针。|
|[COleControl：： GetFocus](#getfocus)|确定控件是否有焦点。|
|[COleControl：： Ivsfontandcolorstorage.getfont 错误](#getfont)|返回常用字体属性的值。|
|[COleControl：： GetFontTextMetrics](#getfonttextmetrics)|返回 `CFontHolder` 对象的指标。|
|[COleControl：： GetForeColor](#getforecolor)|返回 "股票前景色" 属性的值。|
|[COleControl：： GetHwnd](#gethwnd)|返回 stock hWnd 属性的值。|
|[COleControl：： GetMessageString](#getmessagestring)|提供菜单项的状态栏文本。|
|[COleControl：： GetNotSupported](#getnotsupported)|禁止用户访问控件的属性值。|
|[COleControl：： GetReadyState](#getreadystate)|返回控件的就绪状态。|
|[COleControl：： GetRectInContainer](#getrectincontainer)|返回控件的相对于其容器的矩形。|
|[COleControl：： GetStockTextMetrics](#getstocktextmetrics)|返回常用字体属性的度量值。|
|[COleControl：： GetText](#gettext)|返回 stock 文本或 Caption 属性的值。|
|[COleControl：： GetWindowlessDropTarget](#getwindowlessdroptarget)|重写以允许无窗口控件作为拖放操作的目标。|
|[COleControl：： InitializeIIDs](#initializeiids)|通知控件将使用的 Iid 的基类。|
|[COleControl：： InternalGetFont](#internalgetfont)|返回常用字体属性的 `CFontHolder` 对象。|
|[COleControl：： InternalGetText](#internalgettext)|检索股票代码标题或文本属性。|
|[COleControl：： InternalSetReadyState](#internalsetreadystate)|设置控件的就绪状态，并激发就绪状态更改事件。|
|[COleControl：： Microsoft.office.core.iribbonui.invalidatecontrol](#invalidatecontrol)|使显示的控件的区域无效，从而导致重绘该控件。|
|[COleControl：： InvalidateRgn](#invalidatergn)|使给定区域内的容器窗口的工作区失效。 可用于在区域中重绘无窗口控件。|
|[COleControl：： IsConvertingVBX](#isconvertingvbx)|允许专用加载 OLE 控件。|
|[COleControl：： IsModified](#ismodified)|确定控件状态是否已更改。|
|[COleControl：： IsOptimizedDraw](#isoptimizeddraw)|指示容器是否支持当前绘制操作的优化绘图。|
|[COleControl：： IsSubclassedControl](#issubclassedcontrol)|调用以确定控件是否为 Windows 控件的子类。|
|[COleControl：： Load](#load)|重置任何以前的异步数据并启动控件的异步属性的新加载。|
|[COleControl：： LockInPlaceActive](#lockinplaceactive)|确定容器是否可以停用控件。|
|[COleControl：： OnAmbientPropertyChange](#onambientpropertychange)|在环境属性更改时调用。|
|[COleControl：： OnAppearanceChanged](#onappearancechanged)|当 "股票外观" 属性更改时调用。|
|[COleControl：： OnBackColorChanged](#onbackcolorchanged)|当更改了 stock 背景色属性时调用。|
|[COleControl：： OnBorderStyleChanged](#onborderstylechanged)|当 "股票 BorderStyle" 属性更改时调用。|
|[COleControl：： OnClick](#onclick)|调用以激发 stock Click 事件。|
|[COleControl：： OnClose](#onclose)|通知控件 `IOleControl::Close` 已被调用。|
|[COleControl：： OnDoVerb](#ondoverb)|在执行控制谓词后调用。|
|[COleControl：： OnDraw](#ondraw)|当请求控件重绘自身时调用。|
|[COleControl：： OnDrawMetafile](#ondrawmetafile)|当请求控件使用图元文件设备上下文重绘自身时，由容器调用。|
|[COleControl：： OnEdit](#onedit)|由容器调用以 UI 激活 OLE 控件。|
|[COleControl：： OnEnabledChanged](#onenabledchanged)|当 "已启用库存" 属性更改时调用。|
|[COleControl：： OnEnumVerbs](#onenumverbs)|由容器调用以枚举控件的谓词。|
|[COleControl：： OnEventAdvise](#oneventadvise)|当事件处理程序连接或与控件断开连接时调用。|
|[COleControl：： OnFontChanged](#onfontchanged)|当 "常用字体" 属性更改时调用。|
|[COleControl：： OnForeColorChanged](#onforecolorchanged)|当 "股票前景" 属性更改时调用。|
|[COleControl：： OnFreezeEvents](#onfreezeevents)|当控件的事件被冻结或解冻时调用。|
|[COleControl：： OnGetColorSet](#ongetcolorset)|通知控件 `IOleObject::GetColorSet` 已被调用。|
|[COleControl：： OnGetControlInfo](#ongetcontrolinfo)|向容器提供助记键信息。|
|[COleControl：： OnGetDisplayString](#ongetdisplaystring)|调用以获取表示属性值的字符串。|
|[COleControl：： OnGetInPlaceMenu](#ongetinplacemenu)|请求将与容器菜单合并的控件菜单的句柄。|
|[COleControl：： OnGetNaturalExtent](#ongetnaturalextent)|重写以检索最接近建议大小和区模式的控件的显示大小。|
|[COleControl：： OnGetPredefinedStrings](#ongetpredefinedstrings)|返回表示属性的可能值的字符串。|
|[COleControl：： OnGetPredefinedValue](#ongetpredefinedvalue)|返回与预定义字符串相对应的值。|
|[COleControl：： OnGetViewExtent](#ongetviewextent)|重写以检索控件的显示区域的大小（可用于启用两遍绘制）。|
|[COleControl：： OnGetViewRect](#ongetviewrect)|重写以将控件的大小转换为从特定位置开始的矩形。|
|[COleControl：： OnGetViewStatus](#ongetviewstatus)|重写以检索控件的视图状态。|
|[COleControl：： OnHideToolBars](#onhidetoolbars)|当控件处于 UI 禁用状态时由容器调用。|
|[COleControl：： OnInactiveMouseMove](#oninactivemousemove)|重写以使鼠标指针下的非活动控件的容器 WM_MOUSEMOVE 发送到控件的消息。|
|[COleControl：： OnInactiveSetCursor](#oninactivesetcursor)|重写以使鼠标指针下的非活动控件的容器 WM_SETCURSOR 发送到控件的消息。|
|[COleControl：： OnKeyDownEvent](#onkeydownevent)|在激发股票 KeyDown 事件之后调用。|
|[COleControl：： OnKeyPressEvent](#onkeypressevent)|在激发 stock 按键事件之后调用。|
|[COleControl：： OnKeyUpEvent](#onkeyupevent)|在激发 stock KeyUp 事件之后调用。|
|[COleControl：： OnMapPropertyToPage](#onmappropertytopage)|指示用于编辑属性的属性页。|
|[COleControl：： OnMnemonic](#onmnemonic)|当已按下控件的助记键时调用。|
|[COleControl：： OnProperties](#onproperties)|在调用控件的 "Properties" 谓词时调用。|
|[COleControl：： OnQueryHitPoint](#onqueryhitpoint)|重写以查询控件的显示是否与给定点重叠。|
|[COleControl：： OnQueryHitRect](#onqueryhitrect)|重写以查询控件的显示是否与给定矩形中的任何点重叠。|
|[COleControl：： OnRenderData](#onrenderdata)|由框架调用以检索指定格式的数据。|
|[COleControl：： OnRenderFileData](#onrenderfiledata)|由框架调用以从文件中检索指定格式的数据。|
|[COleControl：： OnRenderGlobalData](#onrenderglobaldata)|由框架调用以检索指定格式的全局内存中的数据。|
|[COleControl：： OnResetState](#onresetstate)|将控件的属性重置为默认值。|
|[COleControl：： OnSetClientSite](#onsetclientsite)|通知控件 `IOleControl::SetClientSite` 已被调用。|
|[COleControl：： OnSetData](#onsetdata)|将控件的数据替换为另一个值。|
|[COleControl：： OnSetExtent](#onsetextent)|在控件的范围发生更改后调用。|
|[COleControl：： OnSetObjectRects](#onsetobjectrects)|在控件的维度更改后调用。|
|[COleControl：： OnShowToolBars](#onshowtoolbars)|当控件已激活 UI 时调用。|
|[COleControl：： OnTextChanged](#ontextchanged)|当更改了 stock 文本或标题属性时调用。|
|[COleControl：： OnWindowlessMessage](#onwindowlessmessage)|处理无窗口控件的窗口消息（鼠标和键盘消息除外）。|
|[COleControl：:P arentToClient](#parenttoclient)|将相对于容器原点的点转换为相对于控件原点的点。|
|[COleControl：:P ostModalDialog](#postmodaldialog)|通知容器模式对话框已关闭。|
|[COleControl：:P reModalDialog](#premodaldialog)|通知容器将要显示的模式对话框。|
|[COleControl：： RecreateControlWindow](#recreatecontrolwindow)|销毁并重新创建控件的窗口。|
|[COleControl：： Refresh](#refresh)|强制重新绘制控件的外观。|
|[COleControl：： ReleaseCapture](#releasecapture)|释放鼠标捕获。|
|[COleControl：： ReleaseDC](#releasedc)|释放无窗口控件的容器的显示设备上下文。|
|[COleControl：： ReparentControlWindow](#reparentcontrolwindow)|重置控件窗口的父级。|
|[COleControl：： ResetStockProps](#resetstockprops)|将 `COleControl` stock 属性初始化为其默认值。|
|[COleControl：： ResetVersion](#resetversion)|将版本号初始化为给定的值。|
|[COleControl：： ScrollWindow](#scrollwindow)|允许无窗口控件在其就地活动图像中滚动显示的区域。|
|[COleControl：： SelectFontObject](#selectfontobject)|选择自定义字体属性到设备上下文。|
|[COleControl：： SelectStockFont](#selectstockfont)|选择 "常用字体" 属性到设备上下文。|
|[COleControl：： SerializeExtent](#serializeextent)|序列化或初始化控件的显示空间。|
|[COleControl：： SerializeStockProps](#serializestockprops)|序列化或初始化 `COleControl` 常用属性。|
|[COleControl：： SerializeVersion](#serializeversion)|序列化或初始化控件的版本信息。|
|[COleControl：： SetAppearance](#setappearance)|设置 "股票外观" 属性的值。|
|[COleControl：： SetBackColor](#setbackcolor)|设置 "股票背景色" 属性的值。|
|[COleControl：： SetBorderStyle](#setborderstyle)|设置 "stock BorderStyle" 属性的值。|
|[COleControl：： SetCapture](#setcapture)|导致控件的容器窗口代表控件占据鼠标捕获。|
|[COleControl：： SetControlSize](#setcontrolsize)|设置 OLE 控件的位置和大小。|
|[COleControl：： SetEnabled](#setenabled)|设置 "启用股票" 属性的值。|
|[COleControl：： SetFocus](#setfocus)|导致控件的容器窗口代表控件拥有输入焦点。|
|[COleControl：： SetFont](#setfont)|设置 "常用字体" 属性的值。|
|[COleControl：： SetForeColor](#setforecolor)|设置 "股票前景色" 属性的值。|
|[COleControl：： SetInitialSize](#setinitialsize)|设置 OLE 控件第一次在容器中显示时的大小。|
|[COleControl：： SetModifiedFlag](#setmodifiedflag)|更改控件的修改状态。|
|[COleControl：： SetNotPermitted](#setnotpermitted)|指示编辑请求失败。|
|[COleControl：： SetNotSupported](#setnotsupported)|防止用户修改控件的属性值。|
|[COleControl：： SetRectInContainer](#setrectincontainer)|设置控件相对于其容器的矩形。|
|[COleControl：： SetText](#settext)|设置 stock 文本或标题属性的值。|
|[COleControl：： ThrowError](#throwerror)|指示 OLE 控件中发生了错误。|
|[COleControl：： TransformCoords](#transformcoords)|转换容器和控件之间的坐标值。|
|[COleControl：： TranslateColor](#translatecolor)|将 OLE_COLOR 值转换为 COLORREF 值。|
|[COleControl：： WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|确定在下一次加载控件时环境属性是否可用。|
|[COleControl：： WindowProc](#windowproc)|为 `COleControl` 对象提供 Windows 过程。|

### <a name="protected-methods"></a>受保护方法

|名称|说明|
|----------|-----------------|
|[COleControl：:D rawContent](#drawcontent)|当需要更新控件的外观时由框架调用。|
|[COleControl：:D rawMetafile](#drawmetafile)|当使用图元文件设备上下文时由框架调用。|
|[COleControl：： IsInvokeAllowed](#isinvokeallowed)|启用自动化方法调用。|
|[COleControl：： SetInitialDataFormats](#setinitialdataformats)|由框架调用以初始化控件支持的数据格式列表。|

## <a name="remarks"></a>备注

派生自 `CWnd`，此类继承 Windows 窗口对象的所有功能以及特定于 OLE 的附加功能，如事件激发和支持方法和属性的功能。

可以将 OLE 控件插入 OLE 容器应用程序中，并使用双向系统事件激发并向容器公开方法和属性，与容器进行通信。 请注意，标准 OLE 容器只支持 OLE 控件的基本功能。 它们不支持 OLE 控件的扩展功能。 如果在控件中发生特定操作，将事件发送到容器，则会发生事件激发。 反过来，容器通过使用一组公开的方法和属性（类似于C++类的成员函数和数据成员）与控件进行通信。 此方法允许开发人员控制控件的外观并在发生特定操作时通知容器。

## <a name="windowless-controls"></a>无窗口控件

OLE 控件可以在不使用窗口的情况下就地激活。 无窗口控件具有明显优势：

- 无窗口控件可以是透明的，也可以是非矩形

- 无窗口控件减少对象的实例大小和创建时间

控件不需要窗口。 Windows 提供的服务可以通过单个共享窗口（通常是容器）和一个调度代码轻松地提供。 在此对象上，有一个窗口通常是不必要的。

当使用无窗口激活时，容器（有窗口）负责提供其他已由控件自己的窗口提供的服务。 例如，如果您的控件需要查询键盘焦点、查询鼠标捕获或获取设备上下文，则这些操作由容器管理。 `COleControl` 无窗口操作成员函数在容器上调用这些操作。

启用无窗口激活时，容器会将输入消息委托给控件的 `IOleInPlaceObjectWindowless` 接口（ [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject)的扩展可实现无窗口支持）。 当调整鼠标坐标后，此接口 `COleControl`的实现将通过控件的消息映射调度这些消息。 您可以通过将相应条目添加到消息映射来处理这些消息，如普通窗口消息。

在无窗口控件中，应始终使用 `COleControl` 成员函数，而不是相应的 `CWnd` 成员函数或其相关的 Windows API 函数。

OLE 控件对象也可以仅在活动状态下创建窗口，但非活动活动转换所需的工作量会下降，并且过渡速度会下降。 在某些情况下，出现这种问题：作为示例，请考虑使用文本框网格。 当 cursoring 列时，必须将每个控件就地激活，然后将其停用。 非活动/活动转换的速度将直接影响滚动速度。

有关开发 OLE 控件框架的详细信息，请参阅文章[Mfc Activex 控件](../../mfc/mfc-activex-controls.md)和[概述：创建 mfc activex 控制程序](../../mfc/reference/mfc-activex-control-wizard.md)。 有关优化 OLE 控件（包括无窗口和无闪烁控件）的信息，请参阅[MFC ActiveX 控件：优化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>要求

**标头：** afxctl。h

##  <a name="ambientbackcolor"></a>COleControl：： AmbientBackColor

返回环境背景值属性的值。

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>返回值

容器的环境背景色属性的当前值（如果有）。 如果该属性不受支持，则此函数将返回系统定义的 Windows 背景色。

### <a name="remarks"></a>备注

环境背景色属性可供所有控件使用，由容器定义。 请注意，支持此属性不需要容器。

##  <a name="ambientdisplayname"></a>COleControl：： AmbientDisplayName

容器分配给控件的名称可用于向用户显示的错误消息。

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>返回值

OLE 控件的名称。 默认值为零长度字符串。

### <a name="remarks"></a>备注

请注意，支持此属性不需要容器。

##  <a name="ambientfont"></a>COleControl：： AmbientFont

返回环境字体属性的值。

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>返回值

指向容器环境字体调度接口的指针。 默认值为 NULL。 如果返回的不等于 NULL，则需要通过调用其[IUnknown：： Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)成员函数来释放字体。

### <a name="remarks"></a>备注

环境字体属性由容器定义，可用于所有控件。请注意，支持此属性不需要容器。

##  <a name="ambientforecolor"></a>COleControl：： AmbientForeColor

返回环境前景色属性的值。

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>返回值

容器的环境前景色属性的当前值（如果有）。 如果不支持，则此函数将返回系统定义的 Windows 文本颜色。

### <a name="remarks"></a>备注

环境前景色属性可供所有控件使用，由容器定义。 请注意，支持此属性不需要容器。

##  <a name="ambientlocaleid"></a>COleControl：： AmbientLocaleID

返回容器的区域设置 ID。

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>返回值

容器的 LocaleID 属性的值（如果有）。 如果此属性不受支持，则此函数返回0。

### <a name="remarks"></a>备注

控件可以使用 LocaleID 来调整其用户界面的特定区域设置。 请注意，支持此属性不需要容器。

##  <a name="ambientappearance"></a>COleControl：： AmbientAppearance

检索控件对象的当前外观设置。

```
short AmbientAppearance();
```

### <a name="return-value"></a>返回值

控件的外观：

- **0**平面外观

- **1**三维外观

### <a name="remarks"></a>备注

调用此函数可检索控件的 DISPID_AMBIENT_APPEARANCE 属性的当前值。

##  <a name="ambientscaleunits"></a>COleControl：： AmbientScaleUnits

返回容器使用的单位类型。

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>返回值

一个字符串，其中包含容器的环境 ScaleUnits。 如果此属性不受支持，则此函数返回一个长度为零的字符串。

### <a name="remarks"></a>备注

容器的环境 ScaleUnits 属性可用于显示位置或维度，其中标有所选单位，例如缇或厘米。 请注意，支持此属性不需要容器。

##  <a name="ambientshowgrabhandles"></a>COleControl：： AmbientShowGrabHandles

确定容器是否允许控件在活动时显示其自身的抓取柄。

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>返回值

如果应显示抓取柄，则为非零值;否则为0。 如果此属性不受支持，则此函数将返回非零值。

### <a name="remarks"></a>备注

请注意，支持此属性不需要容器。

##  <a name="ambientshowhatching"></a>COleControl：： AmbientShowHatching

确定容器是否允许控件在激活 UI 时以阴影模式显示自身。

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>返回值

如果应显示阴影模式，则为非零值;否则为0。 如果此属性不受支持，则此函数将返回非零值。

### <a name="remarks"></a>备注

请注意，支持此属性不需要容器。

##  <a name="ambienttextalign"></a>COleControl：： AmbientTextAlign

确定控件容器首选的环境文本对齐方式。

```
short AmbientTextAlign();
```

### <a name="return-value"></a>返回值

容器的环境文本对齐属性的状态。 如果此属性不受支持，则此函数返回0。

下面列出了有效的返回值：

|返回值|含义|
|------------------|-------------|
|0|常规对齐方式（从右到左的数字）。|
|1|左对齐|
|2|中心|
|3|右对齐|

### <a name="remarks"></a>备注

此属性可用于所有嵌入的控件，并且由容器定义。 请注意，支持此属性不需要容器。

##  <a name="ambientuidead"></a>COleControl：： AmbientUIDead

确定容器是否希望控件响应用户界面操作。

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>返回值

如果控件应响应用户界面操作，则为非零值;否则为0。 如果此属性不受支持，则此函数返回0。

### <a name="remarks"></a>备注

例如，在设计模式下，容器可能将此项设置为 TRUE。

##  <a name="ambientusermode"></a>COleControl：： AmbientUserMode

确定容器是处于设计模式还是处于用户模式。

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>返回值

如果容器处于用户模式，则为非零值;否则为0（处于设计模式）。 如果此属性不受支持，则此函数返回 TRUE。

### <a name="remarks"></a>备注

例如，容器可能在设计模式下将此项设置为 FALSE。

##  <a name="boundpropertychanged"></a>COleControl：： BoundPropertyChanged

发出信号表示绑定属性值已更改。

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>parameters

*dispid*<br/>
控件的绑定属性的调度 ID。

### <a name="remarks"></a>备注

每次属性的值发生更改时都必须调用此方法，即使在未通过属性集方法进行更改的情况下也是如此。 请特别注意映射到成员变量的绑定属性。 任何时候此类成员变量发生更改，都必须调用 `BoundPropertyChanged`。

##  <a name="boundpropertyrequestedit"></a>COleControl：： BoundPropertyRequestEdit

向 `IPropertyNotifySink` 接口请求权限，以更改控件提供的绑定属性值。

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>parameters

*dispid*<br/>
控件的绑定属性的调度 ID。

### <a name="return-value"></a>返回值

如果允许更改，则为非零值;否则为0。 默认值为非零值。

### <a name="remarks"></a>备注

如果权限被拒绝，则控件不能让属性的值发生更改。 这可以通过忽略或失败尝试更改属性值的操作来完成。

##  <a name="clienttoparent"></a>COleControl：： ClientToParent

将*pPoint*的坐标转换为父坐标。

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>parameters

*lprcBounds*<br/>
一个指针，指向容器中 OLE 控件的边界。 不是工作区，而是整个控件的区域（包括边框和滚动条）。

*pPoint*<br/>
指向要转换为父（容器）坐标的 OLE 工作区点的指针。

### <a name="remarks"></a>备注

在 input *pPoint*上，相对于 OLE 控件（控件工作区左上角）的工作区的原点。 On output *pPoint*是相对于父级（容器左上角）的原点。

##  <a name="clipcaretrect"></a>COleControl：： ClipCaretRect

如果插入符号矩形完全或部分覆盖了重叠的不透明对象，则调整它。

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>parameters

*lpRect*<br/>
输入时，指向包含要调整的插入符号区域的[RECT](/windows/win32/api/windef/ns-windef-rect)结构的指针。 输出时，调整后的插入符号区域; 如果完全覆盖了插入符号矩形，则为 NULL。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

脱字号是闪烁线条、块或位图，通常指示文本或图形的插入位置。

无窗口对象在不事先检查插入符号是否部分或完全隐藏了重叠对象的情况下，不能安全地显示插入符号。 为了实现此目的，对象可以使用 `ClipCaretRect` 来使插入符号调整（减少）以确保它适合于剪辑区域。

创建插入符号的对象应将脱字号矩形提交给 `ClipCaretRect`，并将调整后的矩形用于插入符号。 如果完全隐藏插入符号，则此方法将返回 FALSE，并且在这种情况下，不应显示插入符号。

##  <a name="colecontrol"></a>COleControl：： COleControl

构造 `COleControl` 对象。

```
COleControl();
```

### <a name="remarks"></a>备注

通常不直接调用此函数。 相反，OLE 控件通常由其类工厂创建。

##  <a name="controlinfochanged"></a>COleControl：： ControlInfoChanged

如果控件支持的助记键集已更改，则调用此函数。

```
void ControlInfoChanged();
```

### <a name="remarks"></a>备注

收到此通知后，控件的容器通过调用[IOleControl：： GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo)获取新的助记键集。 请注意，该容器不需要响应此通知。

##  <a name="displayerror"></a>COleControl：:D isplayError

在处理 stock 错误事件之后，由框架调用（除非事件处理程序已取消显示错误）。

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>parameters

*scode*<br/>
要报告的状态代码值。 有关可能代码的完整列表，请参阅文章[ActiveX 控件：高级主题](../../mfc/mfc-activex-controls-advanced-topics.md)。

*lpszDescription*<br/>
所报告错误的说明。

*lpszSource*<br/>
生成错误的模块的名称（通常是 OLE 控件模块的名称）。

*lpszHelpFile*<br/>
包含错误说明的帮助文件的名称。

*nHelpID*<br/>
所报告错误的帮助上下文 ID。

### <a name="remarks"></a>备注

默认行为将显示一个消息框，其中包含包含在*lpszDescription*中的错误说明。

重写此函数以自定义显示错误的方式。

##  <a name="doclick"></a>COleControl：:D oClick

模拟控件上的鼠标单击操作。

```
void DoClick();
```

### <a name="remarks"></a>备注

如果控件支持，则将调用可重写的 `COleControl::OnClick` 成员函数，并激发 stock Click 事件。

此函数作为常用方法（称为 DoClick）由 `COleControl` 基类支持。 有关详细信息，请参阅[ActiveX 控件：方法](../../mfc/mfc-activex-controls-methods.md)一文。

##  <a name="dopropexchange"></a>COleControl：:D oPropExchange

在从持久存储表示形式（如流或属性集）加载或存储控件时由框架调用。

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>parameters

*pPX*<br/>
一个指向 `CPropExchange` 对象的指针。 框架提供了此对象以建立属性交换的上下文，包括其方向。

### <a name="remarks"></a>备注

此函数通常会调用**PX_** 系列函数来加载或存储 OLE 控件的特定用户定义属性。

如果已使用 "控件向导" 创建 OLE 控件项目，则此函数的重写版本将通过调用基类函数来序列化 `COleControl` 支持的常用属性，`COleControl::DoPropExchange`。 将用户定义属性添加到 OLE 控件时，需要修改此函数以序列化新属性。 有关序列化的详细信息，请参阅[ActiveX 控件：序列化](../../mfc/mfc-activex-controls-serializing.md)一文。

##  <a name="dosuperclasspaint"></a>COleControl：:D oSuperclassPaint

重绘已从 Windows 控件中产生子类的 OLE 控件。

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
指向控件容器的设备上下文的指针。

*rcBounds*<br/>
要在其中绘制控件的区域。

### <a name="remarks"></a>备注

调用此函数可正确处理非活动 OLE 控件的绘制。 仅当 OLE 控件将 Windows 控件子类，并应在控件的 `OnDraw` 函数中调用此函数时，才应使用此函数。

有关此函数和 Windows 控件的子类的详细信息，请参阅[ActiveX 控件：为 Windows 控件提供子类一](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)文。

##  <a name="drawcontent"></a>COleControl：:D rawContent

当需要更新控件的外观时由框架调用。

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
指向设备上下文的指针。

*.rc*<br/>
要在其中绘制的矩形区域。

### <a name="remarks"></a>备注

此函数直接调用可重写的 `OnDraw` 函数。

##  <a name="drawmetafile"></a>COleControl：:D rawMetafile

当使用图元文件设备上下文时由框架调用。

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
指向图元文件设备上下文的指针。

*.rc*<br/>
要在其中绘制的矩形区域。

##  <a name="enablesimpleframe"></a>COleControl：： EnableSimpleFrame

启用 OLE 控件的简单框架特性。

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>备注

此特性允许控件支持其他控件的可视包含，但不支持真正的 OLE 包容。 例如，包含多个控件的分组框。 这些控件不包含 OLE，但它们位于同一个组框中。

##  <a name="exchangeextent"></a>COleControl：： ExchangeExtent

序列化或初始化控件的范围（其在 HIMETRIC 单元中的维度）的状态。

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>parameters

*pPX*<br/>
指向[CPropExchange](../../mfc/reference/cpropexchange-class.md)对象的指针。 框架提供了此对象以建立属性交换的上下文，包括其方向。

### <a name="return-value"></a>返回值

如果函数成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

此函数通常由 `COleControl::DoPropExchange`的默认实现调用。

##  <a name="exchangestockprops"></a>COleControl：： ExchangeStockProps

序列化或初始化控件的常用属性的状态。

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>parameters

*pPX*<br/>
指向[CPropExchange](../../mfc/reference/cpropexchange-class.md)对象的指针。 框架提供了此对象以建立属性交换的上下文，包括其方向。

### <a name="remarks"></a>备注

此函数通常由 `COleControl::DoPropExchange`的默认实现调用。

##  <a name="exchangeversion"></a>COleControl：： ExchangeVersion

序列化或初始化控件的版本信息的状态。

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>parameters

*pPX*<br/>
一个指向 `CPropExchange` 对象的指针。 框架提供了此对象以建立属性交换的上下文，包括其方向。

*dwVersionDefault*<br/>
控件的当前版本号。

*bConvert*<br/>
指示永久数据在保存时是否应转换为最新格式，或保持为与加载的格式相同的格式。

### <a name="return-value"></a>返回值

函数的非零成功;否则为0。

### <a name="remarks"></a>备注

通常，这将是由控件的 `COleControl::DoPropExchange`的重写调用的第一个函数。 加载时，此函数将读取永久性数据的版本号，并相应地设置[CPropExchange](../../mfc/reference/cpropexchange-class.md)对象的 version 特性。 保存时，此函数将写入永久性数据的版本号。

有关持久性和版本控制的详细信息，请参阅[ActiveX 控件：序列化](../../mfc/mfc-activex-controls-serializing.md)一文。

##  <a name="fireclick"></a>COleControl：： FireClick

当鼠标单击活动控件上时由框架调用。

```
void FireClick();
```

### <a name="remarks"></a>备注

如果将此事件定义为自定义事件，则需要确定事件的激发时间。

若要发生 Click 事件的自动触发，控件的事件映射必须定义了 stock Click 事件。

##  <a name="firedblclick"></a>COleControl：： FireDblClick

当鼠标在活动控件上双击时由框架调用。

```
void FireDblClick();
```

### <a name="remarks"></a>备注

如果将此事件定义为自定义事件，则需要确定事件的激发时间。

若要发生 DblClick 事件的自动触发，控件的事件映射必须定义一个 stock DblClick 事件。

##  <a name="fireerror"></a>COleControl：： FireError

激发 stock 错误事件。

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>parameters

*scode*<br/>
要报告的状态代码值。 有关可能代码的完整列表，请参阅文章[ActiveX 控件：高级主题](../../mfc/mfc-activex-controls-advanced-topics.md)。

*lpszDescription*<br/>
所报告错误的说明。

*nHelpID*<br/>
所报告错误的帮助 ID。

### <a name="remarks"></a>备注

此事件提供一种在代码中的适当位置，在控件内发生错误的方式。 与其他常用事件（如 Click 或 MouseMove）不同，框架永远不会引发错误。

若要报告在属性获取函数、属性集函数或自动化方法期间发生的错误，请调用[COleControl：： ThrowError](#throwerror)。

OLE 控件的 Stock 错误事件的实现使用 SCODE 值。 如果控件使用此事件，并且要在 Visual Basic 4.0 中使用，则将收到错误，因为 Visual Basic 不支持 SCODE 值。

若要解决此问题，请手动更改控件的中的 SCODE 参数。ODL**文件。** 此外，使用 SCODE 参数的任何自定义事件、方法或属性也会导致相同的问题。

##  <a name="fireevent"></a>COleControl：： FireEvent

使用任意数量的可选参数从控件中触发用户定义的事件。

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>parameters

*dispid*<br/>
要激发的事件的调度 ID。

*pbParams*<br/>
事件的参数类型的描述符。

### <a name="remarks"></a>备注

通常不应直接调用此函数。 相反，你将在控件的类声明的事件映射节中调用事件触发函数。

*PbParams*参数是以空格分隔的**VTS_** 列表。 其中一个或多个值（由空格（而不是逗号）分隔）指定函数的参数列表。 可能的值如下所示：

|符号|参数类型|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  已为所有变体类型定义了其他变体常量（VTS_FONT 和 VTS_PICTURE 除外），它们提供指向变量数据常量的指针。 使用**VTS_P**`constantname` 约定来命名这些常量。 例如，VTS_PCOLOR 是指向 VTS_COLOR 常量的指针。

##  <a name="firekeydown"></a>COleControl：： FireKeyDown

当控件处于活动状态时，当按下某个键时由框架调用。

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>parameters

*pnChar*<br/>
指向按下键的虚拟键代码值的指针。 有关标准虚拟键代码的列表，请参阅 Winuser。h

*nShiftState*<br/>
包含以下标志的组合：

- 在操作过程中，SHIFT_MASK 按下 SHIFT 键。

- CTRL_MASK 在操作过程中按下了 CTRL 键。

- ALT_MASK 在操作过程中按下了 ALT 键。

### <a name="remarks"></a>备注

如果将此事件定义为自定义事件，则需要确定事件的激发时间。

若要发生 KeyDown 事件的自动触发，控件的事件映射必须定义有股票 KeyDown 事件。

##  <a name="firekeypress"></a>COleControl：： FireKeyPress

当按下某个键时由框架调用，当自定义控件在容器中处于活动状态时，将释放该控件。

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>parameters

*pnChar*<br/>
一个指针，指向按下的键的字符值。

### <a name="remarks"></a>备注

如果将此事件定义为自定义事件，则需要确定事件的激发时间。

例如，事件的接收方可以修改*pnChar*，例如，将所有小写字符都转换为大写。 如果要检查修改后的字符，请覆盖 `OnKeyPressEvent`。

若要发生按键事件的自动触发，控件的事件映射必须定义了一个 "stock 按键" 事件。

##  <a name="firekeyup"></a>COleControl：： FireKeyUp

当自定义控件在容器中处于活动状态时，当释放某个键时由框架调用。

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>parameters

*pnChar*<br/>
指向已释放密钥的虚拟键代码值的指针。 有关标准虚拟键代码的列表，请参阅 Winuser。h

*nShiftState*<br/>
包含以下标志的组合：

- 在操作过程中，SHIFT_MASK 按下 SHIFT 键。

- CTRL_MASK 在操作过程中按下了 CTRL 键。

- ALT_MASK 在操作过程中按下了 ALT 键。

### <a name="remarks"></a>备注

如果将此事件定义为自定义事件，则需要确定事件的激发时间。

若要发生 KeyUp 事件的自动激发，控件的事件映射必须定义一个 stock KeyUp 事件。

##  <a name="firemousedown"></a>COleControl：： FireMouseDown

当在活动自定义控件上按下鼠标按钮时，由框架调用。

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>parameters

*nButton*<br/>
按下鼠标按钮的数值。 它可以包含以下值之一：

- LEFT_BUTTON 按下鼠标左键。

- MIDDLE_BUTTON 按下鼠标中键。

- RIGHT_BUTTON 按下鼠标右键。

*nShiftState*<br/>
包含以下标志的组合：

- 在操作过程中，SHIFT_MASK 按下 SHIFT 键。

- CTRL_MASK 在操作过程中按下了 CTRL 键。

- ALT_MASK 在操作过程中按下了 ALT 键。

*x*<br/>
按下鼠标按钮时光标的 x 坐标。 该坐标相对于控件窗口的左上角。

*y*<br/>
按下鼠标按钮时光标的 y 坐标。 该坐标相对于控件窗口的左上角。

### <a name="remarks"></a>备注

如果将此事件定义为自定义事件，则需要确定事件的激发时间。

若要使 MouseDown 事件自动触发发生，控件的事件映射必须已定义了一个 stock MouseDown 事件。

##  <a name="firemousemove"></a>COleControl：： FireMouseMove

当光标移到活动的自定义控件上时由框架调用。

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>parameters

*nButton*<br/>
按下鼠标按钮的数值。 包含以下值的组合：

- LEFT_BUTTON 在操作过程中按下鼠标左键。

- MIDDLE_BUTTON 操作期间，按下鼠标中键。

- 在操作过程中，RIGHT_BUTTON 按下鼠标右键。

*nShiftState*<br/>
包含以下标志的组合：

- 在操作过程中，SHIFT_MASK 按下 SHIFT 键。

- CTRL_MASK 在操作过程中按下了 CTRL 键。

- ALT_MASK 在操作过程中按下了 ALT 键。

*x*<br/>
光标的 x 坐标。 该坐标相对于控件窗口的左上角。

*y*<br/>
光标的 y 坐标。 该坐标相对于控件窗口的左上角。

### <a name="remarks"></a>备注

如果将此事件定义为自定义事件，则需要确定事件的激发时间。

若要发生 MouseMove 事件的自动触发，控件的事件映射必须定义一个 stock MouseMove 事件。

##  <a name="firemouseup"></a>COleControl：： FireMouseUp

当通过活动自定义控件释放鼠标按钮时，由框架调用。

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>parameters

*nButton*<br/>
已释放的鼠标按钮的数值。 它可以具有下列值之一：

- LEFT_BUTTON 释放鼠标左键。

- MIDDLE_BUTTON 放开鼠标中键。

- 已释放鼠标右键 RIGHT_BUTTON。

*nShiftState*<br/>
包含以下标志的组合：

- 在操作过程中，SHIFT_MASK 按下 SHIFT 键。

- CTRL_MASK 在操作过程中按下了 CTRL 键。

- ALT_MASK 在操作过程中按下了 ALT 键。

*x*<br/>
释放鼠标按钮时光标的 x 坐标。 该坐标相对于控件窗口的左上角。

*y*<br/>
释放鼠标按钮时光标的 y 坐标。 该坐标相对于控件窗口的左上角。

### <a name="remarks"></a>备注

如果将此事件定义为自定义事件，则需要确定事件的激发时间。

若要发生 MouseUp 事件的自动激发，控件的事件映射必须已定义了 stock MouseUp 事件。

##  <a name="firereadystatechange"></a>COleControl：： FireReadyStateChange

使用控件的 "就绪" 状态的当前值激发一个事件。

```
void FireReadyStateChange();
```

### <a name="remarks"></a>备注

就绪状态可以为下列值之一：

|||
|-|-|
|READYSTATE_UNINITIALIZED|默认初始化状态|
|READYSTATE_LOADING|控件当前正在加载其属性|
|READYSTATE_LOADED|控件已初始化|
|READYSTATE_INTERACTIVE|控件具有足够的数据以进行交互，但并不是所有的异步数据都已加载|
|READYSTATE_COMPLETE|控件的所有数据|

使用[GetReadyState](#getreadystate)确定控件当前的准备情况。

[InternalSetReadyState](#internalsetreadystate)将 "就绪" 状态更改为提供的值，然后调用 `FireReadyStateChange`。

##  <a name="getactivationpolicy"></a>COleControl：： GetActivationPolicy

更改支持 `IPointerInactive` 接口的控件的默认激活行为。

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>返回值

POINTERINACTIVE 枚举中的标志的组合。 可能的标志包括：

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|当鼠标在鼠标移动操作过程中输入对象时，该对象应就地激活。|
|POINTERINACTIVE_DEACTIVATEONLEAVE|当鼠标移动操作过程中鼠标离开对象时，应停用对象。|
|POINTERINACTIVE_ACTIVATEONDRAG|当在拖放操作过程中将鼠标拖动到对象上时，应就地激活对象。|

### <a name="remarks"></a>备注

启用 `IPointerInactive` 接口时，容器会将 WM_SETCURSOR 和 WM_MOUSEMOVE 消息委托给它。 当调整鼠标坐标后，此接口 `COleControl`的实现将通过控件的消息映射调度这些消息。

每当容器接收到 WM_SETCURSOR 或 WM_MOUSEMOVE 消息，并将鼠标指针悬停在支持 `IPointerInactive`的非活动对象上时，它应调用接口上的 `GetActivationPolicy`，并从 POINTERINACTIVE 枚举返回标志。

您可以通过将相应条目添加到消息映射来处理这些消息，就像普通的窗口消息一样。 在处理程序中，避免在不事先检查其值是否为非 NULL 的情况下使用 `m_hWnd` 成员变量（或使用该变量的任何成员函数）。

除设置鼠标光标和/或激发鼠标移动事件（例如提供特殊的视觉反馈）以外的任何对象都应返回 POINTERINACTIVE_ACTIVATEONENTRY 标志并仅在活动时才绘制反馈。 如果对象返回此标志，则容器应立即将其激活，然后将其转发到触发调用 `GetActivationPolicy`的同一消息。

如果同时返回 POINTERINACTIVE_ACTIVATEONENTRY 和 POINTERINACTIVE_DEACTIVATEONLEAVE 标志，则只有当鼠标位于对象上时，才会激活对象。 如果只返回 POINTERINACTIVE_ACTIVATEONENTRY 标志，则仅当鼠标第一次进入对象时，才会激活该对象一次。

您还可能希望将非活动控件作为 OLE 拖放操作的目标。 这需要在用户将对象拖到控件上时激活控件，使控件的窗口可以注册为拖放目标。 若要导致在拖动过程中发生激活，请返回 POINTERINACTIVE_ACTIVATEONDRAG 标志：

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

`GetActivationPolicy` 通信的信息不应由容器缓存。 相反，每次鼠标进入非活动对象时，都应调用此方法。

如果非活动对象在鼠标进入该对象时未请求就地激活，则只要鼠标指针停留在该对象上，它的容器就会通过调用[OnInactiveSetCursor](#oninactivesetcursor)将后续 WM_SETCURSOR 消息调度到此对象。

启用 `IPointerInactive` 接口通常意味着希望控件始终能够处理鼠标消息。 若要在不支持 `IPointerInactive` 接口的容器中获取此行为，你将需要在可见时始终激活控件，这意味着控件应在其杂项标志中具有 OLEMISC_ACTIVATEWHENVISIBLE 标志。 但是，若要防止此标志在支持 `IPointerInactive`的容器中生效，还可以指定 OLEMISC_IGNOREACTIVATEWHENVISIBLE 标志：

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>COleControl：： GetAmbientProperty

获取容器的环境属性的值。

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>parameters

*dwDispid*<br/>
所需环境属性的调度 ID。

*vtProp*<br/>
一个变量类型标记，它指定要在*pvProp*中返回的值的类型。

*pvProp*<br/>
一个指针，指向将接收属性值或返回值的变量的地址。 此指针的实际类型必须与*vtProp*指定的类型匹配。

|vtProp|PvProp 的类型|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>返回值

如果支持环境属性，则为非零值;否则为0。

### <a name="remarks"></a>备注

如果使用 `GetAmbientProperty` 检索环境 DisplayName 和 ScaleUnits 属性，请将*vtProp*设置为 "`CString*`" VT_BSTR 和 " *pvProp* "。 如果要检索环境字体属性，请将*vtProp*设置为 VT_FONT，并将*PVPROP*设置为 LPFONTDISP *。

请注意，已为常见环境属性（如[AmbientBackColor](#ambientbackcolor)和[AmbientFont](#ambientfont)）提供函数。

##  <a name="getappearance"></a>COleControl：： GetAppearance

实现控件的 stock 外观属性的 Get 函数。

```
short GetAppearance ();
```

### <a name="return-value"></a>返回值

如果成功，则返回值将当前外观设置指定为**short** （VT_I2）值。 如果控件的外观为平面，则此值为零; 如果控件的外观为三维，则为1。

##  <a name="getbackcolor"></a>COleControl：： GetBackColor

实现控件的常用背景色属性的 Get 函数。

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>返回值

如果成功，则返回值指定当前背景色作为 OLE_COLOR 值。 可以通过调用 `TranslateColor`将此值转换为 COLORREF 值。

##  <a name="getborderstyle"></a>COleControl：： GetBorderStyle

实现控件的 stock BorderStyle 属性的 Get 函数。

```
short GetBorderStyle();
```

### <a name="return-value"></a>返回值

如果控件具有普通边框，则为 1; 否则为。如果控件没有边框，则为0。

##  <a name="getcapture"></a>COleControl：： GetCapture

确定 `COleControl` 对象是否具有鼠标捕获。

```
CWnd* GetCapture();
```

### <a name="return-value"></a>返回值

如果控件已激活且无窗口，则在控件当前具有鼠标捕获（由控件的容器确定）**时返回，** 如果该控件没有捕获，则返回 NULL。

否则，将返回具有鼠标捕获的 `CWnd` 对象（等同于 `CWnd::GetCapture`）。

### <a name="remarks"></a>备注

调用[SetCapture](#setcapture)时，激活的无窗口控件接收鼠标捕获。

##  <a name="getclassid"></a>COleControl：： GetClassID

由框架调用以检索控件的 OLE 类 ID。

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>parameters

*pclsid*<br/>
指向类 ID 位置的指针。

### <a name="return-value"></a>返回值

如果调用不成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

通常由[IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)实现。

##  <a name="getclientoffset"></a>COleControl：： GetClientOffset

检索控件的矩形区域的左上角与其工作区左上角之间的差异。

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>parameters

*pdxOffset*<br/>
指向 OLE 控件的工作区的水平偏移量的指针。

*pdyOffset*<br/>
指向 OLE 控件的工作区的垂直偏移量的指针。

### <a name="remarks"></a>备注

OLE 控件的容器内有一个矩形区域。 控件的工作区是不包括边框和滚动条的控件区域。 `GetClientOffset` 检索的偏移量是控件的矩形区域的左上角和其工作区左上角之间的差异。 如果控件具有标准边框和滚动条以外的非客户端元素，请重写此成员函数以指定偏移量。

##  <a name="getclientrect"></a>COleControl：： GetClientRect

检索控件的工作区的大小。

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>parameters

*lpRect*<br/>
指向 `RECT` 结构的指针，该结构包含无窗口控件的工作区的尺寸;也就是说，控件的大小减去窗口边框、框架、滚动条等。 *LpRect*参数指示控件的客户端矩形的大小，而不是其位置。

##  <a name="getclientsite"></a>COleControl：： GetClientSite

查询对象，以便指针指向其容器中的当前客户端站点。

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>返回值

指向控件的容器中的当前客户端站点的指针。

### <a name="remarks"></a>备注

返回的指针指向 `IOleClientSite`的实例。 `IOleClientSite` 接口由容器实现，它是对象上下文的视图：它在文档中的定位位置，其中获取其存储、用户界面和其他资源。

##  <a name="getcontrolflags"></a>COleControl：： GetControlFlags

检索控件标志设置。

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>返回值

ControlFlags 枚举中标志的运算组合：

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>备注

默认情况下，`GetControlFlags` 返回 `fastBeginPaint | clipPaintDC`。

|||
|-|-|
|`fastBeginPaint`|如果设置，则使用为 OLE 控件而不是[BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) API 定制的 begin 画图函数（默认设置）。|
|`clipPaintDC`|如果未设置，则禁用对 `COleControl` 所做 `IntersectClipRect` 的调用，并获得较小的速度优势。 如果使用无窗口激活，标志将不起作用。|
|`pointerInactive`|如果设置，则通过启用 `COleControl`的 `IPointerInactive` 接口实现（默认情况下已禁用），提供鼠标交互，同时控件处于非活动状态。|
|`noFlickerActivate`|如果设置，则消除额外的绘图操作和伴随的视觉闪烁。 当控件在非活动状态和活动状态中以相同方式绘制自身时使用。 如果使用无窗口激活，标志将不起作用。|
|`windowlessActivate`|如果设置，则指示控件使用无窗口激活。|
|`canOptimizeDraw`|如果设置，则指示控件将执行优化的绘图（如果容器支持）。|

有关 `GetControlFlags` 和 OLE 控件的其他优化的详细信息，请参阅[ActiveX 控件：优化](../../mfc/mfc-activex-controls-optimization.md)。

##  <a name="getcontrolsize"></a>COleControl：： GetControlSize

检索 OLE 控件窗口的大小。

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>parameters

*pcx*<br/>
指定控件的宽度（以像素为单位）。

*pcy*<br/>
指定控件的高度（以像素为单位）。

### <a name="remarks"></a>备注

请注意，控件窗口的所有坐标都是相对于控件的左上角的。

##  <a name="getdc"></a>COleControl：： GetDC

为无窗口对象提供从其容器获取屏幕（或兼容）的设备上下文。

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>parameters

*lprcRect*<br/>
一个指针，指向无窗口控件要在控件的工作区坐标中重绘的矩形。 NULL 表示完全对象的范围。

dwFlags<br/>
设备上下文的绘制属性。 选项包括：

- OLEDC_NODRAW 指示对象不使用设备上下文来执行任何绘制，而只是获取有关显示设备的信息。 容器应该只传递窗口的 DC，无需进一步处理。

- OLEDC_PAINTBKGND 请求容器在返回 DC 之前绘制背景。 如果对象正在请求 DC 来重绘带有透明背景的区域，则应使用此标志。

- OLEDC_OFFSCREEN 通知容器：对象要呈现到屏幕外位图，随后应将该位图复制到屏幕上。 当对象要执行的绘图操作生成很多闪烁时，对象应使用此标志。 容器可随意接受此请求。 但是，如果未设置此标志，则容器必须手动取回屏幕 DC。 这允许对象执行直接屏幕操作，例如显示选定内容（通过**XOR**操作）。

### <a name="return-value"></a>返回值

如果成功，则为指向容器 `CWnd` 客户端区域的显示设备上下文的指针;否则，返回值为 NULL。 显示设备上下文可以在后续的 GDI 函数中用于在容器的窗口的工作区中进行绘制。

### <a name="remarks"></a>备注

必须调用[ReleaseDC](#releasedc)成员函数，以便在绘制后释放上下文。 调用 `GetDC`时，对象会将其要绘制的矩形传递到自己的客户端坐标中。 `GetDC` 将它们转换为容器工作区的坐标。 对象不应请求大于其自己的工作区矩形的所需绘制矩形，其大小可以使用[GetClientRect](#getclientrect)检索。 这可防止对象无意中绘制不应出现的位置。

##  <a name="getenabled"></a>COleControl：： GetEnabled

实现控件的启用了库存的属性的 Get 函数。

```
BOOL GetEnabled();
```

### <a name="return-value"></a>返回值

如果启用控件，则为非零值;否则为0。

##  <a name="getextendedcontrol"></a>COleControl：： GetExtendedControl

获取一个指针，该指针指向由表示具有一组扩展属性的控件的容器维护的对象。

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>返回值

指向容器的扩展控件对象的指针。 如果没有可用的对象，则该值为 NULL。

此对象可通过其 `IDispatch` 接口进行操作。 你还可以使用 `QueryInterface` 获取由对象提供的其他可用接口。 但是，该对象不是支持一组特定接口所必需的。 请注意，依赖容器扩展控件对象的特定功能可将控件的可移植性限制为其他任意容器。

### <a name="remarks"></a>备注

调用此函数的函数负责在对象结束时释放指针。 请注意，容器不需要支持此对象。

##  <a name="getfocus"></a>COleControl：： GetFocus

确定 `COleControl` 对象是否具有焦点。

```
CWnd* GetFocus();
```

### <a name="return-value"></a>返回值

如果控件已激活且无窗口，则在控件当前具有键盘焦点时（由控件的容器确定 **）返回，** 如果该控件没有焦点，则返回 NULL。

否则，将返回具有焦点的 `CWnd` 对象（等同于 `CWnd::GetFocus`）。

### <a name="remarks"></a>备注

调用[SetFocus](#setfocus)时，激活的无窗口控件接收焦点。

##  <a name="getfont"></a>COleControl：： Ivsfontandcolorstorage.getfont 错误

实现常用字体属性的 Get 函数。

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>返回值

指向控件的常用字体属性的字体调度接口的指针。

### <a name="remarks"></a>备注

请注意，在完成后，调用方必须释放对象。 在控件的实现中，使用 `InternalGetFont` 访问控件的常用字体对象。 有关在控件中使用字体的详细信息，请参阅[Activex 控件：在 Activex 控件中使用字体一](../../mfc/mfc-activex-controls-using-fonts.md)文。

##  <a name="getfonttextmetrics"></a>COleControl：： GetFontTextMetrics

度量控件所拥有的任何 `CFontHolder` 对象的文本指标。

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>parameters

*lptm*<br/>
指向[TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw)结构的指针。

*fontHolder*<br/>
对[CFontHolder](../../mfc/reference/cfontholder-class.md)对象的引用。

### <a name="remarks"></a>备注

可以使用[COleControl：： SelectFontObject](#selectfontobject)函数选择此类字体。 如果成功，`GetFontTextMetrics` 会将*lptm*所指向的 `TEXTMETRIC` 结构初始化为包含 `fontHolder`字体的有效指标信息; 如果不成功，则用零填充结构。 绘制控件时，应使用此函数，而不是[GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) ，因为控件（如任何嵌入的 OLE 对象）可能需要将其呈现到图元文件中。

调用[SelectFontObject](#selectfontobject)函数时，将刷新默认字体的 `TEXTMETRIC` 结构。 只应在选择 "常用字体" 属性后调用 `GetFontTextMetrics`，以确保它提供的信息有效。

##  <a name="getforecolor"></a>COleControl：： GetForeColor

实现 stock 前景色属性的 Get 函数。

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>返回值

如果成功，则返回值指定当前前景色作为 OLE_COLOR 值。 可以通过调用 `TranslateColor`将此值转换为[COLORREF](/windows/win32/gdi/colorref)值。

##  <a name="gethwnd"></a>COleControl：： GetHwnd

实现 stock hWnd 属性的 Get 函数。

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>返回值

OLE 控件的窗口句柄（如果有）;否则为 NULL。

##  <a name="getmessagestring"></a>COleControl：： GetMessageString

由框架调用，以获取描述*nID*标识的菜单项的用途的简短字符串。

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>parameters

*nID*<br/>
菜单项 ID。

*rMessage*<br/>
对[CString](../../atl-mfc-shared/reference/cstringt-class.md)对象的引用，通过该对象，将返回一个字符串。

### <a name="remarks"></a>备注

这可用于在突出显示菜单项时，获取显示在状态栏中的消息。 默认实现尝试加载*nID*标识的字符串资源。

##  <a name="getnotsupported"></a>COleControl：： GetNotSupported

禁止用户访问控件的属性值。

```
void GetNotSupported();
```

### <a name="remarks"></a>备注

调用此函数代替任何属性的 Get 函数，而控件的用户不支持对其进行属性检索。 一个示例是只写的属性。

##  <a name="getreadystate"></a>COleControl：： GetReadyState

返回控件的就绪状态。

```
long GetReadyState();
```

### <a name="return-value"></a>返回值

控件的就绪状态，为以下值之一：

|||
|-|-|
|READYSTATE_UNINITIALIZED|默认初始化状态|
|READYSTATE_LOADING|控件当前正在加载其属性|
|READYSTATE_LOADED|控件已初始化|
|READYSTATE_INTERACTIVE|控件具有足够的数据以进行交互，但并不是所有的异步数据都已加载|
|READYSTATE_COMPLETE|控件的所有数据|

### <a name="remarks"></a>备注

大多数简单控件都不需要区分已加载和交互式。 但是，在至少异步接收某些数据之前，支持数据路径属性的控件可能尚未准备好进行交互。 控件会尝试尽快成为交互控件。

##  <a name="getrectincontainer"></a>COleControl：： GetRectInContainer

获取控件的矩形相对于容器的坐标，以设备单位表示。

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>parameters

*lpRect*<br/>
一个指针，指向将向其中复制控件坐标的矩形结构。

### <a name="return-value"></a>返回值

如果控件处于就地活动状态，则为非零值;否则为0。

### <a name="remarks"></a>备注

仅当控件处于就地活动状态时，矩形才有效。

##  <a name="getstocktextmetrics"></a>COleControl：： GetStockTextMetrics

度量控件的常用字体属性的文本度量值，可通过[SelectStockFont](#selectstockfont)函数进行选择。

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>parameters

*lptm*<br/>
指向[TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw)结构的指针。

### <a name="remarks"></a>备注

如果成功，则 `GetStockTextMetrics` 函数将初始化*lptm*所指向的 `TEXTMETRIC` 结构，如果成功，则用零填充结构; 如果不成功，则用零填充结构。 在绘制控件时使用此函数，而不是[GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) ，因为控件（如任何嵌入的 OLE 对象）可能需要将其呈现到图元文件中。

调用 `SelectStockFont` 函数时，将刷新默认字体的 `TEXTMETRIC` 结构。 仅在选择了常用字体后，才应调用此函数，以确保它提供的信息有效。

##  <a name="gettext"></a>COleControl：： GetText

实现 stock 文本或 Caption 属性的 Get 函数。

```
BSTR GetText();
```

### <a name="return-value"></a>返回值

如果不存在字符串，则为控件文本字符串的当前值或长度为零的字符串。

> [!NOTE]
>  有关 BSTR 数据类型的详细信息，请参阅宏和全局部分中的[数据类型](../../mfc/reference/data-types-mfc.md)。

### <a name="remarks"></a>备注

请注意，此函数的调用方必须对返回的字符串调用 `SysFreeString`，以便释放资源。 在控件的实现中，使用 `InternalGetText` 访问控件的 stock 文本或标题属性。

##  <a name="getwindowlessdroptarget"></a>COleControl：： GetWindowlessDropTarget

如果希望将无窗口控件作为 OLE 拖放操作的目标，请覆盖 `GetWindowlessDropTarget`。

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>返回值

指向对象的 `IDropTarget` 接口的指针。 由于它没有窗口，因此无窗口对象无法注册 `IDropTarget` 接口。 但是，若要参与拖放，无窗口对象仍可以实现该接口，并 `GetWindowlessDropTarget`中将其返回。

### <a name="remarks"></a>备注

通常，这需要将该控件的窗口注册为放置目标。 但由于控件没有自己的窗口，容器将使用其自己的窗口作为放置目标。 控件只需提供 `IDropTarget` 接口的实现，容器可以在适当的时间委托调用。 例如：

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>COleControl：： InitializeIIDs

通知控件将使用的 Iid 的基类。

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>parameters

*piidPrimary*<br/>
指向控件的主调度接口的接口 ID 的指针。

*piidEvents*<br/>
指向控件的事件接口的接口 ID 的指针。

### <a name="remarks"></a>备注

在控件的构造函数中调用此函数，以通知控件将使用的接口 Id 的基类。

##  <a name="internalgetfont"></a>COleControl：： InternalGetFont

访问控件的常用字体属性

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>返回值

对包含 stock 字体对象的[CFontHolder](../../mfc/reference/cfontholder-class.md)对象的引用。

##  <a name="internalgettext"></a>COleControl：： InternalGetText

访问控件的 stock 文本或 Caption 属性。

```
const CString& InternalGetText();
```

### <a name="return-value"></a>返回值

对控件文本字符串的引用。

##  <a name="internalsetreadystate"></a>COleControl：： InternalSetReadyState

设置控件的就绪状态。

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>parameters

*lNewReadyState*<br/>
为控件设置的就绪状态为以下值之一：

|||
|-|-|
|READYSTATE_UNINITIALIZED|默认初始化状态|
|READYSTATE_LOADING|控件当前正在加载其属性|
|READYSTATE_LOADED|控件已初始化|
|READYSTATE_INTERACTIVE|控件具有足够的数据以进行交互，但并不是所有的异步数据都已加载|
|READYSTATE_COMPLETE|控件的所有数据|

### <a name="remarks"></a>备注

大多数简单控件都不需要区分已加载和交互式。 但是，在至少异步接收某些数据之前，支持数据路径属性的控件可能尚未准备好进行交互。 控件会尝试尽快成为交互控件。

##  <a name="invalidatecontrol"></a>COleControl：： Microsoft.office.core.iribbonui.invalidatecontrol

强制控件重绘自身。

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>parameters

*lpRect*<br/>
指向要使其无效的控件的区域的指针。

*bErase*<br/>
指定在处理更新区域时是否清除更新区域中的背景。

### <a name="remarks"></a>备注

如果*lpRect*具有 NULL 值，则将重新绘制整个控件。 如果*lpRect*不为 NULL，则表示要使其无效的控件矩形部分。 如果控件没有窗口，或者当前不处于活动状态，则忽略该矩形，并对客户端站点的[IAdviseSink：： OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange)成员函数进行调用。 使用此函数，而不是 `CWnd::InvalidateRect` 或 `InvalidateRect`。

##  <a name="invalidatergn"></a>COleControl：： InvalidateRgn

使给定区域内的容器窗口的工作区失效。

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>parameters

*pRgn*<br/>
指向[CRgn](../../mfc/reference/crgn-class.md)对象的指针，该对象标识要使其在包含窗口的工作区坐标中无效的 OLE 对象的显示区域。 如果此参数为 NULL，则范围为整个对象。

*bErase*<br/>
指定是否要清除无效区域中的背景。 如果为 TRUE，则清除背景。 如果为 FALSE，则后台保持不变。

### <a name="remarks"></a>备注

这可用于在容器中重绘无窗口控件。 在发送下一[WM_PAINT](/windows/win32/gdi/wm-paint)消息时，无效区域与更新区域中的所有其他区域一起标记为要进行绘制。

如果*bErase*在更新区域的任何部分都为 TRUE，则将清除整个区域中的背景，而不只是给定部件的背景。

##  <a name="isconvertingvbx"></a>COleControl：： IsConvertingVBX

允许专用加载 OLE 控件。

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>返回值

如果正在转换控件，则为非零值;否则为0。

### <a name="remarks"></a>备注

将使用 VBX 控件的窗体转换为使用 OLE 控件的窗体时，可能需要 OLE 控件的特殊加载代码。 例如，如果要加载 OLE 控件的实例，则可能会调用 `DoPropExchange`中的[PX_Font](persistence-of-ole-controls.md#px_font) ：

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

但是，VBX 控件没有 Font 对象;每个字体属性都单独保存。 在这种情况下，可以使用 `IsConvertingVBX` 来区分这两种情况：

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

另一种情况是，如果您的 VBX 控件保存了专有的二进制数据（在其 VBM_SAVEPROPERTY 的消息处理程序中），并且您的 OLE 控件以不同的格式保存其二进制数据。 如果希望您的 OLE 控件与 VBX 控件向后兼容，则可以通过区分 VBX 控件或 OLE 控件是否正在加载来使用 `IsConvertingVBX` 函数读取旧格式和新格式。

在控件的 `DoPropExchange` 函数中，可以检查此条件，如果为 true，则执行特定于此转换的加载代码（如前面的示例）。 如果控件未进行转换，则可以执行正常加载代码。 此功能仅适用于从 VBX 对应项转换的控件。

##  <a name="isinvokeallowed"></a>COleControl：： IsInvokeAllowed

启用自动化方法调用。

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>返回值

如果已初始化控件，则为非零值;否则为0。

### <a name="remarks"></a>备注

框架对 `IDispatch::Invoke` 调用 `IsInvokeAllowed` 来确定是否可以调用给定函数（由 `dispid`标识）。 OLE 控件的默认行为是仅当控件已初始化时才允许调用自动化方法;但 `IsInvokeAllowed` 是一个虚函数，如有必要，可能会被重写（例如，将控件用作自动化服务器时）。

##  <a name="ismodified"></a>COleControl：： IsModified

确定是否已修改控件的状态。

```
BOOL IsModified();
```

### <a name="return-value"></a>返回值

如果控件自上次保存后已修改，则为非零值;否则为0。

### <a name="remarks"></a>备注

当属性更改值时，将修改控件的状态。

##  <a name="isoptimizeddraw"></a>COleControl：： IsOptimizedDraw

确定容器是否支持当前绘制操作的优化绘图。

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>返回值

如果容器支持当前绘制操作的优化绘图，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

如果支持优化的绘图，则绘制完成后，控件不需要选择旧对象（笔、画笔、字体等）到设备上下文。

##  <a name="issubclassedcontrol"></a>COleControl：： IsSubclassedControl

由框架调用，以确定控件是否为 Windows 控件的子类。

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>返回值

如果控件为子类，则为非零值;否则为0。

### <a name="remarks"></a>备注

必须重写此函数，如果 OLE 控件将 Windows 控件子类，则返回 TRUE。

##  <a name="load"></a>COleControl：： Load

重置所有先前加载的数据，并启动控件异步属性的新加载。

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>parameters

*strNewPath*<br/>
指向字符串的指针，该字符串包含引用异步控件属性绝对位置的路径。

*片*<br/>
实现异步控件属性的[CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md)对象。

##  <a name="lockinplaceactive"></a>COleControl：： LockInPlaceActive

阻止容器停用控件。

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>parameters

*模块*<br/>
如果要锁定控件的就地活动状态，则为 TRUE;如果要解除锁定，则为 FALSE。

### <a name="return-value"></a>返回值

如果锁定成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

请注意，在完成后，控件的每个锁定必须与控件解除锁定。 只应将控件锁定一小段时间，如触发事件时。

##  <a name="onambientpropertychange"></a>COleControl：： OnAmbientPropertyChange

当容器的某个环境属性更改了值时由框架调用。

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>parameters

*dispID*<br/>
已更改的环境属性的调度 ID，或在多个属性已更改的情况下 DISPID_UNKNOWN。

##  <a name="onappearancechanged"></a>COleControl：： OnAppearanceChanged

当 stock 外观属性值已更改时由框架调用。

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>备注

如果希望在此属性更改后发出通知，请重写此函数。 默认实现将调用 `InvalidateControl`。

##  <a name="onbackcolorchanged"></a>COleControl：： OnBackColorChanged

当 stock 背景色属性值已更改时由框架调用。

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>备注

如果希望在此属性更改后发出通知，请重写此函数。 默认实现将调用 `InvalidateControl`。

##  <a name="onborderstylechanged"></a>COleControl：： OnBorderStyleChanged

当 stock BorderStyle 属性值已更改时由框架调用。

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>备注

默认实现将调用 `InvalidateControl`。

如果希望在此属性更改后发出通知，请重写此函数。

##  <a name="onclick"></a>COleControl：： OnClick

当单击鼠标按钮或调用 DoClick stock 方法时由框架调用。

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>parameters

*iButton*<br/>
鼠标按钮的索引。 可以是下列值之一：

- LEFT_BUTTON 单击了鼠标左键。

- MIDDLE_BUTTON 单击了鼠标中键。

- 单击鼠标右键 RIGHT_BUTTON。

### <a name="remarks"></a>备注

默认实现将调用 `COleControl::FireClick`。

重写此成员函数以修改或扩展默认处理。

##  <a name="onclose"></a>COleControl：： OnClose

当容器调用控件的 `IOleControl::Close` 函数时由框架调用。

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>parameters

*dwSaveOption*<br/>
指示是否应在加载前保存对象的标志。 有效值是：

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>备注

默认情况下，如果控件对象已修改并且*dwSaveOption*为 OLECLOSE_SAVEIFDIRTY 或 OLECLOSE_PROMPTSAVE，则 `OnClose` 将保存控件对象。

##  <a name="ondoverb"></a>COleControl：： OnDoVerb

当容器调用 `IOleObject::DoVerb` 成员函数时由框架调用。

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>parameters

*iVerb*<br/>
要调用的控制谓词的索引。

*lpMsg*<br/>
指向导致调用谓词的 Windows 消息的指针。

*hWndParent*<br/>
控件的父窗口的句柄。 如果执行谓词时创建了窗口（或窗口），则应将*hWndParent*用作父项。

*lpRect*<br/>
一个指针，它指向将复制控件的坐标（相对于容器）的 RECT 结构。

### <a name="return-value"></a>返回值

如果调用成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

默认实现使用 ON_OLEVERB 和 ON_STDOLEVERB 消息映射项来确定要调用的正确函数。

重写此函数可以更改谓词的默认处理。

##  <a name="ondraw"></a>COleControl：： OnDraw

由框架调用，以使用指定的设备上下文在指定的边框中绘制 OLE 控件。

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
在其中进行绘制的设备上下文。

*rcBounds*<br/>
控件的矩形区域，包括边框。

*rcInvalid*<br/>
无效的控件的矩形区域。

### <a name="remarks"></a>备注

`OnDraw` 通常称为屏幕显示，将屏幕设备上下文作为*pDC*传递。 *RcBounds*参数标识目标设备上下文中的矩形（相对于其当前映射模式）。 *RcInvalid*参数是无效的实际矩形。 在某些情况下，这将是比*rcBounds*更小的区域。

##  <a name="ondrawmetafile"></a>COleControl：： OnDrawMetafile

由框架调用，以使用指定的图元文件设备上下文在指定的边框内绘制 OLE 控件。

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
在其中进行绘制的设备上下文。

*rcBounds*<br/>
控件的矩形区域，包括边框。

### <a name="remarks"></a>备注

默认实现调用[OnDraw](#ondraw)函数。

##  <a name="onedit"></a>COleControl：： OnEdit

导致控件激活 UI。

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>parameters

*lpMsg*<br/>
指向调用谓词的 Windows 消息的指针。

*hWndParent*<br/>
控件的父窗口的句柄。

*lpRect*<br/>
指向容器中的控件使用的矩形的指针。

### <a name="return-value"></a>返回值

如果调用成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

这等效于调用控件的 OLEIVERB_UIACTIVATE 谓词。

此函数通常用作 ON_OLEVERB 消息映射项的处理程序函数。 这会使 "编辑" 谓词可用于控件的 "对象" 菜单。 例如：

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>COleControl：： OnEnabledChanged

当启用了 stock 的属性值更改时由框架调用。

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>备注

如果希望在此属性更改后发出通知，请重写此函数。 默认实现将调用[microsoft.office.core.iribbonui.invalidatecontrol](#invalidatecontrol)。

##  <a name="onenumverbs"></a>COleControl：： OnEnumVerbs

当容器调用 `IOleObject::EnumVerbs` 成员函数时由框架调用。

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>parameters

*ppenumOleVerb*<br/>
指向枚举控件的谓词的 `IEnumOLEVERB` 对象的指针。

### <a name="return-value"></a>返回值

如果谓词可用，则为非零值;否则为0。

### <a name="remarks"></a>备注

默认实现枚举消息映射中的 ON_OLEVERB 项。

重写此函数可以更改枚举谓词的默认方式。

##  <a name="oneventadvise"></a>COleControl：： OnEventAdvise

当事件处理程序连接到 OLE 控件或与该控件断开连接时由框架调用。

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>parameters

*bAdvise*<br/>
如果为 TRUE，则表示事件处理程序已连接到控件。 FALSE 指示事件处理程序已与控件断开连接。

##  <a name="onfontchanged"></a>COleControl：： OnFontChanged

当常用字体属性值已更改时由框架调用。

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>备注

默认实现将调用 `COleControl::InvalidateControl`。 如果控件是对 Windows 控件进行子类化，则默认实现还会向控件的窗口发送 WM_SETFONT 消息。

如果希望在此属性更改后发出通知，请重写此函数。

### <a name="example"></a>示例

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>COleControl：： OnForeColorChanged

当股票前景属性值已更改时由框架调用。

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>备注

默认实现将调用 `InvalidateControl`。

如果希望在此属性更改后发出通知，请重写此函数。

##  <a name="onfreezeevents"></a>COleControl：： OnFreezeEvents

在容器调用 `IOleControl::FreezeEvents`之后，由框架调用。

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>parameters

*bFreeze*<br/>
如果控件的事件处理被冻结，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

默认实现不执行任何操作。

如果在事件处理被冻结或解冻时需要其他行为，请重写此函数。

##  <a name="ongetcolorset"></a>COleControl：： OnGetColorSet

当容器调用 `IViewObject::GetColorSet` 成员函数时由框架调用。

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>parameters

*ptd*<br/>
指向应呈现图片的目标设备。 如果此值为 NULL，则应该为默认目标设备（通常为显示设备）呈现图片。

*hicTargetDev*<br/>
指定*ptd*所指示的目标设备上的信息上下文。 此参数可以是设备上下文，但这不是必需的。 如果*ptd*为 null，则*hicTargetDev*还应为 null。

*ppColorSet*<br/>
一个指针，指向应将使用的颜色集复制到其中的位置。 如果该函数未返回颜色集，则返回 NULL。

### <a name="return-value"></a>返回值

如果返回有效的颜色集，则为非零值;否则为0。

### <a name="remarks"></a>备注

容器调用此函数以获取绘制 OLE 控件所需的所有颜色。 容器可以使用与设置总体调色板所需的颜色一起获得的颜色集。 默认实现返回 FALSE。

重写此函数以对此请求进行任何特殊处理。

##  <a name="ongetcontrolinfo"></a>COleControl：： OnGetControlInfo

当控件的容器请求有关控件的信息时由框架调用。

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>parameters

*pControlInfo*<br/>
指向要填充的[CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo)结构的指针。

### <a name="remarks"></a>备注

此信息主要包含控件的助记键的说明。 默认实现用默认信息填充*pControlInfo* 。

如果控件需要处理助记键，请重写此函数。

##  <a name="ongetdisplaystring"></a>COleControl：： OnGetDisplayString

由框架调用以获取一个字符串，该字符串表示*dispid*标识的属性的当前值。

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>parameters

*dispid*<br/>
该控件的属性的调度 ID。

*strValue*<br/>
对[CString](../../atl-mfc-shared/reference/cstringt-class.md)对象的引用，通过该对象，将返回一个字符串。

### <a name="return-value"></a>返回值

如果已在 StrValue 中返回一个字符串 *，则为*非零; 否则为0。

### <a name="remarks"></a>备注

如果控件的属性的值无法直接转换为字符串，并且您希望在容器提供的属性浏览器中显示该属性的值，则重写此函数。

##  <a name="ongetinplacemenu"></a>COleControl：： OnGetInPlaceMenu

当控件激活 UI 时由框架调用，以获取要合并到容器的现有菜单中的菜单。

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>返回值

控件的菜单的句柄; 如果控件没有，则为 NULL。 默认实现返回 NULL。

### <a name="remarks"></a>备注

有关合并 OLE 资源的详细信息，请参阅文章[菜单和资源（OLE）](../../mfc/menus-and-resources-ole.md)一文。

##  <a name="ongetnaturalextent"></a>COleControl：： OnGetNaturalExtent

由框架调用，以响应容器的 `IViewObjectEx::GetNaturalExtent` 请求。

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>parameters

*dwAspect*<br/>
指定要如何表示该对象。 表示形式包括内容、图标、缩略图或打印文档。 有效值取自枚举[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)或 DVASPECT2。

*lindex*<br/>
对象中感兴趣的部分。 目前只有-1 是有效的。

*ptd*<br/>
指向[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)结构，定义应为其返回对象大小的目标设备。

*hicTargetDev*<br/>
指定*ptd*参数指示的目标设备的信息上下文，对象可从该参数提取设备度量值并测试设备的功能。 如果*ptd*为 NULL，则对象应忽略*hicTargetDev*参数中的值。

*pExtentInfo*<br/>
指向指定大小调整数据的 `DVEXTENTINFO` 结构。 `DVEXTENTINFO` 结构为：

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

结构成员 `dwExtentMode` 可以采用以下两个值之一：

- DVEXTENT_CONTENT 查询控件精确适应内容的大小（靠齐到大小）

- 调整大小时，请 DVEXTENT_INTEGRAL 传递建议大小以进行控制

*psizel*<br/>
指向由控件返回的大小调整数据的点。 对于未调整的任何维度，返回的大小调整数据将设置为-1。

### <a name="return-value"></a>返回值

如果成功返回或调整大小，则为非零值;否则为0。

### <a name="remarks"></a>备注

重写此函数以返回对象的显示大小，该大小与 `DVEXTENTINFO` 结构中的建议大小和区模式最接近。 默认实现返回 FALSE，并且不对大小进行调整。

##  <a name="ongetpredefinedstrings"></a>COleControl：： OnGetPredefinedStrings

由框架调用以获取一组预定义的字符串，这些字符串表示属性的可能值。

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>parameters

*dispid*<br/>
该控件的属性的调度 ID。

*pStringArray*<br/>
要用返回值填充的字符串数组。

*pCookieArray*<br/>
要用返回值填充的 DWORD 数组。

### <a name="return-value"></a>返回值

如果已将元素添加到*pStringArray*和*pCookieArray*，则为非零值。

### <a name="remarks"></a>备注

如果控件有一个属性，其中包含一组可由字符串表示的可能值，请重写此函数。 对于添加到*pStringArray*的每个元素，应将相应的 "cookie" 元素添加到*pCookieArray 中。* 此框架稍后可能会将这些 "cookie" 值传递到 `COleControl::OnGetPredefinedValue` 函数。

##  <a name="ongetpredefinedvalue"></a>COleControl：： OnGetPredefinedValue

由框架调用，以获取与先前由 `COleControl::OnGetPredefinedStrings`重写返回的预定义字符串之一相对应的值。

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>parameters

*dispid*<br/>
该控件的属性的调度 ID。

*dwCookie*<br/>
先前由 `COleControl::OnGetPredefinedStrings`重写返回的 cookie 值。

*lpvarOut*<br/>
指向 `VARIANT` 结构的指针，通过该结构将返回属性值。

### <a name="return-value"></a>返回值

如果已在*lpvarOut*中返回值，则为非零值;否则为0。

##  <a name="ongetviewextent"></a>COleControl：： OnGetViewExtent

由框架调用，以响应容器的[IViewObject2：： GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent)请求。

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>parameters

*dwDrawAspect*<br/>
用于描述要显示对象的哪一窗体或方面的 DWORD。 有效值取自枚举[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)或 DVASPECT2。

*lindex*<br/>
对象中感兴趣的部分。 目前只有-1 是有效的。

*ptd*<br/>
指向[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)结构，定义应为其返回对象大小的目标设备。

*lpsizel*<br/>
指向返回对象大小的位置。

### <a name="return-value"></a>返回值

如果成功返回了区信息，则为非零值;否则为0。

### <a name="remarks"></a>备注

如果控件使用两遍绘图，并且它的透明和透明部分具有不同的尺寸，则重写此函数。

##  <a name="ongetviewrect"></a>COleControl：： OnGetViewRect

由框架调用，以响应容器的 `IViewObjectEx::GetRect` 请求。

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>parameters

*dwAspect*<br/>
用于描述要显示对象的哪一窗体或方面的 DWORD。 有效值取自枚举[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)或 DVASPECT2：

- 整个对象的 DVASPECT_CONTENT 边框。 对象原点的左上角，大小等于 `GetViewExtent`返回的范围 *。*

- 具有矩形不透明区域的 DVASPECT_OPAQUE 对象将返回该矩形。 其他失败。

- 覆盖所有透明或不规则部分的 DVASPECT_TRANSPARENT 矩形。

*pRect*<br/>
指向[RECTL](/previous-versions/dd162907\(v=vs.85\))结构，指定应在其中绘制对象的矩形。 此参数控制对象的定位和拉伸。

### <a name="return-value"></a>返回值

如果成功返回大小为对象的矩形，则为非零值;否则为0。

### <a name="remarks"></a>备注

对象的大小由 `OnGetViewRect` 转换为从特定位置（默认为显示的左上角）开始的矩形。 如果控件使用两遍绘图，并且它的透明和透明部分具有不同的尺寸，则重写此函数。

##  <a name="ongetviewstatus"></a>COleControl：： OnGetViewStatus

由框架调用，以响应容器的 `IViewObjectEx::GetViewStatus` 请求。

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>返回值

如果成功，则为 VIEWSTATUS 枚举的值之一;否则为0。 可能的值包括以下各项的任意组合：

|||
|-|-|
|VIEWSTATUS_OPAQUE|对象完全不透明。 如果未设置此位，则对象将包含透明部分。 此位仅适用于内容相关的方面，而不是 DVASPECT_ICON 或 DVASPECT_DOCPRINT。|
|VIEWSTATUS_SOLIDBKGND|对象具有纯色背景（由纯色而非画笔图案组成）。 只有在设置 VIEWSTATUS_OPAQUE 并仅适用于与内容相关的方面，而不是 DVASPECT_ICON 或 DVASPECT_DOCPRINT 时，此位才有意义。|
|VIEWSTATUS_DVASPECTOPAQUE|对象支持 DVASPECT_OPAQUE。 将绘图方位作为参数的所有 IViewObjectEx 方法均可通过此方面调用。|
|VIEWSTATUS_DVASPECTTRANSPARENT|对象支持 DVASPECT_TRANSPARENT。 将绘图方面作为参数的所有 `IViewObjectEx` 方法都可以使用此特性来调用。|

### <a name="remarks"></a>备注

如果控件使用两遍绘图，则重写此函数。 默认实现返回 VIEWSTATUS_OPAQUE。

##  <a name="onhidetoolbars"></a>COleControl：： OnHideToolBars

当控件为 UI 停用时由框架调用。

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>备注

实现应隐藏 `OnShowToolbars`显示的所有工具栏。

##  <a name="oninactivemousemove"></a>COleControl：： OnInactiveMouseMove

由鼠标指针下的非活动对象的容器调用，接收到 WM_MOUSEMOVE 消息。

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>parameters

*lprcBounds*<br/>
包含窗口的工作区坐标中的对象边框。 接收到 WM_MOUSEMOVE 消息时，通知对象在屏幕上的准确位置和大小。

*x*<br/>
鼠标位置在所包含窗口的工作区坐标中的 x 坐标。

*y*<br/>
鼠标位置在所包含窗口的工作区坐标中的 y 坐标。

*dwKeyState*<br/>
标识键盘上的键盘修改键的当前状态。 有效值可以是任何标志的组合 MK_CONTROL、MK_SHIFT、MK_ALT、MK_BUTTON、MK_LBUTTON、MK_MBUTTON 和 MK_RBUTTON。

### <a name="remarks"></a>备注

请注意，窗口客户端坐标（像素）用于传递鼠标光标的位置。 这是通过同时传递同一坐标系统中的对象的边框来实现的。

##  <a name="oninactivesetcursor"></a>COleControl：： OnInactiveSetCursor

由鼠标指针下的非活动对象的容器调用，接收到 WM_SETCURSOR 消息。

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>parameters

*lprcBounds*<br/>
包含窗口的工作区坐标中的对象边框。 接收到 WM_SETCURSOR 消息时，通知对象在屏幕上的准确位置和大小。

*x*<br/>
鼠标位置在所包含窗口的工作区坐标中的 x 坐标。

*y*<br/>
鼠标位置在所包含窗口的工作区坐标中的 y 坐标。

*dwMouseMsg*<br/>
发生 WM_SETCURSOR 的鼠标消息的标识符。

*bSetAlways*<br/>
指定对象是否必须设置光标。 如果为 TRUE，则对象必须设置光标;如果为 FALSE，则游标无需设置游标，并且应在这种情况下返回 S_FALSE。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

请注意，窗口客户端坐标（像素）用于传递鼠标光标的位置。 这是通过同时传递同一坐标系统中的对象的边框来实现的。

##  <a name="onkeydownevent"></a>COleControl：： OnKeyDownEvent

在处理了股票 KeyDown 事件之后，由框架调用。

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>parameters

*nChar*<br/>
按下的键的虚拟键代码值。 有关标准虚拟键代码的列表，请参阅 Winuser。h

*nShiftState*<br/>
包含以下标志的组合：

- 在操作过程中，SHIFT_MASK 按下 SHIFT 键。

- CTRL_MASK 在操作过程中按下了 CTRL 键。

- ALT_MASK 在操作过程中按下了 ALT 键。

### <a name="remarks"></a>备注

如果在触发事件后，控件需要访问密钥信息，请重写此函数。

##  <a name="onkeypressevent"></a>COleControl：： OnKeyPressEvent

在激发了 stock 按键事件之后，由框架调用。

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>parameters

*nChar*<br/>
包含按下的键的虚拟键代码值。 有关标准虚拟键代码的列表，请参阅 Winuser。h

### <a name="remarks"></a>备注

请注意，此*nChar*值可能已由容器进行了修改。

如果希望在此事件发生后发出通知，请重写此函数。

##  <a name="onkeyupevent"></a>COleControl：： OnKeyUpEvent

在处理了股票 KeyDown 事件之后，由框架调用。

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>parameters

*nChar*<br/>
按下的键的虚拟键代码值。 有关标准虚拟键代码的列表，请参阅 Winuser。h

*nShiftState*<br/>
包含以下标志的组合：

- 在操作过程中，SHIFT_MASK 按下 SHIFT 键。

- CTRL_MASK 在操作过程中按下了 CTRL 键。

- ALT_MASK 在操作过程中按下了 ALT 键。

### <a name="remarks"></a>备注

如果在触发事件后，控件需要访问密钥信息，请重写此函数。

##  <a name="onmappropertytopage"></a>COleControl：： OnMapPropertyToPage

由框架调用，以获取实现了指定属性的编辑的属性页的类 ID。

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>parameters

*dispid*<br/>
该控件的属性的调度 ID。

*lpclsid*<br/>
指向 `CLSID` 结构的指针，通过该结构将返回类 ID。

*pbPageOptional*<br/>
返回一个指示符，指示是否使用指定的属性页。

### <a name="return-value"></a>返回值

如果已在*lpclsid*中返回类 ID，则为非零值;否则为0。

### <a name="remarks"></a>备注

重写此函数以提供一种方法，用于从容器的属性浏览器调用控件的属性页。

##  <a name="onmnemonic"></a>COleControl：： OnMnemonic

当容器已检测到 OLE 控件的助记键已按下时由框架调用。

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>parameters

*pMsg*<br/>
一个指针，指向由助记键按键操作生成的 Windows 消息。

##  <a name="onproperties"></a>COleControl：： OnProperties

当容器调用控件的属性谓词时由框架调用。

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>parameters

*lpMsg*<br/>
指向调用谓词的 Windows 消息的指针。

*hWndParent*<br/>
控件的父窗口的句柄。

*lpRect*<br/>
指向容器中的控件使用的矩形的指针。

### <a name="return-value"></a>返回值

如果调用成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

默认实现显示 "模式属性" 对话框。

你还可以使用此函数来导致控件的属性页的显示。 调用 `OnProperties` 函数，将控件的父级的句柄传递到*hWndParent*参数。 在这种情况下，将忽略*lpMsg*和*lpRect*参数的值。

##  <a name="onqueryhitpoint"></a>COleControl：： OnQueryHitPoint

由框架调用，以响应容器的 `IViewObjectEx::QueryHitPoint` 请求。

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>parameters

*dwAspect*<br/>
指定表示对象的方式。 有效值取自枚举[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)或 DVASPECT2。

*pRectBounds*<br/>
指向 `RECT` 结构的指针，该结构指定 OLE 控件客户端区域的边框。

*ptlLoc*<br/>
指向 `POINT` 结构的指针，该结构指定要检查是否命中的点。 在 OLE 工作区坐标中指定该点。

*lCloseHint*<br/>
为检查命中的点定义 "收盘" 的距离。

*pHitResult*<br/>
指向命中查询结果的指针。 以下值之一：

- HITRESULT_OUTSIDE *ptlLoc*位于 OLE 对象之外，但未关闭。

- HITRESULT_TRANSPARENT *ptlLoc*位于 OLE 对象的边界内，但不接近图像。 例如，透明圆的中间点可以 HITRESULT_TRANSPARENT。

- HITRESULT_CLOSE *ptlLoc*位于 OLE 对象内部或外部，但接近于要在其中被视为的对象。 小型、瘦或详细对象可能会使用此值。 即使某个点位于对象的边框外，它仍可能会关闭（这对于命中小对象是必需的）。

- HITRESULT_HIT *ptlLoc*位于对象的图像内。

### <a name="return-value"></a>返回值

如果成功返回命中结果，则为非零值;否则为0。 命中与 OLE 控件显示区域重叠。

### <a name="remarks"></a>备注

查询对象的显示矩形是否与给定点重叠（点击点）。 可对 `QueryHitPoint` 进行重写，以对非矩形对象进行命中测试。

##  <a name="onqueryhitrect"></a>COleControl：： OnQueryHitRect

由框架调用，以响应容器的 `IViewObjectEx::QueryHitRect` 请求。

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>parameters

*dwAspect*<br/>
指定要如何表示该对象。 有效值取自枚举[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)或 DVASPECT2。

*pRectBounds*<br/>
指向 `RECT` 结构的指针，该结构指定 OLE 控件客户端区域的边框。

*prcLoc*<br/>
指向 `RECT` 结构的指针，该结构指定要检查是否存在命中的矩形（与对象矩形重叠），相对于对象的左上角。

*lCloseHint*<br/>
未使用。

*pHitResult*<br/>
指向命中查询结果的指针。 以下值之一：

- OLE 对象不会遇到矩形中的任何点 HITRESULT_OUTSIDE。

- HITRESULT_HIT 矩形中的至少一个点是对象上的一个点。

### <a name="return-value"></a>返回值

如果成功返回命中结果，则为非零值;否则为0。

### <a name="remarks"></a>备注

查询对象的显示矩形是否与给定矩形中的任何点重叠（到达矩形）。 可对 `QueryHitRect` 进行重写，以对非矩形对象进行命中测试。

##  <a name="onrenderdata"></a>COleControl：： OnRenderData

由框架调用以检索指定格式的数据。

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>parameters

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构，指定请求信息时所用的格式。

*lpStgMedium*<br/>
指向要返回数据的[STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1)结构。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

指定的格式是以前使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)或[DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata)成员函数放置在控件对象中用于延迟呈现的格式。 此函数的默认实现分别调用 `OnRenderFileData` 或 `OnRenderGlobalData`（如果提供的存储介质是文件或内存）。 如果请求的格式为 CF_METAFILEPICT 或持久属性集格式，则默认实现将呈现相应的数据并返回非零值。 否则，它将返回0并不执行任何操作。

如果 TYMED_NULL *lpStgMedium > tymed* ，则应按*lpFormatEtc-> tymed*指定的方式分配和填充 STGMEDIUM。 如果未 TYMED_NULL，则应将 STGMEDIUM 与数据一起填充。

重写此函数以按请求的格式和媒体提供数据。 根据您的数据，您可能需要替代此函数的其他版本之一。 如果数据大小较小且固定，请覆盖 `OnRenderGlobalData`。 如果数据位于文件中或大小可变，请覆盖 `OnRenderFileData`。

有关详细信息，请参阅 Windows SDK 中的 `FORMATETC` 和 `STGMEDIUM` 结构。

##  <a name="onrenderfiledata"></a>COleControl：： OnRenderFileData

当存储介质为文件时，由框架调用以检索指定格式的数据。

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>parameters

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构，指定请求信息时所用的格式。

*.Pfile*<br/>
指向要在其中呈现数据的[CFile](../../mfc/reference/cfile-class.md)对象。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

指定的格式是以前在控件对象中放置的格式，它使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)成员函数进行延迟渲染。 此函数的默认实现只返回 FALSE。

重写此函数以按请求的格式和媒体提供数据。 根据您的数据，您可能希望改为重写此函数的其他版本之一。 如果要处理多个存储媒体，请覆盖 `OnRenderData`。 如果数据位于文件中或大小可变，请覆盖 `OnRenderFileData`。

有关详细信息，请参阅 Windows SDK 中的 `FORMATETC` 结构。

##  <a name="onrenderglobaldata"></a>COleControl：： OnRenderGlobalData

当指定的存储介质为全局内存时，由框架调用以检索指定格式的数据。

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>parameters

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构，指定请求信息时所用的格式。

*phGlobal*<br/>
指向全局内存的句柄，其中的数据将被返回。 如果未分配内存，则此参数可以为 NULL。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

指定的格式是以前在控件对象中放置的格式，它使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)成员函数进行延迟渲染。 此函数的默认实现只返回 FALSE。

如果*phGlobal*为 NULL，则应在*phGlobal*中分配并返回新的 HGLOBAL。 否则，由*phGlobal*指定的 HGLOBAL 应使用数据进行填充。 放置在 HGLOBAL 中的数据量不能超过内存块的当前大小。 此外，不能将块重新分配到更大的大小。

重写此函数以按请求的格式和媒体提供数据。 根据您的数据，您可能需要替代此函数的其他版本之一。 如果要处理多个存储媒体，请覆盖 `OnRenderData`。 如果数据位于文件中或大小可变，请覆盖 `OnRenderFileData`。

有关详细信息，请参阅 Windows SDK 中的 `FORMATETC` 结构。

##  <a name="onresetstate"></a>COleControl：： OnResetState

当控件的属性应设置为其默认值时，由框架调用。

```
virtual void OnResetState();
```

### <a name="remarks"></a>备注

默认实现将调用[DoPropExchange](#dopropexchange)，同时传递导致属性设置为其默认值的 `CPropExchange` 对象。

控件编写器可以在此可重写的中插入 OLE 控件的初始化代码。 如果调用了[IPersistStream：： Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load)或[IPersistStorage：： load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load)失败，或者调用[IPersistStreamInit：： InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew)或[IPersistStorage：： InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) ，而无需先调用 `IPersistStream::Load` 或 `IPersistStorage::Load`，则将调用此函数。

##  <a name="onsetclientsite"></a>COleControl：： OnSetClientSite

当容器调用控件的 `IOleControl::SetClientSite` 函数时由框架调用。

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>备注

默认情况下，`OnSetClientSite` 会检查是否加载数据路径属性，如果是，则调用 `DoDataPathPropExchange`。

重写此函数以对此通知执行任何特殊处理。 特别是，此函数的重写应调用基类。

##  <a name="onsetdata"></a>COleControl：： OnSetData

由框架调用以将控件的数据替换为指定的数据。

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>parameters

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针，该结构指定数据的格式。

*lpStgMedium*<br/>
指向数据所在的[STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1)结构的指针。

*bRelease*<br/>
如果控件应释放存储介质，则为 TRUE;如果控件不应释放存储介质，则为 FALSE。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果数据采用持久性属性集格式，则默认实现会相应地修改控件的状态。 否则，默认实现不执行任何操作。 如果*bRelease*为 TRUE，则对 `ReleaseStgMedium` 调用。否则为。

重写此函数以将控件的数据替换为指定的数据。

有关详细信息，请参阅 Windows SDK 中的 `FORMATETC` 和 `STGMEDIUM` 结构。

##  <a name="onsetextent"></a>COleControl：： OnSetExtent

当需要更改控件的范围时由框架调用，这是对[IOleObject：： SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent)的调用的结果。

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>parameters

*lpSizeL*<br/>
指向 `SIZEL` 结构的指针，该结构使用长整数表示控件的宽度和高度，以 HIMETRIC 单位表示。

### <a name="return-value"></a>返回值

如果接受大小更改，则为非零值;否则为0。

### <a name="remarks"></a>备注

默认实现处理控件范围的大小调整。 如果控件处于就地活动状态，则会对容器的 `OnPosRectChanged` 进行调用。

重写此函数以更改控件的默认大小调整。

##  <a name="onsetobjectrects"></a>COleControl：： OnSetObjectRects

由框架调用以实现对[IOleInPlaceObject：： SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects)的调用。

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>parameters

*lpRectPos*<br/>
指向 `RECT` 结构的指针，该结构指示控件相对于容器的新位置和大小。

*lpRectClip*<br/>
一个指向 `RECT` 结构的指针，该指针指示控件要剪裁到的矩形区域。

### <a name="return-value"></a>返回值

如果已接受重定位，则为非零;否则为0。

### <a name="remarks"></a>备注

默认实现会自动处理控件窗口的重定位和调整大小，并返回 TRUE。

重写此函数以更改此函数的默认行为。

##  <a name="onshowtoolbars"></a>COleControl：： OnShowToolBars

当控件已激活 UI 时由框架调用。

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>备注

默认实现不执行任何操作。

##  <a name="ontextchanged"></a>COleControl：： OnTextChanged

当 stock 标题或文本属性值已更改时由框架调用。

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>备注

默认实现将调用 `InvalidateControl`。

如果希望在此属性更改后发出通知，请重写此函数。

##  <a name="onwindowlessmessage"></a>COleControl：： OnWindowlessMessage

由框架调用，以响应容器的 `IOleInPlaceObjectWindowless::OnWindowMessage` 请求。

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>parameters

*缺少*<br/>
Windows 传递的消息标识符。

*wParam*<br/>
由 Windows 传递。 指定其他特定于消息的信息。 此参数的内容取决于*msg*参数的值。

*lParam*<br/>
由 Windows 传递。 指定其他特定于消息的信息。 此参数的内容取决于*msg*参数的值。

*plResult*<br/>
Windows 结果代码。 指定消息处理的结果，并取决于所发送的消息。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

处理无窗口控件的窗口消息。 `COleControl`的 `OnWindowlessMessage` 应用于除鼠标消息和键盘消息以外的窗口消息。 `COleControl` 提供了[SetCapture](#setcapture)和[SetFocus](#setfocus) ，专用于为无窗口 OLE 对象获取鼠标捕获和键盘焦点。

由于无窗口对象没有窗口，因此它们需要一个机制让容器向它们分派消息。 无窗口 OLE 对象 `OnWindowMessage` 通过 `IOleInPlaceObjectWindowless` 接口（ [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject)的扩展支持的扩展）从其容器中获取消息。 `OnWindowMessage` 不采用 `HWND` 参数。

##  <a name="parenttoclient"></a>COleControl：:P arentToClient

将*pPoint*的坐标转换为客户端坐标。

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>parameters

*lprcBounds*<br/>
一个指针，指向容器中 OLE 控件的边界。 不是工作区，而是整个控件的区域（包括边框和滚动条）。

*pPoint*<br/>
指向要转换为控件的工作区坐标的父级（容器）点的指针。

*bHitTest*<br/>
指定是否在点上完成命中测试。

### <a name="return-value"></a>返回值

如果*bHitTest*为 FALSE，则返回 HTNOWHERE。 如果*bHitTest*为 TRUE，则返回父（容器）点在 OLE 控件的工作区中着陆的位置，它是以下鼠标命中测试值之一：

- 不具有大小调整边框的窗口边框中的 HTBORDER。

- 窗口的下水平边框中的 HTBOTTOM。

- 窗口边框左上角的 HTBOTTOMLEFT。

- 窗口边框右下角的 HTBOTTOMRIGHT。

- 标题栏区域中的 HTCAPTION。

- 工作区中的 HTCLIENT。

- HTERROR 在屏幕背景上或在窗口之间的分隔线上（与 HTNOWHERE 相同，不同之处在于 `DefWndProc` Windows 函数发出系统提示音，指示错误）。

- HTGROWBOX 在 "大小" 框中。

- 水平滚动条中的 HTHSCROLL。

- 窗口左边框中的 HTLEFT。

- "最大化" 按钮中的 HTMAXBUTTON。

- 菜单区域中的 HTMENU。

- "最小化" 按钮中的 HTMINBUTTON。

- HTNOWHERE 在屏幕背景上或在窗口之间的分隔线上显示。

- "最小化" 按钮中的 HTREDUCE。

- 窗口右边框中的 HTRIGHT。

- HTSIZE 在大小框中（与 HTGROWBOX 相同）。

- HTSYSMENU 在控件菜单或子窗口的 "关闭" 按钮中。

- 窗口的上水平边框中的 HTTOP。

- 窗口边框左上角的 HTTOPLEFT。

- 窗口边框右上角的 HTTOPRIGHT。

- 当前由另一个窗口覆盖的窗口中的 HTTRANSPARENT。

- 垂直滚动条中的 HTVSCROLL。

- "最大化" 按钮中的 HTZOOM。

### <a name="remarks"></a>备注

On input *pPoint*是相对于父级（容器左上角）的原点。 在 output *pPoint*上，相对于 OLE 控件（控件工作区左上角）的工作区的原点。

##  <a name="postmodaldialog"></a>COleControl：:P ostModalDialog

通知容器模式对话框已关闭。

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>parameters

*hWndParent*<br/>
模式对话框的父窗口的句柄。

### <a name="remarks"></a>备注

在显示任何模式对话框后调用此函数。 您必须调用此函数，以便容器可以 `PreModalDialog`禁用任何顶级窗口。 应将此函数与对 `PreModalDialog`的调用配对。

##  <a name="premodaldialog"></a>COleControl：:P reModalDialog

通知容器将要显示的模式对话框。

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>parameters

*hWndParent*<br/>
模式对话框的父窗口的句柄。

### <a name="remarks"></a>备注

在显示任何模式对话框之前调用此函数。 必须调用此函数，使容器能够禁用其所有顶级窗口。 显示模式对话框之后，必须调用 `PostModalDialog`。

##  <a name="recreatecontrolwindow"></a>COleControl：： RecreateControlWindow

销毁并重新创建控件的窗口。

```
void RecreateControlWindow();
```

### <a name="remarks"></a>备注

如果需要更改窗口的样式位，则这可能是必需的。

##  <a name="refresh"></a>COleControl：： Refresh

强制重新绘制 OLE 控件。

```
void Refresh();
```

### <a name="remarks"></a>备注

此函数作为常用方法（称为 Refresh） `COleControl` 基类支持。 这允许 OLE 控件的用户在特定时间重绘控件。 有关此方法的详细信息，请参阅文章[ActiveX 控件：方法](../../mfc/mfc-activex-controls-methods.md)。

##  <a name="releasecapture"></a>COleControl：： ReleaseCapture

释放鼠标捕获。

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果控件当前具有鼠标捕获，则释放捕获。 否则，此函数将不起作用。

##  <a name="releasedc"></a>COleControl：： ReleaseDC

释放无窗口控件的容器的显示设备上下文，释放设备上下文以供其他应用程序使用。

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
标识要释放的容器设备上下文。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

应用程序必须调用[GetDC](#getdc)的每个调用的 `ReleaseDC`。

##  <a name="reparentcontrolwindow"></a>COleControl：： ReparentControlWindow

设置控件的父级。

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>parameters

*hWndOuter*<br/>
控件窗口的句柄。

*hWndParent*<br/>
新的父窗口的句柄。

### <a name="remarks"></a>备注

调用此函数可重置控件窗口的父级。

##  <a name="resetstockprops"></a>COleControl：： ResetStockProps

将 `COleControl` 股票属性的状态初始化为其默认值。

```
void ResetStockProps();
```

### <a name="remarks"></a>备注

属性包括：外观、背景色、样式栏、标题、已启用、字体、前景色、hWnd 和文本。 有关常用属性的说明，请参阅[ActiveX 控件：添加常用属性](../../mfc/mfc-activex-controls-adding-stock-properties.md)。

您可以通过使用 `ResetStockProps` 和 `ResetVersion` 来覆盖 `COleControl::OnResetState`，提高控件的二进制初始化性能。 请参阅以下示例。 有关优化初始化的详细信息，请参阅[ActiveX 控件：优化](../../mfc/mfc-activex-controls-optimization.md)。

### <a name="example"></a>示例

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>COleControl：： ResetVersion

将版本号初始化为指定值。

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>parameters

*dwVersionDefault*<br/>
要分配给控件的版本号。

### <a name="remarks"></a>备注

您可以通过使用 `ResetVersion` 和 `ResetStockProps` 来覆盖 `COleControl::OnResetState`，提高控件的二进制初始化性能。 请参阅[ResetStockProps](#resetstockprops)上的示例。 有关优化初始化的详细信息，请参阅[ActiveX 控件：优化](../../mfc/mfc-activex-controls-optimization.md)。

##  <a name="scrollwindow"></a>COleControl：： ScrollWindow

允许无窗口 OLE 对象在屏幕上的就地活动图像中滚动区域。

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>parameters

*xAmount*<br/>
指定水平滚动的量（以设备单位为单位）。 此参数必须是负值才能滚动到左侧。

*yAmount*<br/>
指定垂直滚动的量（以设备单位为单位）。 此参数必须为负值才能向上滚动。

*lpRect*<br/>
指向[CRect](../../atl-mfc-shared/reference/crect-class.md)对象或 RECT 结构，它指定要滚动的 OLE 对象的工作区部分（在包含窗口的工作区坐标中）。 如果*lpRect*为 NULL，则滚动整个 OLE 对象的工作区。

*lpClipRect*<br/>
指向一个 `CRect` 对象或 `RECT` 结构，该对象指定要剪裁到的矩形。 仅滚动矩形内的像素。 即使在*lpRect*矩形中，它也不会受到影响。 如果*lpClipRect*为 NULL，则不会对滚动矩形执行任何剪切。

##  <a name="selectfontobject"></a>COleControl：： SelectFontObject

在设备上下文中选择字体。

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
指向设备上下文对象的指针。

*fontHolder*<br/>
对[CFontHolder](../../mfc/reference/cfontholder-class.md)对象的引用，该对象表示要选择的字体。

### <a name="return-value"></a>返回值

指向先前选定字体的指针。 当调用方完成使用 FontHolder 的所有绘制操作时 *，* 它应通过将以前选择的字体作为参数传递给[CDC：： SelectObject](../../mfc/reference/cdc-class.md#selectobject)来重新选择它。

##  <a name="selectstockfont"></a>COleControl：： SelectStockFont

选择 "常用字体" 属性到设备上下文。

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
将选择字体的设备上下文。

### <a name="return-value"></a>返回值

指向前面选定的 `CFont` 对象的指针。 完成后，应使用[CDC：： SelectObject](../../mfc/reference/cdc-class.md#selectobject)将此字体选择回设备上下文。

##  <a name="serializeextent"></a>COleControl：： SerializeExtent

序列化或初始化分配给控件的显示空间的状态。

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>parameters

*ar*<br/>
要序列化到或从其进行序列化的 `CArchive` 对象。

### <a name="remarks"></a>备注

您可以使用 `SerializeExtent`、`SerializeStockProps`和 `SerializeVersion` 重写 `COleControl::Serialize`来改善控件的二进制持久性性能。 请参阅以下示例。 有关优化初始化的详细信息，请参阅[ActiveX 控件：优化](../../mfc/mfc-activex-controls-optimization.md)。

### <a name="example"></a>示例

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>COleControl：： SerializeStockProps

序列化或初始化 `COleControl` 股票属性的状态：外观、背景色、样式栏、标题、已启用、字体、前景色和文本。

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>parameters

*ar*<br/>
要序列化到或从其进行序列化的 `CArchive` 对象。

### <a name="remarks"></a>备注

有关常用属性的说明，请参阅[ActiveX 控件：添加常用属性](../../mfc/mfc-activex-controls-adding-stock-properties.md)。

您可以使用 `SerializeStockProps`、`SerializeExtent`和 `SerializeVersion` 重写 `COleControl::Serialize`来改善控件的二进制持久性性能。 有关示例，请参阅[SerializeExtent](#serializeextent)中的代码。 有关优化初始化的详细信息，请参阅[ActiveX 控件：优化](../../mfc/mfc-activex-controls-optimization.md)。

##  <a name="serializeversion"></a>COleControl：： SerializeVersion

序列化或初始化控件的版本信息的状态。

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>parameters

*ar*<br/>
要序列化到或从其进行序列化的 `CArchive` 对象。

*dwVersionDefault*<br/>
控件的当前版本号。

*bConvert*<br/>
指示是否应在保存持久性数据时将其转换为最新格式，或以加载时的相同格式进行维护。

### <a name="return-value"></a>返回值

控件的版本号。 如果正在加载指定的存档，`SerializeVersion` 将返回从该存档加载的版本。 否则，它将返回当前加载的版本。

### <a name="remarks"></a>备注

您可以使用 `SerializeVersion`、`SerializeExtent`和 `SerializeStockProps` 重写 `COleControl::Serialize`来改善控件的二进制持久性性能。 有关示例，请参阅[SerializeExtent](#serializeextent)中的代码。 有关优化初始化的详细信息，请参阅[ActiveX 控件：优化](../../mfc/mfc-activex-controls-optimization.md)。

##  <a name="setappearance"></a>COleControl：： SetAppearance

设置控件的 stock 外观属性值。

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>parameters

*sAppearance*<br/>
用于控件外观的**短**（VT_I2）值。 如果值为零，则将控件的外观设置为平面，值为1时，将控件的外观设置为三维。

### <a name="remarks"></a>备注

有关常用属性的详细信息，请参阅[ActiveX 控件：属性](../../mfc/mfc-activex-controls-properties.md)。

##  <a name="setbackcolor"></a>COleControl：： SetBackColor

设置控件的常用背景色属性值。

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>parameters

*dwBackColor*<br/>
用于控件的背景绘制的 OLE_COLOR 值。

### <a name="remarks"></a>备注

有关使用此属性和其他相关属性的详细信息，请参阅[ActiveX 控件：属性](../../mfc/mfc-activex-controls-properties.md)一文。

##  <a name="setborderstyle"></a>COleControl：： SetBorderStyle

设置控件的 stock 样式属性值。

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>parameters

*sBorderStyle*<br/>
控件的新边框样式;0指示没有边框，1表示普通边框。

### <a name="remarks"></a>备注

然后，将重新创建并 `OnBorderStyleChanged` 调用控件窗口。

##  <a name="setcapture"></a>COleControl：： SetCapture

导致控件的容器窗口代表控件占据鼠标捕获。

```
CWnd* SetCapture();
```

### <a name="return-value"></a>返回值

一个指针，指向先前接收到的鼠标输入 `CWnd` 窗口对象。

### <a name="remarks"></a>备注

如果控件已激活且无窗口，此函数会导致控件的容器窗口代表鼠标捕获。 否则，此函数会使控件本身占有鼠标捕获（与 `CWnd::SetCapture`相同）。

##  <a name="setcontrolsize"></a>COleControl：： SetControlSize

设置 OLE 控件窗口的大小，并通知容器控件网站正在更改。

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>parameters

*cx*<br/>
指定控件的新宽度（以像素为单位）。

*cy*<br/>
指定控件的新高度（以像素为单位）。

### <a name="return-value"></a>返回值

如果调用成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

不应在控件的构造函数中使用此函数。

请注意，控件窗口的所有坐标都是相对于控件的左上角的。

##  <a name="setenabled"></a>COleControl：： SetEnabled

设置控件的 "启用了股票" 的属性值。

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>parameters

*bEnabled*<br/>
如果要启用该控件，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

设置此属性后，将调用 `OnEnabledChange`。

##  <a name="setfocus"></a>COleControl：： SetFocus

导致控件的容器窗口代表控件拥有输入焦点。

```
CWnd* SetFocus();
```

### <a name="return-value"></a>返回值

指向之前具有输入焦点的 `CWnd` 窗口对象的指针; 如果没有此类窗口，则为 NULL。

### <a name="remarks"></a>备注

如果控件已激活且无窗口，此函数会使控件的容器窗口代表控件上的输入焦点。 输入焦点会将键盘输入定向到容器的窗口，容器会将所有后续键盘消息调度到调用 `SetFocus`的 OLE 对象。 之前有输入焦点的任何窗口都将丢失它。

如果控件不是无窗口的，则此函数会使控件本身拥有输入焦点（与 `CWnd::SetFocus`相同）。

##  <a name="setfont"></a>COleControl：： SetFont

设置控件的常用字体属性。

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>parameters

*pFontDisp*<br/>
指向字体调度接口的指针。

##  <a name="setforecolor"></a>COleControl：： SetForeColor

设置控件的 "股票前景色" 属性值。

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>parameters

*dwForeColor*<br/>
用于控件的前景绘图的 OLE_COLOR 值。

### <a name="remarks"></a>备注

有关使用此属性和其他相关属性的详细信息，请参阅[ActiveX 控件：属性](../../mfc/mfc-activex-controls-properties.md)一文。

##  <a name="setinitialdataformats"></a>COleControl：： SetInitialDataFormats

由框架调用以初始化控件支持的数据格式列表。

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>备注

默认实现指定两种格式： CF_METAFILEPICT 和持久性属性集。

##  <a name="setinitialsize"></a>COleControl：： SetInitialSize

设置 OLE 控件第一次在容器中显示时的大小。

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>parameters

*cx*<br/>
OLE 控件的初始宽度（以像素为单位）。

*cy*<br/>
OLE 控件的初始高度（以像素为单位）。

### <a name="remarks"></a>备注

在构造函数中调用此函数可设置控件的初始大小。 初始大小以设备单位或像素为单位。 建议在控件的构造函数中进行此调用。

##  <a name="setmodifiedflag"></a>COleControl：： SetModifiedFlag

更改控件的修改状态。

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>parameters

*bModified*<br/>
控件的已修改标志的新值。 如果为 TRUE，则表示已修改控件的状态;FALSE 指示控件的状态刚刚保存。

### <a name="remarks"></a>备注

每当发生会影响控件持久状态的更改时调用此函数。 例如，如果永久性属性的值发生更改，则使用*bModified* **TRUE**调用此函数。

##  <a name="setnotpermitted"></a>COleControl：： SetNotPermitted

指示编辑请求失败。

```
void SetNotPermitted();
```

### <a name="remarks"></a>备注

如果 `BoundPropertyRequestEdit` 失败，请调用此函数。 此函数引发类型 `COleDispScodeException` 的异常，以指示不允许设置操作。

##  <a name="setnotsupported"></a>COleControl：： SetNotSupported

防止用户修改控件的属性值。

```
void SetNotSupported();
```

### <a name="remarks"></a>备注

调用此函数以代替任何属性的 Set 函数，但不支持对控件的用户修改属性值。 一个示例是只读属性。

##  <a name="setrectincontainer"></a>COleControl：： SetRectInContainer

设置控件矩形相对于容器的坐标，以设备单位表示。

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>parameters

*lpRect*<br/>
指向一个矩形的指针，该矩形包含控件的新坐标（相对于容器）。

### <a name="return-value"></a>返回值

如果调用成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

如果控件处于打开状态，则调整其大小;否则，将调用容器的 `OnPosRectChanged` 函数。

##  <a name="settext"></a>COleControl：： SetText

设置控件的常用标题或文本属性的值。

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>parameters

*pszText*<br/>
指向字符串的指针。

### <a name="remarks"></a>备注

请注意，stock 标题和文本属性都映射到相同的值。 这意味着对任一属性所做的任何更改都将自动更改这两种属性。 通常，控件应支持 stock 标题或文本属性，但不能同时支持两者。

##  <a name="throwerror"></a>COleControl：： ThrowError

指示控件中出现错误。

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>parameters

*sc*<br/>
要报告的状态代码值。 有关可能代码的完整列表，请参阅文章[ActiveX 控件：高级主题](../../mfc/mfc-activex-controls-advanced-topics.md)。

*nDescriptionID*<br/>
要报告的异常的字符串资源 ID。

*nHelpID*<br/>
要报告的主题的帮助 ID。

*pszDescription*<br/>
一个字符串，其中包含要报告的异常的说明。

### <a name="remarks"></a>备注

只应从 OLE 属性的 Get 或 Set 函数中调用此函数，或者从 OLE 自动化方法的实现中调用此函数。 如果需要发出其他时间发生的信号错误，应激发 stock 错误事件。

##  <a name="transformcoords"></a>COleControl：： TransformCoords

转换 HIMETRIC 单元与容器的本机单位之间的坐标值。

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>parameters

*lpptlHimetric*<br/>
指向 `POINTL` 结构的指针，该结构包含 HIMETRIC 单位中的坐标。

*lpptfContainer*<br/>
指向 `POINTF` 结构的指针，该结构包含容器的单元大小的坐标。

*flag*<br/>
以下值的组合：

- XFORMCOORDS_POSITION 容器中的位置。

- XFORMCOORDS_SIZE 容器中的大小。

- XFORMCOORDS_HIMETRICTOCONTAINER 将 HIMETRIC 单位转换为容器的单位。

- XFORMCOORDS_CONTAINERTOHIMETRIC 将容器的单位转换为 HIMETRIC 单元。

### <a name="remarks"></a>备注

前两个标志 "XFORMCOORDS_POSITION" 和 "XFORMCOORDS_SIZE" 指示是否应将坐标视为位置或大小。 其余两个标志指示转换的方向。

##  <a name="translatecolor"></a>COleControl：： TranslateColor

将 OLE_COLOR 数据类型的颜色值转换为[COLORREF](/windows/win32/gdi/colorref)数据类型。

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>parameters

*clrColor*<br/>
一个 OLE_COLOR 数据类型。 有关详细信息，请参阅 Windows [OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor)函数。

*hpal*<br/>
可选调色板的句柄;可以为 NULL。

### <a name="return-value"></a>返回值

RGB （红、绿、蓝）32位颜色值，用于定义与设备可表示的*clrColor*值最接近的纯色。

### <a name="remarks"></a>备注

此函数可用于将库存前景色和背景色属性转换为[CDC](../../mfc/reference/cdc-class.md)成员函数使用的 COLORREF 类型。

##  <a name="willambientsbevalidduringload"></a>COleControl：： WillAmbientsBeValidDuringLoad

确定控件是否应使用环境属性的值作为默认值（当它随后从其持久性状态加载时）。

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>返回值

非零表示环境属性将有效;否则，环境属性将无效。

### <a name="remarks"></a>备注

在某些容器中，在首次调用 `COleControl::DoPropExchange`的重写过程中，控件可能无法访问其环境属性。 如果容器在调用[IOleObject：： SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite)之前调用[IPersistStreamInit：： load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load)或[IPersistStorage：： load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) ，就会出现这种情况（即，如果它不服从 OLEMISC_SETCLIENTSITEFIRST 状态位）。

##  <a name="windowproc"></a>COleControl：： WindowProc

为 `COleControl` 对象提供 Windows 过程。

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>parameters

message<br/>
指定要处理的 Windows 消息。

*wParam*<br/>
提供处理消息时使用的其他信息。 参数值取决于消息。

*lParam*<br/>
提供处理消息时使用的其他信息。 参数值取决于消息。

### <a name="return-value"></a>返回值

已调度消息的返回值。

### <a name="remarks"></a>备注

调用此函数可通过控件的消息映射调度特定消息。

## <a name="see-also"></a>另请参阅

[MFC 示例 CIRC3](../../overview/visual-cpp-samples.md)<br/>
[MFC 示例 TESTHELP](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage 类](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd 类](../../mfc/reference/cwnd-class.md)<br/>
[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder 类](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder 类](../../mfc/reference/cpictureholder-class.md)<br/>

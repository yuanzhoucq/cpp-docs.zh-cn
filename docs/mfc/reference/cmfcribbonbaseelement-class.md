---
title: CMFCRibbonBaseElement 类
ms.date: 11/04/2016
f1_keywords:
- CMFCRibbonBaseElement
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::AddToKeyList
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::AddToListBox
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::CanBeAddedToQuickAccessToolBar
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::CanBeCompacted
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::CanBeStretched
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::CanBeStretchedHorizontally
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::CleanUpSizes
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::ClosePopupMenu
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::CopyFrom
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::DestroyCtrl
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::DrawImage
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::Find
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::FindByData
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::FindByID
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::FindByOriginal
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetCompactSize
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetData
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetDescription
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetDroppedDown
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetElements
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetElementsByID
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetHighlighted
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetID
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetImageSize
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetIntermediateSize
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetKeys
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetKeyTipRect
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetKeyTipSize
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetLocationInGroup
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetMenuKeys
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetNotifyID
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetOriginal
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetParentCategory
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetParentPanel
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetParentRibbonBar
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetParentWnd
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetPressed
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetQuickAccessToolBarID
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetRect
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetRegularSize
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetSize
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetText
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetToolTipText
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetTopLevelRibbonBar
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::HasCompactMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::HasFocus
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::HasIntermediateMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::HasLargeMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::HasMenu
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::HitTest
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsAlignByColumn
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsAlwaysLargeImage
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsAutoRepeatMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsChecked
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsCompactMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsDefaultMenuLook
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsDisabled
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsDroppedDown
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsFocused
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsGalleryIcon
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsHighlighted
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsIntermediateMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsLargeMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsMenuMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsPressed
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsQATMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsSeparator
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsShowGroupBorder
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsShowTooltipOnBottom
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsTabStop
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsTextAlwaysOnRight
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsVisible
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsWholeRowHeight
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::NotifyCommand
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::NotifyHighlightListItem
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnAddToQAToolbar
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnAfterChangeRect
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnAutoRepeat
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnCalcTextSize
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnChangeMenuHighlight
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnDraw
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnDrawKeyTip
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnDrawMenuImage
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnDrawOnList
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnKey
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnMenuKey
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnRTLChanged
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnShow
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnShowPopupMenu
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::PostMenuCommand
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::Redraw
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetACCData
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetCompactMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetData
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetDefaultMenuLook
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetDescription
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetID
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetInitialMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetKeys
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetOriginal
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetParentCategory
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetParentMenu
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetParentRibbonBar
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetRect
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetText
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetTextAlwaysOnRight
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetToolTipText
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetVisible
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::StretchHorizontally
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::StretchToWholeRow
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::UpdateTooltipInfo
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnProcessKey
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnSetFocus
helpviewer_keywords:
- CMFCRibbonBaseElement [MFC], AddToKeyList
- CMFCRibbonBaseElement [MFC], AddToListBox
- CMFCRibbonBaseElement [MFC], CanBeAddedToQuickAccessToolBar
- CMFCRibbonBaseElement [MFC], CanBeCompacted
- CMFCRibbonBaseElement [MFC], CanBeStretched
- CMFCRibbonBaseElement [MFC], CanBeStretchedHorizontally
- CMFCRibbonBaseElement [MFC], CleanUpSizes
- CMFCRibbonBaseElement [MFC], ClosePopupMenu
- CMFCRibbonBaseElement [MFC], CopyFrom
- CMFCRibbonBaseElement [MFC], DestroyCtrl
- CMFCRibbonBaseElement [MFC], DrawImage
- CMFCRibbonBaseElement [MFC], Find
- CMFCRibbonBaseElement [MFC], FindByData
- CMFCRibbonBaseElement [MFC], FindByID
- CMFCRibbonBaseElement [MFC], FindByOriginal
- CMFCRibbonBaseElement [MFC], GetCompactSize
- CMFCRibbonBaseElement [MFC], GetData
- CMFCRibbonBaseElement [MFC], GetDescription
- CMFCRibbonBaseElement [MFC], GetDroppedDown
- CMFCRibbonBaseElement [MFC], GetElements
- CMFCRibbonBaseElement [MFC], GetElementsByID
- CMFCRibbonBaseElement [MFC], GetHighlighted
- CMFCRibbonBaseElement [MFC], GetID
- CMFCRibbonBaseElement [MFC], GetImageSize
- CMFCRibbonBaseElement [MFC], GetIntermediateSize
- CMFCRibbonBaseElement [MFC], GetKeys
- CMFCRibbonBaseElement [MFC], GetKeyTipRect
- CMFCRibbonBaseElement [MFC], GetKeyTipSize
- CMFCRibbonBaseElement [MFC], GetLocationInGroup
- CMFCRibbonBaseElement [MFC], GetMenuKeys
- CMFCRibbonBaseElement [MFC], GetNotifyID
- CMFCRibbonBaseElement [MFC], GetOriginal
- CMFCRibbonBaseElement [MFC], GetParentCategory
- CMFCRibbonBaseElement [MFC], GetParentPanel
- CMFCRibbonBaseElement [MFC], GetParentRibbonBar
- CMFCRibbonBaseElement [MFC], GetParentWnd
- CMFCRibbonBaseElement [MFC], GetPressed
- CMFCRibbonBaseElement [MFC], GetQuickAccessToolBarID
- CMFCRibbonBaseElement [MFC], GetRect
- CMFCRibbonBaseElement [MFC], GetRegularSize
- CMFCRibbonBaseElement [MFC], GetSize
- CMFCRibbonBaseElement [MFC], GetText
- CMFCRibbonBaseElement [MFC], GetToolTipText
- CMFCRibbonBaseElement [MFC], GetTopLevelRibbonBar
- CMFCRibbonBaseElement [MFC], HasCompactMode
- CMFCRibbonBaseElement [MFC], HasFocus
- CMFCRibbonBaseElement [MFC], HasIntermediateMode
- CMFCRibbonBaseElement [MFC], HasLargeMode
- CMFCRibbonBaseElement [MFC], HasMenu
- CMFCRibbonBaseElement [MFC], HitTest
- CMFCRibbonBaseElement [MFC], IsAlignByColumn
- CMFCRibbonBaseElement [MFC], IsAlwaysLargeImage
- CMFCRibbonBaseElement [MFC], IsAutoRepeatMode
- CMFCRibbonBaseElement [MFC], IsChecked
- CMFCRibbonBaseElement [MFC], IsCompactMode
- CMFCRibbonBaseElement [MFC], IsDefaultMenuLook
- CMFCRibbonBaseElement [MFC], IsDisabled
- CMFCRibbonBaseElement [MFC], IsDroppedDown
- CMFCRibbonBaseElement [MFC], IsFocused
- CMFCRibbonBaseElement [MFC], IsGalleryIcon
- CMFCRibbonBaseElement [MFC], IsHighlighted
- CMFCRibbonBaseElement [MFC], IsIntermediateMode
- CMFCRibbonBaseElement [MFC], IsLargeMode
- CMFCRibbonBaseElement [MFC], IsMenuMode
- CMFCRibbonBaseElement [MFC], IsPressed
- CMFCRibbonBaseElement [MFC], IsQATMode
- CMFCRibbonBaseElement [MFC], IsSeparator
- CMFCRibbonBaseElement [MFC], IsShowGroupBorder
- CMFCRibbonBaseElement [MFC], IsShowTooltipOnBottom
- CMFCRibbonBaseElement [MFC], IsTabStop
- CMFCRibbonBaseElement [MFC], IsTextAlwaysOnRight
- CMFCRibbonBaseElement [MFC], IsVisible
- CMFCRibbonBaseElement [MFC], IsWholeRowHeight
- CMFCRibbonBaseElement [MFC], NotifyCommand
- CMFCRibbonBaseElement [MFC], NotifyHighlightListItem
- CMFCRibbonBaseElement [MFC], OnAddToQAToolbar
- CMFCRibbonBaseElement [MFC], OnAfterChangeRect
- CMFCRibbonBaseElement [MFC], OnAutoRepeat
- CMFCRibbonBaseElement [MFC], OnCalcTextSize
- CMFCRibbonBaseElement [MFC], OnChangeMenuHighlight
- CMFCRibbonBaseElement [MFC], OnDraw
- CMFCRibbonBaseElement [MFC], OnDrawKeyTip
- CMFCRibbonBaseElement [MFC], OnDrawMenuImage
- CMFCRibbonBaseElement [MFC], OnDrawOnList
- CMFCRibbonBaseElement [MFC], OnKey
- CMFCRibbonBaseElement [MFC], OnMenuKey
- CMFCRibbonBaseElement [MFC], OnRTLChanged
- CMFCRibbonBaseElement [MFC], OnShow
- CMFCRibbonBaseElement [MFC], OnShowPopupMenu
- CMFCRibbonBaseElement [MFC], PostMenuCommand
- CMFCRibbonBaseElement [MFC], Redraw
- CMFCRibbonBaseElement [MFC], SetACCData
- CMFCRibbonBaseElement [MFC], SetCompactMode
- CMFCRibbonBaseElement [MFC], SetData
- CMFCRibbonBaseElement [MFC], SetDefaultMenuLook
- CMFCRibbonBaseElement [MFC], SetDescription
- CMFCRibbonBaseElement [MFC], SetID
- CMFCRibbonBaseElement [MFC], SetInitialMode
- CMFCRibbonBaseElement [MFC], SetKeys
- CMFCRibbonBaseElement [MFC], SetOriginal
- CMFCRibbonBaseElement [MFC], SetParentCategory
- CMFCRibbonBaseElement [MFC], SetParentMenu
- CMFCRibbonBaseElement [MFC], SetParentRibbonBar
- CMFCRibbonBaseElement [MFC], SetRect
- CMFCRibbonBaseElement [MFC], SetText
- CMFCRibbonBaseElement [MFC], SetTextAlwaysOnRight
- CMFCRibbonBaseElement [MFC], SetToolTipText
- CMFCRibbonBaseElement [MFC], SetVisible
- CMFCRibbonBaseElement [MFC], StretchHorizontally
- CMFCRibbonBaseElement [MFC], StretchToWholeRow
- CMFCRibbonBaseElement [MFC], UpdateTooltipInfo
- CMFCRibbonBaseElement [MFC], OnProcessKey
- CMFCRibbonBaseElement [MFC], OnSetFocus
ms.assetid: 419ea91b-5062-44cc-b0a3-f87d29566f62
ms.openlocfilehash: f28ba975b060de149edaa5e3b93eac61d4cd6703
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/14/2020
ms.locfileid: "81375311"
---
# <a name="cmfcribbonbaseelement-class"></a>CMFCRibbonBaseElement 类

类`CMFCRibbonBaseElement`是可以添加到[功能区栏](../../mfc/reference/cmfcribbonbar-class.md)的所有元素的基类。 功能区元素的示例包括功能区按钮、功能区复选框和功能区组合框。

## <a name="syntax"></a>语法

```
class CMFCRibbonBaseElement : public CObject
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|说明|
|----------|-----------------|
|`CMFCRibbonBaseElement`|构造 `CMFCRibbonBaseElement` 对象。|

### <a name="public-methods"></a>公共方法

|名称|说明|
|----------|-----------------|
|[CMFC 功能基础元素：：添加到关键列表](#addtokeylist)|将功能区元素的键提示添加到一系列键提示。|
|[CMFC 功能基础元素：：添加到列表框](#addtolistbox)|将功能区元素添加到指定的功能区命令列表框。|
|[CMFC 功能基础元素：：可添加到快速访问工具栏](#canbeaddedtoquickaccesstoolbar)|指示功能区元素是否可以添加到快速访问工具栏。|
|[CMFC 功能基础元素：：可压缩](#canbecompacted)|指示功能区元素的大小是否可以紧凑。|
|[CMFC 功能基础元素：：可拉伸](#canbestretched)|指示功能区元素的高度是否可以垂直增加到功能区行的高度。|
|[CMFC 功能基础元素：：可横向拉伸](#canbestretchedhorizontally)|指示功能区元素的宽度是否可以更改。|
|[CMFC 功能基础元素：：清理](#cleanupsizes)|清理功能区元素的尺寸设置。|
|[CMFC 功能基础元素：：闭合弹出菜单](#closepopupmenu)|关闭功能区元素的弹出菜单。|
|[CMFC 功能基础元素：：从](#copyfrom)|将指定的`CMFCRibbonBaseElement`状态复制到当前对象。|
|[CMFC功能基础元素：:D](#destroyctrl)|销毁功能区元素。|
|[CMFC功能基础元素：:D原始图像](#drawimage)|绘制功能区元素的图像。|
|[CMFC 功能基础元素：查找](#find)|如果指定指针指向当前对象，则返回指向功能区元素的指定指针。|
|[CMFC 功能基础元素：：查找数据](#findbydata)|如果功能区元素包含指定的数据，则检索指向功能区元素的指针。|
|[CMFC 功能基础元素：：查找ByID](#findbyid)|如果指定的命令 ID 标识了该元素，则检索指向功能区元素的指针。|
|[CMFC 功能基础元素：：按原始查找](#findbyoriginal)|如果功能区元素的原始功能区元素与指定的功能区元素匹配，则检索指向功能区元素的指针。|
|[CMFC 功能基础元素：获取压缩尺寸](#getcompactsize)|返回功能区元素的压缩大小。|
|[CMFC 功能基础元素：获取数据](#getdata)|检索与功能区元素关联的用户定义的数据。|
|[CMFC 功能基础元素：获取描述](#getdescription)|返回功能区元素的说明。|
|[CMFC 功能基础元素：：向下删除](#getdroppeddown)|如果功能区元素的弹出菜单被下拉，则检索指向功能区元素的指针。|
|[CMFC功能基础元素：获取元素](#getelements)|将当前功能区元素添加到指定的数组。|
|[CMFC 功能基础元素：获取元素 ByID](#getelementsbyid)|如果当前功能区元素包含指定的命令 ID，则将当前功能区元素添加到指定的数组中。|
|[CMFC 功能基础元素：：获得突出显示](#gethighlighted)|如果功能区元素突出显示，则检索该指针。|
|[CMFC 功能基础元素：GetID](#getid)|返回功能区元素的命令 ID。|
|[CMFC 功能基础元素：获取图像大小](#getimagesize)|返回功能区元素的图像大小。|
|[CMFC 功能基础元素：获取中间大小](#getintermediatesize)|返回处于中间状态的功能区元素的大小。|
|[CMFC功能基础元素：获取密钥](#getkeys)|返回与功能区元素关联的键尖。|
|[CMFC 功能基础元素：：获取密钥提示](#getkeytiprect)|检索功能区元素的键尖边界矩形。|
|[CMFC 功能基础元素：：获取关键提示大小](#getkeytipsize)|检索键提示文本的大小。|
|[CMFC 功能基础元素：：获取定位组](#getlocationingroup)|指示功能区组中功能区元素的显示位置。|
|[CMFC功能基础元素：获取菜单键](#getmenukeys)|返回与按钮关联的键提示。|
|[CMFC 功能基础元素：获取NotifyID](#getnotifyid)|检索功能区元素的通知命令 ID。|
|[CMFC功能基础元素：获取原始元素](#getoriginal)|检索原始功能区元素。|
|[CMFC 功能基础元素：获取父项](#getparentcategory)|检索功能区元素的功能区类别。|
|[CMFC 功能基础元素：获取家长面板](#getparentpanel)|检索包含功能区元素的功能区面板。|
|[CMFC 功能基础元素：获取父功能栏](#getparentribbonbar)|检索功能区元素的父功能区栏。|
|[CMFC 功能基础元素：获取家长](#getparentwnd)|检索功能区元素的父窗口。|
|[CMFC 功能基础元素：：获取压榨](#getpressed)|如果用户当前按下功能区元素，则检索指向功能区元素的指针。|
|[CMFC 功能基础元素：获取快速访问工具Barid](#getquickaccesstoolbarid)|在功能区元素位于快速访问工具栏中时检索其命令 ID。|
|[CMFC 功能基础元素：：获取 Rect](#getrect)|返回功能区元素的边界矩形。|
|[CMFC 功能基础元素：获取常规大小](#getregularsize)|返回功能区元素的常规大小。|
|[CMFC 功能基础元素：获取大小](#getsize)|返回功能区元素的当前大小。|
|[CMFC 功能基础元素：获取文本](#gettext)|返回与功能区元素关联的文本。|
|[CMFC 功能基础元素：：获取工具提示文本](#gettooltiptext)|返回功能区元素的工具提示文本。|
|[CMFC 功能基础元素：获取顶级功能区栏](#gettoplevelribbonbar)|检索功能区元素的顶层功能区栏。|
|[CMFC 功能基础元素：：具有压缩模式](#hascompactmode)|指定功能区元素是否有压缩模式。|
|[CMFC 功能基础元素：：有焦点](#hasfocus)|指示父元素是否具有键盘焦点。|
|[CMFC功能基础元素：：具有中间模式](#hasintermediatemode)|指定功能区元素是否有中间模式。|
|[CMFC功能基础元素：：具有大模式](#haslargemode)|指定功能区元素是否具有大模式。|
|[CMFC功能基础元素：：哈斯梅因](#hasmenu)|指示功能区元素是否具有菜单。|
|[CMFC功能基础元素：hitTest](#hittest)|如果指定点位于其中，则检索指向功能区元素的指针。|
|[CMFC 功能基础元素：：正对齐比列](#isalignbycolumn)|指示功能区元素是否与其他功能区元素垂直对齐。|
|[CMFC 功能基础元素：：始终较大的图像](#isalwayslargeimage)|指示功能区元素图像大小是否始终较大。|
|[CMFC 功能基础元素：：自动重复模式](#isautorepeatmode)|指示功能区元素是否处于自动重复模式。|
|[CMFC 功能基础元素：：已选中](#ischecked)|指定是否选中功能区元素。|
|[CMFC 功能基础元素：：压缩模式](#iscompactmode)|指定功能区元素是否处于紧凑模式。|
|[CMFC 功能基础元素：：默认菜单查看](#isdefaultmenulook)||
|[CMFC 功能基础元素：：已禁用](#isdisabled)|指定功能区元素是否禁用。|
|[CMFC 功能基础元素：：已丢弃](#isdroppeddown)|确定功能区元素是否显示弹出菜单并向下下拉。|
|[CMFC 功能基础元素：：聚焦](#isfocused)|指定功能区元素是否具有焦点。|
|[CMFC功能基础元素：：IsgalleryIcon](#isgalleryicon)|指示功能区元素是否包含在功能区库中。|
|[CMFC 功能基础元素：：已突出显示](#ishighlighted)|指定功能区元素是否突出显示。|
|[CMFC 功能基础元素：：中间模式](#isintermediatemode)|指示功能区元素的当前图像是否为中间大小。|
|[CMFC 功能基础元素：：是大模式](#islargemode)|指示功能区元素的当前图像是否大。|
|[CMFC功能基础元素：：即菜单模式](#ismenumode)|指示功能区元素是否包含在菜单中。|
|[CMFC 功能基础元素：：按压](#ispressed)|指示用户是否已单击功能区元素。|
|[CMFC功能基础元素：isQAT模式](#isqatmode)|指示功能区元素是否包含在快速访问工具栏中。|
|[CMFC功能基础元素：分离器](#isseparator)|指示功能区元素是否为显示分隔符。|
|[CMFC 功能基础元素：：IsShowGroup边框](#isshowgroupborder)|指示功能区元素是否包含在显示公共边框的组中。|
|[CMFC 功能基础元素：：isShowTooltipon 底部](#isshowtooltiponbottom)|指示工具提示是否显示在功能区元素下。|
|[CMFC 功能基础元素：：IsTabStop](#istabstop)|指示是否可以使用键盘选择功能区元素。|
|[CMFC 功能基础元素：：文本始终正确](#istextalwaysonright)|指示功能区元素的文本是否显示在右侧。|
|[CMFC 功能基础元素：可见](#isvisible)|指示功能区元素当前是否显示。|
|[CMFC 功能基础元素：：完整罗高](#iswholerowheight)|指示功能区元素的显示高度是否与包含功能区面板的显示高度相同。|
|[CMFC 功能基础元素：：通知命令](#notifycommand)|向功能区元素的父窗口发送命令通知。|
|[CMFC 功能基础元素：：通知突出显示列表项](#notifyhighlightlistitem)|当用户突出显示位于列表中的功能区元素时，通知功能区栏的父窗口。|
|[CMFC功能基础元素：：在ADDtoQA工具栏上](#onaddtoqatoolbar)|将功能区元素添加到指定的快速访问工具栏。|
|[CMFC 功能基础元素：：在转换后](#onafterchangerect)|更新功能区元素的工具提示。|
|[CMFC功能基础元素：：自动重复](#onautorepeat)|更新功能区元素以响应持续的用户输入。|
|[CMFC 功能基础元素：：在文本大小上](#oncalctextsize)|计算功能区元素的文本大小。|
|[CMFC 功能基础元素：：在更改菜单高亮显示](#onchangemenuhighlight)|当突出显示更改位于菜单中的功能区元素时，由框架调用。|
|[CMFC 功能基础元素：：开拉](#ondraw)|由框架调用以绘制功能区元素。|
|[CMFC 功能基础元素：：绘制键提示](#ondrawkeytip)|由框架调用以绘制功能区元素的键尖。|
|[CMFC功能基础元素：：在绘制菜单图像](#ondrawmenuimage)|绘制功能区元素的菜单图像时由框架调用。|
|[CMFC功能基础元素：在画上列表](#ondrawonlist)|由框架调用以在命令列表框中绘制功能区元素。|
|[CMFC功能基础元素：：在键上](#onkey)|当用户按下键尖并且功能区元素具有焦点时，由框架调用。|
|[CMFC功能基础元素：：上菜单键](#onmenukey)||
|[CMFC 功能基础元素：：在RTL改变](#onrtlchanged)|当布局更改方向时由框架调用。|
|[CMFC 功能基础元素：：上展](#onshow)|由框架调用以显示或隐藏功能区元素。|
|[CMFC功能基础元素：：在显示弹出菜单](#onshowpopupmenu)|当功能区元素要显示弹出菜单时，由框架调用。|
|[CMFC功能基础元素：:P奥斯特库梅命令](#postmenucommand)||
|[CMFC 功能基础元素：：重绘](#redraw)|更新功能区元素的显示。|
|[CMFC 功能基础元素：：设置ACC数据](#setaccdata)|设置功能区元素的可访问性数据。|
|[CMFC 功能基础元素：：设置压缩模式](#setcompactmode)|设置功能区元素的显示大小。|
|[CMFC 功能基础元素：：集数据](#setdata)|将数据项与功能区元素关联。|
|[CMFC 功能基础元素：：设置默认菜单查看](#setdefaultmenulook)||
|[CMFC 功能基础元素：：设置描述](#setdescription)|设置功能区元素的说明。|
|[CMFC 功能基础元素：：SetID](#setid)|设置功能区元素的命令 ID。|
|[CMFC 功能基础元素：：设置初始模式](#setinitialmode)|设置功能区元素的初始显示大小。|
|[CMFC 功能基础元素：：设置键](#setkeys)|设置功能区元素的键尖。|
|[CMFC 功能基础元素：：设置原始](#setoriginal)|设置功能区元素的原始功能区元素。|
|[CMFC 功能基础元素：：设置父项类别](#setparentcategory)|设置功能区元素的父类别。|
|[CMFC 功能基础元素：：设置父菜单](#setparentmenu)|设置功能区元素的父菜单容器。|
|[CMFC 功能基础元素：：设置父功能区栏](#setparentribbonbar)|设置功能区元素的父功能区栏。|
|[CMFC 功能基础元素：：设置 Rect](#setrect)|设置他显示功能区元素矩形的尺寸。|
|[CMFC 功能基础元素：：设置文本](#settext)|设置功能区元素的文本。|
|[CMFC 功能基础元素：：设置文本始终正确](#settextalwaysonright)|设置功能区元素的文本，以便显示在右侧。|
|[CMFC 功能基础元素：：设置工具提示文本](#settooltiptext)|设置功能区元素的工具提示文本。|
|[CMFC 功能基础元素：：设置可见](#setvisible)|设置功能区元素的可见性状态。|
|[CMFC 功能基础元素：：水平拉伸](#stretchhorizontally)|拉伸功能区元素的宽度。|
|[CMFC 功能基础元素：：拉伸到整体行](#stretchtowholerow)|将功能区元素的显示高度更改为指定的行高度。|
|[CMFC 功能基础元素：：更新工具提示信息](#updatetooltipinfo)|使用功能区元素的命令资源更新工具提示文本。|

### <a name="protected-methods"></a>受保护的方法

|名称|说明|
|----------|-----------------|
|[CMFC 功能基础元素：：在进程键上](#onprocesskey)|当用户按下快捷键时，由框架调用。|
|[CMFC 功能基础元素：：上集焦点](#onsetfocus)|当功能区元素接收或丢失输入焦点时，由框架调用。|

## <a name="remarks"></a>备注

该`CMFCRibbonBaseElement`类定义所有功能区元素共有的属性，包括命令 ID、文本标签、工具提示文本、元素描述和状态（可以集中、突出显示、按下、禁用、选中或下拉）。

功能区元素的图像大小由`RibbonImageType`成员定义，可以是以下值之一：

- `RibbonImageLarge`

- `RibbonImageSmall`

根据其大小，功能区元素显示小图像或大图像。

## <a name="example"></a>示例

下面的示例演示了如何使用 `CMFCRibbonBaseElement` 类中的各种方法。 该示例演示如何从`CMFCRibbonBaseElement``CMFCRibbonStatusBar`类获取对象、设置功能区元素的说明、设置文本、设置键提示以及设置功能区元素的工具提示文本。 此代码片段属于 [Draw Client 示例](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_DrawClient#8](../../mfc/reference/codesnippet/cpp/cmfcribbonbaseelement-class_1.cpp)]
[!code-cpp[NVC_MFC_DrawClient#9](../../mfc/reference/codesnippet/cpp/cmfcribbonbaseelement-class_2.cpp)]

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md)

## <a name="requirements"></a>要求

**标头：** afxbaseribbonelement.h

## <a name="cmfcribbonbaseelementaddtokeylist"></a><a name="addtokeylist"></a>CMFC 功能基础元素：：添加到关键列表

将功能区元素的键提示添加到一系列键提示。

```
virtual void AddToKeyList(
    CArray<CMFCRibbonKeyTip*, CMFCRibbonKeyTip*>& arElems);
```

### <a name="parameters"></a>参数

*阿雷姆斯*<br/>
[在]引用[一](../../mfc/reference/carray-class.md)系列键尖。

### <a name="remarks"></a>备注

启用功能区键提示功能后，当用户按下 ALT 键或 F10 键时，框架将显示功能区键提示。

## <a name="cmfcribbonbaseelementaddtolistbox"></a><a name="addtolistbox"></a>CMFC 功能基础元素：：添加到列表框

将功能区元素添加到指定的功能区命令列表框。

```
virtual int AddToListBox(
    CMFCRibbonCommandsListBox* pWndListBox,
    BOOL bDeep);
```

### <a name="parameters"></a>参数

*pWndListBox*<br/>
[在]指向命令列表框的指针。

*bDeep*<br/>
[在]不使用此参数。

### <a name="return-value"></a>返回值

添加的功能区元素的零基索引。

### <a name="remarks"></a>备注

框架将功能区元素添加到命令列表框，以使用户能够自定义用户界面。

## <a name="cmfcribbonbaseelementcanbeaddedtoquickaccesstoolbar"></a><a name="canbeaddedtoquickaccesstoolbar"></a>CMFC 功能基础元素：：可添加到快速访问工具栏

指示功能区元素是否可以添加到快速访问工具栏。

```
virtual BOOL CanBeAddedToQuickAccessToolBar() const;
```

### <a name="return-value"></a>返回值

如果元素可以添加，则为 TRUE;如果元素可以添加，则为 TRUE。否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementcanbecompacted"></a><a name="canbecompacted"></a>CMFC 功能基础元素：：可压缩

指示功能区元素的大小是否可以紧凑。

```
virtual BOOL CanBeCompacted() const;
```

### <a name="return-value"></a>返回值

如果功能区元素的大小可以紧凑，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

功能区元素的大小可以是紧凑、中间或大。

## <a name="cmfcribbonbaseelementcanbestretched"></a><a name="canbestretched"></a>CMFC 功能基础元素：：可拉伸

指示功能区元素的高度是否可以垂直增加到功能区行的高度。

```
virtual BOOL CanBeStretched();
```

### <a name="return-value"></a>返回值

始终返回 TRUE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 TRUE。 重写此方法以指示功能区元素的高度是否可以垂直增加到功能区行的高度。

## <a name="cmfcribbonbaseelementcanbestretchedhorizontally"></a><a name="canbestretchedhorizontally"></a>CMFC 功能基础元素：：可横向拉伸

指示功能区元素的宽度是否可以更改。

```
virtual BOOL CanBeStretchedHorizontally();
```

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 FALSE。 重写此方法以指示功能区元素的宽度是否可以更改。

## <a name="cmfcribbonbaseelementcleanupsizes"></a><a name="cleanupsizes"></a>CMFC 功能基础元素：：清理

清理功能区元素的尺寸设置。

```
virtual void CleanUpSizes();
```

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。 在派生类中重写此方法以重置功能区元素的尺寸设置。

## <a name="cmfcribbonbaseelementclosepopupmenu"></a><a name="closepopupmenu"></a>CMFC 功能基础元素：：闭合弹出菜单

关闭功能区元素的弹出菜单。

```
virtual void ClosePopupMenu();
```

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementcopyfrom"></a><a name="copyfrom"></a>CMFC 功能基础元素：：从

将指定的[CMFCRibbonBase 元素](../../mfc/reference/cmfcribbonbaseelement-class.md)的状态复制到当前对象。

```
virtual void CopyFrom(const CMFCRibbonBaseElement& src);
```

### <a name="parameters"></a>参数

*src*<br/>
[在]源[CMFC 功能基础元素](../../mfc/reference/cmfcribbonbaseelement-class.md)对象。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementdestroyctrl"></a><a name="destroyctrl"></a>CMFC功能基础元素：:D

销毁功能区元素。

```
virtual void DestroyCtrl();
```

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。 重写派生类中的此方法以销毁功能区元素。

## <a name="cmfcribbonbaseelementdrawimage"></a><a name="drawimage"></a>CMFC功能基础元素：:D原始图像

绘制功能区元素的图像。

```
virtual void DrawImage(
    CDC* pDC,
    RibbonImageType type,
    CRect rectImage);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

*type*<br/>
[在]枚举的图像类型。 有关可能值的列表，请参阅备注部分。

*rectImage*<br/>
[在]图像矩形。

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。 在派生类中重写此方法以绘制功能区元素的图像。

下表列出了*类型*参数的可能值：

|||
|-|-|
| `RibbonImageLarge`  | 大 32x32 像素的图像大小。  |
| `RibbonImageSmall`  | 小 16x16 像素的图像大小。  |

## <a name="cmfcribbonbaseelementfind"></a><a name="find"></a>CMFC 功能基础元素：查找

如果指定的指针指向当前对象，则返回该指针。

```
virtual CMFCRibbonBaseElement* Find(const CMFCRibbonBaseElement* pElement);
```

### <a name="parameters"></a>参数

*p元素*<br/>
[在]指向功能区元素的指针。

### <a name="return-value"></a>返回值

如果*pElement*指向当前对象，则指向功能区元素的指针;否则 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementfindbydata"></a><a name="findbydata"></a>CMFC 功能基础元素：：查找数据

如果功能区元素包含指定的数据，则检索指向功能区元素的指针。

```
virtual CMFCRibbonBaseElement* FindByData(DWORD_PTR dwData);
```

### <a name="parameters"></a>参数

*dwData*<br/>
[在]与功能区元素关联的数据。

### <a name="return-value"></a>返回值

如果功能区元素包含指定数据，则指向功能区元素的指针;否则 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementfindbyid"></a><a name="findbyid"></a>CMFC 功能基础元素：：查找ByID

如果指定的命令 ID 标识了该元素，则检索指向功能区元素的指针。

```
virtual CMFCRibbonBaseElement* FindByID(UINT uiCmdID);
```

### <a name="parameters"></a>参数

*乌伊CmdID*<br/>
[在]功能区元素的命令 ID。

### <a name="return-value"></a>返回值

如果指定的命令 ID 标识了该元素，则指向功能区元素的指针;否则 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementfindbyoriginal"></a><a name="findbyoriginal"></a>CMFC 功能基础元素：：按原始查找

如果当前功能区元素的原始功能区元素与指定的功能区元素匹配，则检索指向当前功能区元素的指针。

```
virtual CMFCRibbonBaseElement* FindByOriginal(CMFCRibbonBaseElement* pOriginal);
```

### <a name="parameters"></a>参数

*p原始*<br/>
[在]指向功能区元素的指针。

### <a name="return-value"></a>返回值

如果功能区元素的原始功能区元素与指定的功能区元素匹配，则指向功能区元素的指针;否则 NULL。

### <a name="remarks"></a>备注

复制到另一个容器的功能区元素将保留指向原始功能区元素的指针。

## <a name="cmfcribbonbaseelementgetcompactsize"></a><a name="getcompactsize"></a>CMFC 功能基础元素：获取压缩尺寸

返回功能区元素的压缩大小。

```
virtual CSize GetCompactSize(CDC* pDC);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

### <a name="return-value"></a>返回值

功能区元素的紧凑大小。

> [!NOTE]
> 紧凑大小表示功能区元素被截断（它显示一个小图像，或没有文本的图像）。

## <a name="cmfcribbonbaseelementgetdata"></a><a name="getdata"></a>CMFC 功能基础元素：获取数据

检索与功能区元素关联的用户定义的数据。

```
DWORD_PTR GetData() const;
```

### <a name="return-value"></a>返回值

与功能区元素关联的用户定义的数据。

## <a name="cmfcribbonbaseelementgetdescription"></a><a name="getdescription"></a>CMFC 功能基础元素：获取描述

返回功能区元素的说明。

```
virtual CString GetDescription() const;
```

### <a name="return-value"></a>返回值

功能区元素描述。 如果功能区元素位于[CMFCRibbonMainPanel 类](../../mfc/reference/cmfcribbonmainpanel-class.md)上，则说明将显示在状态栏、工具提示或菜单按钮下。

## <a name="cmfcribbonbaseelementgetdroppeddown"></a><a name="getdroppeddown"></a>CMFC 功能基础元素：：向下删除

如果功能区元素的弹出菜单被下拉，则检索指向功能区元素的指针。

```
virtual CMFCRibbonBaseElement* GetDroppedDown();
```

### <a name="return-value"></a>返回值

如果功能区元素的弹出菜单被下拉，则指向其带状元素的指针;否则 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetelements"></a><a name="getelements"></a>CMFC功能基础元素：获取元素

将当前功能区元素添加到指定的数组。

```
virtual void GetElements(
    CArray<CMFCRibbonBaseElement*, CMFCRibbonBaseElement*>& arElements);
```

### <a name="parameters"></a>参数

*ar元素*<br/>
[进出]功能区元素的数组。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetelementsbyid"></a><a name="getelementsbyid"></a>CMFC 功能基础元素：获取元素 ByID

如果当前功能区元素包含指定的命令 ID，则将当前功能区元素添加到指定的数组中。

```
virtual void GetElementsByID(
    UINT uiCmdID,
    CArray<CMFCRibbonBaseElement*, CMFCRibbonBaseElement*>& arElements);
```

### <a name="parameters"></a>参数

*乌伊CmdID*<br/>
[在]功能区元素的命令 ID。

*ar元素*<br/>
[在]功能区元素的数组。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgethighlighted"></a><a name="gethighlighted"></a>CMFC 功能基础元素：：获得突出显示

如果功能区元素突出显示，则检索该指针。

```
virtual CMFCRibbonBaseElement* GetHighlighted();
```

### <a name="return-value"></a>返回值

如果突出显示功能区元素，则指向该功能区元素的指针;如果该元素突出显示，则指向该元素。否则 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetid"></a><a name="getid"></a>CMFC 功能基础元素：GetID

返回功能区元素的命令 ID。

```
UINT GetID() const;
```

### <a name="return-value"></a>返回值

功能区元素的命令 ID。

## <a name="cmfcribbonbaseelementgetimagesize"></a><a name="getimagesize"></a>CMFC 功能基础元素：获取图像大小

返回功能区元素的图像大小。

```
virtual CSize GetImageSize(RibbonImageType R) const;
```

### <a name="return-value"></a>返回值

功能区元素的图像大小。

## <a name="cmfcribbonbaseelementgetintermediatesize"></a><a name="getintermediatesize"></a>CMFC 功能基础元素：获取中间大小

返回处于中间状态的功能区元素的大小。

```
virtual CSize GetIntermediateSize(CDC* pDC);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

### <a name="return-value"></a>返回值

功能区元素在其中间状态下的大小。

## <a name="cmfcribbonbaseelementgetkeys"></a><a name="getkeys"></a>CMFC功能基础元素：获取密钥

返回与功能区元素关联的键尖。

```
LPCTSTR GetKeys() const;
```

### <a name="return-value"></a>返回值

与功能区元素关联的键尖。

## <a name="cmfcribbonbaseelementgetkeytiprect"></a><a name="getkeytiprect"></a>CMFC 功能基础元素：：获取密钥提示

检索功能区元素的键尖边界矩形。

```
virtual CRect GetKeyTipRect(
    CDC* pDC,
    BOOL bIsMenu);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

*bIsMenu*<br/>
[在]如果功能区元素显示弹出菜单，则为 TRUE;如果功能区元素显示弹出菜单，则为 TRUE。否则 FALSE。

### <a name="return-value"></a>返回值

始终返回具有 0 值的矩形。

### <a name="remarks"></a>备注

在派生类中重写此方法以返回键尖边界矩形。

## <a name="cmfcribbonbaseelementgetkeytipsize"></a><a name="getkeytipsize"></a>CMFC 功能基础元素：：获取关键提示大小

检索键提示文本的大小。

```
virtual CSize GetKeyTipSize(CDC* pDC);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

### <a name="return-value"></a>返回值

键尖文本的大小。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetlocationingroup"></a><a name="getlocationingroup"></a>CMFC 功能基础元素：：获取定位组

指示功能区组中功能区元素的显示位置。

```
RibbonElementLocation GetLocationInGroup() const;
```

### <a name="return-value"></a>返回值

`RibbonElementLocation` 枚举值。 下表列出了可能的值。

|“值”|说明|
|-----------|-----------------|
|`RibbonElementNotInGroup`|功能区元素不包含在功能区组中。|
|`RibbonElementSingleInGroup`|功能区元素显示为功能区组中的唯一项。|
|`RibbonElementFirstInGroup`|功能区元素显示在功能区组的左端。|
|`RibbonElementLastInGroup`|功能区元素显示在功能区组的右端。|
|`RibbonElementMiddleInGroup`|功能区元素不显示在功能区组的两端。|

### <a name="remarks"></a>备注

功能区元素组仅水平对齐。

## <a name="cmfcribbonbaseelementgetmenukeys"></a><a name="getmenukeys"></a>CMFC功能基础元素：获取菜单键

返回功能区元素的菜单键提示。

```
LPCTSTR GetMenuKeys() const;
```

### <a name="return-value"></a>返回值

与功能区元素关联的菜单键提示。

### <a name="remarks"></a>备注

调用时，菜单键提示将显示一个弹出式菜单。

## <a name="cmfcribbonbaseelementgetnotifyid"></a><a name="getnotifyid"></a>CMFC 功能基础元素：获取NotifyID

检索功能区元素的通知命令 ID。

```
virtual UINT GetNotifyID();
```

### <a name="return-value"></a>返回值

通知命令 ID。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetoriginal"></a><a name="getoriginal"></a>CMFC功能基础元素：获取原始元素

检索原始功能区元素。

```
CMFCRibbonBaseElement* GetOriginal() const;
```

### <a name="return-value"></a>返回值

指向原始功能区元素的指针。

### <a name="remarks"></a>备注

复制到另一个容器的功能区元素将保留指向原始功能区元素的指针。

## <a name="cmfcribbonbaseelementgetparentcategory"></a><a name="getparentcategory"></a>CMFC 功能基础元素：获取父项

检索功能区元素的功能区类别。

```
CMFCRibbonCategory* GetParentCategory() const;
```

### <a name="return-value"></a>返回值

指向功能区类别的指针。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetparentpanel"></a><a name="getparentpanel"></a>CMFC 功能基础元素：获取家长面板

检索包含功能区元素的功能区面板。

```
virtual CMFCRibbonPanel* GetParentPanel() const;
```

### <a name="return-value"></a>返回值

指向包含功能区元素的功能区面板的指针。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetparentribbonbar"></a><a name="getparentribbonbar"></a>CMFC 功能基础元素：获取父功能栏

检索功能区元素的父功能区栏。

```
CMFCRibbonBar* GetParentRibbonBar() const;
```

### <a name="return-value"></a>返回值

指向功能区元素的父功能区栏的指针。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetparentwnd"></a><a name="getparentwnd"></a>CMFC 功能基础元素：获取家长

检索功能区元素的父窗口。

```
virtual CWnd* GetParentWnd() const;
```

### <a name="return-value"></a>返回值

如果方法成功，则指向功能区元素的父窗口的指针;否则，NULL。

### <a name="remarks"></a>备注

功能区元素的父窗口是[CMFC 功能区栏类](../../mfc/reference/cmfcribbonbar-class.md)或[CMFCRibbonPanelMenuBar](internal-classes.md)。

## <a name="cmfcribbonbaseelementgetpressed"></a><a name="getpressed"></a>CMFC 功能基础元素：：获取压榨

如果用户当前按下功能区元素，则检索指向功能区元素的指针。

```
virtual CMFCRibbonBaseElement* GetPressed();
```

### <a name="return-value"></a>返回值

如果用户当前按下功能区元素，则指向功能区元素的指针;否则，NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetquickaccesstoolbarid"></a><a name="getquickaccesstoolbarid"></a>CMFC 功能基础元素：获取快速访问工具Barid

在功能区元素位于快速访问工具栏中时检索其命令 ID。

```
virtual UINT GetQuickAccessToolBarID() const;
```

### <a name="return-value"></a>返回值

功能区元素位于快速访问工具栏中时的命令 ID。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetrect"></a><a name="getrect"></a>CMFC 功能基础元素：：获取 Rect

返回功能区元素的边界矩形。

```
CRect GetRect() const;
```

### <a name="return-value"></a>返回值

功能区元素的边界矩形。 矩形的位置位于父功能区控件的坐标中。

## <a name="cmfcribbonbaseelementgetregularsize"></a><a name="getregularsize"></a>CMFC 功能基础元素：获取常规大小

返回功能区元素的常规大小。

```
virtual CSize GetRegularSize(CDC* pDC) = 0;
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

### <a name="return-value"></a>返回值

功能区元素的常规大小。

### <a name="remarks"></a>备注

> [!NOTE]
> 常规大小是功能区元素的最大可能大小。

## <a name="cmfcribbonbaseelementgetsize"></a><a name="getsize"></a>CMFC 功能基础元素：获取大小

返回功能区元素的当前大小。

```
virtual CSize GetSize(CDC* pDC);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

### <a name="return-value"></a>返回值

功能区元素的当前大小。

## <a name="cmfcribbonbaseelementgettext"></a><a name="gettext"></a>CMFC 功能基础元素：获取文本

返回与功能区元素关联的文本。

```
LPCTSTR GetText() const;
```

### <a name="return-value"></a>返回值

与功能区元素关联的文本。

## <a name="cmfcribbonbaseelementgettooltiptext"></a><a name="gettooltiptext"></a>CMFC 功能基础元素：：获取工具提示文本

返回功能区元素的工具提示文本。

```
virtual CString GetToolTipText() const;
```

### <a name="return-value"></a>返回值

功能区元素的工具提示文本。

## <a name="cmfcribbonbaseelementgettoplevelribbonbar"></a><a name="gettoplevelribbonbar"></a>CMFC 功能基础元素：获取顶级功能区栏

检索功能区元素的顶层功能区栏。

```
CMFCRibbonBar* GetTopLevelRibbonBar() const;
```

### <a name="return-value"></a>返回值

如果方法成功，则指向功能区元素的顶层功能区栏的指针;否则，NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementhascompactmode"></a><a name="hascompactmode"></a>CMFC 功能基础元素：：具有压缩模式

指定功能区元素是否有压缩模式。

```
virtual BOOL HasCompactMode() const;
```

### <a name="return-value"></a>返回值

如果功能区元素具有紧凑模式，则为 TRUE。 否则。

### <a name="remarks"></a>备注

> [!NOTE]
> 在紧凑模式下，元素仅显示小图像。

## <a name="cmfcribbonbaseelementhasintermediatemode"></a><a name="hasintermediatemode"></a>CMFC功能基础元素：：具有中间模式

指定功能区元素是否有中间模式。

```
virtual BOOL HasIntermediateMode() const;
```

### <a name="return-value"></a>返回值

如果功能区元素具有中间模式，则为 TRUE，否则为 FALSE。 在中间模式中，元素在图像的右侧显示一个小图像和文本。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementhaslargemode"></a><a name="haslargemode"></a>CMFC功能基础元素：：具有大模式

确定功能区元素是否有大型模式。

```
virtual BOOL HasLargeMode() const;
```

### <a name="return-value"></a>返回值

如果功能区元素具有大模式，则为 TRUE。 否则。

### <a name="remarks"></a>备注

在大型模式下，元素可以获取父面板的完整高度。

## <a name="cmfcribbonbaseelementhasmenu"></a><a name="hasmenu"></a>CMFC功能基础元素：：哈斯梅因

指示功能区元素是否具有菜单。

```
virtual BOOL HasMenu() const;
```

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 FALSE。 在派生类中重写此方法以指示功能区元素是否具有菜单。

## <a name="cmfcribbonbaseelementhittest"></a><a name="hittest"></a>CMFC功能基础元素：hitTest

如果指定点位于其中，则检索指向功能区元素的指针。

```
virtual CMFCRibbonBaseElement* HitTest(CPoint point);
```

### <a name="parameters"></a>参数

*点*<br/>
[在]不使用此参数。

### <a name="return-value"></a>返回值

指向功能区元素的指针（如果存在）;否则 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回指向功能区元素的有效指针（当它存在时）。 重写此方法以指示点是否驻留在功能区元素中。

## <a name="cmfcribbonbaseelementisalignbycolumn"></a><a name="isalignbycolumn"></a>CMFC 功能基础元素：：正对齐比列

指示功能区元素是否与其他功能区元素垂直对齐。

```
virtual BOOL IsAlignByColumn() const;
```

### <a name="return-value"></a>返回值

始终返回 TRUE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 TRUE。 在派生类中重写此方法，以指示派生的功能区元素是否与其他功能区元素垂直对齐。

## <a name="cmfcribbonbaseelementisalwayslargeimage"></a><a name="isalwayslargeimage"></a>CMFC 功能基础元素：：始终较大的图像

指示功能区元素图像大小是否始终较大。

```
virtual BOOL IsAlwaysLargeImage() const;
```

### <a name="return-value"></a>返回值

如果功能区元素图像大小始终较大，则为 TRUE;如果功能区元素图像大小始终较大，则为 TRUE。否则 FALSE。

### <a name="remarks"></a>备注

大图像大小为 32 x 32 像素。

## <a name="cmfcribbonbaseelementisautorepeatmode"></a><a name="isautorepeatmode"></a>CMFC 功能基础元素：：自动重复模式

指示功能区元素是否处于自动重复模式。

```
virtual BOOL IsAutoRepeatMode(int& nDelay) const;
```

### <a name="parameters"></a>参数

*nDelay*<br/>
[在]不使用此参数。

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 FALSE。 重写此方法以指示功能区元素是否处于自动重复模式。

在自动重复模式下，功能区元素以设定的间隔（以毫秒为单位）响应持续用户输入。

## <a name="cmfcribbonbaseelementischecked"></a><a name="ischecked"></a>CMFC 功能基础元素：：已选中

指定是否选中功能区元素。

```
virtual BOOL IsChecked() const;
```

### <a name="return-value"></a>返回值

如果选中功能区元素，则为 TRUE;如果已检查功能区元素，则为 TRUE。否则 FALSE。

## <a name="cmfcribbonbaseelementiscompactmode"></a><a name="iscompactmode"></a>CMFC 功能基础元素：：压缩模式

指定功能区元素是否处于紧凑模式。

```
BOOL IsCompactMode() const;
```

### <a name="return-value"></a>返回值

如果功能区元素处于紧凑模式，则为 TRUE;如果功能区元素处于紧凑模式。否则 FALSE。

## <a name="cmfcribbonbaseelementisdefaultmenulook"></a><a name="isdefaultmenulook"></a>CMFC 功能基础元素：：默认菜单查看

指示功能区元素是否设置为显示为弹出命令。

```
BOOL IsDefaultMenuLook() const;
```

### <a name="return-value"></a>返回值

如果功能区元素设置为显示为弹出命令，则为 TRUE;如果功能区元素设置为弹出命令，则为 TRUE。否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementisdisabled"></a><a name="isdisabled"></a>CMFC 功能基础元素：：已禁用

指定功能区元素是否禁用。

```
virtual BOOL IsDisabled() const;
```

### <a name="return-value"></a>返回值

如果功能区元素已禁用，则为 TRUE;如果功能区元素已禁用，则为 TRUE。否则 FALSE。

## <a name="cmfcribbonbaseelementisdroppeddown"></a><a name="isdroppeddown"></a>CMFC 功能基础元素：：已丢弃

指定功能区元素是否显示弹出式菜单并下拉。

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>返回值

如果功能区元素向下下降并显示弹出菜单，则为 TRUE;否则 FALSE。

## <a name="cmfcribbonbaseelementisfocused"></a><a name="isfocused"></a>CMFC 功能基础元素：：聚焦

指定功能区元素是否具有焦点。

```
virtual BOOL IsFocused() const;
```

### <a name="return-value"></a>返回值

如果功能区元素具有焦点，则为 TRUE;否则 FALSE。

## <a name="cmfcribbonbaseelementisgalleryicon"></a><a name="isgalleryicon"></a>CMFC功能基础元素：：IsgalleryIcon

指示功能区元素是否包含在功能区库中。

```
virtual BOOL IsGalleryIcon() const;
```

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 FALSE。 在派生类中重写此方法，以指示功能区元素是否包含在功能区库中。

## <a name="cmfcribbonbaseelementishighlighted"></a><a name="ishighlighted"></a>CMFC 功能基础元素：：已突出显示

指定功能区元素是否突出显示。

```
virtual BOOL IsHighlighted() const;
```

### <a name="return-value"></a>返回值

如果功能区元素突出显示，则为 TRUE;如果功能区元素突出显示，则为 TRUE。否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementisintermediatemode"></a><a name="isintermediatemode"></a>CMFC 功能基础元素：：中间模式

指示功能区元素的当前图像是否为中间大小。

```
BOOL IsIntermediateMode() const;
```

### <a name="return-value"></a>返回值

如果功能区元素的图像为中间大小，则为 TRUE;如果功能区元素的图像为中间大小，则为 TRUE。否则 FALSE。

### <a name="remarks"></a>备注

中间图像大小为 16 x 16 像素。

## <a name="cmfcribbonbaseelementislargemode"></a><a name="islargemode"></a>CMFC 功能基础元素：：是大模式

指示功能区元素的当前图像是否大。

```
BOOL IsLargeMode() const;
```

### <a name="return-value"></a>返回值

如果功能区元素的图像大小较大，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

大图像大小为 32 x 32 像素。

## <a name="cmfcribbonbaseelementismenumode"></a><a name="ismenumode"></a>CMFC功能基础元素：：即菜单模式

指示功能区元素是否包含在菜单中。

```
BOOL IsMenuMode() const;
```

### <a name="return-value"></a>返回值

如果功能区元素包含在菜单中，则为 TRUE;如果功能区元素包含在菜单中，则为 TRUE。否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementispressed"></a><a name="ispressed"></a>CMFC 功能基础元素：：按压

指示用户是否已单击功能区元素。

```
virtual BOOL IsPressed() const;
```

### <a name="return-value"></a>返回值

如果用户单击功能区元素，则为 TRUE;如果用户单击了功能区元素，则为 TRUE。否则 FALSE。

## <a name="cmfcribbonbaseelementisqatmode"></a><a name="isqatmode"></a>CMFC功能基础元素：isQAT模式

指示功能区元素是否包含在快速访问工具栏中。

```
BOOL IsQATMode() const;
```

### <a name="return-value"></a>返回值

如果功能区元素包含在快速访问工具栏中，则为 TRUE;如果功能区元素包含在快速访问工具栏中，则为 TRUE。否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementisseparator"></a><a name="isseparator"></a>CMFC功能基础元素：分离器

指示功能区元素是否为显示分隔符。

```
virtual BOOL IsSeparator() const;
```

### <a name="return-value"></a>返回值

如果功能区元素是显示分隔符，则为 TRUE;如果功能区元素是显示分隔符，则为 TRUE。否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementisshowgroupborder"></a><a name="isshowgroupborder"></a>CMFC 功能基础元素：：IsShowGroup边框

指示功能区元素是否包含在显示公共边框的组中。

```
BOOL IsShowGroupBorder() const;
```

### <a name="return-value"></a>返回值

如果功能区元素包含在显示公共边框的组中，则为 TRUE;如果功能区元素包含在显示公共边框的组中，则为 TRUE。否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementisshowtooltiponbottom"></a><a name="isshowtooltiponbottom"></a>CMFC 功能基础元素：：isShowTooltipon 底部

指示工具提示是否显示在功能区元素下。

```
virtual BOOL IsShowTooltipOnBottom() const;
```

### <a name="return-value"></a>返回值

如果工具提示显示在功能区元素下，则为 TRUE;如果工具提示显示在功能区元素下，则为 TRUE。如果工具提示显示在指针附近，则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementistabstop"></a><a name="istabstop"></a>CMFC 功能基础元素：：IsTabStop

指示是否可以使用键盘选择功能区元素。

```
virtual BOOL IsTabStop() const;
```

### <a name="return-value"></a>返回值

始终返回 TRUE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 TRUE。 重写此方法以指示是否可以使用键盘选择功能区元素。

## <a name="cmfcribbonbaseelementistextalwaysonright"></a><a name="istextalwaysonright"></a>CMFC 功能基础元素：：文本始终正确

指示功能区元素的文本是否显示在右侧。

```
BOOL IsTextAlwaysOnRight() const;
```

### <a name="return-value"></a>返回值

如果功能区元素的文本显示在右侧，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementisvisible"></a><a name="isvisible"></a>CMFC 功能基础元素：可见

指示功能区元素当前是否显示。

```
BOOL IsVisible() const;
```

### <a name="return-value"></a>返回值

如果功能区元素当前显示为 TRUE;如果功能区元素当前显示，则为 TRUE。否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementiswholerowheight"></a><a name="iswholerowheight"></a>CMFC 功能基础元素：：完整罗高

指示功能区元素的显示高度是否与包含功能区面板的显示高度相同。

```
virtual BOOL IsWholeRowHeight() const;
```

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 FALSE。 重写此方法以指示功能区元素的显示高度是否与包含功能区面板的显示高度相同。

## <a name="cmfcribbonbaseelementnotifycommand"></a><a name="notifycommand"></a>CMFC 功能基础元素：：通知命令

向功能区元素的父窗口发送命令通知。

```
BOOL NotifyCommand(BOOL bWithDelay = FALSE);
```

### <a name="parameters"></a>参数

*b 延迟*<br/>
[在]TRUE 将命令通知添加到父窗口的消息队列;FALSE 立即将消息发送到父窗口。

### <a name="return-value"></a>返回值

如果消息已发送，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementnotifyhighlightlistitem"></a><a name="notifyhighlightlistitem"></a>CMFC 功能基础元素：：通知突出显示列表项

当用户突出显示位于列表中的功能区元素时，通知功能区栏的父窗口。

```
virtual void NotifyHighlightListItem(int nIndex);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]列表中功能区元素的索引。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementonaddtoqatoolbar"></a><a name="onaddtoqatoolbar"></a>CMFC功能基础元素：：在ADDtoQA工具栏上

将功能区元素添加到指定的快速访问工具栏。

```
virtual BOOL OnAddToQAToolbar(CMFCRibbonQuickAccessToolBar& qat);
```

### <a name="parameters"></a>参数

*qat*<br/>
[在]快速访问工具栏。

### <a name="return-value"></a>返回值

始终返回 TRUE，指示功能区元素已添加到快速访问工具栏。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementonafterchangerect"></a><a name="onafterchangerect"></a>CMFC 功能基础元素：：在转换后

更新功能区元素的工具提示。

```
virtual void OnAfterChangeRect(CDC* pDC);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]不使用此参数。

### <a name="remarks"></a>备注

默认情况下，此方法更新功能区元素的工具提示。 重写此方法，以在功能区元素的显示矩形更改后更新其功能区元素。

## <a name="cmfcribbonbaseelementonautorepeat"></a><a name="onautorepeat"></a>CMFC功能基础元素：：自动重复

更新功能区元素以响应持续的用户输入。

```
virtual BOOL OnAutoRepeat();
```

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 FALSE。 重写此方法以处理持续的用户输入。

## <a name="cmfcribbonbaseelementoncalctextsize"></a><a name="oncalctextsize"></a>CMFC 功能基础元素：：在文本大小上

计算功能区元素的文本大小。

```
virtual void OnCalcTextSize(CDC* pDC);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]不使用此参数。

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。 重写此方法以计算功能区元素的文本大小。

## <a name="cmfcribbonbaseelementonchangemenuhighlight"></a><a name="onchangemenuhighlight"></a>CMFC 功能基础元素：：在更改菜单高亮显示

当突出显示更改位于菜单中的功能区元素时，由框架调用。

```
virtual void OnChangeMenuHighlight(CMFCRibbonPanelMenuBar* pPanelMenuBar
    CMFCRibbonBaseElement* pHot);
```

### <a name="parameters"></a>参数

*pPanelMenuBar*<br/>
[在]不使用此参数。

*pHot*<br/>
[在]不使用此参数。

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。 重写此方法以在突出显示更改时更新位于菜单中的功能区元素。

## <a name="cmfcribbonbaseelementondraw"></a><a name="ondraw"></a>CMFC 功能基础元素：：开拉

由框架调用以绘制功能区元素。

```
virtual void OnDraw(CDC* pDC) = 0;
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

### <a name="remarks"></a>备注

如果要自定义特定功能区元素的图形，请在派生类中重写此方法。

## <a name="cmfcribbonbaseelementondrawkeytip"></a><a name="ondrawkeytip"></a>CMFC 功能基础元素：：绘制键提示

由框架调用以绘制功能区元素的键尖。

```
virtual void OnDrawKeyTip(
    CDC* pDC,
    const CRect& rect,
    BOOL bIsMenu);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

*矩形*<br/>
[在]键尖的边界矩形。

*bIsMenu*<br/>
[在]如果键尖是用于弹出式菜单按钮的，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementondrawmenuimage"></a><a name="ondrawmenuimage"></a>CMFC功能基础元素：：在绘制菜单图像

绘制功能区元素的菜单图像时由框架调用。

```
virtual BOOL OnDrawMenuImage(
    CDC* pDC,
    CRect rect);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

*矩形*<br/>
[在]菜单图像矩形。

### <a name="return-value"></a>返回值

始终返回 TRUE 以指示已绘制图像。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementondrawonlist"></a><a name="ondrawonlist"></a>CMFC功能基础元素：在画上列表

由框架调用以在命令列表框中绘制功能区元素。

```
virtual void OnDrawOnList(
    CDC* pDC,
    CString strText,
    int nTextOffset,
    CRect rect,
    BOOL bIsSelected,
    BOOL bHighlighted);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向功能区元素的设备上下文。

*斯特文本*<br/>
[在]显示文本。

*n文本偏移*<br/>
[在]从列表框左侧到显示文本的距离（以像素为单位）。

*矩形*<br/>
[在]功能区元素的显示矩形。

*bIs选择*<br/>
[在]不使用此参数。

*b 突出显示*<br/>
[在]不使用此参数。

### <a name="remarks"></a>备注

命令列表框显示功能区元素，使用户能够自定义快速访问工具栏。

## <a name="cmfcribbonbaseelementonkey"></a><a name="onkey"></a>CMFC功能基础元素：：在键上

当用户按下键尖并且功能区元素具有焦点时，由框架调用。

```
virtual BOOL OnKey(BOOL bIsMenuKey);
```

### <a name="parameters"></a>参数

*bIsMenu键*<br/>
[在]如果钥匙提示显示弹出式菜单，则为 TRUE;否则，FALSE。

### <a name="return-value"></a>返回值

如果事件已处理，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementonmenukey"></a><a name="onmenukey"></a>CMFC功能基础元素：：上菜单键

当用户按下主面板上的菜单键提示时，由框架调用。

```
virtual BOOL OnMenuKey(UINT nUpperChar);
```

### <a name="parameters"></a>参数

*n 上沙尔*<br/>
[在]不使用此参数。

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 FALSE。 重写此方法，当用户按下主面板上的菜单键提示时做出响应。

## <a name="cmfcribbonbaseelementonprocesskey"></a><a name="onprocesskey"></a>CMFC 功能基础元素：：在进程键上

当用户按下快捷键时，由框架调用。

```
virtual BOOL OnProcessKey(UINT nChar);
```

### <a name="parameters"></a>参数

*n查尔*<br/>
[在]不使用此参数。

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

如果希望功能区元素处理快捷键，则重写此方法。

## <a name="cmfcribbonbaseelementonrtlchanged"></a><a name="onrtlchanged"></a>CMFC 功能基础元素：：在RTL改变

当布局更改方向时由框架调用。

```
virtual void OnRTLChanged(BOOL bIsRTL);
```

### <a name="parameters"></a>参数

*比塞尔*<br/>
[在]不使用此参数。

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。 重写此方法，在布局更改方向时调整功能区元素。 默认布局方向从左到右。

## <a name="cmfcribbonbaseelementonsetfocus"></a><a name="onsetfocus"></a>CMFC 功能基础元素：：上集焦点

当功能区元素接收或丢失输入焦点时，由框架调用。

```
virtual void OnSetFocus(BOOL B);
```

### <a name="remarks"></a>备注

如果希望应用程序处理功能区元素焦点中的更改，请覆盖派生类中的此方法。

## <a name="cmfcribbonbaseelementonshow"></a><a name="onshow"></a>CMFC 功能基础元素：：上展

由框架调用以显示或隐藏功能区元素。

```
virtual void OnShow(BOOL bShow);
```

### <a name="parameters"></a>参数

*b显示*<br/>
[在]不使用此参数。

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。 重写此方法以显示或隐藏功能区元素。

## <a name="cmfcribbonbaseelementonshowpopupmenu"></a><a name="onshowpopupmenu"></a>CMFC功能基础元素：：在显示弹出菜单

在功能区元素显示弹出式菜单之前由框架调用。

```
virtual void OnShowPopupMenu();
```

### <a name="remarks"></a>备注

此方法通知功能区栏的父窗口功能区元素将显示一个弹出式菜单。

## <a name="cmfcribbonbaseelementpostmenucommand"></a><a name="postmenucommand"></a>CMFC功能基础元素：:P奥斯特库梅命令

关闭功能区元素的弹出菜单，并向父菜单发送一条近消息。

```
void PostMenuCommand(UINT uiCmdId);
```

### <a name="parameters"></a>参数

*乌伊CmDId*<br/>
[在]不使用该参数。

### <a name="remarks"></a>备注

仅当功能区元素位于弹出菜单上时，才会发送关闭消息。

## <a name="cmfcribbonbaseelementredraw"></a><a name="redraw"></a>CMFC 功能基础元素：：重绘

更新功能区元素的显示。

```
virtual void Redraw();
```

### <a name="remarks"></a>备注

此方法通过调用[CWnd：：redrawWindow](/windows/win32/api/winuser/nf-winuser-redrawwindow)并设置RDW_INVALIDATE、RDW_ERASE和RDW_UPDATENOW标志来重绘功能区元素的显示矩形。

## <a name="cmfcribbonbaseelementsetaccdata"></a><a name="setaccdata"></a>CMFC 功能基础元素：：设置ACC数据

设置功能区元素的可访问性数据。

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>参数

*p 父级*<br/>
功能区元素的父窗口。

*数据*<br/>
功能区元素的可访问性数据。

### <a name="return-value"></a>返回值

始终返回 TRUE。

### <a name="remarks"></a>备注

默认情况下，此方法设置功能区元素的辅助功能数据，并始终返回 TRUE。 重写此方法以设置可访问性数据并返回一个指示成功或失败的值。

## <a name="cmfcribbonbaseelementsetcompactmode"></a><a name="setcompactmode"></a>CMFC 功能基础元素：：设置压缩模式

设置功能区元素的显示大小。

```
virtual void SetCompactMode(BOOL bCompactMode = TRUE);
```

### <a name="parameters"></a>参数

*b压缩模式*<br/>
[在]TRUE 以减小功能区元素的显示大小;FALSE 可增加功能区元素的显示大小。

### <a name="remarks"></a>备注

下表总结了此方法的逻辑。

|*b压缩模式*|当前功能区元素大小|新的功能区元素大小|
|--------------------|---------------------------------|-----------------------------|
|TRUE|精简|无更改。|
|TRUE|中级|如果可能，则紧凑。|
|TRUE|大型|如果可能，则中间。|
|FALSE|精简|如果可能，中间;否则大。|

## <a name="cmfcribbonbaseelementsetdata"></a><a name="setdata"></a>CMFC 功能基础元素：：集数据

将数据项与功能区元素关联。

```
void SetData(DWORD_PTR dwData);
```

### <a name="parameters"></a>参数

*dwData*<br/>
[在]数据值。

## <a name="cmfcribbonbaseelementsetdefaultmenulook"></a><a name="setdefaultmenulook"></a>CMFC 功能基础元素：：设置默认菜单查看

将功能区元素设为弹出命令。

```
void SetDefaultMenuLook(BOOL bIsDefaultMenuLook = TRUE);
```

### <a name="parameters"></a>参数

*bIsdefaultMenuLook*<br/>
[在]TRUE 将功能区元素设置为显示为弹出命令;如果为"真"，则设置为"TRUE"，将功能区元素设置为弹出命令。否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementsetdescription"></a><a name="setdescription"></a>CMFC 功能基础元素：：设置描述

设置功能区元素的说明。

```
virtual void SetDescription(LPCTSTR lpszText);
```

### <a name="parameters"></a>参数

*lpszText*<br/>
[在]功能区元素的说明。

### <a name="remarks"></a>备注

框架在状态栏、工具提示或菜单按钮下显示新说明。

## <a name="cmfcribbonbaseelementsetid"></a><a name="setid"></a>CMFC 功能基础元素：：SetID

设置功能区元素的命令 ID。

```
virtual void SetID(UINT nID);
```

### <a name="parameters"></a>参数

*nID*<br/>
[在]命令 ID。

## <a name="cmfcribbonbaseelementsetinitialmode"></a><a name="setinitialmode"></a>CMFC 功能基础元素：：设置初始模式

设置功能区元素的初始显示大小。

```
virtual void SetInitialMode(BOOL bOneRow = FALSE);
```

### <a name="parameters"></a>参数

*bOneRow*<br/>
[在]TRUE 将功能区元素的显示大小限制为紧凑或中间;否则，FALSE。

### <a name="remarks"></a>备注

功能区元素的显示大小可以是紧凑、中间或大。

## <a name="cmfcribbonbaseelementsetkeys"></a><a name="setkeys"></a>CMFC 功能基础元素：：设置键

设置功能区元素的键提示。

```
virtual void SetKeys(
    LPCTSTR lpszKeys,
    LPCTSTR lpszMenuKeys=NULL);
```

### <a name="parameters"></a>参数

*lpszKeys*<br/>
[在]功能区元素的键尖。

*lpszMenuKeys*<br/>
[在]功能区元素的弹出菜单的键尖。

## <a name="cmfcribbonbaseelementsetoriginal"></a><a name="setoriginal"></a>CMFC 功能基础元素：：设置原始

设置功能区元素的原始功能区元素。

```
virtual void SetOriginal(CMFCRibbonBaseElement* pOriginal);
```

### <a name="parameters"></a>参数

*p原始*<br/>
[在]指向功能区元素的指针。

### <a name="remarks"></a>备注

复制到另一个容器的功能区元素将保留指向原始功能区元素的指针。

## <a name="cmfcribbonbaseelementsetparentcategory"></a><a name="setparentcategory"></a>CMFC 功能基础元素：：设置父项类别

设置功能区元素的父类别。

```
virtual void SetParentCategory(CMFCRibbonCategory* pParent);
```

### <a name="parameters"></a>参数

*p 父级*<br/>
[在]指向功能区类别的指针。

### <a name="remarks"></a>备注

功能区控件中的选项卡式组称为类别。

## <a name="cmfcribbonbaseelementsetparentmenu"></a><a name="setparentmenu"></a>CMFC 功能基础元素：：设置父菜单

设置功能区元素的父菜单容器。

```
virtual void SetParentMenu(CMFCRibbonPanelMenuBar* pMenuBar);
```

### <a name="parameters"></a>参数

*pMenuBar*<br/>
[在]父菜单。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementsetparentribbonbar"></a><a name="setparentribbonbar"></a>CMFC 功能基础元素：：设置父功能区栏

设置功能区元素的父功能区栏。

```
virtual void SetParentRibbonBar(CMFCRibbonBar* pRibbonBar);
```

### <a name="parameters"></a>参数

*pRibbonbar*<br/>
[在]指向父功能区栏。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementsetrect"></a><a name="setrect"></a>CMFC 功能基础元素：：设置 Rect

设置功能区元素的显示矩形的尺寸。

```
void SetRect(CRect rect);
```

### <a name="parameters"></a>参数

*矩形*<br/>
[在]矩形的尺寸。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementsettext"></a><a name="settext"></a>CMFC 功能基础元素：：设置文本

设置功能区元素的文本和键尖。

```
virtual void SetText(LPCTSTR lpszText);
```

### <a name="parameters"></a>参数

*lpszText*<br/>
[在]功能区元素的文本和键尖。

### <a name="remarks"></a>备注

要设置功能区元素的键尖，将换行符转义序列后跟键尖字符添加到*lpszText*。

### <a name="example"></a>示例

```
//Set the text for the ribbon element
SetText(_T("Margins"))
//Set the text and a single-letter keytip
SetText(_T("Margins\nm"))
//Set the text and a multiple-letter keytip
SetText(_T("Line Numbers\nln"))
```

## <a name="cmfcribbonbaseelementsettextalwaysonright"></a><a name="settextalwaysonright"></a>CMFC 功能基础元素：：设置文本始终正确

设置功能区元素的文本，以便显示在右侧。

```
virtual void SetTextAlwaysOnRight(BOOL bSet = TRUE);
```

### <a name="parameters"></a>参数

*bSet*<br/>
[在]TRUE 显示右侧的文本;否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementsettooltiptext"></a><a name="settooltiptext"></a>CMFC 功能基础元素：：设置工具提示文本

设置功能区元素的工具提示文本。

```
virtual void SetToolTipText(LPCTSTR lpszText);
```

### <a name="parameters"></a>参数

*lpszText*<br/>
[在]工具提示文本。

## <a name="cmfcribbonbaseelementsetvisible"></a><a name="setvisible"></a>CMFC 功能基础元素：：设置可见

设置功能区元素的可见性。

```
void SetVisible(BOOL bIsVisible);
```

### <a name="parameters"></a>参数

*b可见*<br/>
[在]TRUE 以显示功能区元素;FALSE 以隐藏功能区元素。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementstretchhorizontally"></a><a name="stretchhorizontally"></a>CMFC 功能基础元素：：水平拉伸

拉伸功能区元素的宽度。

```
virtual void StretchHorizontally();
```

### <a name="remarks"></a>备注

默认情况下，此方法在调试生成中生成断言失败，因此不应调用。 重写此方法以拉伸功能区元素的宽度。

## <a name="cmfcribbonbaseelementstretchtowholerow"></a><a name="stretchtowholerow"></a>CMFC 功能基础元素：：拉伸到整体行

将功能区元素的显示高度更改为指定的行高度。

```
virtual BOOL StretchToWholeRow(
    CDC* pDC,
    int nHeight);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]不使用此参数。

*nHeight*<br/>
[在]行的高度。

### <a name="return-value"></a>返回值

如果已设置显示高度，则为 TRUE;如果已设置显示高度，则为 TRUE。否则，FALSE。

### <a name="remarks"></a>备注

重写此方法可将功能区元素的显示高度更改为指定的行高度。

## <a name="cmfcribbonbaseelementupdatetooltipinfo"></a><a name="updatetooltipinfo"></a>CMFC 功能基础元素：：更新工具提示信息

使用功能区元素的命令资源更新工具提示文本。

```
virtual void UpdateTooltipInfo();
```

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementhasfocus"></a><a name="hasfocus"></a>CMFC 功能基础元素：：有焦点

指示父元素是否具有键盘焦点。

```
virtual BOOL HasFocus() const;
```

### <a name="return-value"></a>返回值

如果功能区元素是焦点，则为 TRUE;如果功能区元素是焦点的，则为 TRUE。否则 FALSE。

### <a name="remarks"></a>备注

## <a name="see-also"></a>另请参阅

[层次结构图表](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)

---
title: CMFCToolBar 类
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBar
- AFXTOOLBAR/CMFCToolBar
- AFXTOOLBAR/CMFCToolBar::AddBasicCommand
- AFXTOOLBAR/CMFCToolBar::AddCommandUsage
- AFXTOOLBAR/CMFCToolBar::AddToolBarForImageCollection
- AFXTOOLBAR/CMFCToolBar::AdjustLayout
- AFXTOOLBAR/CMFCToolBar::AdjustSize
- AFXTOOLBAR/CMFCToolBar::AllowChangeTextLabels
- AFXTOOLBAR/CMFCToolBar::AreTextLabels
- AFXTOOLBAR/CMFCToolBar::AutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::ButtonToIndex
- AFXTOOLBAR/CMFCToolBar::CalcFixedLayout
- AFXTOOLBAR/CMFCToolBar::CalcSize
- AFXTOOLBAR/CMFCToolBar::CanHandleSiblings
- AFXTOOLBAR/CMFCToolBar::CleanUpImages
- AFXTOOLBAR/CMFCToolBar::CleanUpLockedImages
- AFXTOOLBAR/CMFCToolBar::CanBeClosed
- AFXTOOLBAR/CMFCToolBar::CanBeRestored
- AFXTOOLBAR/CMFCToolBar::CanFocus
- AFXTOOLBAR/CMFCToolBar::CommandToIndex
- AFXTOOLBAR/CMFCToolBar::Create
- AFXTOOLBAR/CMFCToolBar::CreateEx
- AFXTOOLBAR/CMFCToolBar::Deactivate
- AFXTOOLBAR/CMFCToolBar::EnableCustomizeButton
- AFXTOOLBAR/CMFCToolBar::EnableDocking
- AFXTOOLBAR/CMFCToolBar::EnableLargeIcons
- AFXTOOLBAR/CMFCToolBar::EnableQuickCustomization
- AFXTOOLBAR/CMFCToolBar::EnableReflections
- AFXTOOLBAR/CMFCToolBar::EnableTextLabels
- AFXTOOLBAR/CMFCToolBar::FromHandlePermanent
- AFXTOOLBAR/CMFCToolBar::GetAllButtons
- AFXTOOLBAR/CMFCToolBar::GetAllToolbars
- AFXTOOLBAR/CMFCToolBar::GetBasicCommands
- AFXTOOLBAR/CMFCToolBar::GetButton
- AFXTOOLBAR/CMFCToolBar::GetButtonInfo
- AFXTOOLBAR/CMFCToolBar::GetButtonSize
- AFXTOOLBAR/CMFCToolBar::GetButtonStyle
- AFXTOOLBAR/CMFCToolBar::GetButtonText
- AFXTOOLBAR/CMFCToolBar::GetColdImages
- AFXTOOLBAR/CMFCToolBar::GetColumnWidth
- AFXTOOLBAR/CMFCToolBar::GetCommandButtons
- AFXTOOLBAR/CMFCToolBar::GetCount
- AFXTOOLBAR/CMFCToolBar::GetCustomizeButton
- AFXTOOLBAR/CMFCToolBar::GetDefaultImage
- AFXTOOLBAR/CMFCToolBar::GetDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetDisabledMenuImages
- AFXTOOLBAR/CMFCToolBar::GetDroppedDownMenu
- AFXTOOLBAR/CMFCToolBar::GetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::GetHighlightedButton
- AFXTOOLBAR/CMFCToolBar::GetHotBorder
- AFXTOOLBAR/CMFCToolBar::GetHotTextColor
- AFXTOOLBAR/CMFCToolBar::GetHwndLastFocus
- AFXTOOLBAR/CMFCToolBar::GetOVERWRITESetText
- AFXTOOLBAR/CMFCToolBar::GetImageSize
- AFXTOOLBAR/CMFCToolBar::GetImages
- AFXTOOLBAR/CMFCToolBar::GetImagesOffset
- AFXTOOLBAR/CMFCToolBar::GetInvalidateItemRect
- AFXTOOLBAR/CMFCToolBar::GetItemID
- AFXTOOLBAR/CMFCToolBar::GetItemRect
- AFXTOOLBAR/CMFCToolBar::GetLargeColdImages
- AFXTOOLBAR/CMFCToolBar::GetLargeDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLargeImages
- AFXTOOLBAR/CMFCToolBar::GetLockedColdImages
- AFXTOOLBAR/CMFCToolBar::GetLockedDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImageSize
- AFXTOOLBAR/CMFCToolBar::GetLockedMenuImages
- AFXTOOLBAR/CMFCToolBar::GetMenuButtonSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImageSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImages
- AFXTOOLBAR/CMFCToolBar::GetOrigButtons
- AFXTOOLBAR/CMFCToolBar::GetOrigResetButtons
- AFXTOOLBAR/CMFCToolBar::GetResourceID
- AFXTOOLBAR/CMFCToolBar::GetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::GetRowHeight
- AFXTOOLBAR/CMFCToolBar::GetShowTooltips
- AFXTOOLBAR/CMFCToolBar::GetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::GetUserImages
- AFXTOOLBAR/CMFCToolBar::HitTest
- AFXTOOLBAR/CMFCToolBar::InsertButton
- AFXTOOLBAR/CMFCToolBar::InsertSeparator
- AFXTOOLBAR/CMFCToolBar::InvalidateButton
- AFXTOOLBAR/CMFCToolBar::IsAddRemoveQuickCustomize
- AFXTOOLBAR/CMFCToolBar::IsAltCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsAutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::IsBasicCommand
- AFXTOOLBAR/CMFCToolBar::IsButtonExtraSizeAvailable
- AFXTOOLBAR/CMFCToolBar::IsButtonHighlighted
- AFXTOOLBAR/CMFCToolBar::IsCommandPermitted
- AFXTOOLBAR/CMFCToolBar::IsCommandRarelyUsed
- AFXTOOLBAR/CMFCToolBar::IsCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsDragButton
- AFXTOOLBAR/CMFCToolBar::IsExistCustomizeButton
- AFXTOOLBAR/CMFCToolBar::IsFloating
- AFXTOOLBAR/CMFCToolBar::IsLargeIcons
- AFXTOOLBAR/CMFCToolBar::IsLastCommandFromButton
- AFXTOOLBAR/CMFCToolBar::IsLocked
- AFXTOOLBAR/CMFCToolBar::IsOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::IsUserDefined
- AFXTOOLBAR/CMFCToolBar::LoadBitmap
- AFXTOOLBAR/CMFCToolBar::LoadBitmapEx
- AFXTOOLBAR/CMFCToolBar::LoadParameters
- AFXTOOLBAR/CMFCToolBar::LoadState
- AFXTOOLBAR/CMFCToolBar::LoadToolBar
- AFXTOOLBAR/CMFCToolBar::LoadToolBarEx
- AFXTOOLBAR/CMFCToolBar::OnChangeHot
- AFXTOOLBAR/CMFCToolBar::OnFillBackground
- AFXTOOLBAR/CMFCToolBar::OnReset
- AFXTOOLBAR/CMFCToolBar::OnSetAccData
- AFXTOOLBAR/CMFCToolBar::OnSetDefaultButtonText
- AFXTOOLBAR/CMFCToolBar::RemoveAllButtons
- AFXTOOLBAR/CMFCToolBar::RemoveButton
- AFXTOOLBAR/CMFCToolBar::RemoveStateFromRegistry
- AFXTOOLBAR/CMFCToolBar::ReplaceButton
- AFXTOOLBAR/CMFCToolBar::ResetAll
- AFXTOOLBAR/CMFCToolBar::ResetAllImages
- AFXTOOLBAR/CMFCToolBar::RestoreOriginalState
- AFXTOOLBAR/CMFCToolBar::SaveState
- AFXTOOLBAR/CMFCToolBar::SetBasicCommands
- AFXTOOLBAR/CMFCToolBar::SetButtonInfo
- AFXTOOLBAR/CMFCToolBar::SetButtonStyle
- AFXTOOLBAR/CMFCToolBar::SetButtonText
- AFXTOOLBAR/CMFCToolBar::SetButtons
- AFXTOOLBAR/CMFCToolBar::SetCommandUsageOptions
- AFXTOOLBAR/CMFCToolBar::SetCustomizeMode
- AFXTOOLBAR/CMFCToolBar::SetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::SetHeight
- AFXTOOLBAR/CMFCToolBar::SetHotBorder
- AFXTOOLBAR/CMFCToolBar::SetHotTextColor
- AFXTOOLBAR/CMFCToolBar::SetLargeIcons
- AFXTOOLBAR/CMFCToolBar::SetLockedSizes
- AFXTOOLBAR/CMFCToolBar::SetMenuSizes
- AFXTOOLBAR/CMFCToolBar::SetNonPermittedCommands
- AFXTOOLBAR/CMFCToolBar::SetOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::SetPermament
- AFXTOOLBAR/CMFCToolBar::SetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::SetShowTooltips
- AFXTOOLBAR/CMFCToolBar::SetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::SetSizes
- AFXTOOLBAR/CMFCToolBar::SetToolBarBtnText
- AFXTOOLBAR/CMFCToolBar::SetTwoRowsWithSibling
- AFXTOOLBAR/CMFCToolBar::SetUserImages
- AFXTOOLBAR/CMFCToolBar::StretchPane
- AFXTOOLBAR/CMFCToolBar::TranslateChar
- AFXTOOLBAR/CMFCToolBar::UpdateButton
- AFXTOOLBAR/CMFCToolBar::WrapToolBar
- AFXTOOLBAR/CMFCToolBar::AllowShowOnList
- AFXTOOLBAR/CMFCToolBar::CalcMaxButtonHeight
- AFXTOOLBAR/CMFCToolBar::DoPaint
- AFXTOOLBAR/CMFCToolBar::DrawButton
- AFXTOOLBAR/CMFCToolBar::DrawSeparator
- AFXTOOLBAR/CMFCToolBar::OnUserToolTip
- AFXTOOLBAR/CMFCToolBar::m_bDontScaleImages
- AFXTOOLBAR/CMFCToolBar::m_dblLargeImageRatio
helpviewer_keywords:
- CMFCToolBar [MFC], AddBasicCommand
- CMFCToolBar [MFC], AddCommandUsage
- CMFCToolBar [MFC], AddToolBarForImageCollection
- CMFCToolBar [MFC], AdjustLayout
- CMFCToolBar [MFC], AdjustSize
- CMFCToolBar [MFC], AllowChangeTextLabels
- CMFCToolBar [MFC], AreTextLabels
- CMFCToolBar [MFC], AutoGrayInactiveImages
- CMFCToolBar [MFC], ButtonToIndex
- CMFCToolBar [MFC], CalcFixedLayout
- CMFCToolBar [MFC], CalcSize
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CleanUpImages
- CMFCToolBar [MFC], CleanUpLockedImages
- CMFCToolBar [MFC], CanBeClosed
- CMFCToolBar [MFC], CanBeRestored
- CMFCToolBar [MFC], CanFocus
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CommandToIndex
- CMFCToolBar [MFC], Create
- CMFCToolBar [MFC], CreateEx
- CMFCToolBar [MFC], Deactivate
- CMFCToolBar [MFC], EnableCustomizeButton
- CMFCToolBar [MFC], EnableDocking
- CMFCToolBar [MFC], EnableLargeIcons
- CMFCToolBar [MFC], EnableQuickCustomization
- CMFCToolBar [MFC], EnableReflections
- CMFCToolBar [MFC], EnableTextLabels
- CMFCToolBar [MFC], FromHandlePermanent
- CMFCToolBar [MFC], GetAllButtons
- CMFCToolBar [MFC], GetAllToolbars
- CMFCToolBar [MFC], GetBasicCommands
- CMFCToolBar [MFC], GetButton
- CMFCToolBar [MFC], GetButtonInfo
- CMFCToolBar [MFC], GetButtonSize
- CMFCToolBar [MFC], GetButtonStyle
- CMFCToolBar [MFC], GetButtonText
- CMFCToolBar [MFC], GetColdImages
- CMFCToolBar [MFC], GetColumnWidth
- CMFCToolBar [MFC], GetCommandButtons
- CMFCToolBar [MFC], GetCount
- CMFCToolBar [MFC], GetCustomizeButton
- CMFCToolBar [MFC], GetDefaultImage
- CMFCToolBar [MFC], GetDisabledImages
- CMFCToolBar [MFC], GetDisabledMenuImages
- CMFCToolBar [MFC], GetDroppedDownMenu
- CMFCToolBar [MFC], GetGrayDisabledButtons
- CMFCToolBar [MFC], GetHighlightedButton
- CMFCToolBar [MFC], GetHotBorder
- CMFCToolBar [MFC], GetHotTextColor
- CMFCToolBar [MFC], GetHwndLastFocus
- CMFCToolBar [MFC], GetIgnoreSetText
- CMFCToolBar [MFC], GetImageSize
- CMFCToolBar [MFC], GetImages
- CMFCToolBar [MFC], GetImagesOffset
- CMFCToolBar [MFC], GetInvalidateItemRect
- CMFCToolBar [MFC], GetItemID
- CMFCToolBar [MFC], GetItemRect
- CMFCToolBar [MFC], GetLargeColdImages
- CMFCToolBar [MFC], GetLargeDisabledImages
- CMFCToolBar [MFC], GetLargeImages
- CMFCToolBar [MFC], GetLockedColdImages
- CMFCToolBar [MFC], GetLockedDisabledImages
- CMFCToolBar [MFC], GetLockedImages
- CMFCToolBar [MFC], GetLockedImageSize
- CMFCToolBar [MFC], GetLockedMenuImages
- CMFCToolBar [MFC], GetMenuButtonSize
- CMFCToolBar [MFC], GetMenuImageSize
- CMFCToolBar [MFC], GetMenuImages
- CMFCToolBar [MFC], GetOrigButtons
- CMFCToolBar [MFC], GetOrigResetButtons
- CMFCToolBar [MFC], GetResourceID
- CMFCToolBar [MFC], GetRouteCommandsViaFrame
- CMFCToolBar [MFC], GetRowHeight
- CMFCToolBar [MFC], GetShowTooltips
- CMFCToolBar [MFC], GetSiblingToolBar
- CMFCToolBar [MFC], GetUserImages
- CMFCToolBar [MFC], HitTest
- CMFCToolBar [MFC], InsertButton
- CMFCToolBar [MFC], InsertSeparator
- CMFCToolBar [MFC], InvalidateButton
- CMFCToolBar [MFC], IsAddRemoveQuickCustomize
- CMFCToolBar [MFC], IsAltCustomizeMode
- CMFCToolBar [MFC], IsAutoGrayInactiveImages
- CMFCToolBar [MFC], IsBasicCommand
- CMFCToolBar [MFC], IsButtonExtraSizeAvailable
- CMFCToolBar [MFC], IsButtonHighlighted
- CMFCToolBar [MFC], IsCommandPermitted
- CMFCToolBar [MFC], IsCommandRarelyUsed
- CMFCToolBar [MFC], IsCustomizeMode
- CMFCToolBar [MFC], IsDragButton
- CMFCToolBar [MFC], IsExistCustomizeButton
- CMFCToolBar [MFC], IsFloating
- CMFCToolBar [MFC], IsLargeIcons
- CMFCToolBar [MFC], IsLastCommandFromButton
- CMFCToolBar [MFC], IsLocked
- CMFCToolBar [MFC], IsOneRowWithSibling
- CMFCToolBar [MFC], IsUserDefined
- CMFCToolBar [MFC], LoadBitmap
- CMFCToolBar [MFC], LoadBitmapEx
- CMFCToolBar [MFC], LoadParameters
- CMFCToolBar [MFC], LoadState
- CMFCToolBar [MFC], LoadToolBar
- CMFCToolBar [MFC], LoadToolBarEx
- CMFCToolBar [MFC], OnChangeHot
- CMFCToolBar [MFC], OnFillBackground
- CMFCToolBar [MFC], OnReset
- CMFCToolBar [MFC], OnSetAccData
- CMFCToolBar [MFC], OnSetDefaultButtonText
- CMFCToolBar [MFC], RemoveAllButtons
- CMFCToolBar [MFC], RemoveButton
- CMFCToolBar [MFC], RemoveStateFromRegistry
- CMFCToolBar [MFC], ReplaceButton
- CMFCToolBar [MFC], ResetAll
- CMFCToolBar [MFC], ResetAllImages
- CMFCToolBar [MFC], RestoreOriginalState
- CMFCToolBar [MFC], SaveState
- CMFCToolBar [MFC], SetBasicCommands
- CMFCToolBar [MFC], SetButtonInfo
- CMFCToolBar [MFC], SetButtonStyle
- CMFCToolBar [MFC], SetButtonText
- CMFCToolBar [MFC], SetButtons
- CMFCToolBar [MFC], SetCommandUsageOptions
- CMFCToolBar [MFC], SetCustomizeMode
- CMFCToolBar [MFC], SetGrayDisabledButtons
- CMFCToolBar [MFC], SetHeight
- CMFCToolBar [MFC], SetHotBorder
- CMFCToolBar [MFC], SetHotTextColor
- CMFCToolBar [MFC], SetLargeIcons
- CMFCToolBar [MFC], SetLockedSizes
- CMFCToolBar [MFC], SetMenuSizes
- CMFCToolBar [MFC], SetNonPermittedCommands
- CMFCToolBar [MFC], SetOneRowWithSibling
- CMFCToolBar [MFC], SetPermament
- CMFCToolBar [MFC], SetRouteCommandsViaFrame
- CMFCToolBar [MFC], SetShowTooltips
- CMFCToolBar [MFC], SetSiblingToolBar
- CMFCToolBar [MFC], SetSizes
- CMFCToolBar [MFC], SetToolBarBtnText
- CMFCToolBar [MFC], SetTwoRowsWithSibling
- CMFCToolBar [MFC], SetUserImages
- CMFCToolBar [MFC], StretchPane
- CMFCToolBar [MFC], TranslateChar
- CMFCToolBar [MFC], UpdateButton
- CMFCToolBar [MFC], WrapToolBar
- CMFCToolBar [MFC], AllowShowOnList
- CMFCToolBar [MFC], CalcMaxButtonHeight
- CMFCToolBar [MFC], DoPaint
- CMFCToolBar [MFC], DrawButton
- CMFCToolBar [MFC], DrawSeparator
- CMFCToolBar [MFC], OnUserToolTip
- CMFCToolBar [MFC], m_bDontScaleImages
- CMFCToolBar [MFC], m_dblLargeImageRatio
ms.assetid: e7679c01-fb94-44c0-98c6-3af955292fb5
ms.openlocfilehash: dc1a8b1fc852ff1071b20ced64fc8e0686725a83
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/14/2020
ms.locfileid: "81375077"
---
# <a name="cmfctoolbar-class"></a>CMFCToolBar 类

该`CMFCToolBar`类类似于[CToolBar 类](../../mfc/reference/ctoolbar-class.md)，但提供了用户界面功能的其他支持。 其中包括平面工具栏、有热图的工具栏、大图标、页导航按钮、锁定的工具栏、Rebar 控件、图像下的文本、背景图像和选项卡式工具栏。 `CMFCToolBar` 类还包含内置支持，用户可对工具栏和菜单、工具栏和菜单之间的拖放、组合框按钮、编辑框按钮、颜色选取器和汇总按钮进行自定义。

有关详细信息，请参阅位于 Visual Studio 安装的**VC\\\\atlmfc src\\mfc**文件夹中的源代码。

## <a name="syntax"></a>语法

```
class CMFCToolBar : public CMFCBaseToolBar
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|说明|
|----------|-----------------|
|`CMFCToolBar::CMFCToolBar`|默认构造函数。|
|`CMFCToolBar::~CMFCToolBar`|析构函数。|

### <a name="public-methods"></a>公共方法

|名称|说明|
|----------|-----------------|
|[CMFCToolbar：：添加基本命令](#addbasiccommand)|将菜单命令添加到用户打开菜单时始终显示的命令列表中。|
|[CMFC工具栏：添加命令用法](#addcommandusage)|增加与给定命令关联的计数器的一个。|
|[CMFCToolbar：：添加工具栏图片集](#addtoolbarforimagecollection)|将用户界面资源中的图像添加到应用程序中的图像集合。|
|[CMFC工具栏：调整布局](#adjustlayout)|重新计算工具栏的大小和位置。 （覆盖[CBasePane：调整布局](../../mfc/reference/cbasepane-class.md#adjustlayout)）。|
|[CMFC工具栏：调整尺寸](#adjustsize)|重新计算工具栏的大小。|
|[CMFCTool 栏：允许更改文本标签](#allowchangetextlabels)|指定文本标签是否可以显示在工具栏按钮上的图像下。|
|[CMFCTool 栏：：文本标签](#aretextlabels)|指定图像下的文本标签当前是否显示在工具栏按钮上。|
|[CMFCToolbar：自动格雷非活动图像](#autograyinactiveimages)|启用或禁用自动生成非活动按钮映像。|
|[CMFC工具栏：：按钮索引](#buttontoindex)|返回此工具栏中指定的[CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md)对象的索引。|
|[CMFC工具栏：钙固定布局](#calcfixedlayout)|计算工具栏的水平大小。 （覆盖[CBasePane：：CalcFixed 布局](../../mfc/reference/cbasepane-class.md#calcfixedlayout).）|
|[CMFCToolBar：：计算](#calcsize)|框架在布局计算过程中调用。 （覆盖[CPane：：计算大小](../../mfc/reference/cpane-class.md#calcsize)。|
|[CMFCToolBar：：坎汉兄弟](#canhandlesiblings)|确定工具栏和其同级是否定位在同一窗格上。|
|[CMFCToolbar：：清理图片](#cleanupimages)|释放分配给工具栏图像的系统资源。|
|[CMFCToolbar：：清理锁定图像](#cleanuplockedimages)|释放为锁定工具栏图像分配的系统资源。|
|[CMFCToolbar：可关闭](#canbeclosed)|指定用户是否可以关闭工具栏。 （覆盖[CBasePane：可以关闭](../../mfc/reference/cbasepane-class.md#canbeclosed).）|
|[CMFCToolBar：可以还原](#canberestored)|确定系统在自定义后是否可以将工具栏还原到其原始状态。|
|[CMFCToolBar：可以集中注意力](#canfocus)|指定窗格是否可以接收焦点。 （覆盖[CBasePane：：可以聚焦](../../mfc/reference/cbasepane-class.md#canfocus).）|
|[CMFCToolBar：：坎汉兄弟](#canhandlesiblings)|确定工具栏和其同级是否定位在同一窗格上。|
|[CMFC工具栏：：命令索引](#commandtoindex)|返回工具栏中具有指定命令 ID 的按钮的索引。|
|[CMFC工具栏：创建](#create)|创建一个 `CMFCToolBar` 对象。|
|[CMFC工具栏：创建Ex](#createex)|创建`CMFCToolBar`使用其他样式选项（如大型图标）的对象。|
|[CMFCToolBar：:D激活](#deactivate)|停用工具栏。|
|[CMFC工具栏：启用自定义按钮](#enablecustomizebutton)|启用或禁用工具栏末尾显示的 **"添加或删除按钮**"按钮。|
|[CMFC工具栏：启用停靠](#enabledocking)|启用窗格与主框架的停靠。 （覆盖[CBasePane：启用停靠](../../mfc/reference/cbasepane-class.md#enabledocking).）|
|[CMFCTool 栏：启用大型图标](#enablelargeicons)|启用或禁用工具栏按钮上的大型图标。|
|[CMFCToolBar：：启用快速定制](#enablequickcustomization)|启用或禁用工具栏的快速自定义，以便用户可以按**Alt**键并将按钮拖动到新位置。|
|[CMFCToolBar：：启用反射](#enablereflections)|启用或禁用命令反射。|
|[CMFCTool 栏：启用文本标签](#enabletextlabels)|启用或禁用工具栏按钮图像下的文本标签。|
|[CMFCToolbar：：从永久处理](#fromhandlepermanent)|检索指向包含给定窗口句柄`CMFCToolBar`的对象的指针。|
|[CMFC工具栏：获取所有按钮](#getallbuttons)|返回工具栏中的按钮的只读列表。|
|[CMFC工具栏：获取所有工具栏](#getalltoolbars)|返回应用程序中所有工具栏的只读列表。|
|[CMFC工具栏：获取基本命令](#getbasiccommands)|返回应用程序中定义的基本命令的只读列表。|
|[CMFCToolBar：获取按钮](#getbutton)|返回指向具有指定工具栏`CMFCToolBarButton`按钮索引的对象的指针。|
|[CMFCToolBar：获取按钮信息](#getbuttoninfo)|在指定索引处返回按钮的命令 ID、样式和图像索引。|
|[CMFCToolBar::GetButtonSize](#getbuttonsize)|返回工具栏上每个按钮的尺寸。|
|[CMFC工具栏：获取按钮样式](#getbuttonstyle)|返回位于指定索引处的工具栏按钮的当前样式。|
|[CMFCTool 栏：获取按钮文本](#getbuttontext)|返回具有指定索引的按钮的文本标签。|
|[CMFCToolbar：获取冷图像](#getcoldimages)|返回指向应用程序中冷工具栏按钮图像集合的指针。|
|[CMFCTool 栏：获取柱宽度](#getcolumnwidth)|返回工具栏按钮的宽度。|
|[CMFC工具栏：获取命令按钮](#getcommandbuttons)|从应用程序中的所有工具栏返回具有指定命令 ID 的按钮列表。|
|[CMFC工具栏：获取计数](#getcount)|返回工具栏上的按钮和分隔符数。|
|[CMFC工具栏：获取自定义按钮](#getcustomizebutton)|检索指向与工具栏关联的`CMFCCustomizeButton`对象的指针。|
|[CMFCTool 栏：获取默认图像](#getdefaultimage)|返回具有指定命令 ID 的工具栏按钮的默认图像的索引。|
|[CMFCToolBar：获取禁用图像](#getdisabledimages)|返回指向应用程序中用于禁用工具栏按钮的图像集合的指针。|
|[CMFCToolbar：获取禁用的菜单图像](#getdisabledmenuimages)|返回指向应用程序中禁用菜单按钮的图像集合的指针。|
|[CMFCToolbar：获取向下菜单](#getdroppeddownmenu)|检索指向当前显示其子菜单的菜单按钮对象的指针。|
|[CMFC工具栏：获取格雷禁用按钮](#getgraydisabledbuttons)|指定禁用按钮的图像是常规按钮图像的调光版本，还是从禁用按钮图像的集合中获取。|
|[CMFCToolBar：获取突出显示按钮](#gethighlightedbutton)|返回指向当前突出显示的工具栏按钮的指针。|
|[CMFCToolBar：获取 Hot 边框](#gethotborder)|确定工具栏按钮是否热跟踪。|
|[CMFCToolbar：获取HottextColor](#gethottextcolor)|返回突出显示工具栏按钮的文本颜色。|
|[CMFCToolBar：获取 Hwnd 最后焦点](#gethwndlastfocus)|将句柄返回到工具栏之前具有输入焦点的窗口。|
|[CMFCTool 栏：获取忽略集文本](#getignoresettext)|指定是否忽略对设置按钮标签的调用。|
|[CMFCTool 栏：获取图像大小](#getimagesize)|返回工具栏按钮图像的当前大小。|
|[CMFCToolBar：获取图像](#getimages)|返回指向应用程序中默认按钮图像集合的指针。|
|[CMFCToolBar：获取图像偏移](#getimagesoffset)|在工具栏按钮图像的全局列表中返回用于查找此工具栏工具栏的工具栏按钮图像的索引偏移量。|
|[CMFCToolbar：获取无效项目](#getinvalidateitemrect)|检索给定索引处的按钮必须重绘的工作区区域。|
|[CMFCTool 栏：获取项目ID](#getitemid)|在指定的索引处返回工具栏按钮的命令 ID。|
|[CMFCToolbar：获取项目重新完成](#getitemrect)|在指定的索引处返回按钮的边界矩形。|
|[CMFCToolbar：获取大型冷图像](#getlargecoldimages)|返回指向应用程序中大型冷工具栏按钮图像集合的指针。|
|[CMFCToolbar：获取大型禁用图像](#getlargedisabledimages)|返回指向应用程序中大型禁用工具栏按钮图像集合的指针。|
|[CMFCToolBar：获取大型图像](#getlargeimages)|返回指向应用程序中大型工具栏按钮图像集合的指针。|
|[CMFCToolbar：获取锁定的冷图像](#getlockedcoldimages)|返回指向工具栏中锁定冷图像集合的指针。|
|[CMFCToolBar：获取锁定禁用图像](#getlockeddisabledimages)|返回指向工具栏中锁定禁用图像集合的指针。|
|[CMFCToolBar：获取锁定图像](#getlockedimages)|返回指向工具栏中锁定按钮图像集合的指针。|
|[CMFCTool 栏：获取锁定图像大小](#getlockedimagesize)|返回锁定工具栏图像的默认大小。|
|[CMFCToolbar：获取锁定菜单图像](#getlockedmenuimages)|返回指向工具栏中锁定工具栏菜单图像集合的指针。|
|[CMFC工具栏：获取菜单按钮大小](#getmenubuttonsize)|返回应用程序中菜单按钮的大小。|
|[CMFC工具栏：获取菜单图像大小](#getmenuimagesize)|返回应用程序中菜单按钮图像的大小。|
|[CMFCToolBar：获取菜单图像](#getmenuimages)|返回指向应用程序中菜单按钮图像集合的指针。|
|[CMFCToolBar：：获取OrigButtons](#getorigbuttons)|检索工具栏的非自定义按钮的集合。|
|[CMFCToolBar：：获取OrigReset按钮](#getorigresetbuttons)|检索工具栏的非自定义重置按钮的集合。|
|[CMFCToolBar：获取资源ID](#getresourceid)|检索工具栏的资源 ID。|
|[CMFC工具栏：获取路由命令ViaFrame](#getroutecommandsviaframe)|确定向工具栏发送命令的对象、父帧或所有者。|
|[CMFCToolBar：获取罗高](#getrowheight)|返回工具栏按钮的高度。|
|[CMFC工具栏：：获取显示工具提示](#getshowtooltips)|指定是否为工具栏按钮显示工具提示。|
|[CMFC工具栏：获取同级工具栏](#getsiblingtoolbar)|检索工具栏的同级。|
|[CMFCToolBar：获取用户图像](#getuserimages)|返回指向应用程序中用户定义的工具栏按钮图像集合的指针。|
|[CMFC工具栏：命中测试](#hittest)|返回位于指定位置的工具栏按钮的索引。|
|[CMFC工具栏：插入按钮](#insertbutton)|将按钮插入工具栏。|
|[CMFCToolBar：插入分离器](#insertseparator)|将分隔符插入工具栏。|
|[CMFC工具栏：无效按钮](#invalidatebutton)|使提供的索引中存在的工具栏按钮的工作区无效。|
|[CMFCToolbar：：isAddremove快速自定义](#isaddremovequickcustomize)|确定用户是否可以使用 **"自定义"** 菜单选项添加或删除工具栏按钮。|
|[CMFCToolBar：：IsAlt定制模式](#isaltcustomizemode)|指定是否使用*快速自定义*来拖动按钮。|
|[CMFCToolbar：非自动格雷非活动图像](#isautograyinactiveimages)|指定是否启用非活动（非突出显示）按钮映像的自动生成。|
|[CMFCToolbar：：是基本命令](#isbasiccommand)|确定命令是否位于基本命令列表中。|
|[CMFC工具栏：是按钮超尺寸可用](#isbuttonextrasizeavailable)|确定工具栏是否可以显示具有扩展边框的按钮。|
|[CMFCTool 栏：按键突出显示](#isbuttonhighlighted)|确定工具栏上的按钮是否突出显示。|
|[CMFCTool 栏：是允许的](#iscommandpermitted)|确定是否允许命令。|
|[CMFCToolbar：：是命令很少使用](#iscommandrarelyused)|确定是否很少使用命令（请参阅[CMFCToolBar：：set命令使用选项](#setcommandusageoptions)）。|
|[CMFCToolbar：是定制模式](#iscustomizemode)|指定工具栏框架是否处于自定义模式。|
|[CMFCToolBar：：IsDragButton](#isdragbutton)|确定是否拖动工具栏按钮。|
|[CMFC工具栏：存在定制按钮](#isexistcustomizebutton)|确定工具栏是否包含 **"自定义"** 按钮。|
|[CMFCToolBar：是浮动的](#isfloating)|确定工具栏是否浮动。|
|[CMFCToolbar：：大图标](#islargeicons)|指定应用程序中的工具栏当前是否显示大图标。|
|[CMFCToolbar：是来自按钮的"正命令"](#islastcommandfrombutton)|确定最近执行的命令是否从指定的工具栏按钮发送。|
|[CMFCToolbar：：锁定](#islocked)|确定工具栏是否锁定。|
|[CMFCToolbar：与同级同一个](#isonerowwithsibling)|确定工具栏及其同级工具栏是否位于同一行上。|
|[CMFCTool 栏：用户定义](#isuserdefined)|指定工具栏是否由用户定义。|
|[CMFC工具栏：加载位图](#loadbitmap)|从应用程序资源加载工具栏图像。|
|[CMFC工具栏：：加载比特映射Ex](#loadbitmapex)|从应用程序资源加载工具栏图像。 包括大图像。|
|[CMFCToolBar：加载参数](#loadparameters)|从 Windows 注册表加载全局工具栏选项。|
|[CMFC工具栏：加载状态](#loadstate)|从 Windows 注册表加载工具栏状态信息。 （覆盖[CPane：LoadState](../../mfc/reference/cpane-class.md#loadstate).）|
|[CMFC工具栏：加载工具栏](#loadtoolbar)|从应用程序资源加载工具栏。|
|[CMFC工具栏：加载工具栏](#loadtoolbarex)|通过使用`CMFCToolBarInfo`帮助器类从应用程序资源加载工具栏，使应用程序能够使用大图像。|
|[CMFCToolbar：：打开](#onchangehot)|当用户选择工具栏上的按钮时，框架调用。|
|[CMFCToolbar：：在填充背景](#onfillbackground)|由[CBasePane：:DoPaint 的](../../mfc/reference/cbasepane-class.md#dopaint)框架调用以填充工具栏背景。|
|[CMFCToolbar：打开](#onreset)|将工具栏还原到其原始状态。|
|[CMFCToolbar：：OnSetAccData](#onsetaccdata)|（覆盖[CBasePane：onSetAccData](../../mfc/reference/cbasepane-class.md#onsetaccdata).）|
|[CMFC工具栏：打开默认按钮文本](#onsetdefaultbuttontext)|将工具栏按钮的文本还原到其默认状态。|
|`CMFCToolBar::OnUpdateCmdUI`|内部使用。|
|[CMFC工具栏：删除所有按钮](#removeallbuttons)|从工具栏中删除所有按钮。|
|[CMFC工具栏：删除按钮](#removebutton)|从工具栏中删除具有指定索引的按钮。|
|[CMFCToolbar：从注册处删除状态](#removestatefromregistry)|从 Windows 注册表中删除工具栏的状态信息。|
|[CMFC工具栏：更换按钮](#replacebutton)|将工具栏按钮替换为其他工具栏按钮。|
|[CMFCToolBar：重置所有](#resetall)|将所有工具栏还原到其原始状态。|
|[CMFCToolbar：：重置所有图像](#resetallimages)|清除应用程序中的所有工具栏图像集合。|
|[CMFCToolBar::RestoreOriginalState](#restoreoriginalstate)|还原工具栏的原始状态。|
|[CMFCToolBar：保存状态](#savestate)|在 Windows 注册表中保存工具栏的状态信息。 （覆盖[CPane：保存状态](../../mfc/reference/cpane-class.md#savestate).）|
|`CMFCToolBar::Serialize`|（重写 `CBasePane::Serialize`。）|
|[CMFC工具栏：：设置基本命令](#setbasiccommands)|设置用户打开菜单时始终显示的命令列表。|
|[CMFC工具栏：设置按钮信息](#setbuttoninfo)|设置工具栏按钮的命令 ID、样式和图像 ID。|
|[CMFC工具栏：设置按钮样式](#setbuttonstyle)|设置给定索引处工具栏按钮的样式。|
|[CMFCTool 栏：设置按钮文本](#setbuttontext)|设置工具栏按钮的文本标签。|
|[CMFC工具栏：设置按钮](#setbuttons)|设置工具栏的按钮。|
|[CMFC工具栏：设置命令使用选项](#setcommandusageoptions)|指定很少使用的命令未显示在应用程序的菜单中时。|
|[CMFC工具栏：设置自定义模式](#setcustomizemode)|为应用程序中的所有工具栏启用或禁用自定义模式。|
|[CMFC工具栏：：设置灰色禁用按钮](#setgraydisabledbuttons)|指定工具栏上的禁用按钮是变暗还是禁用的图像用于禁用的按钮。|
|[CMFC工具栏：设置高度](#setheight)|设置工具栏的高度。|
|[CMFCToolbar：：设置Hot边框](#sethotborder)|指定工具栏按钮是否热跟踪。|
|[CMFC工具栏：设置HottextColor](#sethottextcolor)|设置热工具栏按钮的文本颜色。|
|[CMFC工具栏：设置大图标](#setlargeicons)|指定工具栏按钮是否显示大图标。|
|[CMFC工具栏：设置锁定大小](#setlockedsizes)|设置工具栏上锁定按钮和锁定图像的大小。|
|[CMFC工具栏：设置菜单大小](#setmenusizes)|设置工具栏菜单按钮及其图像的大小。|
|[CMFC工具栏：：设置不允许命令](#setnonpermittedcommands)|设置用户无法执行的命令的列表。|
|[CMFCToolbar：设置同一行](#setonerowwithsibling)|将工具栏及其同级放在同一行上。|
|[CMFC工具栏：：设置](#setpermament)|指定用户是否可以关闭工具栏。|
|[CMFC工具栏：：设置路由命令ViaFrame](#setroutecommandsviaframe)|指定父框架或所有者是向工具栏发送命令。|
|[CMFC工具栏：：设置显示工具提示](#setshowtooltips)|指定框架是否显示工具提示。|
|[CMFC工具栏：：设置同级工具栏](#setsiblingtoolbar)|指定工具栏的同级。|
|[CMFC工具栏：设置大小](#setsizes)|指定所有工具栏上的按钮和图像的大小。|
|[CMFC工具栏：设置工具栏文本](#settoolbarbtntext)|指定工具栏上按钮的属性。|
|[CMFCTool 栏：设置双行与同级](#settworowswithsibling)|将工具栏及其同级放在单独的行上。|
|[CMFC工具栏：设置用户图像](#setuserimages)|设置应用程序中用户定义的映像的集合。|
|[CMFC工具栏：拉伸窗格](#stretchpane)|垂直或水平拉伸工具栏。 （覆盖[CBasePane：拉伸窗格](../../mfc/reference/cbasepane-class.md#stretchpane).）|
|[CMFCToolBar：翻译查尔](#translatechar)|如果指定的键代码对应于有效的键盘快捷键，则执行按钮命令。|
|[CMFC工具栏：更新按钮](#updatebutton)|更新指定按钮的状态。|
|[CMFC工具栏：包装工具栏](#wraptoolbar)|在给定尺寸内重新定位工具栏按钮。|

### <a name="protected-methods"></a>受保护的方法

|名称|说明|
|----------|-----------------|
|[CMFC工具栏：：允许显示列表](#allowshowonlist)|确定工具栏是否显示在 **"自定义"****对话框工具栏窗格**的列表中。|
|[CMFC工具栏：：卡尔马克斯按钮高度](#calcmaxbuttonheight)|计算工具栏中按钮的最大高度。|
|[CMFCToolBar：:DoPaint](#dopaint)|重新绘制工具栏。|
|[CMFCToolBar：:D生按钮](#drawbutton)|重新绘制工具栏按钮。|
|[CMFCToolBar：:D分离器](#drawseparator)|在工具栏上重新绘制分隔符。|
|[CMFC工具栏：在用户工具提示](#onusertooltip)|当按钮的工具提示即将显示时，由框架调用。|

### <a name="data-members"></a>数据成员

|名称|说明|
|----------|-----------------|
|[CMFC工具栏：m_bDontScaleImages](#m_bdontscaleimages)|指定在高 DPI 模式下是否缩放工具栏图像。|
|[CMFC工具栏：m_dblLargeImageRatio](#m_dbllargeimageratio)|指定大型图像的尺寸（高度或宽度）与常规图像的尺寸之间的比率。|

## <a name="remarks"></a>备注

要将`CMFCToolBar`对象合并到应用程序中，请按照以下步骤操作：

1. 将`CMFCToolBar`对象添加到主框架窗口。

1. 处理主框架窗口的WM_CREATE消息时，调用[CMFCToolBar：：创建](#create)或[CMFCToolBar：createEx](#createex)以创建工具栏并指定其样式。

1. 调用[CBasePane：启用停靠](../../mfc/reference/cbasepane-class.md#enabledocking)以指定停靠样式。

要插入特殊按钮（如组合框或下拉工具栏），请在父资源中保留一个虚拟按钮，并使用[CMFCToolBar：：：替换按钮](#replacebutton)在运行时替换虚拟按钮。 有关详细信息，请参阅[演练：将控件放在工具栏上](../walkthrough-putting-controls-on-toolbars.md)。

`CMFCToolBar`是 MFC 库类[CMFCMenuBar 类](../../mfc/reference/cmfcmenubar-class.md)[、CMFCPopupMenuBar 类](../../mfc/reference/cmfcpopupmenubar-class.md)和[CMFCDropDownToolBar 类](../../mfc/reference/cmfcdropdowntoolbar-class.md)的基类。

## <a name="example"></a>示例

下面的示例演示了如何使用 `CMFCToolBar` 类中的各种方法。 该示例演示如何设置工具栏的窗口标签的文本、设置边框、设置窗格的样式以及启用工具栏末尾显示的 **"添加或删除按钮"** 按钮。 此代码段是[IE 演示示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#8](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_2.cpp)]

## <a name="requirements"></a>要求

**标题：** afxtoolbar.h

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CBasePane](../../mfc/reference/cbasepane-class.md)

[CPane](../../mfc/reference/cpane-class.md)

[CMFCBase工具栏](../../mfc/reference/cmfcbasetoolbar-class.md)

`CMFCToolBar`

## <a name="cmfctoolbaraddbasiccommand"></a><a name="addbasiccommand"></a>CMFCToolbar：：添加基本命令

将菜单命令添加到用户打开菜单时始终显示的命令列表中。

```
static void __stdcall AddBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>参数

*乌伊Cmd*<br/>
[在]指定要添加的命令。

### <a name="remarks"></a>备注

打开菜单时，始终显示基本命令。 当用户选择查看最近使用的命令时，此方法是有意义的。

使用[CMFCToolBar：：SetBasicCommands](#setbasiccommands)方法设置用户打开菜单时始终显示的命令列表。 使用[CMFCToolBar：getBasicCommands](#getbasiccommands)方法检索应用程序使用的基本命令的列表。

## <a name="cmfctoolbaraddcommandusage"></a><a name="addcommandusage"></a>CMFC工具栏：添加命令用法

增加与给定命令关联的计数器的一个。

```
static void __stdcall AddCommandUsage(UINT uiCommand);
```

### <a name="parameters"></a>参数

*uiCommand*<br/>
[在]指定命令计数器以递增。

### <a name="remarks"></a>备注

当用户选择菜单项时，框架将调用此方法。

框架使用命令计数器来显示最近使用的菜单项。

此方法使用[CMFCCmd 使用计数：：addCmd](../../mfc/reference/cmfccmdusagecount-class.md#addcmd)方法增加命令计数器。

## <a name="cmfctoolbaraddtoolbarforimagecollection"></a><a name="addtoolbarforimagecollection"></a>CMFCToolbar：：添加工具栏图片集

将用户界面资源中的图像添加到应用程序中的图像集合。

```
static BOOL __stdcall AddToolBarForImageCollection(
    UINT uiResID,
    UINT uiBmpResID=0,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>参数

*uiResID*<br/>
[在]要加载图像的工具栏的资源 ID。

*乌布布雷斯ID*<br/>
[在]带有工具栏图像的位图的资源 ID。

*乌伊库德雷斯ID*<br/>
[在]带有"冷"工具栏图像的位图的资源 ID。

*uiMenuResID*<br/>
[在]带菜单图像的位图的资源 ID。

*ui禁用雷斯ID*<br/>
[在]带有禁用工具栏图像的位图的资源 ID。

*uiMenu 禁用雷斯 ID*<br/>
[在]具有禁用菜单图像的位图的资源 ID。

### <a name="return-value"></a>返回值

如果方法成功，则为 TRUE;如果*uiResID*或*uiBmpResID*未指定有效资源，或者发生其他错误，则 FALSE。

### <a name="remarks"></a>备注

调用此方法以使用工具栏图像加载位图并将其添加到工具栏图像的集合中。 此方法创建一个临时工具栏对象，并调用[CMFCToolBar：：LoadToolbar](#loadtoolbar)。

## <a name="cmfctoolbaradjustlayout"></a><a name="adjustlayout"></a>CMFC工具栏：调整布局

重新计算工具栏的大小和位置。

```
virtual void AdjustLayout();
```

### <a name="remarks"></a>备注

创建工具栏以重新计算其大小和位置时调用此方法。

每次必须更改工具栏的布局时，框架都会调用此方法。 例如，当用户移动另一个控件栏、调整应用程序窗口的大小或自定义工具栏时，布局必须更改。

重写此方法，在派生自 的`CMFCToolbar`类中提供您自己的动态布局。

## <a name="cmfctoolbaradjustsize"></a><a name="adjustsize"></a>CMFC工具栏：调整尺寸

重新计算工具栏的大小。

```
void AdjustSize();
```

### <a name="remarks"></a>备注

此方法确保工具栏适合父框架的边界。 如果工具栏没有父框架，则此方法不执行任何操作。

如果工具栏的父级不是`CMFCReBar`对象[，CMFCToolBar：：AdjustLayout](#adjustlayout)方法调用此方法以重新计算大小。

## <a name="cmfctoolbarallowchangetextlabels"></a><a name="allowchangetextlabels"></a>CMFCTool 栏：允许更改文本标签

指定文本标签是否可以显示在工具栏按钮上的图像下。

```
virtual BOOL AllowChangeTextLabels() const;
```

### <a name="return-value"></a>返回值

如果允许在图像下方显示文本标签，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

自定义对话框调用此方法，以确定是否启用所选**工具栏**工具栏工具栏页上的 **"显示文本标签**"复选框。

默认实现返回 TRUE。

在派生于`CMFCToolBar`的对象中重写此方法，并且不希望用户决定在图像下方的工具栏按钮上是否显示文本标签时返回 FALSE。

## <a name="cmfctoolbarallowshowonlist"></a><a name="allowshowonlist"></a>CMFC工具栏：：允许显示列表

确定工具栏是否显示在 **"自定义"** 对话框**工具栏窗格中的**工具栏列表中。

```
virtual BOOL AllowShowOnList() const;
```

### <a name="return-value"></a>返回值

如果工具栏对象可以显示在工具栏自定义页上的列表框中，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

框架调用此方法以确定工具栏自定义页上的列表是否应包含派生自`CMFCToolBar`的特定对象。

默认实现始终返回 TRUE。 如果不希望工具栏出现在自定义对话框中的工具栏列表中，则重写此方法。

## <a name="cmfctoolbararetextlabels"></a><a name="aretextlabels"></a>CMFCTool 栏：：文本标签

指定图像下的文本标签当前是否显示在工具栏按钮上。

```
BOOL AreTextLabels() const;
```

### <a name="return-value"></a>返回值

如果工具栏按钮在图像下方显示文本标签，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

使用[CMFCToolBar：启用文本标签](#enabletextlabels)以指定是否显示文本。 默认值是 FALSE。 调用[CMFCToolBar：：允许更改文本标签](#allowchangetextlabels)指定用户是否可以在自定义对话框中更改此设置。

## <a name="cmfctoolbarautograyinactiveimages"></a><a name="autograyinactiveimages"></a>CMFCToolbar：自动格雷非活动图像

启用或禁用自动生成非活动按钮映像。

```
static void AutoGrayInactiveImages(
    BOOL bEnable=TRUE,
    int nGrayImagePercentage=0,
    BOOL bRedrawAllToolbars=TRUE);
```

### <a name="parameters"></a>参数

*b 启用*<br/>
[在]指定是否调暗非活动图像的布尔值。 如果此参数为 TRUE，则非活动图像将变暗。 否则，非活动图像不会变暗。

*n 格雷图像百分比*<br/>
[在]指定非活动图像的亮度百分比。 如果*benable*为 FALSE，则忽略此值。

*b 重新绘制所有工具栏*<br/>
[在]指定是否重绘应用程序中的所有工具栏的布尔值。 如果此参数为 TRUE，则此方法将重绘所有工具栏。

### <a name="remarks"></a>备注

如果*bEnable*为 TRUE，则框架使用*nGrayImage 百分比*从常规映像生成非活动图像。 否则，您必须使用[CMFCToolBar：：getColdImages](#getcoldimages)方法提供一组非活动映像。 默认情况下禁用此选项。

有关*nGrayImage 百分比*参数的详细信息，请参阅[CMFCToolBar图像：：灰色图像](../../mfc/reference/cmfctoolbarimages-class.md#grayimages)。

## <a name="cmfctoolbarbuttontoindex"></a><a name="buttontoindex"></a>CMFC工具栏：：按钮索引

返回此工具栏中指定的[CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md)对象的索引。

```
int ButtonToIndex(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>参数

*pButton*<br/>
[在]指向工具栏按钮对象的指针。

### <a name="return-value"></a>返回值

工具栏按钮内部列表中*的 pButton*索引;或 -1 如果指定的按钮不在此工具栏上。

## <a name="cmfctoolbarcalcfixedlayout"></a><a name="calcfixedlayout"></a>CMFC工具栏：钙固定布局

计算工具栏的水平大小。

```
virtual CSize CalcFixedLayout(
    BOOL bStretch,
    BOOL bHorz);
```

### <a name="parameters"></a>参数

*b 拉伸*<br/>
[在]TRUE 将工具栏拉伸到父框架的大小。

*布霍兹*<br/>
[在]TRUE 可水平定向工具栏;FALSE 可垂直定向工具栏。

### <a name="return-value"></a>返回值

指定`CSize`工具栏大小的对象。

### <a name="remarks"></a>备注

此方法使用`CMFCToolBar::CalcLayout`方法计算工具栏的大小。 如果*bStretch*为 TRUE，它将传递*dwMode*参数的LM_STRETCH标志。 如果*bHorz*为 TRUE，则它传递LM_HORZ标志。

有关使用此方法的示例，请参阅 VisualStudioDemo 示例。

## <a name="cmfctoolbarcalcmaxbuttonheight"></a><a name="calcmaxbuttonheight"></a>CMFC工具栏：：卡尔马克斯按钮高度

计算工具栏中按钮的最大高度。

```
virtual int CalcMaxButtonHeight();
```

### <a name="return-value"></a>返回值

按钮的最大高度。

### <a name="remarks"></a>备注

此方法计算工具栏上所有工具栏按钮之间的最大高度。 高度可能因当前工具栏停靠状态等因素而异。

在派生的`CMFCToolBar`类中重写此方法，以提供您自己的高度计算。

## <a name="cmfctoolbarcalcsize"></a><a name="calcsize"></a>CMFCToolBar：：计算

框架在布局计算过程中调用。

```
virtual CSize CalcSize(BOOL bVertDock);
```

### <a name="parameters"></a>参数

*bVertDock*<br/>
[在]TRUE 指定工具栏垂直停靠;FALSE 以指定工具栏水平停靠。

### <a name="return-value"></a>返回值

指定`CSize`工具栏上按钮的整体大小的对象。

### <a name="remarks"></a>备注

此方法考虑影响每个按钮大小的属性，例如文本标签的面积和边框大小。

如果工具栏不包含按钮，则此方法通过使用[CMFCToolBar：：getButtonSize](#getbuttonsize)方法返回单个按钮的保留大小。

## <a name="cmfctoolbarcanbeclosed"></a><a name="canbeclosed"></a>CMFCToolbar：可关闭

指定用户是否可以关闭工具栏。

```
virtual BOOL CanBeClosed() const;
```

### <a name="return-value"></a>返回值

如果用户可以关闭工具栏，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

框架调用此方法以确定用户是否可以关闭工具栏。 如果方法返回 TRUE，则框架将启用工具栏系统菜单中的SC_CLOSE命令，用户可以使用自定义对话框中工具栏列表中的复选框关闭工具栏。

默认实现返回 TRUE。 在派生的`CMFCToolBar`类中重写此方法，以制作用户无法关闭的工具栏对象。

## <a name="cmfctoolbarcanberestored"></a><a name="canberestored"></a>CMFCToolBar：可以还原

确定系统在自定义后是否可以将工具栏还原到其原始状态。

```
virtual BOOL CanBeRestored() const;
```

### <a name="return-value"></a>返回值

如果可以从应用程序资源还原工具栏，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

框架调用此方法以确定工具栏在自定义后是否可以返回到其原始状态。 原始状态从应用程序资源加载。

如果`CanBeRestored`返回 TRUE，则自定义对话框的**工具栏**页将启用所选工具栏的 **"重置**"按钮。

如果工具栏加载时的原始资源 ID 为非零，则默认实现将返回 TRUE。 通常，无法仅还原用户定义的工具栏。

可以重写方法以`CanBeRestored`在派生类中自定义此行为。

## <a name="cmfctoolbarcanfocus"></a><a name="canfocus"></a>CMFCToolBar：可以集中注意力

指定窗格是否可以接收焦点。

```
virtual BOOL CanFocus() const;
```

### <a name="return-value"></a>返回值

此方法返回 FALSE。

### <a name="remarks"></a>备注

此方法重写基类实现[CBasePane：：canFocus，](../../mfc/reference/cbasepane-class.md#canfocus)因为工具栏对象无法接收焦点。

## <a name="cmfctoolbarcanhandlesiblings"></a><a name="canhandlesiblings"></a>CMFCToolBar：：坎汉兄弟

确定工具栏和其同级是否定位在同一窗格上。

```
BOOL CanHandleSiblings();
```

### <a name="return-value"></a>返回值

如果工具栏具有同级，工具栏及其同级位于同一窗格中，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

内部 CMFC自定义按钮：：CreatePopupMenu 方法调用此方法以确定如何显示 **"自定义**"弹出式菜单。 如果此方法返回 TRUE，则框架将显示 **"一行显示按钮**"或在 **"两行"按钮上显示按钮**。

通常不需要使用此方法。 要启用工具栏上显示的 **"自定义**"按钮，请调用[CMFCToolBar：：启用自定义按钮](#enablecustomizebutton)方法。 要启用 **"一行显示按钮**"或在 **"两行"按钮上显示按钮**，请致电[CMFCTool 栏：：设置同级工具栏](#setsiblingtoolbar)。

## <a name="cmfctoolbarcleanupimages"></a><a name="cleanupimages"></a>CMFCToolbar：：清理图片

释放分配给工具栏图像的系统资源。

```
static void CMFCToolBar::CleanUpImages();
```

### <a name="remarks"></a>备注

当应用程序关闭时，框架调用此方法。

## <a name="cmfctoolbarcleanuplockedimages"></a><a name="cleanuplockedimages"></a>CMFCToolbar：：清理锁定图像

释放为锁定工具栏图像分配的系统资源。

```
void CleanUpLockedImages();
```

### <a name="remarks"></a>备注

当应用程序的可视样式发生更改时，调用此方法。 有关使用此方法的示例，请参阅 VisualStudioDemo 示例。

## <a name="cmfctoolbarcommandtoindex"></a><a name="commandtoindex"></a>CMFC工具栏：：命令索引

返回工具栏中具有指定命令 ID 的按钮的索引。

```
int CommandToIndex(
    UINT nIDFind,
    int iIndexFirst=0) const;
```

### <a name="parameters"></a>参数

*nIDFind*<br/>
[在]指定命令 ID。

*iIndex 第一*<br/>
[在]指定要开始的初始索引。

### <a name="return-value"></a>返回值

如果方法成功，工具栏按钮的零索引;-1 如果没有具有指定 ID 的按钮。

### <a name="remarks"></a>备注

对象`CMFCToolBar`维护工具栏上按钮的内部列表。 调用此函数以检索列表中给定按钮的命令 ID 的按钮的索引。

如果*iIndex*大于 0，则此方法将忽略工具栏上索引小于*iIndex*的任何按钮。

## <a name="cmfctoolbarcreate"></a><a name="create"></a>CMFC工具栏：创建

创建一个 `CMFCToolBar` 对象。

```
virtual BOOL Create(
    CWnd* pParentWnd,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>参数

*pparentwnd*<br/>
[在]指向工具栏的父窗口的指针。

*dwStyle*<br/>
[在]工具栏样式。 有关样式列表，请参阅 Windows SDK 中的[工具栏控件和按钮样式](/windows/win32/Controls/toolbar-control-and-button-styles)。

*nID*<br/>
[在]工具栏的子窗口的 ID。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

此方法创建一个控制栏并将其附加到工具栏。 它创建具有TBSTYLE_FLAT样式的控制栏。 调用[CMFCTool 栏：](#createex)如果您想要不同的控制栏样式，请创建Ex。

## <a name="cmfctoolbarcreateex"></a><a name="createex"></a>CMFC工具栏：创建Ex

创建`CMFCToolBar`使用其他样式选项（如大型图标）的对象。

```
virtual BOOL CreateEx(
    CWnd* pParentWnd,
    DWORD dwCtrlStyle=TBSTYLE_FLAT,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    CRect rcBorders=CRect(1,
    1,
    1,
    1),
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>参数

*pparentwnd*<br/>
[在]指向工具栏的父窗口的指针。

*dwCtrl风格*<br/>
[在]用于创建嵌入式控制栏对象的其他样式。

*dwStyle*<br/>
[在]工具栏样式。 有关适当样式的列表，请参阅[工具栏控制和按钮样式](/windows/win32/Controls/toolbar-control-and-button-styles)。

*rcBorders*<br/>
[在]指定`CRect`工具栏窗口边框宽度的对象。

*nID*<br/>
[在]工具栏的子窗口的 ID。

### <a name="return-value"></a>返回值

如果此方法成功，则非零;否则 0。

### <a name="remarks"></a>备注

此方法创建一个控制栏并将其附加到工具栏。

调用此方法而不是[CMFCToolBar：：](#create)在您想要提供特定样式时创建。 例如，将*dwCtrlStyle*设置为TBSTYLE_FLAT |TBSTYLE_TRANSPARENT创建类似于 Internet Explorer 4 使用的工具栏的工具栏。

### <a name="example"></a>示例

下面的示例演示如何使用`CreateEx``CMFCToolBar`类的方法。 此代码段是[IE 演示示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

## <a name="cmfctoolbardeactivate"></a><a name="deactivate"></a>CMFCToolBar：:D激活

停用工具栏。

```
virtual void Deactivate();
```

### <a name="remarks"></a>备注

此方法通过从突出显示的工具栏按钮中删除焦点来停用工具栏。 当工具栏失去焦点或被销毁时，框架将调用此方法。

## <a name="cmfctoolbardopaint"></a><a name="dopaint"></a>CMFCToolBar：:DoPaint

重新绘制工具栏。

```
virtual void DoPaint(CDC* pDC);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

### <a name="remarks"></a>备注

当必须重新绘制工具栏的一部分时，框架将调用此方法。

重写此方法以自定义派生自`CMFCToolBar`的对象的外观。

## <a name="cmfctoolbardrawbutton"></a><a name="drawbutton"></a>CMFCToolBar：:D生按钮

重新绘制工具栏按钮。

```
virtual BOOL DrawButton(
    CDC* pDC,
    CMFCToolBarButton* pButton,
    CMFCToolBarImages* pImages,
    BOOL bHighlighted,
    BOOL bDrawDisabledImages);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

*pButton*<br/>
[在]指向要绘制的按钮的指针。

*pImage*<br/>
[在]指向工具栏图像的指针。

*b 突出显示*<br/>
[在]如果按钮突出显示，则为 TRUE;如果按钮突出显示，则为 TRUE。否则 FALSE。

*bDraw 禁用图像*<br/>
[在]如果禁用的按钮变暗，则为 TRUE;否则 FALSE。

### <a name="return-value"></a>返回值

如果重新绘制了按钮，则为 TRUE;如果按钮已隐藏，则为 FALSE。

### <a name="remarks"></a>备注

当必须重新绘制工具栏按钮时[，CMFCToolBar：:DrawButton](#drawbutton)方法调用此方法。

如果要自定义工具栏上按钮的外观，请重写此方法。

## <a name="cmfctoolbardrawseparator"></a><a name="drawseparator"></a>CMFCToolBar：:D分离器

在工具栏上重新绘制分隔符。

```
virtual void DrawSeparator(
    CDC* pDC,
    const CRect& rect,
    BOOL bHorz);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

*矩形*<br/>
[在]绘制分隔符的位置的边界矩形（以像素为单位）。

*布霍兹*<br/>
[在]如果分隔符是水平的，则为 TRUE，如果分隔符是垂直的，则 FALSE。

### <a name="remarks"></a>备注

[CMFCToolBar：:DoPaint](#dopaint)针对具有TBBS_SEPARATOR样式的每个[CMFCToolBar：:D原始分离器](#drawseparator)对象调用此方法，而不是为这些按钮调用[CMFCToolBar：:DrawButton。](#drawbutton)

在从[CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)派生的类中重写此方法，以自定义工具栏上分隔符的外观。 默认实现调用[CMFCVisualManager：onDrawSeor](../../mfc/reference/cmfcvisualmanager-class.md#ondrawseparator)以绘制其外观由当前可视化管理器决定的分隔符。

## <a name="cmfctoolbarenablecustomizebutton"></a><a name="enablecustomizebutton"></a>CMFC工具栏：启用自定义按钮

启用或禁用工具栏上显示的"自定义"按钮。

```
void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    const CString& strCustomizeText,
    BOOL bQuickCustomize=TRUE);

void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    UINT uiCustomizeTextResId,
    BOOL bQuickCustomize=TRUE);
```

### <a name="parameters"></a>参数

*b 启用*<br/>
[在]启用或禁用"自定义"按钮。

*i 定制Cmd*<br/>
[在]"自定义"按钮的命令 ID。

*str定制文本*<br/>
[在]"自定义"按钮的文本标签。

*ui 自定义文本 Resid*<br/>
[在]"自定义"按钮标签的资源字符串 ID。

*b快速定制*<br/>
[在]启用或禁用从按钮下落的菜单上的"**添加或删除按钮"** 选项。

### <a name="remarks"></a>备注

如果*i自定义 Cmd*为 -1，则当多个工具栏按钮不适合工具栏区域时，框架将显示"自定义"按钮。 该按钮显示一个双左指向箭头或 V 形，表示有更多的按钮。

如果*i自定义 Cmd*指定了有效的命令 ID，并且*bEnable*为 TRUE，则始终显示"自定义"按钮。 该按钮具有一个小向下箭头，并打开包含命令的菜单。 此命令使用*str"自定义文本*"指定的文本标签。 如果*bQuick 自定义*也为 TRUE，则菜单将显示"**添加或删除按钮"** 选项。

框架动态地向菜单添加任何不适合工具栏区域的按钮，然后由*i定制 Cmd*指定的项。 V 形显示在下箭头旁边。

## <a name="cmfctoolbarenabledocking"></a><a name="enabledocking"></a>CMFC工具栏：启用停靠

启用窗格与主框架的停靠。

```
virtual void EnableDocking(DWORD dwAlignment);
```

### <a name="parameters"></a>参数

*dwalignment*<br/>
[在]指定要启用的停靠对齐方式。

### <a name="remarks"></a>备注

此方法通过将`CBasePane::m_dwControlBarStyle`数据成员设置为AFX_CBRS_FLOAT扩展基类实现[CBasePane：：启用Docking。](../../mfc/reference/cbasepane-class.md#enabledocking) 然后，此方法将*dwalignment*传递给基类实现。

## <a name="cmfctoolbarenablelargeicons"></a><a name="enablelargeicons"></a>CMFCTool 栏：启用大型图标

启用或禁用工具栏按钮上的大型图标。

```
void EnableLargeIcons(BOOL bEnable);
```

### <a name="parameters"></a>参数

*b 启用*<br/>
[在]TRUE 启用大型图标，FALSE 可禁用大型图标。

### <a name="remarks"></a>备注

默认情况下，将启用大型图标。

## <a name="cmfctoolbarenablequickcustomization"></a><a name="enablequickcustomization"></a>CMFCToolBar：：启用快速定制

启用或禁用工具栏的快速自定义，以便用户可以按**Alt**键并将按钮拖动到新位置。

```
static void EnableQuickCustomization(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>参数

*b 启用*<br/>
[在]TRUE 启用快速自定义，FALSE 禁用快速自定义。

## <a name="cmfctoolbarenablereflections"></a><a name="enablereflections"></a>CMFCToolBar：：启用反射

启用或禁用命令反射。

```
void EnableReflections(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>参数

*b 启用*<br/>
[在]TRUE 启用命令反射;FALSE 以禁用命令反射。

### <a name="remarks"></a>备注

调用此方法可启用包含嵌入控件（如组合框）的工具栏按钮的命令反射。

有关命令反射的详细信息，请参阅[TN062：Windows 控件的消息反射](../../mfc/tn062-message-reflection-for-windows-controls.md)。

## <a name="cmfctoolbarenabletextlabels"></a><a name="enabletextlabels"></a>CMFCTool 栏：启用文本标签

启用或禁用工具栏按钮图像下的文本标签。

```
void EnableTextLabels(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>参数

*b 启用*<br/>
如果文本标签显示在工具栏按钮图像下，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

如果启用了文本标签，工具栏上的所有按钮都会被放大，为显示在图像下的标签提供空间。 自定义对话框在**工具栏**页面上具有 **"显示文本标签**"复选框。 当用户选择工具栏并选中此选项时，框架将调用`EnableTextLabels`选定的工具栏。 您可以通过从 CMFCToolBar 返回 FALSE 来禁用从[CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)派生的对象的复选框[：：允许更改文本标签](#allowchangetextlabels)。

## <a name="cmfctoolbarfromhandlepermanent"></a><a name="fromhandlepermanent"></a>CMFCToolbar：：从永久处理

检索指向包含给定窗口句柄`CMFCToolBar`的对象的指针。

```
static CMFCToolBar* __stdcall FromHandlePermanent(HWND hwnd);
```

### <a name="parameters"></a>参数

*霍恩德*<br/>
[在]要查找的窗口句柄。

### <a name="return-value"></a>返回值

指向包含给定窗口`CMFCToolBar`句柄的对象的指针，如果没有相应的`CMFCToolBar`对象，则指向 NULL。

### <a name="remarks"></a>备注

此共享方法检查应用程序中每个工具栏中包含给定窗口句柄`CMFCToolBar`的对象。

## <a name="cmfctoolbargetallbuttons"></a><a name="getallbuttons"></a>CMFC工具栏：获取所有按钮

返回工具栏中的按钮的只读列表。

```
const CObList& GetAllButtons() const;
```

### <a name="return-value"></a>返回值

对[COblist 类](../../mfc/reference/coblist-class.md)对象的常量引用，该对象包含[CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md)对象的集合。

## <a name="cmfctoolbargetalltoolbars"></a><a name="getalltoolbars"></a>CMFC工具栏：获取所有工具栏

返回应用程序中所有工具栏的只读列表。

```
static const CObList& GetAllToolbars();
```

### <a name="return-value"></a>返回值

对包含对象集合的`CMFCToolBar` [COblist 类](../../mfc/reference/coblist-class.md)对象的引用。

## <a name="cmfctoolbargetbasiccommands"></a><a name="getbasiccommands"></a>CMFC工具栏：获取基本命令

返回应用程序中定义的基本命令的只读列表。

```
static const CList<UINT,UINT>& GetBasicCommands();
```

### <a name="return-value"></a>返回值

对包含基本命令集合的[CList 类](../../mfc/reference/clist-class.md)对象的引用。

### <a name="remarks"></a>备注

通过调用[CMFCToolBar 添加基本命令：：添加基本命令](#addbasiccommand)或[CMFCToolBar：：设置基本命令](#setbasiccommands)。

## <a name="cmfctoolbargetbutton"></a><a name="getbutton"></a>CMFCToolBar：获取按钮

在指定索引处返回指向[CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md)对象的指针。

```
CMFCToolBarButton* GetButton(int iIndex) const;
```

### <a name="parameters"></a>参数

*iIndex*<br/>
[在]指定要返回的按钮的索引。

### <a name="return-value"></a>返回值

指向工具栏按钮的指针（如果存在）;或 NULL，如果没有这样的按钮。

## <a name="cmfctoolbargetbuttoninfo"></a><a name="getbuttoninfo"></a>CMFCToolBar：获取按钮信息

在指定索引处返回按钮的命令 ID、样式和图像索引。

```
void GetButtonInfo(
    int nIndex,
    UINT& nID,
    UINT& nStyle,
    int& iImage) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]在工具栏上的按钮列表中指定按钮的索引。

*nID*<br/>
[出]按钮的命令 ID。

*nStyle*<br/>
[出]按钮的样式。

*i图像*<br/>
[出]按钮的图像索引。

### <a name="remarks"></a>备注

该方法`GetButtonInfo`在指定的索引处查找工具栏按钮，并检索该按钮的命令 ID、样式和图像索引。

如果指定索引处的按钮不存在，则框架将*nID*和*nStyle*设置为 0，当方法返回时 *，将 iImage*设置到 -1。

## <a name="cmfctoolbargetbuttonsize"></a><a name="getbuttonsize"></a>CMFC工具栏：获取按钮大小

返回工具栏上每个按钮的尺寸。

```
CSize GetButtonSize() const;
```

### <a name="return-value"></a>返回值

指定工具栏上每个按钮尺寸的[CSize 类](../../atl-mfc-shared/reference/csize-class.md)对象。

### <a name="remarks"></a>备注

调用[CMFCTool 栏：设置大小](#setsizes)或[CMFCToolBar：：设置锁定大小](#setlockedsizes)以设置工具栏上每个按钮的尺寸。

## <a name="cmfctoolbargetbuttonstyle"></a><a name="getbuttonstyle"></a>CMFC工具栏：获取按钮样式

返回位于指定索引处的工具栏按钮的当前样式。

```
UINT GetButtonStyle(int nIndex) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]指定工具栏按钮的索引。

### <a name="return-value"></a>返回值

指定工具栏按钮样式的值。 . 有关可能样式的列表，请参阅[工具栏控件样式](../../mfc/reference/toolbar-control-styles.md)。

### <a name="remarks"></a>备注

调用[CMFCTool 栏：设置ButtonStyle](#setbuttonstyle)以设置工具栏按钮的样式

## <a name="cmfctoolbargetbuttontext"></a><a name="getbuttontext"></a>CMFCTool 栏：获取按钮文本

返回具有指定索引的按钮的文本标签。

```
CString GetButtonText(int nIndex) const;

void GetButtonText(
    int nIndex,
    CString& rString) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]工具栏按钮的索引。

*rString*<br/>
[出]工具栏按钮的标签文本。

### <a name="return-value"></a>返回值

工具栏按钮的标签文本。

### <a name="remarks"></a>备注

调用[CMFCTool 栏：设置按钮文本](#setbuttontext)或[CMFCToolBar：：设置工具栏Btn文本](#settoolbarbtntext)以设置文本标签。

## <a name="cmfctoolbargetcoldimages"></a><a name="getcoldimages"></a>CMFCToolbar：获取冷图像

返回指向应用程序中冷工具栏按钮图像集合的指针。

```
static CMFCToolBarImages* GetColdImages();
```

### <a name="return-value"></a>返回值

指向冷工具栏按钮图像集合的指针。

### <a name="remarks"></a>备注

冷图像是当用户不与工具栏按钮交互时使用的图像。 调用[CMFCToolBar：：LoadBitmapEx](#loadbitmapex)或[CMFCToolBar：：加载位图](#loadbitmap)以加载冷图像。

## <a name="cmfctoolbargetcolumnwidth"></a><a name="getcolumnwidth"></a>CMFCTool 栏：获取柱宽度

返回工具栏按钮的宽度。

```
virtual int GetColumnWidth() const;
```

### <a name="return-value"></a>返回值

指定工具栏按钮宽度的值。

### <a name="remarks"></a>备注

框架调用此方法来计算工具栏布局。 在派生类中重写此方法，为工具栏指定不同的列宽度。

## <a name="cmfctoolbargetcommandbuttons"></a><a name="getcommandbuttons"></a>CMFC工具栏：获取命令按钮

从应用程序中的所有工具栏返回具有指定命令 ID 的按钮列表。

```
static int GetCommandButtons(
    UINT uiCmd,
    CObList& listButtons);
```

### <a name="parameters"></a>参数

*乌伊Cmd*<br/>
[在]按钮的命令 ID。

*列表按钮*<br/>
[出]对接收工具栏按钮列表的[CObList 类](../../mfc/reference/coblist-class.md)对象的引用。

### <a name="return-value"></a>返回值

具有指定命令 ID 的按钮数。

## <a name="cmfctoolbargetcount"></a><a name="getcount"></a>CMFC工具栏：获取计数

返回工具栏上的按钮和分隔符数。

```
int GetCount() const;
```

### <a name="return-value"></a>返回值

工具栏上的按钮和分隔符的数量。

## <a name="cmfctoolbargetcustomizebutton"></a><a name="getcustomizebutton"></a>CMFC工具栏：获取自定义按钮

检索指向与工具栏关联的`CMFCCustomizeButton`对象的指针。

```
CMFCCustomizeButton* GetCustomizeButton();
```

### <a name="return-value"></a>返回值

指向与工具栏关联的`CMFCCustomizeButton`对象的指针。

### <a name="remarks"></a>备注

此方法检索显示在工具栏末尾的 **"自定义"** 按钮。 使用[CMFCToolBar：启用"自定义按钮"](#enablecustomizebutton)方法将 **"自定义**"按钮添加到工具栏。

您可以调用[CMFCToolBar：：Is存在自定义按钮](#isexistcustomizebutton)方法，以确定工具栏是否包含有效`CMFCCustomizeButton`对象。

## <a name="cmfctoolbargetdefaultimage"></a><a name="getdefaultimage"></a>CMFCTool 栏：获取默认图像

返回具有指定命令 ID 的工具栏按钮的默认图像的索引。

```
static int GetDefaultImage(UINT uiID);
```

### <a name="parameters"></a>参数

*uiID*<br/>
[在]指定按钮的命令 ID。

### <a name="return-value"></a>返回值

共享图像列表中工具栏图像的索引。

### <a name="remarks"></a>备注

使用此共享方法检索具有指定命令 ID 的工具栏按钮的默认图像索引。 返回值是应用程序中所有工具栏的工具栏按钮图像共享集合中的索引。 调用[CMFCToolBar：：GetImages](#getimages)方法以获取指向此集合的指针。

## <a name="cmfctoolbargetdisabledimages"></a><a name="getdisabledimages"></a>CMFCToolBar：获取禁用图像

返回指向应用程序中用于禁用工具栏按钮的图像集合的指针。

```
static CMFCToolBarImages* __stdcall GetDisabledImages();
```

### <a name="return-value"></a>返回值

指向禁用工具栏按钮图像集合的指针。

### <a name="remarks"></a>备注

使用[CMFCToolBar 编辑BoxButton 类](../../mfc/reference/cmfctoolbareditboxbutton-class.md)和[CMFCToolBar：：LoadBitmap](#loadbitmap)方法加载禁用的工具栏按钮图像。

## <a name="cmfctoolbargetdisabledmenuimages"></a><a name="getdisabledmenuimages"></a>CMFCToolbar：获取禁用的菜单图像

返回指向应用程序中禁用菜单按钮的图像集合的指针。

```
static CMFCToolBarImages* __stdcall GetDisabledMenuImages();
```

### <a name="return-value"></a>返回值

指向禁用菜单图像集合的指针。

### <a name="remarks"></a>备注

使用[CMFCToolBarEditBoxButton 类](../../mfc/reference/cmfctoolbareditboxbutton-class.md)方法加载禁用的图像。

## <a name="cmfctoolbargetdroppeddownmenu"></a><a name="getdroppeddownmenu"></a>CMFCToolbar：获取向下菜单

检索指向当前显示其子菜单的菜单按钮对象的指针。

```
CMFCToolBarMenuButton* GetDroppedDownMenu(int* pIndex = NULL) const;
```

### <a name="parameters"></a>参数

*pIndex*<br/>
[出]在工具栏按钮集合中接收按钮的索引。

### <a name="return-value"></a>返回值

指向菜单按钮对象的指针，该对象显示其子菜单或 NULL（如果没有菜单显示其子菜单）。

### <a name="remarks"></a>备注

如果此方法返回非 NULL 值 *，pIndex*不是 NULL，则*pIndex*指向的值将设置为工具栏按钮集合中菜单按钮的索引。

## <a name="cmfctoolbargetgraydisabledbuttons"></a><a name="getgraydisabledbuttons"></a>CMFC工具栏：获取格雷禁用按钮

指定禁用按钮的图像是常规按钮图像的调光版本，还是从禁用按钮图像的集合中获取。

```
BOOL GetGrayDisabledButtons() const;
```

### <a name="return-value"></a>返回值

TRUE 可调暗禁用按钮的图像;FALSE 从禁用图像的集合中获取图像。

### <a name="remarks"></a>备注

使用[CMFCToolBar：设置格雷禁用按钮](#setgraydisabledbuttons)在调光图像和禁用图像集合中的图像之间切换。

## <a name="cmfctoolbargethighlightedbutton"></a><a name="gethighlightedbutton"></a>CMFCToolBar：获取突出显示按钮

返回指向当前突出显示的工具栏按钮的指针。

```
CMFCToolBarButton* GetHighlightedButton() const;
```

### <a name="return-value"></a>返回值

指向工具栏按钮对象的指针;如果没有突出显示按钮，则为 NULL。

### <a name="remarks"></a>备注

如果工具栏按钮具有键盘焦点，则该按钮将突出显示。 如果工具栏按钮在此应用程序中热跟踪，工具栏按钮也会突出显示（有关详细信息，请参阅[CMFCToolBar：getHotBorder](#gethotborder)和[CMFCToolBar：：SetHotBorder），](#sethotborder)并且当没有工具栏按钮或菜单项具有键盘焦点时，鼠标指向它。

## <a name="cmfctoolbargethotborder"></a><a name="gethotborder"></a>CMFCToolBar：获取 Hot 边框

确定工具栏按钮是否*热跟踪*。 如果按钮是热轨道的，则当鼠标在按钮上移动时，该按钮会突出显示。

```
BOOL GetHotBorder() const;
```

### <a name="return-value"></a>返回值

如果工具栏按钮热跟踪，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

默认情况下，工具栏按钮是热跟踪的。

## <a name="cmfctoolbargethottextcolor"></a><a name="gethottextcolor"></a>CMFCToolbar：获取HottextColor

返回突出显示工具栏按钮的文本颜色。

```
static COLORREF GetHotTextColor();
```

### <a name="return-value"></a>返回值

表示当前突出显示的文本颜色的[COLORREF](/windows/win32/gdi/colorref)值。

### <a name="remarks"></a>备注

调用[CMFCToolBar：：设置HotTextColor，](#sethottextcolor)为突出显示的工具栏按钮设置新的文本颜色。

## <a name="cmfctoolbargethwndlastfocus"></a><a name="gethwndlastfocus"></a>CMFCToolBar：获取 Hwnd 最后焦点

将句柄返回到工具栏之前具有输入焦点的窗口。

```
HWND GetHwndLastFocus() const;
```

### <a name="return-value"></a>返回值

未从[CMFCBaseToolBar 类](../../mfc/reference/cmfcbasetoolbar-class.md)派生的窗口句柄，该类以前具有输入焦点;或 NULL，如果没有这样的窗口。

### <a name="remarks"></a>备注

当`CMFCToolBar`控件接收输入焦点时，它会将句柄存储到丢失焦点的窗口，以便以后可以还原焦点。

## <a name="cmfctoolbargetignoresettext"></a><a name="getignoresettext"></a>CMFCTool 栏：获取忽略集文本

指定是否忽略对设置按钮标签的调用。

```
BOOL GetIgnoreSetText() const;
```

### <a name="return-value"></a>返回值

如果忽略对设置按钮标签的调用，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfctoolbargetimages"></a><a name="getimages"></a>CMFCToolBar：获取图像

返回指向应用程序中默认按钮图像集合的指针。

```
static CMFCToolBarImages* GetImages();
```

### <a name="return-value"></a>返回值

指向[CMFCToolBarImages 类](../../mfc/reference/cmfctoolbarimages-class.md)对象的指针，其中包含应用程序中所有工具栏的默认图像集合。

### <a name="remarks"></a>备注

此共享方法提供对应用程序所有默认工具栏映像集合的访问。 调用[CMFCToolBar：：LoadBitmap](#loadbitmap)方法以向集合中添加图像。

## <a name="cmfctoolbargetimagesize"></a><a name="getimagesize"></a>CMFCTool 栏：获取图像大小

返回工具栏按钮图像的当前大小。

```
CSize GetImageSize() const;
```

### <a name="return-value"></a>返回值

表示工具栏按钮图像当前大小的[CSize 类](../../atl-mfc-shared/reference/csize-class.md)对象。

## <a name="cmfctoolbargetimagesoffset"></a><a name="getimagesoffset"></a>CMFCToolBar：获取图像偏移

在工具栏按钮图像的全局列表中返回用于查找此工具栏工具栏的工具栏按钮图像的索引偏移量。

```
int GetImagesOffset() const;
```

### <a name="return-value"></a>返回值

工具栏图像的索引偏移量。

### <a name="remarks"></a>备注

所有工具栏默认图像都存储在全局[CMFCToolBar 图像类](../../mfc/reference/cmfctoolbarimages-class.md)列表中。 工具栏中每个按钮的图像都连续存储在该列表中。 要计算图像的索引，将工具栏中的按钮索引添加到该工具栏按钮的图像列表开头的偏移量中。

调用[CMFCToolBar：：ButtonToIndex](#buttontoindex)以获取工具栏按钮的索引，该按钮给定指向该按钮的指针。

调用[CMFCToolBar：：获取图像](#getimages)以获取指向工具栏图像集合的指针。

## <a name="cmfctoolbargetinvalidateitemrect"></a><a name="getinvalidateitemrect"></a>CMFCToolbar：获取无效项目

检索给定索引处的按钮必须重绘的工作区区域。

```
virtual void GetInvalidateItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]要为其检索工作区的按钮的索引。

*lpRect*<br/>
[出]指向接收工作区区域的 RECT 对象的指针。

### <a name="remarks"></a>备注

*lpRect*参数不能为 NULL。 如果提供的索引中没有按钮 *，lpRect*将收到初始化为零的 RECT 对象。

## <a name="cmfctoolbargetitemid"></a><a name="getitemid"></a>CMFCTool 栏：获取项目ID

在指定的索引处返回工具栏按钮的命令 ID。

```
UINT GetItemID(int nIndex) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]指定工具栏按钮的索引。

### <a name="return-value"></a>返回值

工具栏按钮的命令 ID;如果指定索引的按钮不存在，则为零。

## <a name="cmfctoolbargetitemrect"></a><a name="getitemrect"></a>CMFCToolbar：获取项目重新完成

在指定的索引处返回按钮的边界矩形。

```
virtual void GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]指定工具栏按钮的索引。

*lpRect*<br/>
[出]指向`CRect`接收图像边界矩形坐标的对象的指针。

### <a name="remarks"></a>备注

如果`CRect`指定索引处的按钮不存在，*则 lpRect*点设置为 0 的对象。

### <a name="example"></a>示例

下面的示例演示如何使用`GetItemRect``CMFCToolBar`类的方法。 此代码段是[IE 演示示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#9](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_4.cpp)]

## <a name="cmfctoolbargetlargecoldimages"></a><a name="getlargecoldimages"></a>CMFCToolbar：获取大型冷图像

返回指向应用程序中大型冷工具栏按钮图像集合的指针。

```
static CMFCToolBarImages* GetLargeColdImages();
```

### <a name="return-value"></a>返回值

指向大型冷图像集合的指针。

### <a name="remarks"></a>备注

冷图像是当用户不与工具栏按钮交互时使用的图像。 调用[CMFCToolBar：：LoadBitmapEx](#loadbitmapex)以加载大型冷图像。

## <a name="cmfctoolbargetlargedisabledimages"></a><a name="getlargedisabledimages"></a>CMFCToolbar：获取大型禁用图像

返回指向应用程序中大型禁用工具栏按钮图像集合的指针。

```
static CMFCToolBarImages* GetLargeDisabledImages();
```

### <a name="return-value"></a>返回值

指向大型禁用工具栏按钮图像集合的指针。

### <a name="remarks"></a>备注

大图像是常规工具栏按钮图像的大版本。 调用[CMFCToolBar：：LoadBitmapEx](#loadbitmapex)或[CMFCToolBar：：加载位图](#loadbitmap)以加载大图像。

## <a name="cmfctoolbargetlargeimages"></a><a name="getlargeimages"></a>CMFCToolBar：获取大型图像

返回指向应用程序中大型工具栏按钮图像集合的指针。

```
static CMFCToolBarImages* GetLargeImages();
```

### <a name="return-value"></a>返回值

指向大型工具栏按钮图像集合的指针。

### <a name="remarks"></a>备注

大图像是常规工具栏按钮图像的大版本。 调用[CMFCToolBar：：加载BitmapEx](#loadbitmapex)以加载大图像。

## <a name="cmfctoolbargetlockedcoldimages"></a><a name="getlockedcoldimages"></a>CMFCToolbar：获取锁定的冷图像

返回指向工具栏中锁定冷图像集合的指针。

```
CMFCToolBarImages* GetLockedColdImages();
```

### <a name="return-value"></a>返回值

指向锁定冷图像集合的指针，如果工具栏未锁定，则指向 NULL。

### <a name="remarks"></a>备注

锁定的图像是当用户无法自定义工具栏时框架使用的常规工具栏按钮图像的版本。 冷图像是当用户不与工具栏按钮交互时使用的图像。

如果工具栏未锁定，此方法将返回 NULL。 如果工具栏未锁定，此方法还会在调试生成中生成断言失败。 有关锁定工具栏的详细信息，请参阅[CMFCToolBar：：锁定](#islocked)。

调用[CMFCToolBar：：LoadBitmapEx](#loadbitmapex)方法以加载锁定的冷图像。

## <a name="cmfctoolbargetlockeddisabledimages"></a><a name="getlockeddisabledimages"></a>CMFCToolBar：获取锁定禁用图像

返回指向工具栏中锁定禁用图像集合的指针。

```
CMFCToolBarImages* GetLockedDisabledImages();
```

### <a name="return-value"></a>返回值

指向锁定禁用图像集合的指针，如果工具栏未锁定，则指向 NULL。

### <a name="remarks"></a>备注

锁定的图像是当用户无法自定义工具栏时框架使用的常规工具栏按钮图像的版本。 禁用的图像是当按钮具有TBBS_DISABLED样式时框架使用的图像。

如果工具栏未锁定，此方法将返回 NULL。 如果工具栏未锁定，此方法还会在调试生成中生成断言失败。 有关锁定工具栏的详细信息，请参阅[CMFCToolBar：：锁定](#islocked)。

调用[CMFCToolBar：：LoadBitmapEx](#loadbitmapex)方法以加载锁定的禁用图像。

## <a name="cmfctoolbargetlockedimages"></a><a name="getlockedimages"></a>CMFCToolBar：获取锁定图像

返回指向工具栏中锁定按钮图像集合的指针。

```
CMFCToolBarImages* GetLockedImages();
```

### <a name="return-value"></a>返回值

指向锁定工具栏按钮图像集合的指针，如果工具栏未锁定，则指向 NULL。

### <a name="remarks"></a>备注

锁定的图像是当用户无法自定义工具栏时框架使用的常规工具栏按钮图像的版本。

如果工具栏未锁定，此方法将返回 NULL。 如果工具栏未锁定，此方法还会在调试生成中生成断言失败。 有关锁定工具栏的详细信息，请参阅[CMFCToolBar：：锁定](#islocked)。

## <a name="cmfctoolbargetlockedimagesize"></a><a name="getlockedimagesize"></a>CMFCTool 栏：获取锁定图像大小

返回锁定工具栏图像的默认大小。

```
CSize GetLockedImageSize() const;
```

### <a name="return-value"></a>返回值

指定`CSize`锁定工具栏图像的大小或未锁定工具栏时的空白`CSize`结构的结构。

### <a name="remarks"></a>备注

锁定的图像是当用户无法自定义工具栏时框架使用的常规工具栏按钮图像的版本。

如果工具栏未锁定`CSize`，则此方法返回宽度为零且高度为零的结构。 如果工具栏未锁定，此方法还会在调试生成中生成断言失败。 有关锁定工具栏的详细信息，请参阅[CMFCToolBar：：锁定](#islocked)。

调用[CMFCToolBar：：设置锁定大小](#setlockedsizes)方法以指定锁定的图像大小。

## <a name="cmfctoolbargetlockedmenuimages"></a><a name="getlockedmenuimages"></a>CMFCToolbar：获取锁定菜单图像

返回指向工具栏中锁定工具栏菜单图像集合的指针。

```
CMFCToolBarImages* GetLockedMenuImages();
```

### <a name="return-value"></a>返回值

指向锁定工具栏菜单图像集合的指针，如果工具栏未锁定，则指向 NULL。

### <a name="remarks"></a>备注

锁定的图像是当用户无法自定义工具栏时框架使用的常规工具栏菜单图像的版本。

如果工具栏未锁定，此方法将返回 NULL。 如果工具栏未锁定，此方法还会在调试生成中生成断言失败。 有关锁定工具栏的详细信息，请参阅[CMFCToolBar：：锁定](#islocked)。

调用[CMFCToolBar：：LoadBitmapEx](#loadbitmapex)方法以加载锁定的菜单图像。

## <a name="cmfctoolbargetmenubuttonsize"></a><a name="getmenubuttonsize"></a>CMFC工具栏：获取菜单按钮大小

返回应用程序中菜单按钮的大小。

```
static CSize GetMenuButtonSize();
```

### <a name="return-value"></a>返回值

以`CSize`像素为单位表示菜单按钮大小的对象。

### <a name="remarks"></a>备注

工具栏上的菜单按钮大小将维护为全局变量，并可以使用此静态方法检索。

调用[CMFCToolBar：：设置MenuSizes](#setmenusizes)以设置此全局变量。

## <a name="cmfctoolbargetmenuimages"></a><a name="getmenuimages"></a>CMFCToolBar：获取菜单图像

返回指向应用程序中菜单按钮图像集合的指针。

```
static CMFCToolBarImages* GetMenuImages();
```

### <a name="return-value"></a>返回值

指向菜单图像集合的指针。

### <a name="remarks"></a>备注

调用[CMFCToolBar：：LoadBitmapEx](#loadbitmapex)方法来加载菜单图像。

调用[CMFCToolBar：setMenuSizes](#setmenusizes)方法以设置按钮的大小及其图像。

## <a name="cmfctoolbargetmenuimagesize"></a><a name="getmenuimagesize"></a>CMFC工具栏：获取菜单图像大小

返回应用程序中菜单按钮图像的大小。

```
static CSize GetMenuImageSize();
```

### <a name="return-value"></a>返回值

表示`CSize`菜单图像大小的对象。

### <a name="remarks"></a>备注

此方法返回作为全局变量维护的工具栏菜单按钮上的图像大小。 调用[CMFCToolBar：：设置MenuSizes](#setmenusizes)以设置此全局变量。

## <a name="cmfctoolbargetorigbuttons"></a><a name="getorigbuttons"></a>CMFCToolBar：：获取OrigButtons

检索工具栏的非自定义按钮的集合。

```
const CObList& GetOrigButtons() const;
```

### <a name="return-value"></a>返回值

对工具栏非自定义按钮列表的引用。

### <a name="remarks"></a>备注

框架在用户自定义工具栏按钮之前创建一个副本。 [CMFCToolBar：SetButtons](#setbuttons)方法将所提供的数组中每个按钮的副本添加到原始按钮列表中。 [CMFCToolBar：还原原始状态](#restoreoriginalstate)方法通过从资源文件加载工具栏来还原工具栏的原始状态。

要设置工具栏的原始按钮列表，请致电[CMFCToolBar：：setorigButtons](#setorigbuttons)方法。

## <a name="cmfctoolbargetorigresetbuttons"></a><a name="getorigresetbuttons"></a>CMFCToolBar：：获取OrigReset按钮

检索工具栏的非自定义重置按钮的集合。

```
const CObList& GetOrigResetButtons() const;
```

### <a name="return-value"></a>返回值

对工具栏非自定义重置按钮列表的引用。

### <a name="remarks"></a>备注

当用户在自定义模式下单击 **"重置"** 按钮时，框架使用此方法还原从工具栏中删除的按钮。

[CMFCToolBar：：SetButtons](#setbuttons)方法在调用[CMFCToolBar：：onReset](#onreset)方法后，将每个工具栏按钮的副本添加到原始重置按钮列表中。 您可以重写[CMFCToolBar：：OnReset](#onreset)方法，以在用户按下 **"重置"** 按钮后自定义按钮的外观。

## <a name="cmfctoolbargetresourceid"></a><a name="getresourceid"></a>CMFCToolBar：获取资源ID

检索工具栏的资源 ID。

```
UINT GetResourceID() const;
```

### <a name="return-value"></a>返回值

工具栏的资源 ID。

### <a name="remarks"></a>备注

调用[CMFCToolBar：：LoadToolBarEx](#loadtoolbarex)方法以设置工具栏的资源 ID。

## <a name="cmfctoolbargetroutecommandsviaframe"></a><a name="getroutecommandsviaframe"></a>CMFC工具栏：获取路由命令ViaFrame

确定向工具栏发送命令的对象、父帧或所有者。

```
BOOL GetRouteCommandsViaFrame();
```

### <a name="return-value"></a>返回值

如果父帧向工具栏发送命令，则非零;如果所有者向工具栏发送命令，则为 0。

### <a name="remarks"></a>备注

默认情况下，父框架向工具栏发送命令。 调用[CMFCTool 栏：设置路由命令ViaFrame](#setroutecommandsviaframe)以更改此行为。

如果此方法返回非零值，则可以使用`CMFCToolBar::GetCommandTarget`方法检索指向父帧对象的指针。 有关使用此方法的示例，请参阅 VisualStudioDemo 示例。

## <a name="cmfctoolbargetrowheight"></a><a name="getrowheight"></a>CMFCToolBar：获取罗高

返回工具栏按钮的高度。

```
virtual int GetRowHeight() const;
```

### <a name="return-value"></a>返回值

工具栏按钮的高度（以像素为单位）。

### <a name="remarks"></a>备注

框架调用此方法来计算工具栏布局。 在派生类中重写此方法，以指定工具栏的不同高度。

## <a name="cmfctoolbargetshowtooltips"></a><a name="getshowtooltips"></a>CMFC工具栏：：获取显示工具提示

指定是否为工具栏按钮显示工具提示。

```
static BOOL GetShowTooltips();
```

### <a name="return-value"></a>返回值

如果工具栏按钮的工具提示显示为 TRUE;如果工具栏按钮显示工具提示，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

默认情况下，将显示工具提示。 您可以通过调用[CMFCToolBar：：setShowTool 提示](#setshowtooltips)来更改此静态标志。

## <a name="cmfctoolbargetsiblingtoolbar"></a><a name="getsiblingtoolbar"></a>CMFC工具栏：获取同级工具栏

检索工具栏的同级。

```
CMFCToolBar* GetSiblingToolBar();
```

### <a name="return-value"></a>返回值

指向同级工具栏的指针。

### <a name="remarks"></a>备注

有关如何启用 **"一行显示按钮**"和 **"两行"按钮显示按钮**的详细信息，请参阅[CMFCToolBar：：：设置SiblingToolBar](#setsiblingtoolbar)。

## <a name="cmfctoolbargetuserimages"></a><a name="getuserimages"></a>CMFCToolBar：获取用户图像

返回指向应用程序中用户定义的工具栏按钮图像集合的指针。

```
static CMFCToolBarImages* GetUserImages();
```

### <a name="return-value"></a>返回值

指向应用程序中所有工具栏的用户定义工具栏按钮图像集合的指针。

### <a name="remarks"></a>备注

调用[CMFCToolBar：：SetUserImage](#setuserimages)方法以设置应用程序中用户定义的映像的集合。

## <a name="cmfctoolbarhittest"></a><a name="hittest"></a>CMFC工具栏：命中测试

返回位于指定位置的工具栏按钮的索引。

```
virtual int HitTest(CPoint point);
```

### <a name="parameters"></a>参数

*点*<br/>
[在]要测试的点，在客户端坐标中。

### <a name="return-value"></a>返回值

位于指定位置的按钮的索引，如果没有该按钮或按钮是分隔符，则为 -1。

## <a name="cmfctoolbarinsertbutton"></a><a name="insertbutton"></a>CMFC工具栏：插入按钮

将按钮插入工具栏。

```
virtual int InsertButton(
    const CMFCToolBarButton& button,
    INT_PTR iInsertAt=-1);

virtual int InsertButton(
    CMFCToolBarButton* pButton,
    int iInsertAt=-1);
```

### <a name="parameters"></a>参数

*按钮*<br/>
[在]指定要插入的按钮。

*iInsertAt*<br/>
[在]指定要在处插入按钮的零基位置。

### <a name="return-value"></a>返回值

如果发生错误，插入按钮的位置或 -1。

### <a name="remarks"></a>备注

如果*iInsertAt*为 -1，则此方法将按钮添加到工具栏按钮列表的末尾。

调用[CMFCToolBar：插入分隔符](#insertseparator)方法，将分隔符插入工具栏。

## <a name="cmfctoolbarinsertseparator"></a><a name="insertseparator"></a>CMFCToolBar：插入分离器

将分隔符插入工具栏。

```
virtual int InsertSeparator(INT_PTR iInsertAt=-1);
```

### <a name="parameters"></a>参数

*iInsertAt*<br/>
[在]指定要插入分隔符的零基位置。 此参数必须大于 0。

### <a name="return-value"></a>返回值

插入分隔符的位置，如果发生错误，则为 -1。

### <a name="remarks"></a>备注

调用此方法以在两个现有按钮之间插入分隔符。 如果*iInsertAt*为 -1，则此方法将分隔符添加到工具栏按钮列表的末尾。

不能使用此方法将分隔符添加到空工具栏。

调用[CMFCToolBar：插入按钮](#insertbutton)方法，将按钮插入工具栏。

## <a name="cmfctoolbarinvalidatebutton"></a><a name="invalidatebutton"></a>CMFC工具栏：无效按钮

使提供的索引中存在的工具栏按钮的工作区无效。

```
CMFCToolBarButton* InvalidateButton(int nIndex);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]工具栏中按钮的零基索引。

### <a name="return-value"></a>返回值

指向在提供的索引`CMFCToolBarButton`或 NULL 上存在的对象的指针（如果没有此类对象）。

### <a name="remarks"></a>备注

当框架更新与工具栏按钮关联的工作区时，它将调用此方法。 它调用[CWnd：：：无效重新解决](../../mfc/reference/cwnd-class.md#invalidaterect)方法，对象位于提供的索引处`CMFCToolBarButton`的对象的客户端矩形。

## <a name="cmfctoolbarisaddremovequickcustomize"></a><a name="isaddremovequickcustomize"></a>CMFCToolbar：：isAddremove快速自定义

确定用户是否可以使用 **"自定义"** 菜单选项添加或删除工具栏按钮。

```
BOOL IsAddRemoveQuickCustomize();
```

### <a name="return-value"></a>返回值

如果用户可以使用 **"自定义"** 菜单选项修改工具栏，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfctoolbarisaltcustomizemode"></a><a name="isaltcustomizemode"></a>CMFCToolBar：：IsAlt定制模式

指定是否使用*快速自定义*来拖动按钮。 启用快速自定义后，用户可以按住 Alt 键并将按钮拖动到新位置。

```
static BOOL __stdcall IsAltCustomizeMode();
```

### <a name="return-value"></a>返回值

如果快速自定义用于拖动按钮，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfctoolbarisautograyinactiveimages"></a><a name="isautograyinactiveimages"></a>CMFCToolbar：非自动格雷非活动图像

指定是否启用非活动（非突出显示）按钮映像的自动生成。

```
static BOOL IsAutoGrayInactiveImages();
```

### <a name="return-value"></a>返回值

如果启用了自动调暗非活动图像的选项，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

您可以通过调用[CMFCToolBar：：自动格雷非活动图像](#autograyinactiveimages)来启用或禁用非活动映像的自动调光。

## <a name="cmfctoolbarisbasiccommand"></a><a name="isbasiccommand"></a>CMFCToolbar：：是基本命令

确定命令是否位于基本命令列表中。

```
static BOOL IsBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>参数

*乌伊Cmd*<br/>
[在]指定要检查的命令。

### <a name="return-value"></a>返回值

如果指定的命令属于基本命令的列表，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

此静态方法确定*uiCmd*指定的命令是否属于基本命令的全局列表。 您可以通过调用[CMFCToolBar 来更改基本命令列表：addBasic命令](#addbasiccommand)或[CMFCToolBar：：SetBasic命令](#setbasiccommands)。

## <a name="cmfctoolbarisbuttonextrasizeavailable"></a><a name="isbuttonextrasizeavailable"></a>CMFC工具栏：是按钮超尺寸可用

确定工具栏是否可以显示具有扩展边框的按钮。

```
virtual BOOL IsButtonExtraSizeAvailable() const;
```

### <a name="return-value"></a>返回值

如果条形可以显示具有额外边框大小的按钮，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

工具栏对象如果能够显示具有扩展边框的按钮，则返回 TRUE。 工具栏按钮在处理[CMFCToolBarButton 时调用此方法：onChangeParentwnd](../../mfc/reference/cmfctoolbarbutton-class.md#onchangeparentwnd)通知，并将相应地设置其内部额外边框大小标志。 稍后可以通过调用[CMFCToolBarButton 来检索此内部标志：是超大型](../../mfc/reference/cmfctoolbarbutton-class.md#isextrasize)。

如果条形图可以显示具有额外`CMFCToolBar`边框大小的工具栏按钮，然后返回 FALSE，则在派生的类中覆盖此方法并返回 TRUE。 默认实现返回 TRUE。

## <a name="cmfctoolbarisbuttonhighlighted"></a><a name="isbuttonhighlighted"></a>CMFCTool 栏：按键突出显示

确定指定的按钮是否突出显示。

```
BOOL IsButtonHighlighted(int iButton) const;
```

### <a name="parameters"></a>参数

*iButton*<br/>
[在]指定工具栏按钮的索引。

### <a name="return-value"></a>返回值

如果指定的按钮突出显示，则为 TRUE;如果指定的按钮突出显示，则为 TRUE。否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfctoolbariscommandpermitted"></a><a name="iscommandpermitted"></a>CMFCTool 栏：是允许的

确定是否允许命令。

```
static BOOL IsCommandPermitted(UINT uiCmd);
```

### <a name="parameters"></a>参数

*乌伊Cmd*<br/>
[在]指定要检查的命令。

### <a name="return-value"></a>返回值

如果允许指定命令，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

此静态方法确定*uiCmd*指定的命令是否属于不允许命令的全局列表。

您可以通过调用[CMFCToolBar：：setNon允许命令](#setnonpermittedcommands)来更改不允许的命令列表。

## <a name="cmfctoolbariscommandrarelyused"></a><a name="iscommandrarelyused"></a>CMFCToolbar：：是命令很少使用

确定是否很少使用命令。

```
static BOOL IsCommandRarelyUsed(UINT uiCmd);
```

### <a name="parameters"></a>参数

*乌伊Cmd*<br/>
[在]指定要检查的命令。

### <a name="return-value"></a>返回值

如果很少使用指定的命令，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

当`IsCommandRarelyUsed`出现以下一个或多个情况时，该方法将返回 FALSE：

- 指定的命令属于基本命令的列表

- 指定的命令是标准命令之一

- 框架处于自定义模式

- 基本命令列表为空

- 超过 20% 的命令调用是对指定命令的调用。

## <a name="cmfctoolbariscustomizemode"></a><a name="iscustomizemode"></a>CMFCToolbar：是定制模式

指定工具栏框架是否处于自定义模式。

```
static BOOL IsCustomizeMode();
```

### <a name="return-value"></a>返回值

如果框架处于自定义模式，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

您可以通过调用[CMFCToolBar 来切换自定义模式：：设置自定义模式](#setcustomizemode)。

当用户调用自定义对话框[（CMFCToolBars 自定义对话框类](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)） 时，框架将更改模式。

## <a name="cmfctoolbarisdragbutton"></a><a name="isdragbutton"></a>CMFCToolBar：：IsDragButton

确定是否拖动工具栏按钮。

```
BOOL IsDragButton(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>参数

*pButton*<br/>
[在]指向工具栏按钮的指针。

### <a name="return-value"></a>返回值

如果正在拖动指定的按钮，则为 TRUE;如果正在拖动指定的按钮，则为 TRUE。否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfctoolbarisexistcustomizebutton"></a><a name="isexistcustomizebutton"></a>CMFC工具栏：存在定制按钮

确定工具栏是否包含 **"自定义"** 按钮。

```
BOOL IsExistCustomizeButton();
```

### <a name="return-value"></a>返回值

如果工具栏包含 **"自定义"** 按钮，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

如果此方法返回 TRUE，[则 CMFCToolBar：：获取自定义按钮](#getcustomizebutton)方法将返回指向工具栏末尾显示的 **"自定义**"按钮的指针。

使用[CMFCToolBar：启用"自定义按钮"](#enablecustomizebutton)方法将 **"自定义**"按钮添加到工具栏。

## <a name="cmfctoolbarisfloating"></a><a name="isfloating"></a>CMFCToolBar：是浮动的

确定工具栏是否浮动。

```
virtual BOOL IsFloating() const;
```

### <a name="return-value"></a>返回值

如果工具栏是浮动的，则为 TRUE;否则，FALSE。

## <a name="cmfctoolbarislargeicons"></a><a name="islargeicons"></a>CMFCToolbar：：大图标

指定应用程序中的工具栏当前是否显示大图标。

```
static BOOL IsLargeIcons();
```

### <a name="return-value"></a>返回值

如果应用程序使用大图标，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

调用[CMFCToolBar：设置大图标](#setlargeicons)以在大图标和常规图标之间切换。

当用户在 **"自定义"** 对话框的 **"选项**"页上切换 **"大图标**"复选框时，框架会自动更改模式。

## <a name="cmfctoolbarislastcommandfrombutton"></a><a name="islastcommandfrombutton"></a>CMFCToolbar：是来自按钮的"正命令"

确定最近执行的命令是否从指定的工具栏按钮发送。

```
static BOOL IsLastCommandFromButton(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>参数

*pButton*<br/>
[在]指向按钮的指针。

### <a name="return-value"></a>返回值

如果最后一个命令是从*pButton*指定的按钮发送的，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

此方法通过调用`CWnd::GetCurrentMessage`获取指向[MSG 结构](/windows/win32/api/winuser/ns-winuser-msg)的指针。 然后，它将按钮的 HWND 与`MSG::lParam`和`MSG::hwnd`成员进行比较，以确定该按钮是否是命令的来源。

## <a name="cmfctoolbarislocked"></a><a name="islocked"></a>CMFCToolbar：：锁定

确定工具栏是否锁定。

```
BOOL IsLocked() const;
```

### <a name="return-value"></a>返回值

如果工具栏已锁定，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

当用户无法执行自定义任务（如重新定位工具栏按钮）时，此方法将返回 TRUE。

锁定的工具栏使用单独的图像列表。 有关这些图像列表的详细信息，请参阅[CMFCToolBar：：LoadBitmapEx](#loadbitmapex)。

## <a name="cmfctoolbarisonerowwithsibling"></a><a name="isonerowwithsibling"></a>CMFCToolbar：与同级同一个

确定工具栏及其同级工具栏是否位于同一行上。

```
BOOL IsOneRowWithSibling();
```

### <a name="return-value"></a>返回值

如果工具栏及其同级位于同一行上，则为 TRUE;如果工具栏及其同级位于同一行上，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

[CMFC自定义按钮：createPopupMenu](internal-classes.md)方法调用此方法以确定如何显示 **"自定义**"弹出式菜单。 如果此方法返回 TRUE，则框架将显示 **"一行"按钮上的"显示按钮**"。 否则，框架将显示 **"两行"按钮上的"显示按钮**"。

通常不需要使用此方法。 要启用 **"一行显示按钮**"或在 **"两行"按钮上显示按钮**，请致电[CMFCTool 栏：：设置同级工具栏](#setsiblingtoolbar)。

## <a name="cmfctoolbarisresourcechanged"></a><a name="isresourcechanged"></a>CMFCTool 栏：资源已更改

```
virtual BOOL IsResourceChanged() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarissibling"></a><a name="issibling"></a>CMFCToolBar：：是兄弟

```
BOOL IsSibling();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarisuserdefined"></a><a name="isuserdefined"></a>CMFCTool 栏：用户定义

指定工具栏是否由用户定义。

```
BOOL IsUserDefined() const;
```

### <a name="return-value"></a>返回值

如果工具栏是由用户创建的，则为 TRUE;否则 FALSE。

## <a name="cmfctoolbarloadbitmap"></a><a name="loadbitmap"></a>CMFC工具栏：加载位图

从应用程序资源加载工具栏图像。

```
virtual BOOL LoadBitmap(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>参数

*uiResID*<br/>
[在]引用热工具栏图像的位图的资源 ID。

*乌伊库德雷斯ID*<br/>
[在]引用冷工具栏图像的位图的资源 ID。

*uiMenuResID*<br/>
[在]引用常规菜单图像的位图的资源 ID。

*封锁*<br/>
[在]锁定工具栏的 TRUE;否则 FALSE。

*ui禁用雷斯ID*<br/>
[在]引用禁用工具栏图像的位图的资源 ID。

*uiMenu 禁用雷斯 ID*<br/>
[在]引用禁用菜单图像的位图的资源 ID。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

[CMFCToolBar::LoadToolBarEx](#loadtoolbarex) 方法调用此方法以加载与工具栏关联的图像。 重写此方法以执行图像资源的自定义加载。

调用 `LoadBitmapEx` 方法以在创建工具栏后加载其他图像。

## <a name="cmfctoolbarloadbitmapex"></a><a name="loadbitmapex"></a>CMFC工具栏：：加载比特映射Ex

```
virtual BOOL LoadBitmapEx(
    CMFCToolBarInfo& params,
    BOOL bLocked = FALSE);
```

### <a name="parameters"></a>参数

[在]*参数*<br/>
[在]*b锁定*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarloadlargeiconsstate"></a><a name="loadlargeiconsstate"></a>CMFC工具栏：加载大图标状态

```
static BOOL __stdcall LoadLargeIconsState(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>参数

[在]*lpsz配置文件名称*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarloadparameters"></a><a name="loadparameters"></a>CMFCToolBar：加载参数

从 Windows 注册表加载全局工具栏选项。

```
static BOOL LoadParameters(LPCTSTR lpszProfileName=NULL);
```

### <a name="parameters"></a>参数

*lpsz配置文件名称*<br/>
[在]指定 Windows 注册表项的相对路径。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

此方法加载全局参数，如菜单动画类型、菜单阴影样式以及是否显示 Windows 注册表中的大图标。

[CWinAppEx：LoadState](../../mfc/reference/cwinappex-class.md#loadstate)方法将此方法称为应用程序初始化过程的一部分。

## <a name="cmfctoolbarloadstate"></a><a name="loadstate"></a>CMFC工具栏：加载状态

从 Windows 注册表加载工具栏状态信息。

```
virtual BOOL LoadState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>参数

*lpsz配置文件名称*<br/>
[在]指定 Windows 注册表项的相对路径。

*nIndex*<br/>
[在]指定工具栏的控制 ID。

*uiID*<br/>
[在]指定工具栏的资源 ID。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

框架将此方法称为应用程序的初始化过程的一部分。 有关详细信息，请参阅[CWinAppEx：：加载状态](../../mfc/reference/cwinappex-class.md#loadstate)。

## <a name="cmfctoolbarloadtoolbar"></a><a name="loadtoolbar"></a>CMFC工具栏：加载工具栏

从应用程序资源加载工具栏。

```
virtual BOOL LoadToolBar(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0,
    UINT uiHotResID=0);
```

### <a name="parameters"></a>参数

*uiResID*<br/>
[在]工具栏的资源 ID。

*乌伊库德雷斯ID*<br/>
[在]引用冷工具栏图像的位图的资源 ID。

*uiMenuResID*<br/>
[在]引用常规菜单图像的位图的资源 ID。

*封锁*<br/>
[在]指定工具栏是否锁定的布尔值。 如果此参数*为 TRUE，* 则工具栏将锁定。 否则，工具栏未锁定。

*ui禁用雷斯ID*<br/>
[在]引用禁用工具栏图像的位图的资源 ID。

*uiMenu 禁用雷斯 ID*<br/>
[在]引用禁用菜单图像的位图的资源 ID。

*乌霍特雷斯ID*<br/>
[在]引用热工具栏图像的位图的资源 ID。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

框架在初始化期间调用此方法以加载与工具栏关联的图像。

### <a name="example"></a>示例

下面的示例演示如何在`LoadToolBar``CMFCToolBar`类中使用 方法。 此代码段是[IE 演示示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

## <a name="cmfctoolbarloadtoolbarex"></a><a name="loadtoolbarex"></a>CMFC工具栏：加载工具栏

通过使用`CMFCToolBarInfo`帮助器类从应用程序资源加载工具栏，使应用程序能够使用大图像。

```
virtual BOOL LoadToolBarEx(
    UINT uiToolbarResID,
    CMFCToolBarInfo& params,
    BOOL bLocked=FALSE);
```

### <a name="parameters"></a>参数

*uiToolbarResID*<br/>
[在]工具栏的资源 ID。

*params*<br/>
[在]对`CMFCToolBarInfo`包含工具栏图像的资源指示的对象的引用。

*封锁*<br/>
[在]指定工具栏是否锁定的布尔值。 如果此参数为 TRUE，则工具栏将锁定。 否则，工具栏未锁定。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

调用此方法从应用程序资源加载工具栏图像。

## <a name="cmfctoolbarm_dbllargeimageratio"></a><a name="m_dbllargeimageratio"></a>CMFC工具栏：m_dblLargeImageRatio

指定大型图像的尺寸（高度或宽度）与常规图像的尺寸之间的比率。

```
AFX_IMPORT_DATA static double m_dblLargeImageRatio;
```

### <a name="remarks"></a>备注

默认比率为 2。 您可以更改此值以使大型工具栏图像变大或变小。

如果不指定一组大型图像，则框架使用此数据成员。 例如，如果仅提供大小为 16x16 的小图像集，并且希望大图像的大小为 24x24，请此数据成员设置为 1.5。

## <a name="cmfctoolbarnextmenu"></a><a name="nextmenu"></a>CMFC工具栏：下一个菜单

```
virtual BOOL NextMenu();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbaronbeforeremovebutton"></a><a name="onbeforeremovebutton"></a>CMFCToolbar：：打开之前删除按钮

```
virtual BOOL OnBeforeRemoveButton(
    CMFCToolBarButton* pButton,
    DROPEFFECT dropEffect);
```

### <a name="parameters"></a>参数

*pButton*<br/>
[在]闲置。

*滴效果*<br/>
[在]闲置。

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbaronchangehot"></a><a name="onchangehot"></a>CMFCToolbar：：打开

当用户选择工具栏上的按钮时，框架调用。

```
virtual void OnChangeHot(int iHot);
```

### <a name="parameters"></a>参数

*iHot*<br/>
[在]指定所选工具栏按钮的索引;如果未选择工具栏按钮，则为 -1。

### <a name="remarks"></a>备注

重写此方法以处理用户在工具栏上选择按钮的通知。

## <a name="cmfctoolbaronchangevisualmanager"></a><a name="onchangevisualmanager"></a>CMFCToolbar：：打开视觉管理器

```
virtual void OnChangeVisualManager();
```

### <a name="remarks"></a>备注

## <a name="cmfctoolbaronfillbackground"></a><a name="onfillbackground"></a>CMFCToolbar：：在填充背景

由[CBasePane：:DoPaint 的](../../mfc/reference/cbasepane-class.md#dopaint)框架调用以填充工具栏背景。

```
virtual void OnFillBackground(CDC* pDC);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

### <a name="remarks"></a>备注

[CMFCToolBar：:DoPaint](#dopaint)在工具栏的背景已填充时调用此方法。 默认实现不执行任何操作。

重写此方法以在派生类中绘制自定义背景。

## <a name="cmfctoolbaronglobalfontschanged"></a><a name="onglobalfontschanged"></a>CMFCToolbar：：在放大缩小字体功能 放大缩小字体功能

```
virtual void OnGlobalFontsChanged();
```

### <a name="remarks"></a>备注

## <a name="cmfctoolbaronreset"></a><a name="onreset"></a>CMFCToolbar：打开

将工具栏还原到其原始状态。

```
virtual void OnReset();
```

### <a name="remarks"></a>备注

重写此方法以处理有关工具栏重置的通知。

默认实现不执行任何操作。 在`OnReset`工具栏具有虚拟按钮`CMFCToolBar`时派生的类中覆盖，当工具栏返回到其原始状态时，必须替换该按钮。

## <a name="cmfctoolbaronsetaccdata"></a><a name="onsetaccdata"></a>CMFCToolbar：：OnSetAccData

```
virtual BOOL OnSetAccData(long lVal);
```

### <a name="parameters"></a>参数

[在]*lVal*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbaronsetdefaultbuttontext"></a><a name="onsetdefaultbuttontext"></a>CMFC工具栏：打开默认按钮文本

将工具栏按钮的文本还原到其默认状态。

```
virtual BOOL OnSetDefaultButtonText(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>参数

*pButton*<br/>
[在]指向正在设置其文本的按钮。

### <a name="return-value"></a>返回值

如果文本已成功还原，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

重写此方法以处理工具栏按钮的文本正在更改为其默认值的通知。

默认实现从应用程序资源加载按钮的文本。

## <a name="cmfctoolbaronusertooltip"></a><a name="onusertooltip"></a>CMFC工具栏：在用户工具提示

当按钮的工具提示即将显示时，由框架调用。

```
virtual BOOL OnUserToolTip(
    CMFCToolBarButton* pButton,
    CString& strTTText) const;
```

### <a name="parameters"></a>参数

*pButton*<br/>
[在]指向要为其显示工具提示的工具栏按钮。

*斯特特文本*<br/>
[出]对`CString`接收工具提示文本的对象的引用。

### <a name="return-value"></a>返回值

如果*strTTText*填充了工具提示文本，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

当工具栏按钮的工具提示即将显示时，框架调用此方法。 如果`OnUserToolTip`返回 TRUE，则框架将显示一个工具提示，其中包含`OnUserToolTip`*strTTText*中返回的文本。 否则，工具提示包含按钮文本。

覆盖`OnUserToolTip`以自定义工具栏按钮的工具提示。 默认实现调用[CMFCToolBar：：onUserToolTip](#onusertooltip)以获取工具提示文本。

## <a name="cmfctoolbarprevmenu"></a><a name="prevmenu"></a>CMFCToolBar：:PrevMenu

```
virtual BOOL PrevMenu();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarprocesscommand"></a><a name="processcommand"></a>CMFC工具栏：:P

将WM_COMMAND消息发布到拥有工具栏的窗口。

```
BOOL ProcessCommand(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>参数

*pButton*<br/>
[在]指向工具栏上的按钮。

### <a name="return-value"></a>返回值

此方法应始终返回 TRUE。 MFC 在内部使用 FALSE 值。

### <a name="remarks"></a>备注

此方法通过调用[CWnd：:PostMessage](../../mfc/reference/cwnd-class.md#postmessage)并将指定按钮的命令 ID 传递给*wParam*参数，将WM_COMMAND消息发布到拥有工具栏的窗口。

使用[ON_COMMAND](message-map-macros-mfc.md#on_command)宏将WM_COMMAND消息映射到成员函数。

## <a name="cmfctoolbarremoveallbuttons"></a><a name="removeallbuttons"></a>CMFC工具栏：删除所有按钮

从工具栏中删除所有按钮和分隔符。

```
virtual void RemoveAllButtons();
```

### <a name="remarks"></a>备注

当重新创建或销毁工具栏时，框架将调用此方法。

## <a name="cmfctoolbarremovebutton"></a><a name="removebutton"></a>CMFC工具栏：删除按钮

从工具栏中删除具有指定索引的按钮。

```
virtual BOOL RemoveButton(int iIndex);
```

### <a name="parameters"></a>参数

*iIndex*<br/>
[在]指定要删除的按钮的零基索引。

### <a name="return-value"></a>返回值

如果方法成功，则为 TRUE;如果指定的索引无效或索引引用 **"自定义"** 按钮，则为 FALSE。

### <a name="remarks"></a>备注

此方法更新受删除按钮影响的其他工具栏属性。 例如，此方法从工具栏中删除非必需分隔符，并重建快捷键表。

有关 **"自定义"** 按钮的详细信息，请参阅[CMFCToolBar：：启用自定义按钮](#enablecustomizebutton)。

## <a name="cmfctoolbarremovestatefromregistry"></a><a name="removestatefromregistry"></a>CMFCToolbar：从注册处删除状态

从 Windows 注册表中删除工具栏的状态信息。

```
virtual BOOL RemoveStateFromRegistry(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>参数

*lpsz配置文件名称*<br/>
[在]指定状态信息所在的注册表项。

*nIndex*<br/>
[在]工具栏的控制 ID。

*uiID*<br/>
[在]工具栏的资源 ID。 如果此参数为 -1，则此方法使用[CWnd：getDlgCtrlID](../../mfc/reference/cwnd-class.md#getdlgctrlid)方法检索资源 ID。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

框架在删除用户定义的工具栏时调用此方法。

如果在 Windows 注册表中存储其他状态信息，则重写此方法。

## <a name="cmfctoolbarreplacebutton"></a><a name="replacebutton"></a>CMFC工具栏：更换按钮

将工具栏按钮替换为其他工具栏按钮。

```
int ReplaceButton(
    UINT uiCmd,
    const CMFCToolBarButton& button,
    BOOL bAll=FALSE);
```

### <a name="parameters"></a>参数

*乌伊Cmd*<br/>
[在]要替换的按钮的命令 ID。

*按钮*<br/>
[在]要插入的`CMFCToolBarButton`引用。

*球*<br/>
[在]指定是否替换具有*uiCmd*指定的命令 ID 的所有按钮的布尔值。 如果此参数为 TRUE，则将替换具有指定命令 ID 的所有按钮。 否则，将替换第一个按钮。

### <a name="return-value"></a>返回值

替换的按钮数。 如果工具栏上不存在具有指定命令 ID 的按钮，则此方法将返回 0。

### <a name="remarks"></a>备注

如果要添加无法从资源加载的工具栏按钮，请调用此方法。 您可以在设计时创建占位符按钮，并在初始化工具栏时将该按钮替换为自定义按钮。 有关使用此方法的示例，请参阅 VisualStudioDemo 示例。

### <a name="example"></a>示例

下面的示例演示如何在`ReplaceButton``CMFCToolBar`类中使用 方法。 此代码段是[IE 演示示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#10](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_5.cpp)]

## <a name="cmfctoolbarresetall"></a><a name="resetall"></a>CMFCToolBar：重置所有

将所有工具栏还原到其原始状态。

```
static void __stdcall ResetAll();
```

### <a name="remarks"></a>备注

此方法调用[CMFCToolBar：：](#restoreoriginalstate)还原应用程序中每个工具栏上可还原的工具栏上的"恢复原始状态"方法。 它使用[CMFCToolBar：：CanBeRestored 方法](#canberestored)来确定是否可以还原工具栏。

## <a name="cmfctoolbarresetallimages"></a><a name="resetallimages"></a>CMFCToolbar：：重置所有图像

清除应用程序中的所有工具栏图像集合。

```
static void __stdcall ResetAllImages();
```

### <a name="remarks"></a>备注

此方法清除由[CMFCToolBar：：LoadToolBar](#loadtoolbar)和[CMFCToolBar：：LoadBitmap](#loadbitmap)方法初始化的图像集合。

## <a name="cmfctoolbarresetimages"></a><a name="resetimages"></a>CMFCToolBar：重置图像

```
virtual void ResetImages();
```

### <a name="remarks"></a>备注

## <a name="cmfctoolbarrestorefocus"></a><a name="restorefocus"></a>CMFCToolBar：恢复焦点

```
virtual void RestoreFocus();
```

### <a name="remarks"></a>备注

## <a name="cmfctoolbarrestoreoriginalstate"></a><a name="restoreoriginalstate"></a>CMFCToolBar：：恢复原始状态

还原工具栏的原始状态。

```
virtual BOOL RestoreOriginalState();
```

### <a name="return-value"></a>返回值

如果方法成功，则为 TRUE;如果方法失败或工具栏由用户定义，则为 FALSE。

### <a name="remarks"></a>备注

此方法使用[CMFCToolBar：：LoadToolBar](#loadtoolbar)方法从资源文件加载工具栏。

当用户选择自定义对话框**工具栏页面上的****"全部重置"** 按钮时，框架将调用此方法。

## <a name="cmfctoolbarsaveparameters"></a><a name="saveparameters"></a>CMFCToolBar：：保存参数

```
static BOOL __stdcall SaveParameters(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>参数

[在]*lpsz配置文件名称*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarsavestate"></a><a name="savestate"></a>CMFCToolBar：保存状态

在 Windows 注册表中保存工具栏的状态信息。

```
virtual BOOL SaveState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>参数

*lpsz配置文件名称*<br/>
[在]指定 Windows 注册表项的相对路径。

*nIndex*<br/>
[在]工具栏的控制 ID。

*uiID*<br/>
[在]工具栏的资源 ID。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

当框架将应用程序状态保存到注册表时，它将调用此方法。 有关详细信息，请参阅[CWinAppEx：：保存状态](../../mfc/reference/cwinappex-class.md#savestate)。

## <a name="cmfctoolbarsetbasiccommands"></a><a name="setbasiccommands"></a>CMFC工具栏：：设置基本命令

设置用户打开菜单时始终显示的命令列表。

```
static void __stdcall SetBasicCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>参数

*lstCommands*<br/>
[在]对包含命令集合`CList`的对象的引用。

### <a name="remarks"></a>备注

打开菜单时，始终显示基本命令。 当用户选择查看最近使用的命令时，此方法是有意义的。

使用[CMFCToolBar：：AddBasicCommand](#addbasiccommand)方法将命令添加到基本命令列表中。 使用[CMFCToolBar：getBasicCommands](#getbasiccommands)方法检索应用程序使用的基本命令的列表。

有关使用此方法的示例，请参阅资源管理器示例。

## <a name="cmfctoolbarsetbuttoninfo"></a><a name="setbuttoninfo"></a>CMFC工具栏：设置按钮信息

设置工具栏按钮的命令 ID、样式和图像 ID。

```
void SetButtonInfo(
    int nIndex,
    UINT nID,
    UINT nStyle,
    int iImage);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]设置其属性的按钮的零基索引。

*nID*<br/>
[在]按钮的命令 ID。

*nStyle*<br/>
[在]按钮的样式。 有关可用工具栏按钮样式的列表，请参阅[工具栏控件样式](../../mfc/reference/toolbar-control-styles.md)。

*i图像*<br/>
[在]按钮的零基图像索引（即工具栏图像集合中的索引）。

### <a name="remarks"></a>备注

调用此方法以设置工具栏按钮的属性。

在调试生成中，如果*nIndex*指定的索引无效，此方法将生成断言失败。

调用[CMFCToolBar：：SetButtonStyle](#setbuttonstyle)方法，以仅设置按钮的样式。

## <a name="cmfctoolbarsetbuttons"></a><a name="setbuttons"></a>CMFC工具栏：设置按钮

设置工具栏的按钮。

```
virtual BOOL SetButtons(
    const UINT* lpIDArray,
    int nIDCount,
    BOOL bRemapImages=TRUE);
```

### <a name="parameters"></a>参数

*lpIDArray*<br/>
[在]指向要插入的按钮的命令指示数数组的指针。

*nIDCount*<br/>
[在]*lpIDArray*中的项数。

*bRemapImage*<br/>
[在]指定是否将现有按钮图像与插入的按钮关联的布尔值。 如果此参数为 TRUE，则重新映射图像。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

调用此方法从工具栏中删除现有按钮并插入新按钮的集合。

此方法将 **"自定义"** 按钮添加到工具栏，并将AFX_WM_RESETTOOLBAR消息发送到工具栏的父窗口。 有关 **"自定义"** 按钮的详细信息，请参阅[CMFCToolBar：：启用自定义按钮](#enablecustomizebutton)。

## <a name="cmfctoolbarsetbuttonstyle"></a><a name="setbuttonstyle"></a>CMFC工具栏：设置按钮样式

设置给定索引处工具栏按钮的样式。

```
virtual void SetButtonStyle(
    int nIndex,
    UINT nStyle);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]要设置其样式的工具栏按钮的零基索引。

*nStyle*<br/>
[在]按钮的样式。 有关可用工具栏按钮样式的列表，请参阅[工具栏控件样式](../../mfc/reference/toolbar-control-styles.md)。

### <a name="remarks"></a>备注

如果*TBBS_DISABLED nStyle，* 则此方法将删除TBBS_PRESSED样式，因为用户无法单击禁用的按钮。

## <a name="cmfctoolbarsetbuttontext"></a><a name="setbuttontext"></a>CMFCTool 栏：设置按钮文本

设置工具栏按钮的文本标签。

```
BOOL SetButtonText(
    int nIndex,
    LPCTSTR lpszText);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]工具栏按钮的索引。

*lpszText*<br/>
[在]工具栏按钮的文本标签。 必须为非 NULL。

### <a name="return-value"></a>返回值

如果方法成功，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

如果提供的索引不引用有效的工具栏按钮，则此方法将返回 FALSE。

## <a name="cmfctoolbarsetcommandusageoptions"></a><a name="setcommandusageoptions"></a>CMFC工具栏：设置命令使用选项

指定很少使用的命令未显示在应用程序的菜单中时。

```
static BOOL SetCommandUsageOptions(
    UINT nStartCount,
    UINT nMinUsagePercentage=5);
```

### <a name="parameters"></a>参数

*n 开始计数*<br/>
[在]指定在框架仅显示基本和最近使用的命令之前必须执行命令的次数。

*nMinUsage百分比*<br/>
[在]必须执行命令才能被视为最近使用的命令的百分比。

### <a name="return-value"></a>返回值

如果*nMinUsage 百分比*等于或大于 100，则 FALSE;否则为 TRUE。

### <a name="remarks"></a>备注

调用此方法以自定义框架用于确定基本和最近使用的菜单项的显示方式的算法。 有关基本命令的详细信息，请参阅[CMFCToolbar：：addBasic命令](#addbasiccommand)。

此类使用 类`CMFCCmdUsageCount`跟踪命令的使用计数。 有关此类的详细信息，请参阅[CMFCCmd使用计数类](../../mfc/reference/cmfccmdusagecount-class.md)。

## <a name="cmfctoolbarsetcustomizemode"></a><a name="setcustomizemode"></a>CMFC工具栏：设置自定义模式

为应用程序中的所有工具栏启用或禁用自定义模式。

```
static BOOL __stdcall SetCustomizeMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>参数

*bSet*<br/>
[在]指定是启用还是禁用自定义模式的布尔值。 将此参数设置为 TRUE 以启用自定义模式或 FALSE 以禁用它。

### <a name="return-value"></a>返回值

如果调用此方法更改自定义模式，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

此方法调整应用程序中每个工具栏的布局并重绘每个工具栏。 调用[CMFCToolBar：：是自定义模式](#iscustomizemode)方法，以确定应用程序是否处于自定义模式，

## <a name="cmfctoolbarsetgraydisabledbuttons"></a><a name="setgraydisabledbuttons"></a>CMFC工具栏：：设置灰色禁用按钮

指定工具栏上的不可用按钮是否变暗，或者是否使用了按钮不可用的图像。

```
void SetGrayDisabledButtons(BOOL bGrayDisabledButtons);
```

### <a name="parameters"></a>参数

*b格雷禁用按钮*<br/>
[在]指定如何显示不可用按钮的布尔值。 如果此参数为 TRUE，则框架将调暗按钮。 否则，框架将使用按钮不可用图像的集合。

### <a name="remarks"></a>备注

默认情况下，不可用的按钮会变暗。

## <a name="cmfctoolbarsetheight"></a><a name="setheight"></a>CMFC工具栏：设置高度

设置工具栏的高度。

```
void SetHeight(int cyHeight);
```

### <a name="parameters"></a>参数

*赛高地*<br/>
[在]工具栏的高度（以像素为单位）。

### <a name="remarks"></a>备注

此方法在设置高度后重绘工具栏。

## <a name="cmfctoolbarsethelpmode"></a><a name="sethelpmode"></a>CMFC工具栏：设置帮助模式

```
static void __stdcall SetHelpMode(BOOL bOn = TRUE);
```

### <a name="parameters"></a>参数

[在]*bon*<br/>

### <a name="remarks"></a>备注

## <a name="cmfctoolbarsethot"></a><a name="sethot"></a>CMFC工具栏：设置Hot

```
BOOL SetHot(CMFCToolBarButton* pMenuButton);
```

### <a name="parameters"></a>参数

[在]*pMenu按钮*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarsethotborder"></a><a name="sethotborder"></a>CMFCToolbar：：设置Hot边框

指定工具栏按钮是否热跟踪。

```
void SetHotBorder(BOOL bShowHotBorder);
```

### <a name="parameters"></a>参数

*b 秀霍特边框*<br/>
[在]指定是否热轨道工具栏按钮的布尔值。 如果此参数为 TRUE，工具栏热跟踪其按钮。 否则，工具栏不会热跟踪其按钮。

### <a name="remarks"></a>备注

如果按钮是热轨道的，则当鼠标在按钮上移动时，框架将突出显示该按钮。 默认情况下，每个工具栏热跟踪其按钮。

调用[CMFCToolBar：：GetHotBorder](#gethotborder)方法以确定工具栏热跟踪其按钮。

## <a name="cmfctoolbarsethottextcolor"></a><a name="sethottextcolor"></a>CMFC工具栏：设置HottextColor

设置热工具栏按钮的文本颜色。

```
static void SetHotTextColor(COLORREF clrText);
```

### <a name="parameters"></a>参数

*clrText*<br/>
[在]指定热轨道工具栏按钮的文本颜色。

### <a name="remarks"></a>备注

有关热跟踪工具栏按钮的详细信息，请参阅[CMFCToolBar：：获取HotBorder](#gethotborder)和[CMFCToolBar：：SetHotBorder](#sethotborder)。

## <a name="cmfctoolbarsetignoresettext"></a><a name="setignoresettext"></a>CMFC工具栏：设置忽略集文本

```
void SetIgnoreSetText(BOOL bValue);
```

### <a name="parameters"></a>参数

[在]*bValue*<br/>

### <a name="remarks"></a>备注

## <a name="cmfctoolbarsetlargeicons"></a><a name="setlargeicons"></a>CMFC工具栏：设置大图标

指定工具栏按钮是否显示大图标。

```
static void SetLargeIcons(BOOL bLargeIcons=TRUE);
```

### <a name="parameters"></a>参数

*b 大图标*<br/>
[在]指定要使用的图标的布尔值。 如果此参数为 TRUE，则框架将显示大图标。 否则，框架将显示常规图标。

### <a name="remarks"></a>备注

当用户更改 **"自定义"** 对话框"**选项**"选项卡中的 **"大图标**"复选框时，框架将调用此方法。 此方法调整应用程序中的所有工具栏的大小。

默认情况下，框架显示常规图标。

有关 **"自定义"** 对话框的详细信息，请参阅[CMFCToolBars 自定义对话框类](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)。

## <a name="cmfctoolbarsetlockedsizes"></a><a name="setlockedsizes"></a>CMFC工具栏：设置锁定大小

设置工具栏上锁定按钮和锁定图像的大小。

```
void SetLockedSizes(
    SIZE sizeButton,
    SIZE sizeImage,
    BOOL bDontScale = FALSE);
```

### <a name="parameters"></a>参数

*大小按钮*<br/>
[在]指定锁定工具栏按钮的大小。

*大小图像*<br/>
[在]指定锁定工具栏图像的大小。

*bDontScale*<br/>
指定在高 DPI 模式下是否缩放锁定工具栏图像。

### <a name="remarks"></a>备注

锁定按钮的默认大小为 23x22 像素。 锁定图像的默认大小为 16x15 像素。

调用[CMFCToolBar：：获取锁定图像大小](#getlockedimagesize)方法以检索锁定图像的大小。 调用[CMFCToolBar：：获取按钮大小](#getbuttonsize)方法以检索锁定工具栏按钮的大小。

## <a name="cmfctoolbarsetmaskmode"></a><a name="setmaskmode"></a>CMFC工具栏：设置蒙版模式

```
void SetMaskMode(BOOL bMasked);
```

### <a name="parameters"></a>参数

[在]*b*<br/>

### <a name="remarks"></a>备注

## <a name="cmfctoolbarsetmenusizes"></a><a name="setmenusizes"></a>CMFC工具栏：设置菜单大小

设置工具栏菜单按钮及其图像的大小。

```
static void __stdcall SetMenuSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>参数

*大小按钮*<br/>
[在]指定工具栏按钮的大小（以像素为单位）。

*大小图像*<br/>
[在]指定工具栏图像的大小（以像素为单位）。

### <a name="remarks"></a>备注

默认情况下，菜单按钮及其图像的大小未定义。

调用[CMFCToolBar：：GetMenuButtonSize 方法](#getmenubuttonsize)以确定菜单按钮的大小和[CMFCToolBar：：GetMenuImageSize](#getmenuimagesize)方法以确定菜单按钮图像的大小。

有关使用此方法的示例，请参阅 IEDemo 和 MSMoneyDemo 示例。

## <a name="cmfctoolbarsetnonpermittedcommands"></a><a name="setnonpermittedcommands"></a>CMFC工具栏：：设置不允许命令

设置用户无法执行的命令的列表。

```
static void SetNonPermittedCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>参数

*lstCommands*<br/>
[在]对`CList`包含用户无法执行的命令的对象的引用。

### <a name="remarks"></a>备注

调用此方法以防止用户选择某些命令。 例如，出于安全原因，您可能希望阻止用户选择某些命令。 有关使用此方法的示例，请参阅 MDITabsDemo 和 MenuSubSet 示例。

此方法清除以前不允许的命令列表。 默认情况下，不允许的命令列表为空。

## <a name="cmfctoolbarsetonerowwithsibling"></a><a name="setonerowwithsibling"></a>CMFCToolbar：设置同一行

将工具栏及其同级放在同一行上。

```
void SetOneRowWithSibling();
```

### <a name="remarks"></a>备注

当用户单击 **"一行"按钮的"显示按钮**"时，框架将调用此方法。

调用[CMFCToolBar：：设置 SiblingToolBar](#setsiblingtoolbar)方法，以启用 **"一行显示按钮**"或在 **"两行"按钮上显示按钮**。 如果为此工具栏调用[CMFCToolBar：设置 SiblingToolbar，](#setsiblingtoolbar)则同级工具栏将移动到此工具栏的行。 否则，此工具栏将移动到同级行。

当用户单击 **"两行"按钮**时，框架将调用[CMFCToolBar：：设置具有同级的"设置双行"](#settworowswithsibling)方法。

## <a name="cmfctoolbarsetorigbuttons"></a><a name="setorigbuttons"></a>CMFCToolBar：：设置OrigButtons

```
void SetOrigButtons(const CObList& lstOrigButtons);
```

### <a name="parameters"></a>参数

[在]*lstOrigButtons*<br/>

### <a name="remarks"></a>备注

## <a name="cmfctoolbarsetpermament"></a><a name="setpermament"></a>CMFC工具栏：：设置

指定用户是否可以关闭工具栏。

```
void SetPermament(BOOL bPermament=TRUE);
```

### <a name="parameters"></a>参数

*bPermament*<br/>
[在]指定用户是否可以关闭工具栏的布尔值。 如果此参数为 TRUE，则用户无法关闭工具栏。 否则，用户可以关闭工具栏。

### <a name="remarks"></a>备注

默认情况下，用户可以关闭每个工具栏。

调用[CMFCToolBar：：CanBeClose](#canbeclosed)方法以确定用户是否可以关闭工具栏。

## <a name="cmfctoolbarsetroutecommandsviaframe"></a><a name="setroutecommandsviaframe"></a>CMFC工具栏：：设置路由命令ViaFrame

指定父框架或所有者是向工具栏发送命令。

```
void SetRouteCommandsViaFrame(BOOL bValue);
```

### <a name="parameters"></a>参数

*bValue*<br/>
[在]如果此参数为 TRUE，则父帧会向工具栏发送命令。 否则，所有者会向工具栏发送命令。

### <a name="remarks"></a>备注

默认情况下，父框架向工具栏发送命令。 调用[CMFCToolBar：getRouteCommandsViaFrame](#getroutecommandsviaframe)方法，以确定父帧或所有者是向工具栏发送命令。

## <a name="cmfctoolbarsetshowtooltips"></a><a name="setshowtooltips"></a>CMFC工具栏：：设置显示工具提示

指定框架是否显示工具提示。

```
static void SetShowTooltips(BOOL bValue);
```

### <a name="parameters"></a>参数

*bValue*<br/>
[在]如果此参数为 TRUE，则框架将显示工具提示。 否则，框架将隐藏工具提示。

### <a name="remarks"></a>备注

默认情况下，框架显示工具提示。

调用[CMFCToolBar：：GetShowTool 提示](#getshowtooltips)方法以确定框架是否显示工具提示。

## <a name="cmfctoolbarsetsiblingtoolbar"></a><a name="setsiblingtoolbar"></a>CMFC工具栏：：设置同级工具栏

指定工具栏的同级。

```
void SetSiblingToolBar(CMFCToolBar* pBrotherToolbar);
```

### <a name="parameters"></a>参数

*pBrother工具栏*<br/>
[在]指向同级工具栏的指针。

### <a name="remarks"></a>备注

此方法启用 **"一行显示按钮**"或在 **"两行"按钮上显示的按钮**，当用户显示 **"自定义**"弹出式菜单时显示。 如果要使用户能够指定相关工具栏是出现在同一行还是出现在不同的行上，请调用此方法。

启用工具栏上显示的 **"自定义"** 按钮后，调用此方法。 要启用 **"自定义"** 按钮，请调用[CMFCToolBar：：启用自定义按钮](#enablecustomizebutton)方法。

要检索工具栏的同级，请致电[CMFCToolBar：：获取同级工具栏](#getsiblingtoolbar)。

## <a name="cmfctoolbarsetsizes"></a><a name="setsizes"></a>CMFC工具栏：设置大小

指定所有工具栏上的按钮和图像的大小。

```
static void __stdcall SetSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>参数

*大小按钮*<br/>
[在]工具栏按钮的大小（以像素为单位）。

*大小图像*<br/>
[在]工具栏按钮图像的大小（以像素为单位）。

### <a name="remarks"></a>备注

工具栏按钮的默认大小为 23x22 像素。 工具栏按钮图像的默认大小为 16x15 像素。

调用[CMFCToolBar：：获取图像大小](#getimagesize)方法以检索工具栏按钮图像的大小。 调用[CMFCToolBar：：获取按钮大小](#getbuttonsize)方法以检索工具栏按钮的大小。

## <a name="cmfctoolbarsettoolbarbtntext"></a><a name="settoolbarbtntext"></a>CMFC工具栏：设置工具栏文本

指定工具栏上按钮的属性。

```
void SetToolBarBtnText(
    UINT nBtnIndex,
    LPCTSTR szText=NULL,
    BOOL bShowText=TRUE,
    BOOL bShowImage=TRUE);
```

### <a name="parameters"></a>参数

*nBtnIndex*<br/>
[在]工具栏按钮列表中工具栏按钮的零基索引。

*szText*<br/>
[在]指定工具栏按钮的文本标签。

*b 显示文本*<br/>
[在]如果此参数为 TRUE，则框架将显示文本标签。 否则，框架将隐藏文本标签。

*b显示图像*<br/>
[在]如果此参数为 TRUE，则框架将显示工具栏按钮图像。 否则，框架将隐藏工具栏按钮图像。

### <a name="remarks"></a>备注

默认情况下，框架显示工具栏按钮的图像，但不显示工具栏按钮的文本标签。

在调试生成中，如果*nBtnIndex*不引用有效的工具栏按钮或工具栏按钮是分隔符，则此方法将生成断言失败。

## <a name="cmfctoolbarsettworowswithsibling"></a><a name="settworowswithsibling"></a>CMFCTool 栏：设置双行与同级

将工具栏及其同级放在单独的行上。

```
void SetTwoRowsWithSibling();
```

### <a name="remarks"></a>备注

当用户单击 **"两行显示按钮**"按钮时，框架将调用此方法。

调用[CMFCToolBar：：设置 SiblingToolBar](#setsiblingtoolbar)方法，以启用 **"一行显示按钮**"或在 **"两行"按钮上显示按钮**。 如果为此工具栏调用[CMFCToolBar：设置 SiblingToolbar，](#setsiblingtoolbar)则同级工具栏将移动到单独的行。 否则，此工具栏将移动到单独的行。

当用户单击 **"一行"按钮的"显示按钮**"时，框架将调用[CMFCToolBar：：当用户单击"一行"按钮时，设置OneRowWith与同级](#setonerowwithsibling)方法。

## <a name="cmfctoolbarsetuserimages"></a><a name="setuserimages"></a>CMFC工具栏：设置用户图像

设置应用程序中用户定义的映像的集合。

```
static BOOL SetUserImages(CMFCToolBarImages* pUserImages);
```

### <a name="parameters"></a>参数

*pUser图像*<br/>
[在]指向用户定义图像集合的指针。

### <a name="return-value"></a>返回值

如果方法成功，则非零;否则 0 如果`CMFCToolBarImages`指定对象无效，或者图像大小与工具栏的默认图像大小不同。

### <a name="remarks"></a>备注

框架使用用户定义的图像绘制由用户自定义的工具栏按钮。 *pUserImage*指定的图像列表在应用程序中的所有工具栏之间共享。

如果指定`CMFCToolBarImages`对象无效或图像大小与工具栏的默认图像大小不同，则此方法会在 Debug 生成中生成断言失败。

OutlookDemo、ToolTipDemo 和 VisualStudioDemo 示例使用此方法设置用户定义的图像的全局集合。 它们加载名为 UserImages.bmp 的文件，该文件位于应用程序的工作目录中。

调用[CMFCToolBar：：GetUserImage](#getuserimages)方法以检索应用程序中用户定义的映像的集合。

## <a name="cmfctoolbarstretchpane"></a><a name="stretchpane"></a>CMFC工具栏：拉伸窗格

垂直或水平拉伸工具栏，并在必要时重新定位按钮。

```
virtual CSize StretchPane(
    int nLength,
    BOOL bVert);
```

### <a name="parameters"></a>参数

*n 长度*<br/>
[在]拉伸窗格的金额（以像素为单位）。

*bVert*<br/>
[在]如果为 TRUE，则垂直拉伸窗格。 如果 FALSE，则水平拉伸窗格。

### <a name="return-value"></a>返回值

指定`CSize`工具栏工作区大小的对象。

### <a name="remarks"></a>备注

此方法调用[CMFCToolBar：wrapToolBar](#wraptoolbar)以重新定位拉伸工具栏中的按钮。

返回值通过调用[CMFCToolBar：：：CalcSize](#calcsize)来确定。

## <a name="cmfctoolbartranslatechar"></a><a name="translatechar"></a>CMFCToolBar：翻译查尔

如果指定的键代码对应于有效的键盘快捷键，则执行按钮命令。

```
virtual BOOL TranslateChar(UINT nChar);
```

### <a name="parameters"></a>参数

*n查尔*<br/>
[在]指定虚拟密钥代码。 有关标准虚拟密钥代码的列表，请参阅 Winuser.h

### <a name="return-value"></a>返回值

如果指定的键码不可打印或与有效的键盘快捷键不对应，则 FALSE;如果指定的密钥代码对应于下拉菜单选项，则为 TRUE;否则[，CMFCToolBar 的返回值：:Process命令](#processcommand)。

### <a name="remarks"></a>备注

当将键与 Alt 键一起按下时，框架将调用此方法。

## <a name="cmfctoolbarupdatebutton"></a><a name="updatebutton"></a>CMFC工具栏：更新按钮

更新指定按钮的状态。

```
void UpdateButton(int nIndex);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]指定要更新的按钮的零基索引。

### <a name="remarks"></a>备注

## <a name="cmfctoolbarwraptoolbar"></a><a name="wraptoolbar"></a>CMFC工具栏：包装工具栏

在给定尺寸内重新定位工具栏按钮。

```
int WrapToolBar(
    int nWidth,
    int nHeight = 32767,
    CDC* pDC = NULL,
    int nColumnWidth = -1,
    int nRowHeight = -1);
```

### <a name="parameters"></a>参数

*n 宽度*<br/>
[在]工具栏的最大宽度。

*nHeight*<br/>
[在]工具栏的最大高度。 如果工具栏是浮动的，则不使用。

*pDC*<br/>
[在]指向设备上下文的指针。 如果为 NULL，则使用工具栏的设备上下文。

*nColumn 宽度*<br/>
[在]按钮宽度。 如果 -1，则使用当前宽度。

[in] m *nRowHeight*按钮高度。 如果 -1，则使用当前高度。

### <a name="return-value"></a>返回值

工具栏上的按钮行数。

### <a name="remarks"></a>备注

此方法重新定位工具栏中的按钮，如有必要，将按钮包装到其他行。

## <a name="cmfctoolbarm_bdontscaleimages"></a><a name="m_bdontscaleimages"></a>CMFC工具栏：m_bDontScaleImages

指定是否在高 DPI 模式下缩放工具栏图像。

```
AFX_IMPORT_DATA static BOOL m_bDontScaleImages;
```

### <a name="remarks"></a>备注

## <a name="see-also"></a>另请参阅

[层次结构图表](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)<br/>
[CMFCMenuBar 类](../../mfc/reference/cmfcmenubar-class.md)<br/>
[CMFC弹出菜单栏类](../../mfc/reference/cmfcpopupmenubar-class.md)<br/>
[CMFC下拉工具栏类](../../mfc/reference/cmfcdropdowntoolbar-class.md)<br/>
[演练：将控件置于工具栏上](../../mfc/walkthrough-putting-controls-on-toolbars.md)

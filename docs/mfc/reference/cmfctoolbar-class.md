---
title: CMFCToolBar 类 |Microsoft Docs
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CMFCToolBar
- AFXTOOLBAR/CMFCToolBar
- AFXTOOLBAR/CMFCToolBar::AddBasicCommand
- AFXTOOLBAR/CMFCToolBar::AddCommandUsage
- AFXTOOLBAR/CMFCToolBar::AddToolBarForImageCollection
- AFXTOOLBAR/CMFCToolBar::AdjustLayout
- AFXTOOLBAR/CMFCToolBar::AdjustSize
- AFXTOOLBAR/CMFCToolBar::AllowChangeTextLabels
- AFXTOOLBAR/CMFCToolBar::AreTextLabels
- AFXTOOLBAR/CMFCToolBar::AutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::ButtonToIndex
- AFXTOOLBAR/CMFCToolBar::CalcFixedLayout
- AFXTOOLBAR/CMFCToolBar::CalcSize
- AFXTOOLBAR/CMFCToolBar::CanHandleSiblings
- AFXTOOLBAR/CMFCToolBar::CleanUpImages
- AFXTOOLBAR/CMFCToolBar::CleanUpLockedImages
- AFXTOOLBAR/CMFCToolBar::CanBeClosed
- AFXTOOLBAR/CMFCToolBar::CanBeRestored
- AFXTOOLBAR/CMFCToolBar::CanFocus
- AFXTOOLBAR/CMFCToolBar::CommandToIndex
- AFXTOOLBAR/CMFCToolBar::Create
- AFXTOOLBAR/CMFCToolBar::CreateEx
- AFXTOOLBAR/CMFCToolBar::Deactivate
- AFXTOOLBAR/CMFCToolBar::EnableCustomizeButton
- AFXTOOLBAR/CMFCToolBar::EnableDocking
- AFXTOOLBAR/CMFCToolBar::EnableLargeIcons
- AFXTOOLBAR/CMFCToolBar::EnableQuickCustomization
- AFXTOOLBAR/CMFCToolBar::EnableReflections
- AFXTOOLBAR/CMFCToolBar::EnableTextLabels
- AFXTOOLBAR/CMFCToolBar::FromHandlePermanent
- AFXTOOLBAR/CMFCToolBar::GetAllButtons
- AFXTOOLBAR/CMFCToolBar::GetAllToolbars
- AFXTOOLBAR/CMFCToolBar::GetBasicCommands
- AFXTOOLBAR/CMFCToolBar::GetButton
- AFXTOOLBAR/CMFCToolBar::GetButtonInfo
- AFXTOOLBAR/CMFCToolBar::GetButtonSize
- AFXTOOLBAR/CMFCToolBar::GetButtonStyle
- AFXTOOLBAR/CMFCToolBar::GetButtonText
- AFXTOOLBAR/CMFCToolBar::GetColdImages
- AFXTOOLBAR/CMFCToolBar::GetColumnWidth
- AFXTOOLBAR/CMFCToolBar::GetCommandButtons
- AFXTOOLBAR/CMFCToolBar::GetCount
- AFXTOOLBAR/CMFCToolBar::GetCustomizeButton
- AFXTOOLBAR/CMFCToolBar::GetDefaultImage
- AFXTOOLBAR/CMFCToolBar::GetDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetDisabledMenuImages
- AFXTOOLBAR/CMFCToolBar::GetDroppedDownMenu
- AFXTOOLBAR/CMFCToolBar::GetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::GetHighlightedButton
- AFXTOOLBAR/CMFCToolBar::GetHotBorder
- AFXTOOLBAR/CMFCToolBar::GetHotTextColor
- AFXTOOLBAR/CMFCToolBar::GetHwndLastFocus
- AFXTOOLBAR/CMFCToolBar::GetOVERWRITESetText
- AFXTOOLBAR/CMFCToolBar::GetImageSize
- AFXTOOLBAR/CMFCToolBar::GetImages
- AFXTOOLBAR/CMFCToolBar::GetImagesOffset
- AFXTOOLBAR/CMFCToolBar::GetInvalidateItemRect
- AFXTOOLBAR/CMFCToolBar::GetItemID
- AFXTOOLBAR/CMFCToolBar::GetItemRect
- AFXTOOLBAR/CMFCToolBar::GetLargeColdImages
- AFXTOOLBAR/CMFCToolBar::GetLargeDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLargeImages
- AFXTOOLBAR/CMFCToolBar::GetLockedColdImages
- AFXTOOLBAR/CMFCToolBar::GetLockedDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImageSize
- AFXTOOLBAR/CMFCToolBar::GetLockedMenuImages
- AFXTOOLBAR/CMFCToolBar::GetMenuButtonSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImageSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImages
- AFXTOOLBAR/CMFCToolBar::GetOrigButtons
- AFXTOOLBAR/CMFCToolBar::GetOrigResetButtons
- AFXTOOLBAR/CMFCToolBar::GetResourceID
- AFXTOOLBAR/CMFCToolBar::GetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::GetRowHeight
- AFXTOOLBAR/CMFCToolBar::GetShowTooltips
- AFXTOOLBAR/CMFCToolBar::GetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::GetUserImages
- AFXTOOLBAR/CMFCToolBar::HitTest
- AFXTOOLBAR/CMFCToolBar::InsertButton
- AFXTOOLBAR/CMFCToolBar::InsertSeparator
- AFXTOOLBAR/CMFCToolBar::InvalidateButton
- AFXTOOLBAR/CMFCToolBar::IsAddRemoveQuickCustomize
- AFXTOOLBAR/CMFCToolBar::IsAltCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsAutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::IsBasicCommand
- AFXTOOLBAR/CMFCToolBar::IsButtonExtraSizeAvailable
- AFXTOOLBAR/CMFCToolBar::IsButtonHighlighted
- AFXTOOLBAR/CMFCToolBar::IsCommandPermitted
- AFXTOOLBAR/CMFCToolBar::IsCommandRarelyUsed
- AFXTOOLBAR/CMFCToolBar::IsCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsDragButton
- AFXTOOLBAR/CMFCToolBar::IsExistCustomizeButton
- AFXTOOLBAR/CMFCToolBar::IsFloating
- AFXTOOLBAR/CMFCToolBar::IsLargeIcons
- AFXTOOLBAR/CMFCToolBar::IsLastCommandFromButton
- AFXTOOLBAR/CMFCToolBar::IsLocked
- AFXTOOLBAR/CMFCToolBar::IsOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::IsUserDefined
- AFXTOOLBAR/CMFCToolBar::LoadBitmap
- AFXTOOLBAR/CMFCToolBar::LoadBitmapEx
- AFXTOOLBAR/CMFCToolBar::LoadParameters
- AFXTOOLBAR/CMFCToolBar::LoadState
- AFXTOOLBAR/CMFCToolBar::LoadToolBar
- AFXTOOLBAR/CMFCToolBar::LoadToolBarEx
- AFXTOOLBAR/CMFCToolBar::OnChangeHot
- AFXTOOLBAR/CMFCToolBar::OnFillBackground
- AFXTOOLBAR/CMFCToolBar::OnReset
- AFXTOOLBAR/CMFCToolBar::OnSetAccData
- AFXTOOLBAR/CMFCToolBar::OnSetDefaultButtonText
- AFXTOOLBAR/CMFCToolBar::RemoveAllButtons
- AFXTOOLBAR/CMFCToolBar::RemoveButton
- AFXTOOLBAR/CMFCToolBar::RemoveStateFromRegistry
- AFXTOOLBAR/CMFCToolBar::ReplaceButton
- AFXTOOLBAR/CMFCToolBar::ResetAll
- AFXTOOLBAR/CMFCToolBar::ResetAllImages
- AFXTOOLBAR/CMFCToolBar::RestoreOriginalState
- AFXTOOLBAR/CMFCToolBar::SaveState
- AFXTOOLBAR/CMFCToolBar::SetBasicCommands
- AFXTOOLBAR/CMFCToolBar::SetButtonInfo
- AFXTOOLBAR/CMFCToolBar::SetButtonStyle
- AFXTOOLBAR/CMFCToolBar::SetButtonText
- AFXTOOLBAR/CMFCToolBar::SetButtons
- AFXTOOLBAR/CMFCToolBar::SetCommandUsageOptions
- AFXTOOLBAR/CMFCToolBar::SetCustomizeMode
- AFXTOOLBAR/CMFCToolBar::SetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::SetHeight
- AFXTOOLBAR/CMFCToolBar::SetHotBorder
- AFXTOOLBAR/CMFCToolBar::SetHotTextColor
- AFXTOOLBAR/CMFCToolBar::SetLargeIcons
- AFXTOOLBAR/CMFCToolBar::SetLockedSizes
- AFXTOOLBAR/CMFCToolBar::SetMenuSizes
- AFXTOOLBAR/CMFCToolBar::SetNonPermittedCommands
- AFXTOOLBAR/CMFCToolBar::SetOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::SetPermament
- AFXTOOLBAR/CMFCToolBar::SetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::SetShowTooltips
- AFXTOOLBAR/CMFCToolBar::SetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::SetSizes
- AFXTOOLBAR/CMFCToolBar::SetToolBarBtnText
- AFXTOOLBAR/CMFCToolBar::SetTwoRowsWithSibling
- AFXTOOLBAR/CMFCToolBar::SetUserImages
- AFXTOOLBAR/CMFCToolBar::StretchPane
- AFXTOOLBAR/CMFCToolBar::TranslateChar
- AFXTOOLBAR/CMFCToolBar::UpdateButton
- AFXTOOLBAR/CMFCToolBar::WrapToolBar
- AFXTOOLBAR/CMFCToolBar::AllowShowOnList
- AFXTOOLBAR/CMFCToolBar::CalcMaxButtonHeight
- AFXTOOLBAR/CMFCToolBar::DoPaint
- AFXTOOLBAR/CMFCToolBar::DrawButton
- AFXTOOLBAR/CMFCToolBar::DrawSeparator
- AFXTOOLBAR/CMFCToolBar::OnUserToolTip
- AFXTOOLBAR/CMFCToolBar::m_bDontScaleImages
- AFXTOOLBAR/CMFCToolBar::m_dblLargeImageRatio
dev_langs:
- C++
helpviewer_keywords:
- CMFCToolBar [MFC], AddBasicCommand
- CMFCToolBar [MFC], AddCommandUsage
- CMFCToolBar [MFC], AddToolBarForImageCollection
- CMFCToolBar [MFC], AdjustLayout
- CMFCToolBar [MFC], AdjustSize
- CMFCToolBar [MFC], AllowChangeTextLabels
- CMFCToolBar [MFC], AreTextLabels
- CMFCToolBar [MFC], AutoGrayInactiveImages
- CMFCToolBar [MFC], ButtonToIndex
- CMFCToolBar [MFC], CalcFixedLayout
- CMFCToolBar [MFC], CalcSize
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CleanUpImages
- CMFCToolBar [MFC], CleanUpLockedImages
- CMFCToolBar [MFC], CanBeClosed
- CMFCToolBar [MFC], CanBeRestored
- CMFCToolBar [MFC], CanFocus
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CommandToIndex
- CMFCToolBar [MFC], Create
- CMFCToolBar [MFC], CreateEx
- CMFCToolBar [MFC], Deactivate
- CMFCToolBar [MFC], EnableCustomizeButton
- CMFCToolBar [MFC], EnableDocking
- CMFCToolBar [MFC], EnableLargeIcons
- CMFCToolBar [MFC], EnableQuickCustomization
- CMFCToolBar [MFC], EnableReflections
- CMFCToolBar [MFC], EnableTextLabels
- CMFCToolBar [MFC], FromHandlePermanent
- CMFCToolBar [MFC], GetAllButtons
- CMFCToolBar [MFC], GetAllToolbars
- CMFCToolBar [MFC], GetBasicCommands
- CMFCToolBar [MFC], GetButton
- CMFCToolBar [MFC], GetButtonInfo
- CMFCToolBar [MFC], GetButtonSize
- CMFCToolBar [MFC], GetButtonStyle
- CMFCToolBar [MFC], GetButtonText
- CMFCToolBar [MFC], GetColdImages
- CMFCToolBar [MFC], GetColumnWidth
- CMFCToolBar [MFC], GetCommandButtons
- CMFCToolBar [MFC], GetCount
- CMFCToolBar [MFC], GetCustomizeButton
- CMFCToolBar [MFC], GetDefaultImage
- CMFCToolBar [MFC], GetDisabledImages
- CMFCToolBar [MFC], GetDisabledMenuImages
- CMFCToolBar [MFC], GetDroppedDownMenu
- CMFCToolBar [MFC], GetGrayDisabledButtons
- CMFCToolBar [MFC], GetHighlightedButton
- CMFCToolBar [MFC], GetHotBorder
- CMFCToolBar [MFC], GetHotTextColor
- CMFCToolBar [MFC], GetHwndLastFocus
- CMFCToolBar [MFC], GetIgnoreSetText
- CMFCToolBar [MFC], GetImageSize
- CMFCToolBar [MFC], GetImages
- CMFCToolBar [MFC], GetImagesOffset
- CMFCToolBar [MFC], GetInvalidateItemRect
- CMFCToolBar [MFC], GetItemID
- CMFCToolBar [MFC], GetItemRect
- CMFCToolBar [MFC], GetLargeColdImages
- CMFCToolBar [MFC], GetLargeDisabledImages
- CMFCToolBar [MFC], GetLargeImages
- CMFCToolBar [MFC], GetLockedColdImages
- CMFCToolBar [MFC], GetLockedDisabledImages
- CMFCToolBar [MFC], GetLockedImages
- CMFCToolBar [MFC], GetLockedImageSize
- CMFCToolBar [MFC], GetLockedMenuImages
- CMFCToolBar [MFC], GetMenuButtonSize
- CMFCToolBar [MFC], GetMenuImageSize
- CMFCToolBar [MFC], GetMenuImages
- CMFCToolBar [MFC], GetOrigButtons
- CMFCToolBar [MFC], GetOrigResetButtons
- CMFCToolBar [MFC], GetResourceID
- CMFCToolBar [MFC], GetRouteCommandsViaFrame
- CMFCToolBar [MFC], GetRowHeight
- CMFCToolBar [MFC], GetShowTooltips
- CMFCToolBar [MFC], GetSiblingToolBar
- CMFCToolBar [MFC], GetUserImages
- CMFCToolBar [MFC], HitTest
- CMFCToolBar [MFC], InsertButton
- CMFCToolBar [MFC], InsertSeparator
- CMFCToolBar [MFC], InvalidateButton
- CMFCToolBar [MFC], IsAddRemoveQuickCustomize
- CMFCToolBar [MFC], IsAltCustomizeMode
- CMFCToolBar [MFC], IsAutoGrayInactiveImages
- CMFCToolBar [MFC], IsBasicCommand
- CMFCToolBar [MFC], IsButtonExtraSizeAvailable
- CMFCToolBar [MFC], IsButtonHighlighted
- CMFCToolBar [MFC], IsCommandPermitted
- CMFCToolBar [MFC], IsCommandRarelyUsed
- CMFCToolBar [MFC], IsCustomizeMode
- CMFCToolBar [MFC], IsDragButton
- CMFCToolBar [MFC], IsExistCustomizeButton
- CMFCToolBar [MFC], IsFloating
- CMFCToolBar [MFC], IsLargeIcons
- CMFCToolBar [MFC], IsLastCommandFromButton
- CMFCToolBar [MFC], IsLocked
- CMFCToolBar [MFC], IsOneRowWithSibling
- CMFCToolBar [MFC], IsUserDefined
- CMFCToolBar [MFC], LoadBitmap
- CMFCToolBar [MFC], LoadBitmapEx
- CMFCToolBar [MFC], LoadParameters
- CMFCToolBar [MFC], LoadState
- CMFCToolBar [MFC], LoadToolBar
- CMFCToolBar [MFC], LoadToolBarEx
- CMFCToolBar [MFC], OnChangeHot
- CMFCToolBar [MFC], OnFillBackground
- CMFCToolBar [MFC], OnReset
- CMFCToolBar [MFC], OnSetAccData
- CMFCToolBar [MFC], OnSetDefaultButtonText
- CMFCToolBar [MFC], RemoveAllButtons
- CMFCToolBar [MFC], RemoveButton
- CMFCToolBar [MFC], RemoveStateFromRegistry
- CMFCToolBar [MFC], ReplaceButton
- CMFCToolBar [MFC], ResetAll
- CMFCToolBar [MFC], ResetAllImages
- CMFCToolBar [MFC], RestoreOriginalState
- CMFCToolBar [MFC], SaveState
- CMFCToolBar [MFC], SetBasicCommands
- CMFCToolBar [MFC], SetButtonInfo
- CMFCToolBar [MFC], SetButtonStyle
- CMFCToolBar [MFC], SetButtonText
- CMFCToolBar [MFC], SetButtons
- CMFCToolBar [MFC], SetCommandUsageOptions
- CMFCToolBar [MFC], SetCustomizeMode
- CMFCToolBar [MFC], SetGrayDisabledButtons
- CMFCToolBar [MFC], SetHeight
- CMFCToolBar [MFC], SetHotBorder
- CMFCToolBar [MFC], SetHotTextColor
- CMFCToolBar [MFC], SetLargeIcons
- CMFCToolBar [MFC], SetLockedSizes
- CMFCToolBar [MFC], SetMenuSizes
- CMFCToolBar [MFC], SetNonPermittedCommands
- CMFCToolBar [MFC], SetOneRowWithSibling
- CMFCToolBar [MFC], SetPermament
- CMFCToolBar [MFC], SetRouteCommandsViaFrame
- CMFCToolBar [MFC], SetShowTooltips
- CMFCToolBar [MFC], SetSiblingToolBar
- CMFCToolBar [MFC], SetSizes
- CMFCToolBar [MFC], SetToolBarBtnText
- CMFCToolBar [MFC], SetTwoRowsWithSibling
- CMFCToolBar [MFC], SetUserImages
- CMFCToolBar [MFC], StretchPane
- CMFCToolBar [MFC], TranslateChar
- CMFCToolBar [MFC], UpdateButton
- CMFCToolBar [MFC], WrapToolBar
- CMFCToolBar [MFC], AllowShowOnList
- CMFCToolBar [MFC], CalcMaxButtonHeight
- CMFCToolBar [MFC], DoPaint
- CMFCToolBar [MFC], DrawButton
- CMFCToolBar [MFC], DrawSeparator
- CMFCToolBar [MFC], OnUserToolTip
- CMFCToolBar [MFC], m_bDontScaleImages
- CMFCToolBar [MFC], m_dblLargeImageRatio
ms.assetid: e7679c01-fb94-44c0-98c6-3af955292fb5
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 7b92acb477e6e15dfe933360dd6456db09d7f52a
ms.sourcegitcommit: 799f9b976623a375203ad8b2ad5147bd6a2212f0
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/19/2018
ms.locfileid: "46408735"
---
# <a name="cmfctoolbar-class"></a>CMFCToolBar 类

`CMFCToolBar`类相似[CToolBar 类](../../mfc/reference/ctoolbar-class.md)，但为用户界面功能提供额外支持。 其中包括平面工具栏、有热图的工具栏、大图标、页导航按钮、锁定的工具栏、Rebar 控件、图像下的文本、背景图像和选项卡式工具栏。 `CMFCToolBar` 类还包含内置支持，用户可对工具栏和菜单、工具栏和菜单之间的拖放、组合框按钮、编辑框按钮、颜色选取器和汇总按钮进行自定义。

有关更多详细信息，请参阅中的源代码**VC\\atlmfc\\src\\mfc**的 Visual Studio 安装文件夹。

## <a name="syntax"></a>语法

```
class CMFCToolBar : public CMFCBaseToolBar
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|描述|
|----------|-----------------|
|`CMFCToolBar::CMFCToolBar`|默认构造函数。|
|`CMFCToolBar::~CMFCToolBar`|析构函数。|

### <a name="public-methods"></a>公共方法

|名称|描述|
|----------|-----------------|
|[CMFCToolBar::AddBasicCommand](#addbasiccommand)|将菜单命令添加到将始终显示，当用户打开一个菜单命令的列表。|
|[CMFCToolBar::AddCommandUsage](#addcommandusage)|一个与给定命令关联的计数器递增。|
|[CMFCToolBar::AddToolBarForImageCollection](#addtoolbarforimagecollection)|将映像从用户界面资源添加到应用程序中的图像集合。|
|[CMFCToolBar::AdjustLayout](#adjustlayout)|重新计算的大小和位置的工具栏。 (重写[cbasepane:: Adjustlayout](../../mfc/reference/cbasepane-class.md#adjustlayout))。|
|[CMFCToolBar::AdjustSize](#adjustsize)|重新计算工具栏的大小。|
|[CMFCToolBar::AllowChangeTextLabels](#allowchangetextlabels)|指定是否可以在工具栏按钮上的映像下显示的文本标签。|
|[CMFCToolBar::AreTextLabels](#aretextlabels)|指定是否在映像下的文本标签当前工具栏按钮上显示。|
|[CMFCToolBar::AutoGrayInactiveImages](#autograyinactiveimages)|启用或禁用的非活动状态的按钮图像的自动生成。|
|[CMFCToolBar::ButtonToIndex](#buttontoindex)|返回指定的索引[CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md)此工具栏中的对象。|
|[CMFCToolBar::CalcFixedLayout](#calcfixedlayout)|计算工具栏的水平大小。 (重写[cbasepane:: Calcfixedlayout](../../mfc/reference/cbasepane-class.md#calcfixedlayout)。)|
|[CMFCToolBar::CalcSize](#calcsize)|由框架作为布局计算过程的一部分调用。 (重写[CPane::CalcSize](../../mfc/reference/cpane-class.md#calcsize)。)|
|[CMFCToolBar::CanHandleSiblings](#canhandlesiblings)|确定工具栏和其同级是否定位在同一窗格上。|
|[CMFCToolBar::CleanUpImages](#cleanupimages)|释放分配给工具栏图像的系统资源。|
|[CMFCToolBar::CleanUpLockedImages](#cleanuplockedimages)|释放锁定的工具栏图像为分配的系统资源。|
|[CMFCToolBar::CanBeClosed](#canbeclosed)|指定用户是否可以关闭工具栏。 (重写[cbasepane:: Canbeclosed](../../mfc/reference/cbasepane-class.md#canbeclosed)。)|
|[CMFCToolBar::CanBeRestored](#canberestored)|确定是否在系统可以还原工具栏到其原始状态后自定义。|
|[CMFCToolBar::CanFocus](#canfocus)|指定是否在窗格可以接收焦点。 (重写[CBasePane::CanFocus](../../mfc/reference/cbasepane-class.md#canfocus)。)|
|[CMFCToolBar::CanHandleSiblings](#canhandlesiblings)|确定工具栏和其同级是否定位在同一窗格上。|
|[CMFCToolBar::CommandToIndex](#commandtoindex)|返回与指定的命令 ID 工具栏上的按钮的索引|
|[CMFCToolBar::Create](#create)|创建一个 `CMFCToolBar` 对象。|
|[CMFCToolBar::CreateEx](#createex)|创建`CMFCToolBar`使用其他样式选项，如大图标的对象。|
|[CMFCToolBar::Deactivate](#deactivate)|工具栏将停用。|
|[Cmfctoolbar:: Enablecustomizebutton](#enablecustomizebutton)|启用或禁用**添加或删除按钮**工具栏在端上显示的按钮。|
|[CMFCToolBar::EnableDocking](#enabledocking)|启用窗格的停靠到主框架。 (重写[CBasePane::EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking)。)|
|[CMFCToolBar::EnableLargeIcons](#enablelargeicons)|启用或禁用工具栏按钮上的大图标。|
|[CMFCToolBar::EnableQuickCustomization](#enablequickcustomization)|启用或禁用工具栏的快速自定义项，以便用户能够按**Alt**密钥，然后将按钮拖动到新位置。|
|[CMFCToolBar::EnableReflections](#enablereflections)|启用或禁用命令反射。|
|[CMFCToolBar::EnableTextLabels](#enabletextlabels)|启用或禁用工具栏按钮图像下的文本标签。|
|[CMFCToolBar::FromHandlePermanent](#fromhandlepermanent)|检索指向的`CMFCToolBar`对象，其中包含给定的窗口句柄。|
|[CMFCToolBar::GetAllButtons](#getallbuttons)|在工具栏中返回按钮的只读的列表。|
|[CMFCToolBar::GetAllToolbars](#getalltoolbars)|在应用程序中返回所有工具栏的只读列表。|
|[CMFCToolBar::GetBasicCommands](#getbasiccommands)|返回只读的应用程序中定义的基本命令列表。|
|[CMFCToolBar::GetButton](#getbutton)|返回一个指向`CMFCToolBarButton`对象具有指定的工具栏按钮索引。|
|[CMFCToolBar::GetButtonInfo](#getbuttoninfo)|返回命令 ID、 样式和图像的按钮的索引中指定索引处。|
|[CMFCToolBar::GetButtonSize](#getbuttonsize)|返回在工具栏上的每个按钮的尺寸。|
|[CMFCToolBar::GetButtonStyle](#getbuttonstyle)|返回位于指定索引处的工具栏按钮的当前样式。|
|[CMFCToolBar::GetButtonText](#getbuttontext)|返回具有指定的索引的按钮的文本标签。|
|[CMFCToolBar::GetColdImages](#getcoldimages)|返回一个指向应用程序中的冷工具栏按钮图像的集合。|
|[CMFCToolBar::GetColumnWidth](#getcolumnwidth)|返回的工具栏按钮的宽度。|
|[CMFCToolBar::GetCommandButtons](#getcommandbuttons)|返回在应用程序中具有指定的命令 ID 从所有工具栏按钮的列表。|
|[CMFCToolBar::GetCount](#getcount)|返回在工具栏上的按钮和分隔符数量。|
|[CMFCToolBar::GetCustomizeButton](#getcustomizebutton)|检索指向的`CMFCCustomizeButton`与工具栏关联的对象。|
|[CMFCToolBar::GetDefaultImage](#getdefaultimage)|返回与指定的命令 ID 的工具栏按钮的默认图像的索引|
|[CMFCToolBar::GetDisabledImages](#getdisabledimages)|返回一个指向用于在应用程序中的已禁用的工具栏按钮的图像的集合。|
|[CMFCToolBar::GetDisabledMenuImages](#getdisabledmenuimages)|返回一个指向用于在应用程序中的已禁用的菜单按钮的图像的集合。|
|[CMFCToolBar::GetDroppedDownMenu](#getdroppeddownmenu)|检索指向当前正在显示它的子菜单的菜单按钮对象的指针。|
|[CMFCToolBar::GetGrayDisabledButtons](#getgraydisabledbuttons)|指定的禁用的按钮的图像是否为灰色的版本的常规按钮图像，或从禁用的按钮图像的集合。|
|[CMFCToolBar::GetHighlightedButton](#gethighlightedbutton)|返回一个指向当前突出显示的工具栏按钮。|
|[CMFCToolBar::GetHotBorder](#gethotborder)|确定工具栏按钮是否热跟踪。|
|[CMFCToolBar::GetHotTextColor](#gethottextcolor)|返回的突出显示的工具栏按钮的文本颜色。|
|[CMFCToolBar::GetHwndLastFocus](#gethwndlastfocus)|返回的句柄之前工具栏有输入的焦点的窗口。|
|[CMFCToolBar::GetIgnoreSetText](#getignoresettext)|指定是否忽略调用来设置按钮的标签。|
|[CMFCToolBar::GetImageSize](#getimagesize)|返回当前的工具栏按钮图像的大小。|
|[CMFCToolBar::GetImages](#getimages)|返回一个指向集合的默认按钮图像的应用程序中。|
|[CMFCToolBar::GetImagesOffset](#getimagesoffset)|返回用于查找此工具栏中的全局列表的工具栏按钮图像的工具栏按钮图像的索引偏移量。|
|[CMFCToolBar::GetInvalidateItemRect](#getinvalidateitemrect)|检索工作区必须位于给定索引处的按钮重绘的区域。|
|[CMFCToolBar::GetItemID](#getitemid)|返回指定索引处的工具栏按钮的命令 ID。|
|[CMFCToolBar::GetItemRect](#getitemrect)|返回指定索引处的按钮的边框。|
|[CMFCToolBar::GetLargeColdImages](#getlargecoldimages)|返回一个指向应用程序中的大型冷工具栏按钮图像的集合。|
|[CMFCToolBar::GetLargeDisabledImages](#getlargedisabledimages)|返回一个指向应用程序中的大型禁用的工具栏按钮图像的集合。|
|[CMFCToolBar::GetLargeImages](#getlargeimages)|返回一个指向应用程序中的大型工具栏按钮图像的集合。|
|[CMFCToolBar::GetLockedColdImages](#getlockedcoldimages)|返回一个指向锁定冷工具栏图像的集合。|
|[CMFCToolBar::GetLockedDisabledImages](#getlockeddisabledimages)|返回一个指向的工具栏中的锁定已禁用映像集合。|
|[CMFCToolBar::GetLockedImages](#getlockedimages)|返回一个指向的工具栏中的锁定的按钮图像的集合。|
|[CMFCToolBar::GetLockedImageSize](#getlockedimagesize)|返回已锁定的工具栏图像的默认大小。|
|[CMFCToolBar::GetLockedMenuImages](#getlockedmenuimages)|返回一个指向集合被锁定的工具栏菜单图像的工具栏中。|
|[CMFCToolBar::GetMenuButtonSize](#getmenubuttonsize)|返回在应用程序中的菜单按钮的大小。|
|[CMFCToolBar::GetMenuImageSize](#getmenuimagesize)|返回在应用程序中的菜单按钮图像的大小。|
|[CMFCToolBar::GetMenuImages](#getmenuimages)|返回一个指向应用程序中的菜单按钮图像的集合。|
|[CMFCToolBar::GetOrigButtons](#getorigbuttons)|检索非自定义工具栏按钮的集合。|
|[CMFCToolBar::GetOrigResetButtons](#getorigresetbuttons)|检索非自定义重置工具栏按钮的集合。|
|[CMFCToolBar::GetResourceID](#getresourceid)|检索工具栏的资源 ID。|
|[CMFCToolBar::GetRouteCommandsViaFrame](#getroutecommandsviaframe)|确定哪些对象、 与父框架或所有者，将命令发送到工具栏。|
|[CMFCToolBar::GetRowHeight](#getrowheight)|返回的工具栏按钮的高度。|
|[CMFCToolBar::GetShowTooltips](#getshowtooltips)|指定是否为工具栏按钮显示的工具提示。|
|[CMFCToolBar::GetSiblingToolBar](#getsiblingtoolbar)|检索工具栏的同级。|
|[CMFCToolBar::GetUserImages](#getuserimages)|返回一个指向应用程序中的用户定义的工具栏按钮图像的集合。|
|[CMFCToolBar::HitTest](#hittest)|返回位于指定位置处的工具栏按钮的索引。|
|[CMFCToolBar::InsertButton](#insertbutton)|将按钮插入到工具栏。|
|[CMFCToolBar::InsertSeparator](#insertseparator)|在工具栏中插入分隔符。|
|[CMFCToolBar::InvalidateButton](#invalidatebutton)|使提供的索引处不存在的工具栏按钮的客户端区域无效。|
|[CMFCToolBar::IsAddRemoveQuickCustomize](#isaddremovequickcustomize)|确定用户是否可以添加或删除通过使用工具栏按钮**自定义**菜单选项。|
|[CMFCToolBar::IsAltCustomizeMode](#isaltcustomizemode)|指定是否*快速自定义*用于将一个按钮。|
|[CMFCToolBar::IsAutoGrayInactiveImages](#isautograyinactiveimages)|指定是否启用自动生成的非活动状态 （非突出显示） 按钮图像。|
|[CMFCToolBar::IsBasicCommand](#isbasiccommand)|确定命令是否已启用的基本命令列表。|
|[CMFCToolBar::IsButtonExtraSizeAvailable](#isbuttonextrasizeavailable)|确定工具栏是否可以显示已扩展边框的按钮。|
|[CMFCToolBar::IsButtonHighlighted](#isbuttonhighlighted)|确定是否突出显示在工具栏上的按钮。|
|[CMFCToolBar::IsCommandPermitted](#iscommandpermitted)|确定是否允许命令。|
|[CMFCToolBar::IsCommandRarelyUsed](#iscommandrarelyused)|确定命令是否很少使用 (请参阅[CMFCToolBar::SetCommandUsageOptions](#setcommandusageoptions))。|
|[CMFCToolBar::IsCustomizeMode](#iscustomizemode)|指定工具栏 framework 是否在自定义模式。|
|[CMFCToolBar::IsDragButton](#isdragbutton)|确定是否正被拖动的工具栏按钮。|
|[CMFCToolBar::IsExistCustomizeButton](#isexistcustomizebutton)|确定工具栏是否包含**自定义**按钮。|
|[CMFCToolBar::IsFloating](#isfloating)|确定是否浮动工具栏。|
|[CMFCToolBar::IsLargeIcons](#islargeicons)|指定应用程序中的工具栏是否当前显示大图标。|
|[CMFCToolBar::IsLastCommandFromButton](#islastcommandfrombutton)|确定是否最近执行的命令从指定的工具栏按钮发送。|
|[CMFCToolBar::IsLocked](#islocked)|确定工具栏是否已锁定。|
|[Cmfctoolbar:: Isonerowwithsibling](#isonerowwithsibling)|确定工具栏和其同级工具栏是否定位于同一行。|
|[CMFCToolBar::IsUserDefined](#isuserdefined)|指定工具栏是用户定义。|
|[CMFCToolBar::LoadBitmap](#loadbitmap)|从应用程序资源加载工具栏图像。|
|[CMFCToolBar::LoadBitmapEx](#loadbitmapex)|从应用程序资源加载工具栏图像。 包含图像的大小。|
|[CMFCToolBar::LoadParameters](#loadparameters)|从 Windows 注册表加载全局工具栏选项。|
|[CMFCToolBar::LoadState](#loadstate)|从 Windows 注册表加载工具栏状态信息。 (重写[CPane::LoadState](../../mfc/reference/cpane-class.md#loadstate)。)|
|[CMFCToolBar::LoadToolBar](#loadtoolbar)|从应用程序资源加载工具栏。|
|[Cmfctoolbar:: Loadtoolbarex](#loadtoolbarex)|通过使用从应用程序资源加载工具栏`CMFCToolBarInfo`帮助器类，以使应用程序使用大图像。|
|[CMFCToolBar::OnChangeHot](#onchangehot)|当用户选择工具栏上的按钮时由框架调用。|
|[CMFCToolBar::OnFillBackground](#onfillbackground)|由框架从调用[CBasePane::DoPaint](../../mfc/reference/cbasepane-class.md#dopaint)以填充工具栏背景。|
|[CMFCToolBar::OnReset](#onreset)|将工具栏还原到其原始状态。|
|[CMFCToolBar::OnSetAccData](#onsetaccdata)|(重写[cbasepane:: Onsetaccdata](../../mfc/reference/cbasepane-class.md#onsetaccdata)。)|
|[CMFCToolBar::OnSetDefaultButtonText](#onsetdefaultbuttontext)|还原为其默认状态的工具栏按钮的文本。|
|`CMFCToolBar::OnUpdateCmdUI`|内部使用。|
|[CMFCToolBar::RemoveAllButtons](#removeallbuttons)|从工具栏中删除所有按钮。|
|[CMFCToolBar::RemoveButton](#removebutton)|从工具栏中删除具有指定索引的按钮。|
|[CMFCToolBar::RemoveStateFromRegistry](#removestatefromregistry)|从 Windows 注册表中删除工具栏的状态信息。|
|[CMFCToolBar::ReplaceButton](#replacebutton)|将工具栏按钮替换为另一个工具栏按钮。|
|[CMFCToolBar::ResetAll](#resetall)|将所有工具栏都还原到其原始状态。|
|[CMFCToolBar::ResetAllImages](#resetallimages)|清除所有应用程序中的工具栏图像集合。|
|[CMFCToolBar::RestoreOriginalState](#restoreoriginalstate)|还原工具栏的原始状态。|
|[CMFCToolBar::SaveState](#savestate)|将工具栏的状态信息保存在 Windows 注册表中。 (重写[CPane::SaveState](../../mfc/reference/cpane-class.md#savestate)。)|
|`CMFCToolBar::Serialize`|（重写 `CBasePane::Serialize`。）|
|[CMFCToolBar::SetBasicCommands](#setbasiccommands)|设置始终显示在用户打开一个菜单命令的列表。|
|[CMFCToolBar::SetButtonInfo](#setbuttoninfo)|设置命令 ID、 样式和工具栏按钮的图像 ID。|
|[CMFCToolBar::SetButtonStyle](#setbuttonstyle)|设置给定索引处的工具栏按钮的样式。|
|[CMFCToolBar::SetButtonText](#setbuttontext)|设置工具栏按钮的文本标签。|
|[CMFCToolBar::SetButtons](#setbuttons)|设置工具栏按钮。|
|[CMFCToolBar::SetCommandUsageOptions](#setcommandusageoptions)|指定当很少使用的命令不会显示在菜单中的应用程序。|
|[CMFCToolBar::SetCustomizeMode](#setcustomizemode)|启用或禁用应用程序中的所有工具栏的自定义模式。|
|[CMFCToolBar::SetGrayDisabledButtons](#setgraydisabledbuttons)|指定是否在工具栏上禁用的按钮为灰显或如果已禁用的映像用于禁用的按钮。|
|[CMFCToolBar::SetHeight](#setheight)|设置工具栏的高度。|
|[CMFCToolBar::SetHotBorder](#sethotborder)|指定工具栏按钮是否热跟踪。|
|[CMFCToolBar::SetHotTextColor](#sethottextcolor)|设置热工具栏按钮的文本颜色。|
|[CMFCToolBar::SetLargeIcons](#setlargeicons)|指定工具栏按钮是否显示大图标。|
|[CMFCToolBar::SetLockedSizes](#setlockedsizes)|设置工具栏上的锁定的按钮和锁定的图像的大小。|
|[CMFCToolBar::SetMenuSizes](#setmenusizes)|设置工具栏菜单按钮及其映像的大小。|
|[CMFCToolBar::SetNonPermittedCommands](#setnonpermittedcommands)|设置的用户不能执行的命令的列表。|
|[Cmfctoolbar:: Setonerowwithsibling](#setonerowwithsibling)|工具栏和其同级放置在同一行上。|
|[CMFCToolBar::SetPermament](#setpermament)|指定用户是否可以关闭工具栏。|
|[CMFCToolBar::SetRouteCommandsViaFrame](#setroutecommandsviaframe)|指定是否与父框架或所有者将命令发送到工具栏。|
|[CMFCToolBar::SetShowTooltips](#setshowtooltips)|指定框架是否显示工具提示。|
|[Cmfctoolbar:: Setsiblingtoolbar](#setsiblingtoolbar)|指定工具栏的同级。|
|[CMFCToolBar::SetSizes](#setsizes)|指定所有工具栏按钮和图像的大小。|
|[CMFCToolBar::SetToolBarBtnText](#settoolbarbtntext)|在工具栏上，指定按钮的属性。|
|[Cmfctoolbar:: Settworowswithsibling](#settworowswithsibling)|工具栏和其同级放置在单独的行。|
|[CMFCToolBar::SetUserImages](#setuserimages)|在应用程序中设置用户定义的映像的集合。|
|[CMFCToolBar::StretchPane](#stretchpane)|垂直或水平拉伸工具栏。 (重写[cbasepane:: Stretchpane](../../mfc/reference/cbasepane-class.md#stretchpane)。)|
|[CMFCToolBar::TranslateChar](#translatechar)|如果指定的键代码对应于有效的键盘快捷方式，执行按钮命令。|
|[CMFCToolBar::UpdateButton](#updatebutton)|更新指定按钮的状态。|
|[CMFCToolBar::WrapToolBar](#wraptoolbar)|重新定位给定维度中的工具栏按钮。|

### <a name="protected-methods"></a>受保护的方法

|名称|描述|
|----------|-----------------|
|[CMFCToolBar::AllowShowOnList](#allowshowonlist)|确定是否工具栏显示在列表中上**工具栏**窗格**自定义**对话框。|
|[CMFCToolBar::CalcMaxButtonHeight](#calcmaxbuttonheight)|计算按钮在工具栏中的最大高度。|
|[CMFCToolBar::DoPaint](#dopaint)|重新绘制一个工具栏。|
|[CMFCToolBar::DrawButton](#drawbutton)|重新绘制的工具栏按钮。|
|[CMFCToolBar::DrawSeparator](#drawseparator)|重新绘制在工具栏上的分隔符。|
|[CMFCToolBar::OnUserToolTip](#onusertooltip)|要显示工具提示的按钮时由框架调用。|

### <a name="data-members"></a>数据成员

|name|描述|
|----------|-----------------|
|[CMFCToolBar::m_bDontScaleImages](#m_bdontscaleimages)|在高 DPI 模式下，指定是否要缩放或不工具栏图像。|
|[CMFCToolBar::m_dblLargeImageRatio](#m_dbllargeimageratio)|指定的图像的大小 （高度或宽度） 的维度和维度的常规映像之间的比率。|

## <a name="remarks"></a>备注

若要将合并`CMFCToolBar`对象到你的应用程序，请执行以下步骤：

1. 添加`CMFCToolBar`主框架窗口的对象。

1. 当处理主框架窗口的 WM_CREATE 消息时，调用[CMFCToolBar::Create](#create)或[CMFCToolBar::CreateEx](#createex)创建工具栏，并指定其样式。

1. 调用[CBasePane::EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking)指定停靠样式。

若要插入的特殊按钮，如组合框或下拉工具栏中，保留在父资源中，虚拟按钮并通过使用来替换在运行时将虚拟按钮[CMFCToolBar::ReplaceButton](#replacebutton)。 有关详细信息，请参阅[演练： 将置于工具栏上的控件](../walkthrough-putting-controls-on-toolbars.md)。

`CMFCToolBar` 是的 MFC 库类的基类[CMFCMenuBar 类](../../mfc/reference/cmfcmenubar-class.md)， [CMFCPopupMenuBar 类](../../mfc/reference/cmfcpopupmenubar-class.md)，并[CMFCDropDownToolBar 类](../../mfc/reference/cmfcdropdowntoolbar-class.md)。

## <a name="example"></a>示例

下面的示例演示如何使用中的各种方法`CMFCToolBar`类。 该示例演示如何设置工具条的窗口标签的文本、 设置边框、 窗格中，样式设置和启用**添加或删除按钮**工具栏在端上显示的按钮。 此代码片段属于[IE 演示示例](../../visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#8](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_2.cpp)]

## <a name="requirements"></a>要求

**标头：** afxtoolbar.h

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CBasePane](../../mfc/reference/cbasepane-class.md)

[CPane](../../mfc/reference/cpane-class.md)

[CMFCBaseToolBar](../../mfc/reference/cmfcbasetoolbar-class.md)

`CMFCToolBar`

##  <a name="addbasiccommand"></a>  CMFCToolBar::AddBasicCommand

将菜单命令添加到将始终显示，当用户打开一个菜单命令的列表。

```
static void __stdcall AddBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>参数

*uiCmd*<br/>
[in]指定要添加的命令。

### <a name="remarks"></a>备注

打开菜单时，会始终显示基本命令。 当用户选择要查看最近使用的命令，此方法是有意义。

使用[CMFCToolBar::SetBasicCommands](#setbasiccommands)方法设置将始终显示，当用户打开一个菜单命令的列表。 使用[CMFCToolBar::GetBasicCommands](#getbasiccommands)方法来检索应用程序使用的基本命令列表。

##  <a name="addcommandusage"></a>  CMFCToolBar::AddCommandUsage

一个与给定命令关联的计数器递增。

```
static void __stdcall AddCommandUsage(UINT uiCommand);
```

### <a name="parameters"></a>参数

*uiCommand*<br/>
[in]指定命令计数器递增。

### <a name="remarks"></a>备注

当用户选择菜单项时，框架将调用此方法。

框架将使用计数器以显示最近使用过的菜单项的命令。

此方法通过使用递增的命令计数器[CMFCCmdUsageCount::AddCmd](../../mfc/reference/cmfccmdusagecount-class.md#addcmd)方法。

##  <a name="addtoolbarforimagecollection"></a>  CMFCToolBar::AddToolBarForImageCollection

将映像从用户界面资源添加到应用程序中的图像集合。

```
static BOOL __stdcall AddToolBarForImageCollection(
    UINT uiResID,
    UINT uiBmpResID=0,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>参数

*uiResID*<br/>
[in]资源 ID 加载带有图像的工具栏。

*uiBmpResID*<br/>
[in]与工具栏图像的位图的资源 ID。

*uiColdResID*<br/>
[in]使用"冷"工具栏图像的位图的资源 ID。

*uiMenuResID*<br/>
[in]菜单图像的位图的资源 ID。

*uiDisabledResID*<br/>
[in]使用禁用的工具栏图像的位图的资源 ID。

*uiMenuDisabledResID*<br/>
[in]已禁用的菜单图像的位图的资源 ID。

### <a name="return-value"></a>返回值

如果方法成功，则为 TRUEFalse *uiResID*或*uiBmpResID*未指定有效的资源，或出现其他错误。

### <a name="remarks"></a>备注

调用此方法以加载与工具栏图像的位图，并将其添加到工具栏图像的集合。 此方法创建临时工具栏对象并调用[CMFCToolBar::LoadToolBar](#loadtoolbar)。

##  <a name="adjustlayout"></a>  CMFCToolBar::AdjustLayout

重新计算的大小和位置的工具栏。

```
virtual void AdjustLayout();
```

### <a name="remarks"></a>备注

在创建工具栏，以便重新计算其大小和位置时调用此方法。

框架调用此方法每次必须更改工具栏的布局。 例如，用户将另一个控件条的移动、 调整大小的应用程序窗口，或自定义工具栏时，必须更改布局。

重写此方法以提供自己的从派生类中的动态布局`CMFCToolbar`。

##  <a name="adjustsize"></a>  CMFCToolBar::AdjustSize

重新计算工具栏的大小。

```
void AdjustSize();
```

### <a name="remarks"></a>备注

此方法可确保工具栏适合的父框架的边界。 如果该工具栏具有没有父框架，此方法任何影响。

[CMFCToolBar::AdjustLayout](#adjustlayout)方法调用此方法来重新计算该大小，如果不是工具栏的父`CMFCReBar`对象。

##  <a name="allowchangetextlabels"></a>  CMFCToolBar::AllowChangeTextLabels

指定是否可以在工具栏按钮上的映像下显示的文本标签。

```
virtual BOOL AllowChangeTextLabels() const;
```

### <a name="return-value"></a>返回值

如果允许显示的图像; 下的文本标签，则返回 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

此方法由自定义对话框中，以确定是否启用**显示文本标签**上的复选框**工具栏**所选工具栏上的页。

默认实现，则返回 TRUE。

重写此方法在从派生的对象中`CMFCToolBar`，并不希望用户决定是否在图像下，工具栏按钮上显示的文本标签时返回 FALSE。

##  <a name="allowshowonlist"></a>  CMFCToolBar::AllowShowOnList

确定是否工具栏显示在列表中的工具栏上**工具栏**窗格**自定义**对话框。

```
virtual BOOL AllowShowOnList() const;
```

### <a name="return-value"></a>返回值

如果可以在工具栏自定义页的列表框中显示该工具栏对象则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

由框架以确定工具栏自定义页上的列表是否应包含特定对象派生自调用此方法`CMFCToolBar`。

默认实现始终返回 TRUE。 如果不想要在自定义对话框中的工具栏列表中显示的工具栏，重写此方法。

##  <a name="aretextlabels"></a>  CMFCToolBar::AreTextLabels

指定是否在映像下的文本标签当前工具栏按钮上显示。

```
BOOL AreTextLabels() const;
```

### <a name="return-value"></a>返回值

如果工具栏按钮显示的图像; 下的文本标签，则返回 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

使用[CMFCToolBar::EnableTextLabels](#enabletextlabels)以指定是否显示文本。 默认值为 FALSE。 调用[CMFCToolBar::AllowChangeTextLabels](#allowchangetextlabels)来指定用户是否可以更改此设置中的自定义对话框。

##  <a name="autograyinactiveimages"></a>  CMFCToolBar::AutoGrayInactiveImages

启用或禁用的非活动状态的按钮图像的自动生成。

```
static void AutoGrayInactiveImages(
    BOOL bEnable=TRUE,
    int nGrayImagePercentage=0,
    BOOL bRedrawAllToolbars=TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
[in]一个布尔值，指定是否 dim 处于非活动状态的图像。 如果此参数为 TRUE，灰显处于非活动状态的图像。 否则，处于非活动状态的图像未变暗。

*nGrayImagePercentage*<br/>
[in]指定处于非活动状态的图像的亮度百分比。 如果*bEnable*为 FALSE 时，将忽略此值。

*bRedrawAllToolbars*<br/>
[in]一个布尔值，该值指定是否在应用程序中重绘所有工具栏。 如果此参数为 TRUE，则此方法重绘所有工具栏。

### <a name="remarks"></a>备注

如果*bEnable*为 TRUE，框架将使用*nGrayImagePercentage*与常规映像生成处于非活动状态的图像。 否则，必须通过使用提供的非活动状态的图像集[CMFCToolBar::GetColdImages](#getcoldimages)方法。 默认情况下，将禁用此选项。

有关详细信息*nGrayImagePercentage*参数，请参阅[CMFCToolBarImages::GrayImages](../../mfc/reference/cmfctoolbarimages-class.md#grayimages)。

##  <a name="buttontoindex"></a>  CMFCToolBar::ButtonToIndex

返回指定的索引[CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md)此工具栏中的对象。

```
int ButtonToIndex(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>参数

*pButton*<br/>
[in]指向工具栏按钮对象的指针。

### <a name="return-value"></a>返回值

索引*pButton*的工具栏按钮; 否则为-1 指定的按钮不在此工具栏上的内部列表中。

##  <a name="calcfixedlayout"></a>  CMFCToolBar::CalcFixedLayout

计算工具栏的水平大小。

```
virtual CSize CalcFixedLayout(
    BOOL bStretch,
    BOOL bHorz);
```

### <a name="parameters"></a>参数

*bStretch*<br/>
[in]要延伸到父帧的大小工具栏，则为 TRUE。

*bHorz*<br/>
[in]为 TRUE，则水平; 定位工具栏如果为 FALSE，则要垂直方向的工具栏。

### <a name="return-value"></a>返回值

一个`CSize`对象，它指定工具栏的大小。

### <a name="remarks"></a>备注

此方法通过使用计算的工具栏大小`CMFCToolBar::CalcLayout`方法。 传递 LM_STRETCH 标志*dwMode*参数如果*bStretch*为 TRUE。 如果传递 LM_HORZ 标志*bHorz*为 TRUE。

请参阅使用此方法的示例，VisualStudioDemo 示例。

##  <a name="calcmaxbuttonheight"></a>  CMFCToolBar::CalcMaxButtonHeight

计算按钮在工具栏中的最大高度。

```
virtual int CalcMaxButtonHeight();
```

### <a name="return-value"></a>返回值

最大按钮的高度。

### <a name="remarks"></a>备注

此方法计算在工具栏上的所有工具栏按钮之间的最大高度。 高度可能会有所不同，具体取决于当前的工具栏停靠状态等因素。

重写此方法在派生类中的`CMFCToolBar`提供高度计算。

##  <a name="calcsize"></a>  CMFCToolBar::CalcSize

由框架作为布局计算过程的一部分调用。

```
virtual CSize CalcSize(BOOL bVertDock);
```

### <a name="parameters"></a>参数

*bVertDock*<br/>
[in]为 TRUE，则指定垂直; 停靠工具栏为 FALSE，则指定水平停靠工具栏。

### <a name="return-value"></a>返回值

一个`CSize`对象，它指定在工具栏上的按钮的总体大小。

### <a name="remarks"></a>备注

此方法会考虑影响的每个按钮，如文本标签和边框大小的区域大小的属性。

如果工具栏包含没有按钮，则此方法返回一个按钮的保留的大小由使用[CMFCToolBar::GetButtonSize](#getbuttonsize)方法。

##  <a name="canbeclosed"></a>  CMFCToolBar::CanBeClosed

指定用户是否可以关闭工具栏。

```
virtual BOOL CanBeClosed() const;
```

### <a name="return-value"></a>返回值

如果工具栏可以关闭用户; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

框架调用此方法以确定用户是否可以关闭一个工具栏。 如果该方法返回 TRUE，框架启用 SC_CLOSE 命令工具栏的系统菜单中，用户可以通过使用自定义对话框中的工具栏的列表中的复选框关闭工具栏。

默认实现，则返回 TRUE。 重写此方法在派生类中的`CMFCToolBar`以使用户无法关闭的工具栏对象。

##  <a name="canberestored"></a>  CMFCToolBar::CanBeRestored

确定是否在系统可以还原工具栏到其原始状态后自定义。

```
virtual BOOL CanBeRestored() const;
```

### <a name="return-value"></a>返回值

如果可以从应用程序资源; 还原工具栏，则返回 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

框架调用此方法以确定是否可以自定义之后到其原始状态返回一个工具栏。 从应用程序资源加载原始状态。

如果`CanBeRestored`，则返回 TRUE，**工具栏**页的自定义对话框的使**重置**为所选工具栏按钮。

如果工具栏时加载它的原始资源 ID 为非零，则默认实现返回 TRUE。 通常情况下，不能还原仅用户定义的工具栏。

您可以重写`CanBeRestored`方法以自定义此行为在派生类。

##  <a name="canfocus"></a>  CMFCToolBar::CanFocus

指定是否在窗格可以接收焦点。

```
virtual BOOL CanFocus() const;
```

### <a name="return-value"></a>返回值

此方法返回 FALSE。

### <a name="remarks"></a>备注

此方法重写基类实现[CBasePane::CanFocus](../../mfc/reference/cbasepane-class.md#canfocus)，这是因为工具栏对象不能接收焦点。

##  <a name="canhandlesiblings"></a>  CMFCToolBar::CanHandleSiblings

确定工具栏和其同级是否定位在同一窗格上。

```
BOOL CanHandleSiblings();
```

### <a name="return-value"></a>返回值

如果该工具栏具有同级，并且在同一窗格; 中的放置工具栏和其同级，则返回 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

内部的 cmfccustomizebutton:: Createpopupmenu 方法调用此方法来确定如何显示**自定义**弹出菜单。 如果此方法返回 TRUE，框架显示**一行上显示按钮**或**两个行显示按钮**按钮。

通常不需要使用此方法。 若要启用**自定义**按钮在工具栏中，调用将显示[cmfctoolbar:: Enablecustomizebutton](#enablecustomizebutton)方法。 若要启用**一行上显示按钮**或**两个行显示按钮**按钮，请调用[cmfctoolbar:: Setsiblingtoolbar](#setsiblingtoolbar)。

##  <a name="cleanupimages"></a>  CMFCToolBar::CleanUpImages

释放分配给工具栏图像的系统资源。

```
static void CMFCToolBar::CleanUpImages();
```

### <a name="remarks"></a>备注

当应用程序关闭时，框架将调用此方法。

##  <a name="cleanuplockedimages"></a>  CMFCToolBar::CleanUpLockedImages

释放锁定的工具栏图像为分配的系统资源。

```
void CleanUpLockedImages();
```

### <a name="remarks"></a>备注

你的应用程序的视觉样式更改时调用此方法。 请参阅使用此方法的示例，VisualStudioDemo 示例。

##  <a name="commandtoindex"></a>  CMFCToolBar::CommandToIndex

返回与指定的命令 ID 工具栏上的按钮的索引

```
int CommandToIndex(
    UINT nIDFind,
    int iIndexFirst=0) const;
```

### <a name="parameters"></a>参数

*nIDFind*<br/>
[in]指定命令 id。

*iIndexFirst*<br/>
[in]指定要从启动的初始索引。

### <a name="return-value"></a>返回值

如果此方法已成功，则工具栏按钮的从零开始的索引如果没有具有指定 ID 的按钮为-1

### <a name="remarks"></a>备注

一个`CMFCToolBar`对象维护的按钮在工具栏上的内部列表。 调用此函数可检索按钮的按钮的命令 ID 的列表中的索引。

如果*iIndex*大于 0，此方法将忽略任何按钮的工具栏上的一个索引小于*iIndex*。

##  <a name="create"></a>  CMFCToolBar::Create

创建一个 `CMFCToolBar` 对象。

```
virtual BOOL Create(
    CWnd* pParentWnd,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>参数

*pParentWnd*<br/>
[in]指向工具栏的父窗口的指针。

*dwStyle*<br/>
[in]Styl toolbar。 请参阅[工具栏控件和按钮样式](/windows/desktop/Controls/toolbar-control-and-button-styles)Windows SDK for 样式的列表中。

*nID*<br/>
[in]子窗口的工具栏的 ID。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

此方法创建的控件条，并将其附加到工具栏。 它使用 TBSTYLE_FLAT 样式创建控件条。 调用[CMFCToolBar::CreateEx](#createex)如果您希望不同的控件栏样式。

##  <a name="createex"></a>  CMFCToolBar::CreateEx

创建`CMFCToolBar`使用其他样式选项，如大图标的对象。

```
virtual BOOL CreateEx(
    CWnd* pParentWnd,
    DWORD dwCtrlStyle=TBSTYLE_FLAT,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    CRect rcBorders=CRect(1,
    1,
    1,
    1),
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>参数

*pParentWnd*<br/>
[in]指向工具栏的父窗口的指针。

*dwCtrlStyle*<br/>
[in]用于创建嵌入的控件条对象的其他样式。

*dwStyle*<br/>
[in]Styl toolbar。 请参阅[工具栏控件和按钮样式](/windows/desktop/Controls/toolbar-control-and-button-styles)的相应样式的列表。

*rcBorders*<br/>
[in]一个`CRect`对象，它指定工具栏窗口边框的宽度。

*nID*<br/>
[in]子窗口的工具栏的 ID。

### <a name="return-value"></a>返回值

如果此方法成功，则非零值否则为 0。

### <a name="remarks"></a>备注

此方法创建的控件条，并将其附加到工具栏。

调用此方法，而不是[CMFCToolBar::Create](#create)时您想要提供特定样式。 例如，设置*dwCtrlStyle*到 TBSTYLE_FLAT |若要创建一个类似于使用的 Internet Explorer 4 工具栏的工具栏的 TBSTYLE_TRANSPARENT。

### <a name="example"></a>示例

下面的示例演示如何使用`CreateEx`方法的`CMFCToolBar`类。 此代码片段属于[IE 演示示例](../../visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

##  <a name="deactivate"></a>  CMFCToolBar::Deactivate

工具栏将停用。

```
virtual void Deactivate();
```

### <a name="remarks"></a>备注

此方法从突出显示的工具栏按钮移走焦点，将停用工具栏。 工具栏失去焦点或销毁时，框架将调用此方法。

##  <a name="dopaint"></a>  CMFCToolBar::DoPaint

重新绘制一个工具栏。

```
virtual void DoPaint(CDC* pDC);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[in]指向设备上下文的指针。

### <a name="remarks"></a>备注

必须重新绘制工具栏的一部分时，由框架调用此方法。

重写此方法以自定义派生的对象的外观`CMFCToolBar`。

##  <a name="drawbutton"></a>  CMFCToolBar::DrawButton

重新绘制的工具栏按钮。

```
virtual BOOL DrawButton(
    CDC* pDC,
    CMFCToolBarButton* pButton,
    CMFCToolBarImages* pImages,
    BOOL bHighlighted,
    BOOL bDrawDisabledImages);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[in]指向设备上下文的指针。

*pButton*<br/>
[in]指向要绘制一个按钮的指针。

*pImages*<br/>
[in]指向工具栏图像的指针。

*bHighlighted*<br/>
[in]如果该按钮将突出显示; 则为 TRUE否则为 FALSE。

*bDrawDisabledImages*<br/>
[in]如果禁用的按钮为灰显; 则为 TRUE否则为 FALSE。

### <a name="return-value"></a>返回值

如果重新绘制按钮; 则为 TRUE如果按钮处于隐藏状态，则为 FALSE。

### <a name="remarks"></a>备注

[CMFCToolBar::DrawButton](#drawbutton)方法调用此方法时必须重新绘制的工具栏按钮。

如果你想要自定义您的工具栏上的按钮的外观，重写此方法。

##  <a name="drawseparator"></a>  CMFCToolBar::DrawSeparator

重新绘制在工具栏上的分隔符。

```
virtual void DrawSeparator(
    CDC* pDC,
    const CRect& rect,
    BOOL bHorz);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[in]指向设备上下文的指针。

*rect*<br/>
[in]该分隔符在绘制，以像素为单位的位置的绑定矩形。

*bHorz*<br/>
[in]如果分隔符是水平的则返回 FALSE 如果分隔符是垂直的则为 TRUE。

### <a name="remarks"></a>备注

[CMFCToolBar::DoPaint](#dopaint)调用此方法为每个[CMFCToolBar::DrawSeparator](#drawseparator)对象，它具有 TBBS_SEPARATOR 样式，而不是调用[CMFCToolBar::DrawButton](#drawbutton)对于那些按钮。

此方法在派生类中的重写[CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)以自定义工具栏上的分隔符的外观。 默认实现调用[CMFCVisualManager::OnDrawSeparator](../../mfc/reference/cmfcvisualmanager-class.md#ondrawseparator)来绘制其外观由当前视觉管理器的分隔符。

##  <a name="enablecustomizebutton"></a>  Cmfctoolbar:: Enablecustomizebutton

启用或禁用显示在工具栏的自定义按钮。

```
void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    const CString& strCustomizeText,
    BOOL bQuickCustomize=TRUE);


void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    UINT uiCustomizeTextResId,
    BOOL bQuickCustomize=TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
[in]启用或禁用自定义按钮。

*iCustomizeCmd*<br/>
[in]自定义按钮的命令 ID。

*strCustomizeText*<br/>
[in]自定义按钮的文本标签。

*uiCustomizeTextResId*<br/>
[in]自定义按钮标签字符串资源 ID。

*bQuickCustomize*<br/>
[in]启用或禁用**添加或删除按钮**下拉从按钮菜单上的选项。

### <a name="remarks"></a>备注

如果*iCustomizeCmd*为-1，则框架显示自定义按钮时工具栏区域中不适合多个工具栏按钮。 按钮显示双精度的向左箭头或 v 形图标，指示有多个按钮。

如果*iCustomizeCmd*指定一个有效的命令 ID，并*bEnable*是 TRUE 时，始终显示按钮自定义。 按钮有一个较小，向下箭头，打开一个包含命令的菜单。 此命令使用指定的文本标签*strCustomizeText*。 如果*bQuickCustomize*也是如此，菜单会显示**添加或删除按钮**选项。

框架不适合由指定的项之前的工具栏区域中任何按钮动态添加的菜单*iCustomizeCmd*。 旁边的向下箭头将显示 v 形图标。

##  <a name="enabledocking"></a>  CMFCToolBar::EnableDocking

启用窗格的停靠到主框架。

```
virtual void EnableDocking(DWORD dwAlignment);
```

### <a name="parameters"></a>参数

*dwAlignment*<br/>
[in]指定要启用的扩展对齐方式。

### <a name="remarks"></a>备注

此方法扩展基类实现[CBasePane::EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking)，通过设置`CBasePane::m_dwControlBarStyle`AFX_CBRS_FLOAT 到的数据成员。 然后，此方法将传递*dwAlignment*基类实现。

##  <a name="enablelargeicons"></a>  CMFCToolBar::EnableLargeIcons

启用或禁用工具栏按钮上的大图标。

```
void EnableLargeIcons(BOOL bEnable);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
[in]若要启用大图标，则返回 FALSE 来禁用大图标，则为 TRUE。

### <a name="remarks"></a>备注

默认情况下，启用大图标。

##  <a name="enablequickcustomization"></a>  CMFCToolBar::EnableQuickCustomization

启用或禁用工具栏的快速自定义项，以便用户能够按**Alt**密钥，然后将按钮拖动到新位置。

```
static void EnableQuickCustomization(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
[in]若要启用快速自定义项，则返回 FALSE 来禁用快速自定义，则为 TRUE。

##  <a name="enablereflections"></a>  CMFCToolBar::EnableReflections

启用或禁用命令反射。

```
void EnableReflections(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
[in]为 TRUE，则启用命令反射;如果为 FALSE 禁用命令反射。

### <a name="remarks"></a>备注

调用此方法以允许命令包含嵌入的控件，如组合框的工具栏按钮的反射。

有关命令反射的详细信息，请参阅[TN062: Windows 控件消息反射](../../mfc/tn062-message-reflection-for-windows-controls.md)。

##  <a name="enabletextlabels"></a>  CMFCToolBar::EnableTextLabels

启用或禁用工具栏按钮图像下的文本标签。

```
void EnableTextLabels(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
如果文本的标签显示在工具栏按钮图像; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

如果启用了文本标签，会增大工具栏上的所有按钮，以提供足够的空间要在图像下，显示的标签。 自定义对话框中有**显示文本标签**上的复选框**工具栏**页。 当用户选择一个工具栏，并检查此选项时，框架将调用`EnableTextLabels`为所选工具栏。 可以禁用复选框的一个派生自[CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)通过返回 FALSE 从[CMFCToolBar::AllowChangeTextLabels](#allowchangetextlabels) 。

##  <a name="fromhandlepermanent"></a>  CMFCToolBar::FromHandlePermanent

检索指向的`CMFCToolBar`对象，其中包含给定的窗口句柄。

```
static CMFCToolBar* __stdcall FromHandlePermanent(HWND hwnd);
```

### <a name="parameters"></a>参数

*hwnd*<br/>
[in]若要查找的窗口句柄。

### <a name="return-value"></a>返回值

一个指向`CMFCToolBar`对象，其中包含给定的窗口句柄，则为 NULL，如果没有相应的`CMFCToolBar`对象存在。

### <a name="remarks"></a>备注

此共享的方法将检查在应用程序为每个工具栏`CMFCToolBar`对象，其中包含给定的窗口句柄。

##  <a name="getallbuttons"></a>  CMFCToolBar::GetAllButtons

在工具栏中返回按钮的只读的列表。

```
const CObList& GetAllButtons() const;
```

### <a name="return-value"></a>返回值

常量引用[CObList 类](../../mfc/reference/coblist-class.md)对象，它包含一系列[CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md)对象。

##  <a name="getalltoolbars"></a>  CMFCToolBar::GetAllToolbars

在应用程序中返回所有工具栏的只读列表。

```
static const CObList& GetAllToolbars();
```

### <a name="return-value"></a>返回值

常量引用[CObList 类](../../mfc/reference/coblist-class.md)对象，其中包含一系列`CMFCToolBar`对象。

##  <a name="getbasiccommands"></a>  CMFCToolBar::GetBasicCommands

返回只读的应用程序中定义的基本命令列表。

```
static const CList<UINT,UINT>& GetBasicCommands();
```

### <a name="return-value"></a>返回值

常量引用[CList 类](../../mfc/reference/clist-class.md)对象，其中包含基本命令的集合。

### <a name="remarks"></a>备注

添加基本的命令通过调用[CMFCToolBar::AddBasicCommand](#addbasiccommand)或[CMFCToolBar::SetBasicCommands](#setbasiccommands)。

##  <a name="getbutton"></a>  CMFCToolBar::GetButton

返回一个指向[CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md)中指定索引处的对象。

```
CMFCToolBarButton* GetButton(int iIndex) const;
```

### <a name="parameters"></a>参数

*iIndex*<br/>
[in]指定要返回的按钮的索引。

### <a name="return-value"></a>返回值

工具栏按钮，如果它存在，则指向的指针或者，如果没有此类按钮，则为 NULL。

##  <a name="getbuttoninfo"></a>  CMFCToolBar::GetButtonInfo

返回命令 ID、 样式和图像的按钮的索引中指定索引处。

```
void GetButtonInfo(
    int nIndex,
    UINT& nID,
    UINT& nStyle,
    int& iImage) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[in]在工具栏上的按钮列表中指定的按钮的索引。

*nID*<br/>
[out]按钮的命令 ID。

*nStyle*<br/>
[out]按钮的样式。

*iImage*<br/>
[out]为按钮的图像的索引。

### <a name="remarks"></a>备注

`GetButtonInfo`方法中指定索引处查找工具栏按钮，并检索按钮的命令 ID、 样式和图像索引。

如果按钮中指定索引处不存在，框架将设置*nID*和*nStyle*为 0，并且*iImage*为-1，该方法返回时。

##  <a name="getbuttonsize"></a>  CMFCToolBar::GetButtonSize

返回在工具栏上的每个按钮的尺寸。

```
CSize GetButtonSize() const;
```

### <a name="return-value"></a>返回值

一个[CSize 类](../../atl-mfc-shared/reference/csize-class.md)对象，它指定在工具栏上的每个按钮的尺寸。

### <a name="remarks"></a>备注

调用[CMFCToolBar::SetSizes](#setsizes)或[CMFCToolBar::SetLockedSizes](#setlockedsizes)设置工具栏上的每个按钮的尺寸。

##  <a name="getbuttonstyle"></a>  CMFCToolBar::GetButtonStyle

返回位于指定索引处的工具栏按钮的当前样式。

```
UINT GetButtonStyle(int nIndex) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[in]指定工具栏按钮的索引。

### <a name="return-value"></a>返回值

一个值，指定工具栏按钮的样式。 . 请参阅[工具栏控件样式](../../mfc/reference/toolbar-control-styles.md)有关可能的样式的列表。

### <a name="remarks"></a>备注

调用[CMFCToolBar::SetButtonStyle](#setbuttonstyle)设置工具栏按钮的样式

##  <a name="getbuttontext"></a>  CMFCToolBar::GetButtonText

返回具有指定的索引的按钮的文本标签。

```
CString GetButtonText(int nIndex) const;

void GetButtonText(
    int nIndex,
    CString& rString) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[in]工具栏按钮的索引。

*rString*<br/>
[out]工具栏按钮的标签文本。

### <a name="return-value"></a>返回值

工具栏按钮的标签文本。

### <a name="remarks"></a>备注

调用[CMFCToolBar::SetButtonText](#setbuttontext)或[CMFCToolBar::SetToolBarBtnText](#settoolbarbtntext)设置文本标签。

##  <a name="getcoldimages"></a>  CMFCToolBar::GetColdImages

返回一个指向应用程序中的冷工具栏按钮图像的集合。

```
static CMFCToolBarImages* GetColdImages();
```

### <a name="return-value"></a>返回值

一个指向冷工具栏按钮图像的集合。

### <a name="remarks"></a>备注

冷映像是在用户不与工具栏按钮交互时，将使用的映像。 调用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)或[CMFCToolBar::LoadBitmap](#loadbitmap)加载冷的图像。

##  <a name="getcolumnwidth"></a>  CMFCToolBar::GetColumnWidth

返回的工具栏按钮的宽度。

```
virtual int GetColumnWidth() const;
```

### <a name="return-value"></a>返回值

一个值，指定工具栏按钮的宽度。

### <a name="remarks"></a>备注

框架调用此方法以计算工具栏布局。 重写此方法在派生类，以指定不同的列宽度为您的工具栏中。

##  <a name="getcommandbuttons"></a>  CMFCToolBar::GetCommandButtons

返回在应用程序中具有指定的命令 ID 从所有工具栏按钮的列表。

```
static int GetCommandButtons(
    UINT uiCmd,
    CObList& listButtons);
```

### <a name="parameters"></a>参数

*uiCmd*<br/>
[in]按钮的命令 ID。

*listButtons*<br/>
[out]对引用[CObList 类](../../mfc/reference/coblist-class.md)对象，它接收的工具栏按钮列表。

### <a name="return-value"></a>返回值

具有指定的命令 ID 的按钮的数目

##  <a name="getcount"></a>  CMFCToolBar::GetCount

返回在工具栏上的按钮和分隔符数量。

```
int GetCount() const;
```

### <a name="return-value"></a>返回值

按钮和工具栏上的分隔符的数量。

##  <a name="getcustomizebutton"></a>  CMFCToolBar::GetCustomizeButton

检索指向的`CMFCCustomizeButton`与工具栏关联的对象。

```
CMFCCustomizeButton* GetCustomizeButton();
```

### <a name="return-value"></a>返回值

一个指向`CMFCCustomizeButton`与工具栏关联的对象。

### <a name="remarks"></a>备注

此方法检索**自定义**按钮在工具栏中的最后阶段显示。 使用[cmfctoolbar:: Enablecustomizebutton](#enablecustomizebutton)方法中添加**自定义**到您的工具栏按钮。

您可以调用[CMFCToolBar::IsExistCustomizeButton](#isexistcustomizebutton)方法，以确定工具栏是否包含有效`CMFCCustomizeButton`对象。

##  <a name="getdefaultimage"></a>  CMFCToolBar::GetDefaultImage

返回与指定的命令 ID 的工具栏按钮的默认图像的索引

```
static int GetDefaultImage(UINT uiID);
```

### <a name="parameters"></a>参数

*uiID*<br/>
[in]指定按钮的命令 ID。

### <a name="return-value"></a>返回值

在共享的映像列表中的工具栏图像的索引。

### <a name="remarks"></a>备注

使用此共享的方法来检索与指定的命令 ID 的工具栏按钮的默认图像的索引 返回值是到共享集合的适用于应用程序中的所有工具栏的工具栏按钮图像的索引。 调用[CMFCToolBar::GetImages](#getimages)方法来获取此集合的指针。

##  <a name="getdisabledimages"></a>  CMFCToolBar::GetDisabledImages

返回一个指向用于在应用程序中的已禁用的工具栏按钮的图像的集合。

```
static CMFCToolBarImages* __stdcall GetDisabledImages();
```

### <a name="return-value"></a>返回值

指向已禁用的工具栏按钮图像的集合的指针。

### <a name="remarks"></a>备注

通过使用来加载已禁用的工具栏按钮图像[CMFCToolBarEditBoxButton 类](../../mfc/reference/cmfctoolbareditboxbutton-class.md)并[CMFCToolBar::LoadBitmap](#loadbitmap)方法。

##  <a name="getdisabledmenuimages"></a>  CMFCToolBar::GetDisabledMenuImages

返回一个指向用于在应用程序中的已禁用的菜单按钮的图像的集合。

```
static CMFCToolBarImages* __stdcall GetDisabledMenuImages();
```

### <a name="return-value"></a>返回值

指向已禁用的菜单图像的集合的指针。

### <a name="remarks"></a>备注

通过使用来加载已禁用的映像[CMFCToolBarEditBoxButton 类](../../mfc/reference/cmfctoolbareditboxbutton-class.md)方法。

##  <a name="getdroppeddownmenu"></a>  CMFCToolBar::GetDroppedDownMenu

检索指向当前正在显示它的子菜单的菜单按钮对象的指针。

```
CMFCToolBarMenuButton* GetDroppedDownMenu(int* pIndex = NULL) const;
```

### <a name="parameters"></a>参数

*pIndex*<br/>
[out]工具栏按钮集合中接收的按钮的索引。

### <a name="return-value"></a>返回值

指向显示其子菜单或 NULL 如果没有菜单显示它的子菜单的菜单按钮对象的指针。

### <a name="remarks"></a>备注

如果此方法返回一个非 NULL 值和*pIndex*不为 NULL，指向的值*pIndex*设置为工具栏按钮集合中的菜单按钮的索引。

##  <a name="getgraydisabledbuttons"></a>  CMFCToolBar::GetGrayDisabledButtons

指定的禁用的按钮的图像是否为灰色的版本的常规按钮图像，或从禁用的按钮图像的集合。

```
BOOL GetGrayDisabledButtons() const;
```

### <a name="return-value"></a>返回值

为 TRUE，则 dim 的禁用的按钮; 的映像如果为 FALSE，则若要从已禁用的图像集合中获取图像。

### <a name="remarks"></a>备注

使用[CMFCToolBar::SetGrayDisabledButtons](#setgraydisabledbuttons)灰显的映像和从集合中已禁用映像的映像之间进行切换。

##  <a name="gethighlightedbutton"></a>  CMFCToolBar::GetHighlightedButton

返回一个指向当前突出显示的工具栏按钮。

```
CMFCToolBarButton* GetHighlightedButton() const;
```

### <a name="return-value"></a>返回值

指向工具栏按钮对象;或者，如果没有按钮将突出显示，则为 NULL。

### <a name="remarks"></a>备注

如果具有键盘焦点，则将突出显示的工具栏按钮。 工具栏按钮也会突出显示，如果使用工具栏按钮，热跟踪在此应用程序 (有关详细信息，请参阅[CMFCToolBar::GetHotBorder](#gethotborder)并[CMFCToolBar::SetHotBorder](#sethotborder)) 和鼠标指向它时没有工具栏按钮或菜单项具有键盘焦点。

##  <a name="gethotborder"></a>  CMFCToolBar::GetHotBorder

确定工具栏按钮是否*热跟踪*。 如果按钮是热跟踪，它将突出显示当鼠标移过它。

```
BOOL GetHotBorder() const;
```

### <a name="return-value"></a>返回值

如果使用工具栏按钮，热跟踪; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

默认情况下，工具栏按钮是热跟踪。

##  <a name="gethottextcolor"></a>  CMFCToolBar::GetHotTextColor

返回的突出显示的工具栏按钮的文本颜色。

```
static COLORREF GetHotTextColor();
```

### <a name="return-value"></a>返回值

一个[COLORREF](/windows/desktop/gdi/colorref)值，该值表示当前突出显示的文本颜色。

### <a name="remarks"></a>备注

调用[CMFCToolBar::SetHotTextColor](#sethottextcolor)设置新的文本颜色突出显示的工具栏按钮。

##  <a name="gethwndlastfocus"></a>  CMFCToolBar::GetHwndLastFocus

返回的句柄之前工具栏有输入的焦点的窗口。

```
HWND GetHwndLastFocus() const;
```

### <a name="return-value"></a>返回值

不派生自的窗口的句柄[CMFCBaseToolBar 类](../../mfc/reference/cmfcbasetoolbar-class.md)，这些以前曾经输入集中; 或者如果没有此类窗口，则为 NULL。

### <a name="remarks"></a>备注

当`CMFCToolBar`控件接收输入的焦点，则将它存储的句柄，以便它可以在以后还原失去焦点的窗口。

##  <a name="getignoresettext"></a>  CMFCToolBar::GetIgnoreSetText

指定是否忽略调用来设置按钮的标签。

```
BOOL GetIgnoreSetText() const;
```

### <a name="return-value"></a>返回值

如果调用来设置按钮标签将被忽略; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="getimages"></a>  CMFCToolBar::GetImages

返回一个指向集合的默认按钮图像的应用程序中。

```
static CMFCToolBarImages* GetImages();
```

### <a name="return-value"></a>返回值

一个指向[CMFCToolBarImages 类](../../mfc/reference/cmfctoolbarimages-class.md)对象，其中包含应用程序中的所有工具栏的默认映像的集合。

### <a name="remarks"></a>备注

此共享的方法提供对所有默认值的集合的访问工具栏图像为应用程序。 调用[CMFCToolBar::LoadBitmap](#loadbitmap)方法将图像添加到集合。

##  <a name="getimagesize"></a>  CMFCToolBar::GetImageSize

返回当前的工具栏按钮图像的大小。

```
CSize GetImageSize() const;
```

### <a name="return-value"></a>返回值

一个[CSize 类](../../atl-mfc-shared/reference/csize-class.md)对象，表示当前的工具栏按钮图像的大小。

##  <a name="getimagesoffset"></a>  CMFCToolBar::GetImagesOffset

返回用于查找此工具栏中的全局列表的工具栏按钮图像的工具栏按钮图像的索引偏移量。

```
int GetImagesOffset() const;
```

### <a name="return-value"></a>返回值

工具栏图像索引偏移量。

### <a name="remarks"></a>备注

所有工具栏默认映像都存储在全局[CMFCToolBarImages 类](../../mfc/reference/cmfctoolbarimages-class.md)列表。 为每个按钮在工具栏中的映像是连续存储在该列表中。 若要计算的图像的索引，请将工具栏中的按钮的索引添加到该工具栏按钮的图像列表的开头的偏移量。

调用[CMFCToolBar::ButtonToIndex](#buttontoindex)获取按钮提供一个指向工具栏按钮的索引。

调用[CMFCToolBar::GetImages](#getimages)以获取指向工具栏图像的集合。

##  <a name="getinvalidateitemrect"></a>  CMFCToolBar::GetInvalidateItemRect

检索工作区必须位于给定索引处的按钮重绘的区域。

```
virtual void GetInvalidateItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[in]若要检索的工作区的按钮的索引。

*lpRect*<br/>
[out]指向接收客户端区域的区域的 RECT 对象的指针。

### <a name="remarks"></a>备注

*LpRect*参数不能为 NULL。 如果提供的索引处不存在任何按钮*lpRect*接收初始化为零的 RECT 对象。

##  <a name="getitemid"></a>  CMFCToolBar::GetItemID

返回指定索引处的工具栏按钮的命令 ID。

```
UINT GetItemID(int nIndex) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[in]指定工具栏按钮的索引。

### <a name="return-value"></a>返回值

工具栏按钮; 的命令 ID或如果不存在具有指定索引的按钮为零。

##  <a name="getitemrect"></a>  CMFCToolBar::GetItemRect

返回指定索引处的按钮的边框。

```
virtual void GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[in]指定工具栏按钮的索引。

*lpRect*<br/>
[out]一个指向`CRect`对象，它接收图像边框的坐标。

### <a name="remarks"></a>备注

`CRect`到对象*lpRect*点设置为 0，如果不存在的指定索引处的按钮。

### <a name="example"></a>示例

下面的示例演示如何使用`GetItemRect`方法的`CMFCToolBar`类。 此代码片段属于[IE 演示示例](../../visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#9](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_4.cpp)]

##  <a name="getlargecoldimages"></a>  CMFCToolBar::GetLargeColdImages

返回一个指向应用程序中的大型冷工具栏按钮图像的集合。

```
static CMFCToolBarImages* GetLargeColdImages();
```

### <a name="return-value"></a>返回值

一个指向冷的大型图像集合。

### <a name="remarks"></a>备注

冷映像是在用户不与工具栏按钮交互时，将使用的映像。 调用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)加载大型冷图像。

##  <a name="getlargedisabledimages"></a>  CMFCToolBar::GetLargeDisabledImages

返回一个指向应用程序中的大型禁用的工具栏按钮图像的集合。

```
static CMFCToolBarImages* GetLargeDisabledImages();
```

### <a name="return-value"></a>返回值

指向的大型集合禁用工具栏按钮图像。

### <a name="remarks"></a>备注

大型映像是大型的正则工具栏按钮图像的版本。 调用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)或[CMFCToolBar::LoadBitmap](#loadbitmap)加载大型图像。

##  <a name="getlargeimages"></a>  CMFCToolBar::GetLargeImages

返回一个指向应用程序中的大型工具栏按钮图像的集合。

```
static CMFCToolBarImages* GetLargeImages();
```

### <a name="return-value"></a>返回值

一个指向较大的工具栏按钮图像的集合。

### <a name="remarks"></a>备注

大型映像是大型的正则工具栏按钮图像的版本。 调用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)加载大型图像。

##  <a name="getlockedcoldimages"></a>  CMFCToolBar::GetLockedColdImages

返回一个指向锁定冷工具栏图像的集合。

```
CMFCToolBarImages* GetLockedColdImages();
```

### <a name="return-value"></a>返回值

一个指向锁定冷映像或如果未锁定工具栏，则为 NULL 的集合。

### <a name="remarks"></a>备注

锁定的映像是框架在用户不能自定义工具栏时使用的正则工具栏按钮图像的版本。 冷映像是在用户不与工具栏按钮交互时，将使用的映像。

如果工具栏不被锁定，则此方法返回 NULL。 如果此方法还生成了断言失败在调试版本中未锁定工具栏。 有关锁定的工具栏的详细信息，请参阅[CMFCToolBar::IsLocked](#islocked)。

调用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)方法以加载锁定冷图像。

##  <a name="getlockeddisabledimages"></a>  CMFCToolBar::GetLockedDisabledImages

返回一个指向的工具栏中的锁定已禁用映像集合。

```
CMFCToolBarImages* GetLockedDisabledImages();
```

### <a name="return-value"></a>返回值

一个指向锁定已禁用的映像或如果未锁定工具栏，则为 NULL 的集合。

### <a name="remarks"></a>备注

锁定的映像是框架在用户不能自定义工具栏时使用的正则工具栏按钮图像的版本。 已禁用的映像是框架在一个按钮具有 TBBS_DISABLED 样式时使用的映像。

如果工具栏不被锁定，则此方法返回 NULL。 如果此方法还生成了断言失败在调试版本中未锁定工具栏。 有关锁定的工具栏的详细信息，请参阅[CMFCToolBar::IsLocked](#islocked)。

调用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)方法以加载锁定禁用映像。

##  <a name="getlockedimages"></a>  CMFCToolBar::GetLockedImages

返回一个指向的工具栏中的锁定的按钮图像的集合。

```
CMFCToolBarImages* GetLockedImages();
```

### <a name="return-value"></a>返回值

指向已锁定的工具栏按钮图像或如果未锁定工具栏，则为 NULL 的集合的指针。

### <a name="remarks"></a>备注

锁定的映像是框架在用户不能自定义工具栏时使用的正则工具栏按钮图像的版本。

如果工具栏不被锁定，则此方法返回 NULL。 如果此方法还生成了断言失败在调试版本中未锁定工具栏。 有关锁定的工具栏的详细信息，请参阅[CMFCToolBar::IsLocked](#islocked)。

##  <a name="getlockedimagesize"></a>  CMFCToolBar::GetLockedImageSize

返回已锁定的工具栏图像的默认大小。

```
CSize GetLockedImageSize() const;
```

### <a name="return-value"></a>返回值

一个`CSize`结构，它指定已锁定的工具栏图像或一个空的大小`CSize`结构，如果未锁定工具栏。

### <a name="remarks"></a>备注

锁定的映像是框架在用户不能自定义工具栏时使用的正则工具栏按钮图像的版本。

此方法返回`CSize`结构使用零宽度和高度，如果未锁定工具栏。 如果此方法还生成了断言失败在调试版本中未锁定工具栏。 有关锁定的工具栏的详细信息，请参阅[CMFCToolBar::IsLocked](#islocked)。

调用[CMFCToolBar::SetLockedSizes](#setlockedsizes)方法，以指定锁定的图像的大小。

##  <a name="getlockedmenuimages"></a>  CMFCToolBar::GetLockedMenuImages

返回一个指向集合被锁定的工具栏菜单图像的工具栏中。

```
CMFCToolBarImages* GetLockedMenuImages();
```

### <a name="return-value"></a>返回值

指向已锁定的工具栏菜单图像或如果未锁定工具栏，则为 NULL 的集合的指针。

### <a name="remarks"></a>备注

锁定的映像是框架在用户不能自定义工具栏时使用的正则工具栏菜单映像的版本。

如果工具栏不被锁定，则此方法返回 NULL。 如果此方法还生成了断言失败在调试版本中未锁定工具栏。 有关锁定的工具栏的详细信息，请参阅[CMFCToolBar::IsLocked](#islocked)。

调用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)方法以加载锁定的菜单图像。

##  <a name="getmenubuttonsize"></a>  CMFCToolBar::GetMenuButtonSize

返回在应用程序中的菜单按钮的大小。

```
static CSize GetMenuButtonSize();
```

### <a name="return-value"></a>返回值

一个`CSize`对象，表示菜单按钮，以像素为单位的大小。

### <a name="remarks"></a>备注

工具栏上的菜单按钮的大小作为全局变量进行维护，并可以通过此静态方法来检索。

调用[CMFCToolBar::SetMenuSizes](#setmenusizes)设置此全局变量。

##  <a name="getmenuimages"></a>  CMFCToolBar::GetMenuImages

返回一个指向应用程序中的菜单按钮图像的集合。

```
static CMFCToolBarImages* GetMenuImages();
```

### <a name="return-value"></a>返回值

一个指向菜单图像的集合。

### <a name="remarks"></a>备注

调用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)方法以加载菜单图像。

调用[CMFCToolBar::SetMenuSizes](#setmenusizes)方法来设置按钮及其映像的大小。

##  <a name="getmenuimagesize"></a>  CMFCToolBar::GetMenuImageSize

返回在应用程序中的菜单按钮图像的大小。

```
static CSize GetMenuImageSize();
```

### <a name="return-value"></a>返回值

一个`CSize`对象，表示菜单图像的大小。

### <a name="remarks"></a>备注

此方法返回作为全局变量进行维护的工具栏菜单按钮上的图像的大小。 调用[CMFCToolBar::SetMenuSizes](#setmenusizes)设置此全局变量。

##  <a name="getorigbuttons"></a>  CMFCToolBar::GetOrigButtons

检索非自定义工具栏按钮的集合。

```
const CObList& GetOrigButtons() const;
```

### <a name="return-value"></a>返回值

对非自定义按钮工具栏的列表的引用。

### <a name="remarks"></a>备注

它们由用户自定义之前，框架将创建工具栏按钮的副本。 [CMFCToolBar::SetButtons](#setbuttons)方法将提供的数组中的每个按钮副本添加到原始按钮列表。 [CMFCToolBar::RestoreOriginalState](#restoreoriginalstate)方法通过从资源文件加载它来还原原始状态的工具栏。

若要设置的原始按钮在工具栏的列表，请调用[CMFCToolBar::SetOrigButtons](#setorigbuttons)方法。

##  <a name="getorigresetbuttons"></a>  CMFCToolBar::GetOrigResetButtons

检索非自定义重置工具栏按钮的集合。

```
const CObList& GetOrigResetButtons() const;
```

### <a name="return-value"></a>返回值

对非自定义重置按钮工具栏的列表的引用。

### <a name="remarks"></a>备注

当用户单击**重置**按钮期间自定义模式，该框架使用此方法来还原已删除从工具栏的按钮。

[CMFCToolBar::SetButtons](#setbuttons)方法将每个工具栏按钮的副本添加到原始重置按钮列表后，它调用[CMFCToolBar::OnReset](#onreset)方法。 您可以重写[CMFCToolBar::OnReset](#onreset)方法以自定义后，用户按下按钮的外观**重置**按钮。

##  <a name="getresourceid"></a>  CMFCToolBar::GetResourceID

检索工具栏的资源 ID。

```
UINT GetResourceID() const;
```

### <a name="return-value"></a>返回值

工具栏资源 ID。

### <a name="remarks"></a>备注

调用[cmfctoolbar:: Loadtoolbarex](#loadtoolbarex)方法以设置工具栏的资源 ID。

##  <a name="getroutecommandsviaframe"></a>  CMFCToolBar::GetRouteCommandsViaFrame

确定哪些对象、 与父框架或所有者，将命令发送到工具栏。

```
BOOL GetRouteCommandsViaFrame();
```

### <a name="return-value"></a>返回值

如果父框架将命令发送到工具栏; 非零值如果所有者将命令发送到工具栏，则为 0。

### <a name="remarks"></a>备注

默认情况下，父框架将命令发送到工具栏。 调用[CMFCToolBar::SetRouteCommandsViaFrame](#setroutecommandsviaframe)要更改此行为。

如果此方法返回一个非零值，您可以使用检索到父帧对象的指针`CMFCToolBar::GetCommandTarget`方法。 请参阅使用此方法的示例，VisualStudioDemo 示例。

##  <a name="getrowheight"></a>  CMFCToolBar::GetRowHeight

返回的工具栏按钮的高度。

```
virtual int GetRowHeight() const;
```

### <a name="return-value"></a>返回值

工具栏按钮，以像素为单位的高度。

### <a name="remarks"></a>备注

框架调用此方法以计算工具栏布局。 重写此方法在派生类来指定您的工具栏上的不同高度。

##  <a name="getshowtooltips"></a>  CMFCToolBar::GetShowTooltips

指定是否为工具栏按钮显示的工具提示。

```
static BOOL GetShowTooltips();
```

### <a name="return-value"></a>返回值

如果工具提示显示的工具栏按钮; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

默认情况下会显示工具提示。 您可以通过调用来更改此静态标志[CMFCToolBar::SetShowTooltips](#setshowtooltips)。

##  <a name="getsiblingtoolbar"></a>  CMFCToolBar::GetSiblingToolBar

检索工具栏的同级。

```
CMFCToolBar* GetSiblingToolBar();
```

### <a name="return-value"></a>返回值

指向同级工具栏的指针。

### <a name="remarks"></a>备注

有关如何启用详细信息**一行上显示按钮**并**两个行显示按钮**按钮，请参阅[cmfctoolbar:: Setsiblingtoolbar](#setsiblingtoolbar)。

##  <a name="getuserimages"></a>  CMFCToolBar::GetUserImages

返回一个指向应用程序中的用户定义的工具栏按钮图像的集合。

```
static CMFCToolBarImages* GetUserImages();
```

### <a name="return-value"></a>返回值

一个指向适用于应用程序中的所有工具栏的用户定义的工具栏按钮图像的集合。

### <a name="remarks"></a>备注

调用[CMFCToolBar::SetUserImages](#setuserimages)方法以在应用程序中设置的用户定义的映像集合。

##  <a name="hittest"></a>  CMFCToolBar::HitTest

返回位于指定位置处的工具栏按钮的索引。

```
virtual int HitTest(CPoint point);
```

### <a name="parameters"></a>参数

*点*<br/>
[in]要在工作区坐标中测试的点。

### <a name="return-value"></a>返回值

位于指定的位置，则为-1 如果没有此类或按钮的索引是按钮的一个分隔符。

##  <a name="insertbutton"></a>  CMFCToolBar::InsertButton

将按钮插入到工具栏。

```
virtual int InsertButton(
    const CMFCToolBarButton& button,
    INT_PTR iInsertAt=-1);


virtual int InsertButton(
    CMFCToolBarButton* pButton,
    int iInsertAt=-1);
```

### <a name="parameters"></a>参数

*按钮*<br/>
[in]指定要插入的按钮。

*iInsertAt*<br/>
[in]指定要插入的按钮的从零开始的位置。

### <a name="return-value"></a>返回值

插入按钮或-1 如果检测到错误发生位置。

### <a name="remarks"></a>备注

如果*iInsertAt*为-1，此方法将按钮添加到工具栏按钮列表的末尾。

调用[CMFCToolBar::InsertSeparator](#insertseparator)方法向工具栏插入分隔符。

##  <a name="insertseparator"></a>  CMFCToolBar::InsertSeparator

在工具栏中插入分隔符。

```
virtual int InsertSeparator(INT_PTR iInsertAt=-1);
```

### <a name="parameters"></a>参数

*iInsertAt*<br/>
[in]指定要插入的分隔符处的从零开始的位置。 此参数必须大于 0。

### <a name="return-value"></a>返回值

插入分隔符或-1 如果检测到错误发生位置。

### <a name="remarks"></a>备注

调用此方法以两个现有按钮之间插入分隔符。 如果*iInsertAt*为-1，此方法将分隔符添加到工具栏按钮列表的末尾。

此方法不能用于将分隔符添加到空工具栏。

调用[CMFCToolBar::InsertButton](#insertbutton)方法来将按钮插入到工具栏。

##  <a name="invalidatebutton"></a>  CMFCToolBar::InvalidateButton

使提供的索引处不存在的工具栏按钮的客户端区域无效。

```
CMFCToolBarButton* InvalidateButton(int nIndex);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[in]在工具栏中按钮的从零开始的索引。

### <a name="return-value"></a>返回值

一个指向`CMFCToolBarButton`位于提供的索引或为空的如果不存在任何此类对象的对象。

### <a name="remarks"></a>备注

更新与工具栏按钮相关联的工作区时，框架将调用此方法。 它将调用[CWnd::InvalidateRect](../../mfc/reference/cwnd-class.md#invalidaterect)方法的客户端矩形`CMFCToolBarButton`提供的索引处不存在的对象。

##  <a name="isaddremovequickcustomize"></a>  CMFCToolBar::IsAddRemoveQuickCustomize

确定用户是否可以添加或删除通过使用工具栏按钮**自定义**菜单选项。

```
BOOL IsAddRemoveQuickCustomize();
```

### <a name="return-value"></a>返回值

如果用户可以使用为 TRUE**自定义**菜单选项，用于修改工具栏; 否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="isaltcustomizemode"></a>  CMFCToolBar::IsAltCustomizeMode

指定是否*快速自定义*用于将一个按钮。 启用快速自定义后，用户可以按住 Alt 键，将按钮拖动到新位置。

```
static BOOL __stdcall IsAltCustomizeMode();
```

### <a name="return-value"></a>返回值

快速自定义用于将一个按钮; 如果为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="isautograyinactiveimages"></a>  CMFCToolBar::IsAutoGrayInactiveImages

指定是否启用自动生成的非活动状态 （非突出显示） 按钮图像。

```
static BOOL IsAutoGrayInactiveImages();
```

### <a name="return-value"></a>返回值

如果启用了自动变暗处于非活动状态的图像的选项; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

可以启用或禁用自动变暗的非活动状态的图像通过调用[CMFCToolBar::AutoGrayInactiveImages](#autograyinactiveimages)。

##  <a name="isbasiccommand"></a>  CMFCToolBar::IsBasicCommand

确定命令是否已启用的基本命令列表。

```
static BOOL IsBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>参数

*uiCmd*<br/>
[in]指定要检查的命令。

### <a name="return-value"></a>返回值

如果指定的命令所属的基本命令; 列表则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

此静态方法确定该命令通过指定*uiCmd*属于基本命令的全局列表。 可以通过调用更改的基本命令列表[CMFCToolBar::AddBasicCommand](#addbasiccommand)或[CMFCToolBar::SetBasicCommands](#setbasiccommands)。

##  <a name="isbuttonextrasizeavailable"></a>  CMFCToolBar::IsButtonExtraSizeAvailable

确定工具栏是否可以显示已扩展边框的按钮。

```
virtual BOOL IsButtonExtraSizeAvailable() const;
```

### <a name="return-value"></a>返回值

如果条形可以显示带有额外的边框大小，则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

如果它可以显示已扩展边框的按钮时返回 TRUE 工具栏对象。 工具栏按钮调用此方法时它处理[CMFCToolBarButton::OnChangeParentWnd](../../mfc/reference/cmfctoolbarbutton-class.md#onchangeparentwnd)通知并将相应地设置其内部的额外边框大小标志。 通过调用可能会更高版本检索此内部标志[CMFCToolBarButton::IsExtraSize](../../mfc/reference/cmfctoolbarbutton-class.md#isextrasize)。

重写此方法在派生类中的`CMFCToolBar`并且返回 TRUE，如果您的栏可以显示额外的边框大小与工具栏按钮，否则返回 FALSE。 默认实现，则返回 TRUE。

##  <a name="isbuttonhighlighted"></a>  CMFCToolBar::IsButtonHighlighted

确定指定的按钮是否突出显示。

```
BOOL IsButtonHighlighted(int iButton) const;
```

### <a name="parameters"></a>参数

*iButton*<br/>
[in]指定工具栏按钮的索引。

### <a name="return-value"></a>返回值

如果指定的按钮将突出显示; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="iscommandpermitted"></a>  CMFCToolBar::IsCommandPermitted

确定是否允许命令。

```
static BOOL IsCommandPermitted(UINT uiCmd);
```

### <a name="parameters"></a>参数

*uiCmd*<br/>
[in]指定要检查的命令。

### <a name="return-value"></a>返回值

如果允许指定的命令; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

此静态方法确定该命令通过指定*uiCmd*属于不允许命令的全局列表。

可以通过调用更改不允许命令的列表[CMFCToolBar::SetNonPermittedCommands](#setnonpermittedcommands)。

##  <a name="iscommandrarelyused"></a>  CMFCToolBar::IsCommandRarelyUsed

确定命令是否很少使用。

```
static BOOL IsCommandRarelyUsed(UINT uiCmd);
```

### <a name="parameters"></a>参数

*uiCmd*<br/>
[in]指定要检查的命令。

### <a name="return-value"></a>返回值

如果很少使用指定的命令; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

`IsCommandRarelyUsed`方法返回 FALSE 时一个或多个以下条件发生：

- 指定的命令所属的基本命令列表

- 指定的命令是一个标准命令

- 框架是在自定义模式

- 基本命令的列表为空

- 超过 20%的命令调用是对指定命令的调用。

##  <a name="iscustomizemode"></a>  CMFCToolBar::IsCustomizeMode

指定工具栏 framework 是否在自定义模式。

```
static BOOL IsCustomizeMode();
```

### <a name="return-value"></a>返回值

如果框架是在自定义模式，则为，TRUE否则为 FALSE。

### <a name="remarks"></a>备注

您可以通过调用切换自定义模式[CMFCToolBar::SetCustomizeMode](#setcustomizemode)。

该框架将模式更改，当用户调用的自定义对话框 ( [CMFCToolBarsCustomizeDialog 类](../../mfc/reference/cmfctoolbarscustomizedialog-class.md))。

##  <a name="isdragbutton"></a>  CMFCToolBar::IsDragButton

确定是否正被拖动的工具栏按钮。

```
BOOL IsDragButton(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>参数

*pButton*<br/>
[in]指向工具栏按钮。

### <a name="return-value"></a>返回值

如果指定的按钮正被拖动; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="isexistcustomizebutton"></a>  CMFCToolBar::IsExistCustomizeButton

确定工具栏是否包含**自定义**按钮。

```
BOOL IsExistCustomizeButton();
```

### <a name="return-value"></a>返回值

如果工具栏包含为 TRUE**自定义**按钮; 否则为 FALSE。

### <a name="remarks"></a>备注

如果此方法返回 TRUE， [CMFCToolBar::GetCustomizeButton](#getcustomizebutton)方法返回一个指向**自定义**按钮在工具栏中的最后阶段显示。

使用[cmfctoolbar:: Enablecustomizebutton](#enablecustomizebutton)方法中添加**自定义**到您的工具栏按钮。

##  <a name="isfloating"></a>  CMFCToolBar::IsFloating

确定是否浮动工具栏。

```
virtual BOOL IsFloating() const;
```

### <a name="return-value"></a>返回值

如果浮动工具栏; 则为 TRUE否则为 FALSE。

##  <a name="islargeicons"></a>  CMFCToolBar::IsLargeIcons

指定应用程序中的工具栏是否当前显示大图标。

```
static BOOL IsLargeIcons();
```

### <a name="return-value"></a>返回值

如果应用程序使用大图标; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

调用[CMFCToolBar::SetLargeIcons](#setlargeicons)大图标和常规图标之间进行切换。

框架会自动更改模式下，当用户切换**大图标**上的复选框**选项**页**自定义**对话框。

##  <a name="islastcommandfrombutton"></a>  CMFCToolBar::IsLastCommandFromButton

确定是否最近执行的命令从指定的工具栏按钮发送。

```
static BOOL IsLastCommandFromButton(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>参数

*pButton*<br/>
[in]指向按钮。

### <a name="return-value"></a>返回值

如果已从按钮发送的最后一个命令为 TRUE， *pButton*指定; 否则为 FALSE。

### <a name="remarks"></a>备注

此方法获取指向的指针[MSG 结构](../../mfc/reference/msg-structure1.md)通过调用`CWnd::GetCurrentMessage`。 然后，它比较的按钮的 HWND`MSG::lParam`和`MSG::hwnd`成员以确定该按钮是否是命令源。

##  <a name="islocked"></a>  CMFCToolBar::IsLocked

确定工具栏是否已锁定。

```
BOOL IsLocked() const;
```

### <a name="return-value"></a>返回值

如果工具栏被锁定，则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

当用户不能执行自定义任务，例如重新定位工具栏按钮时，此方法返回 TRUE。

锁定的工具栏使用单独的映像列表。 有关这些图像列表的详细信息，请参阅[CMFCToolBar::LoadBitmapEx](#loadbitmapex)。

##  <a name="isonerowwithsibling"></a>  Cmfctoolbar:: Isonerowwithsibling

确定工具栏和其同级工具栏是否定位于同一行。

```
BOOL IsOneRowWithSibling();
```

### <a name="return-value"></a>返回值

如果工具栏和其同级是否定位于同一行; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

[Cmfccustomizebutton:: Createpopupmenu](internal-classes.md)方法调用此方法来确定如何显示**自定义**弹出菜单。 如果此方法返回 TRUE，框架显示**一行上显示按钮**按钮。 否则，该框架将显示**两个行显示按钮**按钮。

通常不需要使用此方法。 若要启用**一行上显示按钮**或**两个行显示按钮**按钮，请调用[cmfctoolbar:: Setsiblingtoolbar](#setsiblingtoolbar)。

##  <a name="isresourcechanged"></a>  CMFCToolBar::IsResourceChanged


```
virtual BOOL IsResourceChanged() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="issibling"></a>  CMFCToolBar::IsSibling


```
BOOL IsSibling();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="isuserdefined"></a>  CMFCToolBar::IsUserDefined

指定工具栏是用户定义。

```
BOOL IsUserDefined() const;
```

### <a name="return-value"></a>返回值

工具栏用户创建的; 如果为 TRUE否则为 FALSE。

##  <a name="loadbitmap"></a>  CMFCToolBar::LoadBitmap

从应用程序资源加载工具栏图像。

```
virtual BOOL LoadBitmap(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>参数

*uiResID*<br/>
[in]用于引用热工具栏图像的位图资源 ID。

*uiColdResID*<br/>
[in]用于引用冷工具栏图像的位图资源 ID。

*uiMenuResID*<br/>
[in]用于引用常规菜单图像的位图资源 ID。

*被阻止*<br/>
[in]为 TRUE，则锁定工具栏;否则为 FALSE。

*uiDisabledResID*<br/>
[in]用于引用禁用的工具栏图像的位图资源 ID。

*uiMenuDisabledResID*<br/>
[in]用于引用禁用的菜单图像的位图资源 ID。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

[Cmfctoolbar:: Loadtoolbarex](#loadtoolbarex)方法调用此方法以加载与工具栏关联的图像。 重写此方法以执行图像资源的自定义加载。

调用 `LoadBitmapEx` 方法以在创建工具栏后加载其他图像。

##  <a name="loadbitmapex"></a>  CMFCToolBar::LoadBitmapEx


```
virtual BOOL LoadBitmapEx(
    CMFCToolBarInfo& params,
    BOOL bLocked = FALSE);
```

### <a name="parameters"></a>参数

*params*<br/>
[in][in]*阻止*

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="loadlargeiconsstate"></a>  CMFCToolBar::LoadLargeIconsState


```
static BOOL __stdcall LoadLargeIconsState(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>参数

[in]*lpszProfileName*

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="loadparameters"></a>  CMFCToolBar::LoadParameters

从 Windows 注册表加载全局工具栏选项。

```
static BOOL LoadParameters(LPCTSTR lpszProfileName=NULL);
```

### <a name="parameters"></a>参数

*lpszProfileName*<br/>
[in]指定 Windows 注册表项的相对路径。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

此方法加载全局参数，如菜单动画类型、 菜单阴影样式，以及是否显示大图标从 Windows 注册表。

[CWinAppEx::LoadState](../../mfc/reference/cwinappex-class.md#loadstate)方法调用此方法作为应用程序的初始化过程的一部分。

##  <a name="loadstate"></a>  CMFCToolBar::LoadState

从 Windows 注册表加载工具栏状态信息。

```
virtual BOOL LoadState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>参数

*lpszProfileName*<br/>
[in]指定 Windows 注册表项的相对路径。

*nIndex*<br/>
[in]指定工具栏的控件 ID。

*uiID*<br/>
[in]指定工具栏的资源 ID。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

框架调用此方法作为应用程序的初始化过程的一部分。 有关详细信息，请参阅[CWinAppEx::LoadState](../../mfc/reference/cwinappex-class.md#loadstate)。

##  <a name="loadtoolbar"></a>  CMFCToolBar::LoadToolBar

从应用程序资源加载工具栏。

```
virtual BOOL LoadToolBar(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0,
    UINT uiHotResID=0);
```

### <a name="parameters"></a>参数

*uiResID*<br/>
[in]工具栏资源 ID。

*uiColdResID*<br/>
[in]用于引用冷工具栏图像的位图资源 ID。

*uiMenuResID*<br/>
[in]用于引用常规菜单图像的位图资源 ID。

*被阻止*<br/>
[in]一个布尔值，该值指定工具栏或不处于锁定状态。 如果此参数为 *，则返回 TRUE*，工具栏处于锁定状态。 否则，未锁定工具栏。

*uiDisabledResID*<br/>
[in]用于引用禁用的工具栏图像的位图资源 ID。

*uiMenuDisabledResID*<br/>
[in]用于引用禁用的菜单图像的位图资源 ID。

*uiHotResID*<br/>
[in]用于引用热工具栏图像的位图资源 ID。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

框架调用此方法以加载与工具栏关联的图像的初始化过程。

### <a name="example"></a>示例

下面的示例演示如何使用`LoadToolBar`中的方法`CMFCToolBar`类。 此代码片段属于[IE 演示示例](../../visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

##  <a name="loadtoolbarex"></a>  Cmfctoolbar:: Loadtoolbarex

通过使用从应用程序资源加载工具栏`CMFCToolBarInfo`帮助器类，以使应用程序使用大图像。

```
virtual BOOL LoadToolBarEx(
    UINT uiToolbarResID,
    CMFCToolBarInfo& params,
    BOOL bLocked=FALSE);
```

### <a name="parameters"></a>参数

*uiToolbarResID*<br/>
[in]工具栏资源 ID。

*params*<br/>
[in]对引用`CMFCToolBarInfo`对象，包含工具栏图像的资源 Id。

*被阻止*<br/>
[in]一个布尔值，该值指定工具栏或不处于锁定状态。 如果此参数为 TRUE，已锁定工具栏。 否则，未锁定工具栏。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

调用此方法以从应用程序资源加载工具栏图像。

##  <a name="m_dbllargeimageratio"></a>  CMFCToolBar::m_dblLargeImageRatio

指定的图像的大小 （高度或宽度） 的维度和维度的常规映像之间的比率。

```
AFX_IMPORT_DATA static double m_dblLargeImageRatio;
```

### <a name="remarks"></a>备注

默认值为 2。 可以更改此值可使大型工具栏图像变大或较小。

未指定的大型图像集时，框架将使用此数据成员。 例如，如果只有较小的图像组提供大小为 16 x 16，并且希望将大型图像有大小 24 x 24，则可设置为 1.5 此数据成员。

##  <a name="nextmenu"></a>  CMFCToolBar::NextMenu


```
virtual BOOL NextMenu();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="onbeforeremovebutton"></a>  CMFCToolBar::OnBeforeRemoveButton


```
virtual BOOL OnBeforeRemoveButton(
    CMFCToolBarButton* pButton,
    DROPEFFECT dropEffect);
```

### <a name="parameters"></a>参数

*pButton*<br/>
[in]未使用。

*dropEffect*<br/>
[in]未使用。

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="onchangehot"></a>  CMFCToolBar::OnChangeHot

当用户选择工具栏上的按钮时由框架调用。

```
virtual void OnChangeHot(int iHot);
```

### <a name="parameters"></a>参数

*iHot*<br/>
[in]指定处于选中状态，工具栏按钮的索引或-1，如果没有工具栏按钮处于选中状态。

### <a name="remarks"></a>备注

重写此方法在用户选择了一个按钮在工具栏上的进程通知。

##  <a name="onchangevisualmanager"></a>  CMFCToolBar::OnChangeVisualManager


```
virtual void OnChangeVisualManager();
```

### <a name="remarks"></a>备注

##  <a name="onfillbackground"></a>  CMFCToolBar::OnFillBackground

由框架从调用[CBasePane::DoPaint](../../mfc/reference/cbasepane-class.md#dopaint)以填充工具栏背景。

```
virtual void OnFillBackground(CDC* pDC);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[in]指向设备上下文的指针。

### <a name="remarks"></a>备注

[CMFCToolBar::DoPaint](#dopaint)已填充的一个工具栏背景时调用此方法。 默认实现不执行任何操作。

重写此方法在派生类中绘制自定义背景。

##  <a name="onglobalfontschanged"></a>  CMFCToolBar::OnGlobalFontsChanged


```
virtual void OnGlobalFontsChanged();
```

### <a name="remarks"></a>备注

##  <a name="onreset"></a>  CMFCToolBar::OnReset

将工具栏还原到其原始状态。

```
virtual void OnReset();
```

### <a name="remarks"></a>备注

重写此方法以处理有关工具栏重置的通知。

默认实现不执行任何操作。 重写`OnReset`派生类中`CMFCToolBar`时该工具栏具有虚拟按钮的工具栏返回到其原始状态时，必须将其替换。

##  <a name="onsetaccdata"></a>  CMFCToolBar::OnSetAccData


```
virtual BOOL OnSetAccData(long lVal);
```

### <a name="parameters"></a>参数

[in]*lVal*

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="onsetdefaultbuttontext"></a>  CMFCToolBar::OnSetDefaultButtonText

还原为其默认状态的工具栏按钮的文本。

```
virtual BOOL OnSetDefaultButtonText(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>参数

*pButton*<br/>
[in]指向要设置其文本的按钮。

### <a name="return-value"></a>返回值

已成功还原，则返回 TRUE 如果文本;否则为 FALSE。

### <a name="remarks"></a>备注

重写此方法，正在为其默认值更改工具栏按钮的文本将进程通知。

默认实现将从应用程序资源加载按钮的文本。

##  <a name="onusertooltip"></a>  CMFCToolBar::OnUserToolTip

要显示工具提示的按钮时由框架调用。

```
virtual BOOL OnUserToolTip(
    CMFCToolBarButton* pButton,
    CString& strTTText) const;
```

### <a name="parameters"></a>参数

*pButton*<br/>
[in]指向为其工具提示是要显示的工具栏按钮。

*strTTText*<br/>
[out]对引用`CString`对象，它接收的工具提示文本。

### <a name="return-value"></a>返回值

则为 TRUE *strTTText*填充工具提示文本; 否则为 FALSE。

### <a name="remarks"></a>备注

要显示的工具栏按钮的工具提示时，框架将调用此方法。 如果`OnUserToolTip`返回 TRUE，则框架显示其中包含返回的文本的工具提示`OnUserToolTip`中*strTTText*。 否则，工具提示将包含按钮文本。

重写`OnUserToolTip`自定义工具栏按钮的工具提示。 默认实现调用[CMFCToolBar::OnUserToolTip](#onusertooltip)若要获取的工具提示文本。

##  <a name="prevmenu"></a>  CMFCToolBar::PrevMenu


```
virtual BOOL PrevMenu();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="processcommand"></a>  CMFCToolBar::ProcessCommand

将 WM_COMMAND 消息发送到拥有工具栏的窗口。

```
BOOL ProcessCommand(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>参数

*pButton*<br/>
[in]在工具栏上的按钮的指针。

### <a name="return-value"></a>返回值

此方法应始终返回 TRUE。 MFC 在内部使用 FALSE 值。

### <a name="remarks"></a>备注

此方法将 WM_COMMAND 消息发送到通过调用拥有工具栏的窗口[CWnd::PostMessage](../../mfc/reference/cwnd-class.md#postmessage)并将传递为指定的按钮的命令 ID *wParam*参数。

使用[ON_COMMAND](message-map-macros-mfc.md#on_command)宏 WM_COMMAND 消息映射到的成员函数。

##  <a name="removeallbuttons"></a>  CMFCToolBar::RemoveAllButtons

从工具栏中删除所有按钮和分隔符。

```
virtual void RemoveAllButtons();
```

### <a name="remarks"></a>备注

它将重新创建或销毁工具栏时，框架将调用此方法。

##  <a name="removebutton"></a>  CMFCToolBar::RemoveButton

从工具栏中删除具有指定的索引的按钮。

```
virtual BOOL RemoveButton(int iIndex);
```

### <a name="parameters"></a>参数

*iIndex*<br/>
[in]指定删除按钮的从零开始索引。

### <a name="return-value"></a>返回值

如果该方法成功，或 FALSE 的指定的索引是否无效或索引引用则为 TRUE**自定义**按钮。

### <a name="remarks"></a>备注

此方法会更新其他工具栏按钮删除受影响的属性。 例如，此方法从工具栏中删除不必要的分隔符，并重新生成的键盘快捷方式表。

有关详细信息**自定义**按钮，请参阅[cmfctoolbar:: Enablecustomizebutton](#enablecustomizebutton)。

##  <a name="removestatefromregistry"></a>  CMFCToolBar::RemoveStateFromRegistry

从 Windows 注册表中删除工具栏的状态信息。

```
virtual BOOL RemoveStateFromRegistry(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>参数

*lpszProfileName*<br/>
[in]指定注册表项的状态信息所在的位置。

*nIndex*<br/>
[in]工具栏控件 ID。

*uiID*<br/>
[in]工具栏资源 ID。 如果此参数为-1，则此方法使用[CWnd::GetDlgCtrlID](../../mfc/reference/cwnd-class.md#getdlgctrlid)方法来检索资源 id。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

删除用户定义的工具栏时，框架将调用此方法。

如果在 Windows 注册表中存储的其他状态信息，请重写此方法。

##  <a name="replacebutton"></a>  CMFCToolBar::ReplaceButton

将工具栏按钮替换为另一个工具栏按钮。

```
int ReplaceButton(
    UINT uiCmd,
    const CMFCToolBarButton& button,
    BOOL bAll=FALSE);
```

### <a name="parameters"></a>参数

*uiCmd*<br/>
[in]要替换为按钮的命令 ID。

*按钮*<br/>
[in]对引用`CMFCToolBarButton`插入。

*球*<br/>
[in]一个布尔值，指定是否要替换具有指定的命令 ID 的所有按钮*uiCmd*。 如果此参数为 TRUE，将替换具有指定的命令 ID 的所有按钮。 否则，将替换为第一个按钮。

### <a name="return-value"></a>返回值

替换为的按钮的数目。 如果不存在一个具有指定的命令 ID 的按钮在工具栏上，此方法将返回 0。

### <a name="remarks"></a>备注

当你想要添加不能从资源加载工具栏按钮时调用此方法。 可以在设计时创建一个占位符按钮，并将该按钮的自定义按钮替换为在初始化工具栏时。 请参阅使用此方法的示例，VisualStudioDemo 示例。

### <a name="example"></a>示例

下面的示例演示如何使用`ReplaceButton`中的方法`CMFCToolBar`类。 此代码片段属于[IE 演示示例](../../visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#10](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_5.cpp)]

##  <a name="resetall"></a>  CMFCToolBar::ResetAll

将所有工具栏都还原到其原始状态。

```
static void __stdcall ResetAll();
```

### <a name="remarks"></a>备注

此方法调用[CMFCToolBar::RestoreOriginalState](#restoreoriginalstate)可还原的应用程序中的每个工具栏上的方法。 它使用[CMFCToolBar::CanBeRestored](#canberestored)方法，以确定是否可以还原一个工具栏。

##  <a name="resetallimages"></a>  CMFCToolBar::ResetAllImages

清除所有应用程序中的工具栏图像集合。

```
static void __stdcall ResetAllImages();
```

### <a name="remarks"></a>备注

此方法将清除由初始化的映像集合[CMFCToolBar::LoadToolBar](#loadtoolbar)并[CMFCToolBar::LoadBitmap](#loadbitmap)方法。

##  <a name="resetimages"></a>  CMFCToolBar::ResetImages


```
virtual void ResetImages();
```

### <a name="remarks"></a>备注

##  <a name="restorefocus"></a>  CMFCToolBar::RestoreFocus


```
virtual void RestoreFocus();
```

### <a name="remarks"></a>备注

##  <a name="restoreoriginalstate"></a>  CMFCToolBar::RestoreOriginalState

还原工具栏的原始状态。

```
virtual BOOL RestoreOriginalState();
```

### <a name="return-value"></a>返回值

如果该方法成功，或 FALSE，如果方法失败或工具栏是用户定义的则为 TRUE。

### <a name="remarks"></a>备注

此方法使用从资源文件加载工具栏[CMFCToolBar::LoadToolBar](#loadtoolbar)方法。

框架调用此方法，当用户选择**全部重置**按钮**工具栏**自定义对话框中的页。

##  <a name="saveparameters"></a>  CMFCToolBar::SaveParameters


```
static BOOL __stdcall SaveParameters(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>参数

[in]*lpszProfileName*

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="savestate"></a>  CMFCToolBar::SaveState

将工具栏的状态信息保存在 Windows 注册表中。

```
virtual BOOL SaveState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>参数

*lpszProfileName*<br/>
[in]指定 Windows 注册表项的相对路径。

*nIndex*<br/>
[in]工具栏控件 ID。

*uiID*<br/>
[in]工具栏资源 ID。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

它将应用程序状态保存到注册表时，框架将调用此方法。 有关详细信息，请参阅[CWinAppEx::SaveState](../../mfc/reference/cwinappex-class.md#savestate)。

##  <a name="setbasiccommands"></a>  CMFCToolBar::SetBasicCommands

设置始终显示在用户打开一个菜单命令的列表。

```
static void __stdcall SetBasicCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>参数

*lstCommands*<br/>
[in]对引用`CList`对象，其中包含一系列命令。

### <a name="remarks"></a>备注

打开菜单时，会始终显示基本命令。 当用户选择要查看最近使用的命令，此方法是有意义。

使用[CMFCToolBar::AddBasicCommand](#addbasiccommand)方法将命令添加到的基本命令列表。 使用[CMFCToolBar::GetBasicCommands](#getbasiccommands)方法来检索应用程序使用的基本命令列表。

请参阅使用此方法的示例，该资源管理器示例。

##  <a name="setbuttoninfo"></a>  CMFCToolBar::SetButtonInfo

设置命令 ID、 样式和工具栏按钮的图像 ID。

```
void SetButtonInfo(
    int nIndex,
    UINT nID,
    UINT nStyle,
    int iImage);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[in]其属性设置的按钮的从零开始的索引。

*nID*<br/>
[in]按钮的命令 ID。

*nStyle*<br/>
[in]按钮的样式。 请参阅[工具栏控件样式](../../mfc/reference/toolbar-control-styles.md)可用工具栏按钮样式的列表。

*iImage*<br/>
[in]从零开始的图像的按钮的索引 （也就是说，集合中的工具栏图像索引）。

### <a name="remarks"></a>备注

调用此方法以设置工具栏按钮的属性。

在调试版本中，此方法将生成断言失败如果由指定的索引*nIndex*无效。

调用[CMFCToolBar::SetButtonStyle](#setbuttonstyle)方法以设置按钮的样式。

##  <a name="setbuttons"></a>  CMFCToolBar::SetButtons

设置工具栏按钮。

```
virtual BOOL SetButtons(
    const UINT* lpIDArray,
    int nIDCount,
    BOOL bRemapImages=TRUE);
```

### <a name="parameters"></a>参数

*lpIDArray*<br/>
[in]指向按钮的命令 Id，要插入数组的指针。

*nIDCount*<br/>
[in]中的项数*lpIDArray*。

*bRemapImages*<br/>
[in]一个布尔值，该值指定是否要将现有的按钮图像关联的插入按钮。 如果此参数为 TRUE，将重新映射图像。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

调用此方法以从工具栏中删除现有的按钮并插入新按钮的集合。

此方法将添加**自定义**工具栏和 AFX_WM_RESETTOOLBAR 将消息的发送到父窗口的工具栏按钮。 有关详细信息**自定义**按钮，请参阅[cmfctoolbar:: Enablecustomizebutton](#enablecustomizebutton)。

##  <a name="setbuttonstyle"></a>  CMFCToolBar::SetButtonStyle

设置给定索引处的工具栏按钮的样式。

```
virtual void SetButtonStyle(
    int nIndex,
    UINT nStyle);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[in]设置其样式是工具栏按钮的从零开始的索引。

*nStyle*<br/>
[in]按钮的样式。 请参阅[工具栏控件样式](../../mfc/reference/toolbar-control-styles.md)可用工具栏按钮样式的列表。

### <a name="remarks"></a>备注

此方法移除 TBBS_PRESSED 样式，如果*nStyle*是 TBBS_DISABLED，因为用户不能单击禁用的按钮。

##  <a name="setbuttontext"></a>  CMFCToolBar::SetButtonText

设置工具栏按钮的文本标签。

```
BOOL SetButtonText(
    int nIndex,
    LPCTSTR lpszText);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[in]工具栏按钮的索引。

*lpszText*<br/>
[in]工具栏按钮的文本标签。 必须为非 NULL。

### <a name="return-value"></a>返回值

如果方法成功，则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

如果提供的索引不引用有效的工具栏按钮，此方法返回 FALSE。

##  <a name="setcommandusageoptions"></a>  CMFCToolBar::SetCommandUsageOptions

指定当很少使用的命令不会显示在菜单中的应用程序。

```
static BOOL SetCommandUsageOptions(
    UINT nStartCount,
    UINT nMinUsagePercentage=5);
```

### <a name="parameters"></a>参数

*nStartCount*<br/>
[in]指定与框架显示仅基本和最近使用过的命令之前，必须执行的命令的次数。

*nMinUsagePercentage*<br/>
[in]必须执行命令视为最近使用过的命令的时间的百分比。

### <a name="return-value"></a>返回值

False *nMinUsagePercentage*等于或大于 100; 否则为 TRUE。

### <a name="remarks"></a>备注

调用此方法以自定义框架使用，以确定如何基本和最近使用的菜单项显示的算法。 有关基本命令的详细信息，请参阅[CMFCToolBar::AddBasicCommand](#addbasiccommand)。

此类使用`CMFCCmdUsageCount`类跟踪命令的使用计数。 有关此类的详细信息，请参阅[CMFCCmdUsageCount 类](../../mfc/reference/cmfccmdusagecount-class.md)。

##  <a name="setcustomizemode"></a>  CMFCToolBar::SetCustomizeMode

启用或禁用应用程序中的所有工具栏的自定义模式。

```
static BOOL __stdcall SetCustomizeMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>参数

*bSet*<br/>
[in]一个布尔值，该值指定是否启用或禁用自定义模式。 此参数设置为 true 可启用自定义模式或 FALSE 以禁用它。

### <a name="return-value"></a>返回值

TRUE 如果调用此方法将更改的自定义模式;否则为 FALSE。

### <a name="remarks"></a>备注

此方法调整的布局并重绘应用程序中的每一个工具栏。 调用[CMFCToolBar::IsCustomizeMode](#iscustomizemode)方法来确定应用程序中自定义模式

##  <a name="setgraydisabledbuttons"></a>  CMFCToolBar::SetGrayDisabledButtons

指定是否不可用按钮在工具栏上的显示为灰色，或者是否使用按钮不可用的映像。

```
void SetGrayDisabledButtons(BOOL bGrayDisabledButtons);
```

### <a name="parameters"></a>参数

*bGrayDisabledButtons*<br/>
[in]一个布尔值，该值指定如何显示按钮不可用。 如果此参数为 TRUE，框架将使这些按钮变灰。 否则，框架将使用按钮不可用的映像的集合。

### <a name="remarks"></a>备注

默认情况下，无法使用的按钮为灰显。

##  <a name="setheight"></a>  CMFCToolBar::SetHeight

设置工具栏的高度。

```
void SetHeight(int cyHeight);
```

### <a name="parameters"></a>参数

*cyHeight*<br/>
[in]工具栏上，以像素为单位的高度。

### <a name="remarks"></a>备注

此方法重绘工具栏后设置的高度。

##  <a name="sethelpmode"></a>  CMFCToolBar::SetHelpMode


```
static void __stdcall SetHelpMode(BOOL bOn = TRUE);
```

### <a name="parameters"></a>参数

[in]*bOn*

### <a name="remarks"></a>备注

##  <a name="sethot"></a>  CMFCToolBar::SetHot


```
BOOL SetHot(CMFCToolBarButton* pMenuButton);
```

### <a name="parameters"></a>参数

[in]*pMenuButton*

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="sethotborder"></a>  CMFCToolBar::SetHotBorder

指定工具栏按钮是否热跟踪。

```
void SetHotBorder(BOOL bShowHotBorder);
```

### <a name="parameters"></a>参数

*bShowHotBorder*<br/>
[in]一个布尔值，该值指定是否热跟踪工具栏按钮。 如果此参数为 TRUE 时，工具栏热跟踪其按钮。 否则为工具栏不会不热跟踪其按钮。

### <a name="remarks"></a>备注

如果按钮是热跟踪，该框架，当鼠标移过它突出显示按钮。 默认情况下，每个工具栏热跟踪其按钮。

调用[CMFCToolBar::GetHotBorder](#gethotborder)方法，以确定是否工具栏热跟踪其按钮。

##  <a name="sethottextcolor"></a>  CMFCToolBar::SetHotTextColor

设置热工具栏按钮的文本颜色。

```
static void SetHotTextColor(COLORREF clrText);
```

### <a name="parameters"></a>参数

*clrText*<br/>
[in]指定工具栏按钮的热跟踪的文本颜色。

### <a name="remarks"></a>备注

热跟踪工具栏按钮有关的详细信息，请参阅[CMFCToolBar::GetHotBorder](#gethotborder)并[CMFCToolBar::SetHotBorder](#sethotborder)。

##  <a name="setignoresettext"></a>  CMFCToolBar::SetIgnoreSetText


```
void SetIgnoreSetText(BOOL bValue);
```

### <a name="parameters"></a>参数

[in]*bValue*

### <a name="remarks"></a>备注

##  <a name="setlargeicons"></a>  CMFCToolBar::SetLargeIcons

指定工具栏按钮是否显示大图标。

```
static void SetLargeIcons(BOOL bLargeIcons=TRUE);
```

### <a name="parameters"></a>参数

*bLargeIcons*<br/>
[in]一个布尔值，该值指定要使用哪个图标。 如果此参数为 TRUE，框架将显示大图标。 否则，框架将显示常规图标。

### <a name="remarks"></a>备注

框架调用此方法，当用户更改的状态**大图标**中的复选框**选项**选项卡**自定义**对话框。 此方法调整应用程序中的所有工具栏的都大小。

默认情况下，框架显示正则图标。

有关详细信息**自定义**对话框中，请参阅[CMFCToolBarsCustomizeDialog 类](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)。

##  <a name="setlockedsizes"></a>  CMFCToolBar::SetLockedSizes

设置工具栏上的锁定的按钮和锁定的图像的大小。

```
void SetLockedSizes(
    SIZE sizeButton,
    SIZE sizeImage,
    BOOL bDontScale = FALSE);
```

### <a name="parameters"></a>参数

*sizeButton*<br/>
[in]指定锁定的工具栏按钮的大小。

*sizeImage*<br/>
[in]指定锁定的工具栏图像的大小。

*bDontScale*<br/>
指定是否要缩放锁定工具栏图像在高 DPI 模式下。

### <a name="remarks"></a>备注

锁定按钮的默认大小为 23 x 22 像素。 锁定图像的默认大小为 16 x 15 像素。

调用[CMFCToolBar::GetLockedImageSize](#getlockedimagesize)方法来检索其中的大小已锁定的映像。 调用[CMFCToolBar::GetButtonSize](#getbuttonsize)方法来检索其中的大小锁定工具栏按钮。

##  <a name="setmaskmode"></a>  CMFCToolBar::SetMaskMode


```
void SetMaskMode(BOOL bMasked);
```

### <a name="parameters"></a>参数

[in]*bMasked*

### <a name="remarks"></a>备注

##  <a name="setmenusizes"></a>  CMFCToolBar::SetMenuSizes

设置工具栏菜单按钮及其映像的大小。

```
static void __stdcall SetMenuSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>参数

*sizeButton*<br/>
[in]以像素为单位指定工具栏按钮的大小。

*sizeImage*<br/>
[in]以像素为单位指定的工具栏图像的大小。

### <a name="remarks"></a>备注

默认情况下，菜单按钮和其映像具有未定义的大小。

调用[CMFCToolBar::GetMenuButtonSize](#getmenubuttonsize)方法来确定菜单按钮的大小和[CMFCToolBar::GetMenuImageSize](#getmenuimagesize)方法来确定菜单按钮图像的大小。

请参阅有关示例，请使用此方法的 IEDemo 和 MSMoneyDemo 示例。

##  <a name="setnonpermittedcommands"></a>  CMFCToolBar::SetNonPermittedCommands

设置的用户不能执行的命令的列表。

```
static void SetNonPermittedCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>参数

*lstCommands*<br/>
[in]对引用`CList`对象，其中包含不能由用户执行的命令。

### <a name="remarks"></a>备注

调用此方法将使用户无法选择某些命令。 例如，你可能想要防止用户选择出于安全原因某些命令。 请参阅有关示例，请使用此方法的 MDITabsDemo 和 MenuSubSet 示例。

此方法将清除前面不允许命令的列表。 默认情况下，不允许命令的列表为空。

##  <a name="setonerowwithsibling"></a>  Cmfctoolbar:: Setonerowwithsibling

工具栏和其同级放置在同一行上。

```
void SetOneRowWithSibling();
```

### <a name="remarks"></a>备注

当用户单击，框架将调用此方法**一行上显示按钮**按钮。

调用[cmfctoolbar:: Setsiblingtoolbar](#setsiblingtoolbar)方法，以使**一行上显示按钮**或**两行显示按钮**按钮。 如果您调用[cmfctoolbar:: Setsiblingtoolbar](#setsiblingtoolbar)该工具栏，同级工具栏移动到此工具栏的行。 否则，此工具栏会移动到的同级元素的行。

框架将调用[cmfctoolbar:: Settworowswithsibling](#settworowswithsibling)方法在用户单击时**两个行显示按钮**按钮。

##  <a name="setorigbuttons"></a>  CMFCToolBar::SetOrigButtons


```
void SetOrigButtons(const CObList& lstOrigButtons);
```

### <a name="parameters"></a>参数

[in]*lstOrigButtons*

### <a name="remarks"></a>备注

##  <a name="setpermament"></a>  CMFCToolBar::SetPermament

指定用户是否可以关闭工具栏。

```
void SetPermament(BOOL bPermament=TRUE);
```

### <a name="parameters"></a>参数

*bPermament*<br/>
[in]一个布尔值，该值指定用户是否可以关闭工具栏。 如果此参数为 TRUE，用户不能关闭工具栏。 否则，用户可以关闭工具栏。

### <a name="remarks"></a>备注

默认情况下，用户可以关闭每个工具栏。

调用[CMFCToolBar::CanBeClosed](#canbeclosed)方法，以确定用户是否可以关闭工具栏。

##  <a name="setroutecommandsviaframe"></a>  CMFCToolBar::SetRouteCommandsViaFrame

指定是否与父框架或所有者将命令发送到工具栏。

```
void SetRouteCommandsViaFrame(BOOL bValue);
```

### <a name="parameters"></a>参数

*其中 bValue*<br/>
[in]如果此参数为 TRUE，则父框架将命令发送到工具栏。 否则，所有者将命令发送到工具栏。

### <a name="remarks"></a>备注

默认情况下，父框架将命令发送到工具栏。 调用[CMFCToolBar::GetRouteCommandsViaFrame](#getroutecommandsviaframe)方法，以确定是否与父框架或所有者将命令发送到工具栏。

##  <a name="setshowtooltips"></a>  CMFCToolBar::SetShowTooltips

指定框架是否显示工具提示。

```
static void SetShowTooltips(BOOL bValue);
```

### <a name="parameters"></a>参数

*其中 bValue*<br/>
[in]如果此参数为 TRUE，框架将显示工具提示。 否则，该框架将隐藏工具提示。

### <a name="remarks"></a>备注

默认情况下，框架显示工具提示。

调用[CMFCToolBar::GetShowTooltips](#getshowtooltips)方法，以确定框架是否显示工具提示。

##  <a name="setsiblingtoolbar"></a>  Cmfctoolbar:: Setsiblingtoolbar

指定工具栏的同级。

```
void SetSiblingToolBar(CMFCToolBar* pBrotherToolbar);
```

### <a name="parameters"></a>参数

*pBrotherToolbar*<br/>
[in]指向同级工具栏的指针。

### <a name="remarks"></a>备注

此方法使**一行上显示按钮**或**两个行显示按钮**用户显示时，将显示的按钮**自定义**弹出菜单。 当你想要使用户能够指定相关的工具栏显示在同一行上或在不同的行上时调用此方法。

启用后调用此方法**自定义**显示在工具栏的按钮。 若要启用**自定义**按钮，调用[cmfctoolbar:: Enablecustomizebutton](#enablecustomizebutton)方法。

若要检索的同级元素的一个工具栏，请调用[CMFCToolBar::GetSiblingToolBar](#getsiblingtoolbar)。

##  <a name="setsizes"></a>  CMFCToolBar::SetSizes

指定所有工具栏按钮和图像的大小。

```
static void __stdcall SetSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>参数

*sizeButton*<br/>
[in]工具栏按钮，以像素为单位的大小。

*sizeImage*<br/>
[in]工具栏按钮图像，以像素为单位的大小。

### <a name="remarks"></a>备注

工具栏按钮的默认大小为 23 x 22 像素。 工具栏按钮图像的默认大小为 16 x 15 像素。

调用[CMFCToolBar::GetImageSize](#getimagesize)方法来检索工具栏按钮图像的大小。 调用[CMFCToolBar::GetButtonSize](#getbuttonsize)方法来检索工具栏按钮的大小。

##  <a name="settoolbarbtntext"></a>  CMFCToolBar::SetToolBarBtnText

在工具栏上，指定按钮的属性。

```
void SetToolBarBtnText(
    UINT nBtnIndex,
    LPCTSTR szText=NULL,
    BOOL bShowText=TRUE,
    BOOL bShowImage=TRUE);
```

### <a name="parameters"></a>参数

*nBtnIndex*<br/>
[in]工具栏按钮在工具栏按钮列表中的从零开始的索引。

*szText*<br/>
[in]指定工具栏按钮的文本标签。

*bShowText*<br/>
[in]如果此参数为 TRUE，框架将显示的文本标签。 否则，该框架将隐藏的文本标签。

*bShowImage*<br/>
[in]如果此参数为 TRUE，框架将显示工具栏按钮图像。 否则，该框架将隐藏工具栏按钮图像。

### <a name="remarks"></a>备注

默认情况下，框架显示的工具栏按钮图像，但不显示工具栏按钮的文本标签。

在调试版本中，如果此方法生成断言失败*nBtnIndex*不引用到有效的工具栏按钮或工具栏按钮是一个分隔符。

##  <a name="settworowswithsibling"></a>  Cmfctoolbar:: Settworowswithsibling

工具栏和其同级放置在单独的行。

```
void SetTwoRowsWithSibling();
```

### <a name="remarks"></a>备注

当用户单击，框架将调用此方法**两个行显示按钮**按钮。

调用[cmfctoolbar:: Setsiblingtoolbar](#setsiblingtoolbar)方法，以使**一行上显示按钮**或**两行显示按钮**按钮。 如果您调用[cmfctoolbar:: Setsiblingtoolbar](#setsiblingtoolbar)该工具栏，同级工具栏移动到一个单独的行。 否则，此工具栏会移动到一个单独的行。

框架将调用[cmfctoolbar:: Setonerowwithsibling](#setonerowwithsibling)方法在用户单击时**一行上显示按钮**按钮。

##  <a name="setuserimages"></a>  CMFCToolBar::SetUserImages

在应用程序中设置用户定义的映像的集合。

```
static BOOL SetUserImages(CMFCToolBarImages* pUserImages);
```

### <a name="parameters"></a>参数

*pUserImages*<br/>
[in]指向用户定义的图像集合的指针。

### <a name="return-value"></a>返回值

如果方法成功，则非零值否则为 0 指定`CMFCToolBarImages`对象无效或者具有不同于默认的映像大小的工具栏图像大小。

### <a name="remarks"></a>备注

该框架使用用户定义的图像绘制由用户自定义的工具栏按钮。 指定的映像列表*pUserImages*在所有工具栏间共享应用程序中。

如果此方法生成断言失败在调试版本中指定`CMFCToolBarImages`对象无效或者具有不同于默认的映像大小的工具栏图像大小。

OutlookDemo、 ToolTipDemo 和 VisualStudioDemo 示例使用此方法设置全局集合的用户定义的映像。 它们的加载名为 UserImages.bmp，位于应用程序的工作目录中的文件。

调用[CMFCToolBar::GetUserImages](#getuserimages)方法来检索的用户定义的应用程序中的映像集合。

##  <a name="stretchpane"></a>  CMFCToolBar::StretchPane

垂直或水平拉伸工具栏和重新定位按钮，如有必要。

```
virtual CSize StretchPane(
    int nLength,
    BOOL bVert);
```

### <a name="parameters"></a>参数

*nLength*<br/>
[in]量 （以像素为单位，按其拉伸窗格）。

*bVert*<br/>
[in]如果为 TRUE，垂直拉伸窗格。 如果为 FALSE，水平拉伸窗格。

### <a name="return-value"></a>返回值

一个`CSize`对象，它指定工具栏客户端区域的大小。

### <a name="remarks"></a>备注

此方法调用[CMFCToolBar::WrapToolBar](#wraptoolbar)若要重新定位内外延式工具栏按钮。

返回值确定通过调用[CMFCToolBar::CalcSize](#calcsize)。

##  <a name="translatechar"></a>  CMFCToolBar::TranslateChar

如果指定的键代码对应于有效的键盘快捷方式，执行按钮命令。

```
virtual BOOL TranslateChar(UINT nChar);
```

### <a name="parameters"></a>参数

*NChar*<br/>
[in]指定虚拟键代码。 标准虚拟键代码的列表，请参见 Winuser.h

### <a name="return-value"></a>返回值

如果指定的键代码可以是 FALSE 不可打印或不对应于有效的键盘快捷方式;如果指定的键代码对应于一个下拉列表菜单选项; 则为 TRUE否则，返回值[CMFCToolBar::ProcessCommand](#processcommand)。

### <a name="remarks"></a>备注

当与 Alt 键一起按下某个键时，框架将调用此方法。

##  <a name="updatebutton"></a>  CMFCToolBar::UpdateButton

更新指定按钮的状态。

```
void UpdateButton(int nIndex);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[in]指定更新按钮的从零开始索引。

### <a name="remarks"></a>备注

##  <a name="wraptoolbar"></a>  CMFCToolBar::WrapToolBar

重新定位给定维度中的工具栏按钮。

```
int WrapToolBar(
    int nWidth,
    int nHeight = 32767,
    CDC* pDC = NULL,
    int nColumnWidth = -1,
    int nRowHeight = -1);
```

### <a name="parameters"></a>参数

*nWidth*<br/>
[in]工具栏的最大宽度。

*nHeight*<br/>
[in]工具栏的最大高度。 如果浮动工具栏不使用。

*pDC*<br/>
[in]指向设备上下文指针。 如果为 NULL，则使用工具栏上的设备上下文。

*nColumnWidth*<br/>
[in]按钮宽度。 如果为-1，则使用当前的宽度。

[in] m *nRowHeight*按钮高度。 如果为-1，则使用当前的高度。

### <a name="return-value"></a>返回值

在工具栏上的按钮的行数。

### <a name="remarks"></a>备注

此方法重新定位按钮在工具栏中，包装对其他行，如有必要的按钮。

##  <a name="m_bdontscaleimages"></a>  CMFCToolBar::m_bDontScaleImages

指定在高 DPI 模式中缩放工具栏图像。

```
AFX_IMPORT_DATA static BOOL m_bDontScaleImages;
```

### <a name="remarks"></a>备注

## <a name="see-also"></a>请参阅

[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)<br/>
[CMFCMenuBar 类](../../mfc/reference/cmfcmenubar-class.md)<br/>
[CMFCPopupMenuBar 类](../../mfc/reference/cmfcpopupmenubar-class.md)<br/>
[CMFCDropDownToolBar 类](../../mfc/reference/cmfcdropdowntoolbar-class.md)<br/>
[演练：将控件置于工具栏上](../../mfc/walkthrough-putting-controls-on-toolbars.md)




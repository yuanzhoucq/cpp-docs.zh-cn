---
title: CMFCRibbonPanel 类
ms.date: 11/04/2016
f1_keywords:
- CMFCRibbonPanel
- AFXRIBBONPANEL/CMFCRibbonPanel
- AFXRIBBONPANEL/CMFCRibbonPanel::CMFCRibbonPanel
- AFXRIBBONPANEL/CMFCRibbonPanel::Add
- AFXRIBBONPANEL/CMFCRibbonPanel::AddSeparator
- AFXRIBBONPANEL/CMFCRibbonPanel::AddToolBar
- AFXRIBBONPANEL/CMFCRibbonPanel::FindByData
- AFXRIBBONPANEL/CMFCRibbonPanel::FindByID
- AFXRIBBONPANEL/CMFCRibbonPanel::GetCaptionHeight
- AFXRIBBONPANEL/CMFCRibbonPanel::GetCount
- AFXRIBBONPANEL/CMFCRibbonPanel::GetData
- AFXRIBBONPANEL/CMFCRibbonPanel::GetDefaultButton
- AFXRIBBONPANEL/CMFCRibbonPanel::GetDroppedDown
- AFXRIBBONPANEL/CMFCRibbonPanel::GetElement
- AFXRIBBONPANEL/CMFCRibbonPanel::GetElements
- AFXRIBBONPANEL/CMFCRibbonPanel::GetElementsByID
- AFXRIBBONPANEL/CMFCRibbonPanel::GetFocused
- AFXRIBBONPANEL/CMFCRibbonPanel::GetGalleryRect
- AFXRIBBONPANEL/CMFCRibbonPanel::GetHighlighted
- AFXRIBBONPANEL/CMFCRibbonPanel::GetIndex
- AFXRIBBONPANEL/CMFCRibbonPanel::GetItemIDsList
- AFXRIBBONPANEL/CMFCRibbonPanel::GetName
- AFXRIBBONPANEL/CMFCRibbonPanel::GetParentButton
- AFXRIBBONPANEL/CMFCRibbonPanel::GetParentCategory
- AFXRIBBONPANEL/CMFCRibbonPanel::GetParentMenuBar
- AFXRIBBONPANEL/CMFCRibbonPanel::GetPreferedMenuLocation
- AFXRIBBONPANEL/CMFCRibbonPanel::GetPressed
- AFXRIBBONPANEL/CMFCRibbonPanel::GetRect
- AFXRIBBONPANEL/CMFCRibbonPanel::GetVisibleElements
- AFXRIBBONPANEL/CMFCRibbonPanel::HasElement
- AFXRIBBONPANEL/CMFCRibbonPanel::HitTest
- AFXRIBBONPANEL/CMFCRibbonPanel::HitTestEx
- AFXRIBBONPANEL/CMFCRibbonPanel::Insert
- AFXRIBBONPANEL/CMFCRibbonPanel::InsertSeparator
- AFXRIBBONPANEL/CMFCRibbonPanel::IsCenterColumnVert
- AFXRIBBONPANEL/CMFCRibbonPanel::IsCollapsed
- AFXRIBBONPANEL/CMFCRibbonPanel::IsHighlighted
- AFXRIBBONPANEL/CMFCRibbonPanel::IsJustifyColumns
- AFXRIBBONPANEL/CMFCRibbonPanel::IsMainPanel
- AFXRIBBONPANEL/CMFCRibbonPanel::IsMenuMode
- AFXRIBBONPANEL/CMFCRibbonPanel::MakeGalleryItemVisible
- AFXRIBBONPANEL/CMFCRibbonPanel::OnKey
- AFXRIBBONPANEL/CMFCRibbonPanel::RecalcWidths
- AFXRIBBONPANEL/CMFCRibbonPanel::Remove
- AFXRIBBONPANEL/CMFCRibbonPanel::RemoveAll
- AFXRIBBONPANEL/CMFCRibbonPanel::Replace
- AFXRIBBONPANEL/CMFCRibbonPanel::ReplaceByID
- AFXRIBBONPANEL/CMFCRibbonPanel::SetCenterColumnVert
- AFXRIBBONPANEL/CMFCRibbonPanel::SetData
- AFXRIBBONPANEL/CMFCRibbonPanel::SetElementMenu
- AFXRIBBONPANEL/CMFCRibbonPanel::SetElementRTC
- AFXRIBBONPANEL/CMFCRibbonPanel::SetElementRTCByID
- AFXRIBBONPANEL/CMFCRibbonPanel::SetFocused
- AFXRIBBONPANEL/CMFCRibbonPanel::SetJustifyColumns
- AFXRIBBONPANEL/CMFCRibbonPanel::SetKeys
- AFXRIBBONPANEL/CMFCRibbonPanel::ShowPopup
helpviewer_keywords:
- CMFCRibbonPanel [MFC], CMFCRibbonPanel
- CMFCRibbonPanel [MFC], Add
- CMFCRibbonPanel [MFC], AddSeparator
- CMFCRibbonPanel [MFC], AddToolBar
- CMFCRibbonPanel [MFC], FindByData
- CMFCRibbonPanel [MFC], FindByID
- CMFCRibbonPanel [MFC], GetCaptionHeight
- CMFCRibbonPanel [MFC], GetCount
- CMFCRibbonPanel [MFC], GetData
- CMFCRibbonPanel [MFC], GetDefaultButton
- CMFCRibbonPanel [MFC], GetDroppedDown
- CMFCRibbonPanel [MFC], GetElement
- CMFCRibbonPanel [MFC], GetElements
- CMFCRibbonPanel [MFC], GetElementsByID
- CMFCRibbonPanel [MFC], GetFocused
- CMFCRibbonPanel [MFC], GetGalleryRect
- CMFCRibbonPanel [MFC], GetHighlighted
- CMFCRibbonPanel [MFC], GetIndex
- CMFCRibbonPanel [MFC], GetItemIDsList
- CMFCRibbonPanel [MFC], GetName
- CMFCRibbonPanel [MFC], GetParentButton
- CMFCRibbonPanel [MFC], GetParentCategory
- CMFCRibbonPanel [MFC], GetParentMenuBar
- CMFCRibbonPanel [MFC], GetPreferedMenuLocation
- CMFCRibbonPanel [MFC], GetPressed
- CMFCRibbonPanel [MFC], GetRect
- CMFCRibbonPanel [MFC], GetVisibleElements
- CMFCRibbonPanel [MFC], HasElement
- CMFCRibbonPanel [MFC], HitTest
- CMFCRibbonPanel [MFC], HitTestEx
- CMFCRibbonPanel [MFC], Insert
- CMFCRibbonPanel [MFC], InsertSeparator
- CMFCRibbonPanel [MFC], IsCenterColumnVert
- CMFCRibbonPanel [MFC], IsCollapsed
- CMFCRibbonPanel [MFC], IsHighlighted
- CMFCRibbonPanel [MFC], IsJustifyColumns
- CMFCRibbonPanel [MFC], IsMainPanel
- CMFCRibbonPanel [MFC], IsMenuMode
- CMFCRibbonPanel [MFC], MakeGalleryItemVisible
- CMFCRibbonPanel [MFC], OnKey
- CMFCRibbonPanel [MFC], RecalcWidths
- CMFCRibbonPanel [MFC], Remove
- CMFCRibbonPanel [MFC], RemoveAll
- CMFCRibbonPanel [MFC], Replace
- CMFCRibbonPanel [MFC], ReplaceByID
- CMFCRibbonPanel [MFC], SetCenterColumnVert
- CMFCRibbonPanel [MFC], SetData
- CMFCRibbonPanel [MFC], SetElementMenu
- CMFCRibbonPanel [MFC], SetElementRTC
- CMFCRibbonPanel [MFC], SetElementRTCByID
- CMFCRibbonPanel [MFC], SetFocused
- CMFCRibbonPanel [MFC], SetJustifyColumns
- CMFCRibbonPanel [MFC], SetKeys
- CMFCRibbonPanel [MFC], ShowPopup
ms.assetid: 51d70749-1140-4386-b103-f14082049ba6
ms.openlocfilehash: 1ba7057405da2ebd7fd1bf699a69f97a650fa47c
ms.sourcegitcommit: 7ecd91d8ce18088a956917cdaf3a3565bd128510
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/16/2020
ms.locfileid: "79425765"
---
# <a name="cmfcribbonpanel-class"></a>CMFCRibbonPanel 类

实现包含一组功能区元素的面板。 在绘制面板时，系统将根据面板的大小显示尽可能多的元素。

有关更多详细信息，请参阅位于你的 Visual Studio 安装的**VC\\atlmfc\\src\\mfc**文件夹中的源代码。

## <a name="syntax"></a>语法

```
class CMFCRibbonPanel : public CObject
```

## <a name="members"></a>成员

### <a name="protected-constructors"></a>受保护构造函数

|名称|说明|
|----------|-----------------|
|[CMFCRibbonPanel：： CMFCRibbonPanel](#cmfcribbonpanel)|构造并初始化一个 `CMFCRibbonPanel` 对象。|

### <a name="public-methods"></a>公共方法

|名称|说明|
|----------|-----------------|
|[CMFCRibbonPanel：： Add](#add)|将功能区元素添加到面板。|
|[CMFCRibbonPanel：： AddSeparator](#addseparator)|将分隔符添加到功能区面板。|
|[CMFCRibbonPanel：： AddToolBar](#addtoolbar)|将工具栏添加到功能区面板。|
|[CMFCRibbonPanel：： FindByData](#findbydata)||
|[CMFCRibbonPanel：： FindByID](#findbyid)|返回由指定的命令 ID 标识的元素。|
|[CMFCRibbonPanel：： GetCaptionHeight](#getcaptionheight)||
|[CMFCRibbonPanel：： GetCount](#getcount)|返回功能区面板中的元素数。|
|[CMFCRibbonPanel：：](#getdata)|返回与面板关联的用户定义数据。|
|[CMFCRibbonPanel：： GetDefaultButton](#getdefaultbutton)||
|[CMFCRibbonPanel：： GetDroppedDown](#getdroppeddown)||
|[CMFCRibbonPanel：： GetElement](#getelement)|返回位于指定索引处的功能区元素。|
|[CMFCRibbonPanel：： GetElements](#getelements)|检索功能区面板中包含的所有元素。|
|[CMFCRibbonPanel：： GetElementsByID](#getelementsbyid)||
|[CMFCRibbonPanel：： GetFocused](#getfocused)|返回焦点元素。|
|[CMFCRibbonPanel：： GetGalleryRect](#getgalleryrect)|返回库元素的边框。|
|[CMFCRibbonPanel：： GetHighlighted](#gethighlighted)||
|[CMFCRibbonPanel：： GetIndex](#getindex)||
|[CMFCRibbonPanel：： GetItemIDsList](#getitemidslist)||
|[CMFCRibbonPanel：： GetName](#getname)||
|[CMFCRibbonPanel：： GetParentButton](#getparentbutton)||
|[CMFCRibbonPanel：： GetParentCategory](#getparentcategory)|返回功能区面板的父类别。|
|[CMFCRibbonPanel：： GetParentMenuBar](#getparentmenubar)||
|[CMFCRibbonPanel：： GetPreferedMenuLocation](#getpreferedmenulocation)||
|[CMFCRibbonPanel：： GetPressed](#getpressed)||
|[CMFCRibbonPanel：： GetRect](#getrect)||
|[CMFCRibbonPanel：： GetVisibleElements](#getvisibleelements)|获取可见元素的数组。|
|[CMFCRibbonPanel：： HasElement](#haselement)||
|[CMFCRibbonPanel：： System.windows.media.visualtreehelper.hittest](#hittest)||
|[CMFCRibbonPanel：： HitTestEx](#hittestex)||
|[CMFCRibbonPanel：： Insert](#insert)|在给定位置插入功能区元素。|
|[CMFCRibbonPanel：： InsertSeparator](#insertseparator)|在给定位置插入分隔符。|
|[CMFCRibbonPanel：： IsCenterColumnVert](#iscentercolumnvert)|指定所有面板元素是否应垂直居中（对齐）。|
|[CMFCRibbonPanel：： IsCollapsed](#iscollapsed)||
|[CMFCRibbonPanel：： IsHighlighted](#ishighlighted)||
|[CMFCRibbonPanel：： IsJustifyColumns](#isjustifycolumns)|指定所有面板列的宽度是否相同。|
|[CMFCRibbonPanel：： IsMainPanel](#ismainpanel)||
|[CMFCRibbonPanel：： IsMenuMode](#ismenumode)||
|[CMFCRibbonPanel：： MakeGalleryItemVisible](#makegalleryitemvisible)|滚动库以使指定的功能区元素可见。|
|[CMFCRibbonPanel：： OnKey](#onkey)||
|[CMFCRibbonPanel：： RecalcWidths](#recalcwidths)||
|[CMFCRibbonPanel：： Remove](#remove)|删除位于指定索引处的元素，并选择性地删除该元素。|
|[CMFCRibbonPanel：： RemoveAll](#removeall)|从功能区面板中移除所有元素。|
|[CMFCRibbonPanel：： Replace](#replace)|根据元素各自的索引值替换其中一个元素。|
|[CMFCRibbonPanel：： ReplaceByID](#replacebyid)|根据指定的命令 ID 将一个元素替换为另一个元素。|
|[CMFCRibbonPanel：： SetCenterColumnVert](#setcentercolumnvert)|按列对面板进行排序以垂直对齐元素。|
|[CMFCRibbonPanel：： SetData](#setdata)|将用户定义数据与功能区面板相关联。|
|[CMFCRibbonPanel：： SetElementMenu](#setelementmenu)|为具有给定命令 ID 的元素分配一个弹出菜单。|
|[CMFCRibbonPanel：： SetElementRTC](#setelementrtc)|将所提供的运行时类信息指定的功能区元素添加到功能区面板。|
|[CMFCRibbonPanel：： SetElementRTCByID](#setelementrtcbyid)|将所提供的运行时类信息指定的功能区元素添加到功能区面板。|
|[CMFCRibbonPanel：： SetFocused](#setfocused)|将焦点设置到指定的功能区元素。|
|[CMFCRibbonPanel：： SetJustifyColumns](#setjustifycolumns)|启用或禁用列对齐。|
|[CMFCRibbonPanel：： SetKeys](#setkeys)|设置显示功能区面板的键盘快捷键。|
|[CMFCRibbonPanel：： ShowPopup](#showpopup)||

## <a name="remarks"></a>备注

功能区面板是您在功能区类别中创建的相关任务的逻辑分组。 当功能区的大小改变时，面板布局会自动进行调整，以尽可能多地显示元素。

可以通过调用[CMFCRibbonCategory：： GetPanel](../../mfc/reference/cmfcribboncategory-class.md#getpanel)方法获取功能区类别中包含的功能区面板。

## <a name="example"></a>示例

下面的示例演示如何使用 `CMFCRibbonPanel` 类中的各种方法来配置 `CMFCRibbonPanel` 对象。 该示例演示如何设置显示功能区面板、按列垂直对齐面板中的元素以及启用列对齐的键盘快捷键。 此代码片段是[MS Office 2007 演示示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_MSOffice2007Demo#10](../../mfc/reference/codesnippet/cpp/cmfcribbonpanel-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CMFCRibbonPanel](../../mfc/reference/cmfcribbonpanel-class.md)

## <a name="requirements"></a>要求

**标头：** afxRibbonPanel

##  <a name="add"></a>CMFCRibbonPanel：： Add

将指定的功能区元素追加到功能区面板中包含的功能区元素的数组中。

```
virtual void Add(CMFCRibbonBaseElement* pElem);
```

### <a name="parameters"></a>parameters

*pElem*<br/>
[in，out]指向功能区元素的指针。

### <a name="remarks"></a>备注

##  <a name="addseparator"></a>CMFCRibbonPanel：： AddSeparator

将分隔符添加到功能区面板。

```
virtual void AddSeparator();
```

### <a name="remarks"></a>备注

调用此方法可将分隔符添加到功能区面板。 分隔符将添加到先前调用[CMFCRibbonPanel：： Add](#add)时添加的功能区元素旁边。 若要在给定位置插入分隔符，请调用[CMFCRibbonPanel：： InsertSeparator](#insertseparator)。

##  <a name="addtoolbar"></a>CMFCRibbonPanel：： AddToolBar

将工具栏添加到功能区面板。

```
CMFCRibbonButtonsGroup* AddToolBar(
UINT uiToolbarResID,
UINT uiColdResID = 0,
UINT uiHotResID = 0,
UINT uiDisabledResID = 0);
```

### <a name="parameters"></a>parameters

*uiToolbarResID*<br/>
中指定要添加的工具栏的资源 ID。

*uiColdResID*<br/>
中指定工具栏的冷图像的资源 ID。

*uiHotResID*<br/>
中指定工具栏的热图像的资源 ID。

*uiDisabledResID*<br/>
中指定工具栏的已禁用图像的资源 ID。

### <a name="return-value"></a>返回值

调用此方法可将工具栏添加到功能区面板。 工具栏将添加到由上一次调用[CMFCRibbonPanel：： Add](#add)添加的功能区元素旁边。

### <a name="remarks"></a>备注

有关工具栏、热映像、cold 图像和已禁用图像的详细信息，请参阅[CMFCToolBar 类](../../mfc/reference/cmfctoolbar-class.md)。

##  <a name="cmfcribbonpanel"></a>CMFCRibbonPanel：： CMFCRibbonPanel

构造并初始化[CMFCRibbonPanel](../../mfc/reference/cmfcribbonpanel-class.md)对象。

```
CMFCRibbonPanel(
LPCTSTR lpszName = NULL,
HICON hIcon = NULL);

CMFCRibbonPanel(CMFCRibbonGallery* pPaletteButton);
```

### <a name="parameters"></a>parameters

*lpszName*<br/>
中功能区面板的名称。

*hIcon*<br/>
中功能区面板的默认按钮的图标的句柄。

*pPaletteButton*<br/>
中指向功能区面板的功能区库的指针。

##  <a name="findbydata"></a>CMFCRibbonPanel：： FindByData

检索与指定的数据关联的功能区元素。

```
CMFCRibbonBaseElement* FindByData(DWORD_PTR dwData) const;
```

### <a name="parameters"></a>parameters

*dwData*<br/>
中与功能区元素关联的数据。

### <a name="return-value"></a>返回值

如果方法成功，则为指向功能区元素的指针;否则为 NULL。

### <a name="remarks"></a>备注

##  <a name="findbyid"></a>CMFCRibbonPanel：： FindByID

检索由指定的命令 ID 标识的功能区元素。

```
CMFCRibbonBaseElement* FindByID(UINT uiCmdID) const;
```

### <a name="parameters"></a>parameters

*uiCmdID*<br/>
中功能区元素的命令 ID。

### <a name="return-value"></a>返回值

由指定的命令 ID 标识的功能区元素;否则，如果没有用指定的命令 ID 标识功能区元素，则为 NULL。

##  <a name="getcaptionheight"></a>CMFCRibbonPanel：： GetCaptionHeight

检索功能区面板的标题的高度。

```
int GetCaptionHeight() const;
```

### <a name="return-value"></a>返回值

功能区面板的标题的高度（以像素为单位）。

### <a name="remarks"></a>备注

##  <a name="getcount"></a>CMFCRibbonPanel：： GetCount

检索功能区面板中包含的功能区元素的数目。

```
int GetCount() const;
```

### <a name="return-value"></a>返回值

功能区面板中包含的功能区元素的数目。

##  <a name="getdata"></a>CMFCRibbonPanel：：

返回与面板关联的用户定义数据。

```
DWORD_PTR GetData() const;
```

### <a name="return-value"></a>返回值

与面板关联的用户定义数据。

##  <a name="getdefaultbutton"></a>CMFCRibbonPanel：： GetDefaultButton

检索功能区面板的默认按钮。

```
CMFCRibbonButton& GetDefaultButton();
```

### <a name="return-value"></a>返回值

功能区面板的默认按钮。

### <a name="remarks"></a>备注

当功能区面板没有足够的空间来显示其功能区元素时，将显示 "默认" 按钮。

##  <a name="getdroppeddown"></a>CMFCRibbonPanel：： GetDroppedDown

检索一个指向功能区元素的指针（如果其弹出菜单被删除）。

```
CMFCRibbonBaseElement* GetDroppedDown() const;
```

### <a name="return-value"></a>返回值

一个指针，指向已下拉的弹出菜单的功能区元素;否则，如果没有功能区元素删除弹出菜单，则为 NULL。

### <a name="remarks"></a>备注

仅测试功能区面板中包含的功能区元素。

##  <a name="getelement"></a>CMFCRibbonPanel：： GetElement

返回位于指定索引处的功能区元素。

```
CMFCRibbonBaseElement* GetElement(int nIndex) const;
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中指定要检索的元素的从零开始的索引。

### <a name="return-value"></a>返回值

指向位于功能区面板中位置*nIndex*处的基功能区元素的有效指针，如果指定索引处没有元素，则为 NULL。

##  <a name="getelements"></a>CMFCRibbonPanel：： GetElements

检索功能区面板中包含的所有功能区元素。

```
void GetElements(CArray<CMFCRibbonBaseElement*, CMFCRibbonBaseElement*>& arElements);
```

### <a name="parameters"></a>parameters

*arElements*<br/>
弄用于填充功能区面板中包含的所有功能区元素的数组。

### <a name="remarks"></a>备注

##  <a name="getelementsbyid"></a>CMFCRibbonPanel：： GetElementsByID

将具有指定的命令 ID 的功能区元素添加到指定的数组。

```
void GetElementsByID(
UINT uiCmdID,
CArray<CMFCRibbonBaseElement*, CMFCRibbonBaseElement*>& arElements);
```

### <a name="parameters"></a>parameters

*uiCmdID*<br/>
中功能区元素的命令 ID。

*arElements*<br/>
中功能区元素的数组。

### <a name="remarks"></a>备注

仅测试功能区面板中包含的功能区元素。

##  <a name="gethighlighted"></a>CMFCRibbonPanel：： GetHighlighted

检索在功能区面板上突出显示的功能区元素。

```
CMFCRibbonBaseElement* GetHighlighted() const;
```

### <a name="return-value"></a>返回值

一个指针，指向在功能区面板上突出显示的功能区元素。

### <a name="remarks"></a>备注

##  <a name="getindex"></a>CMFCRibbonPanel：： GetIndex

从功能区面板中包含的功能区元素数组中检索指定功能区元素的从零开始的索引。

```
virtual int GetIndex(CMFCRibbonBaseElement* pElem) const;
```

### <a name="parameters"></a>parameters

*pElem*<br/>
中指向功能区元素的指针。

### <a name="return-value"></a>返回值

如果方法成功，则为指定功能区元素的从零开始的索引;否则为-1。

### <a name="remarks"></a>备注

##  <a name="getitemidslist"></a>CMFCRibbonPanel：： GetItemIDsList

检索功能区面板中所有功能区元素的命令 Id。

```
void GetItemIDsList(CList<UINT, UINT>& lstItems) const;
```

### <a name="parameters"></a>parameters

*lstItems*<br/>
弄功能区面板中包含的功能区元素的命令 Id 列表。

### <a name="remarks"></a>备注

##  <a name="getname"></a>CMFCRibbonPanel：： GetName

检索功能区面板的名称。

```
LPCTSTR GetName() const;
```

### <a name="return-value"></a>返回值

功能区面板的名称。

### <a name="remarks"></a>备注

##  <a name="getparentbutton"></a>CMFCRibbonPanel：： GetParentButton

```
CMFCRibbonBaseElement* GetParentButton() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="getparentcategory"></a>CMFCRibbonPanel：： GetParentCategory

返回功能区面板的父类别。

```
CMFCRibbonCategory* GetParentCategory() const;
```

### <a name="return-value"></a>返回值

指向包含此功能区面板的功能区类别的指针。

##  <a name="getparentmenubar"></a>CMFCRibbonPanel：： GetParentMenuBar

```
CMFCRibbonPanelMenuBar* GetParentMenuBar() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="getpreferedmenulocation"></a>CMFCRibbonPanel：： GetPreferedMenuLocation

检索功能区面板的弹出菜单的首选显示矩形。

```
virtual BOOL GetPreferedMenuLocation(CRect& rect);
```

### <a name="parameters"></a>parameters

*rect*<br/>
弄未使用此参数。

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

此方法始终返回 FALSE。 重写此方法以检索功能区面板的弹出菜单的首选显示矩形。

##  <a name="getpressed"></a>CMFCRibbonPanel：： GetPressed

如果用户当前按下了功能区，则在功能区面板上检索指向该功能区元素的指针。

```
CMFCRibbonBaseElement* GetPressed() const;
```

### <a name="return-value"></a>返回值

如果用户当前按下了某个功能区元素，则为该指针; 否则为。否则为 NULL。

### <a name="remarks"></a>备注

##  <a name="getrect"></a>CMFCRibbonPanel：： GetRect

检索功能区面板的显示矩形。

```
const CRect& GetRect() const;
```

### <a name="return-value"></a>返回值

功能区面板的显示矩形。

### <a name="remarks"></a>备注

##  <a name="haselement"></a>CMFCRibbonPanel：： HasElement

指示功能区面板是否包含指定的功能区元素。

```
BOOL HasElement(const CMFCRibbonBaseElement* pElem) const;
```

### <a name="parameters"></a>parameters

*pElem*<br/>
中指向功能区元素的指针。

### <a name="return-value"></a>返回值

如果功能区面板包含指定的功能区元素，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="highlight"></a>CMFCRibbonPanel：：突出显示

设置所选功能区面板的突出显示颜色以及该点指定的功能区元素的突出显示颜色。

```
virtual void Highlight(
BOOL bHighlight,
CPoint point);
```

### <a name="parameters"></a>parameters

*bHighlight*<br/>
中若要突出显示功能区面板，则为 TRUE;若要 unhighlight 功能区面板，则为 FALSE。

*情况*<br/>
中指针的 x 和 y 坐标，相对于窗口的左上角。

### <a name="remarks"></a>备注

##  <a name="hittest"></a>CMFCRibbonPanel：： System.windows.media.visualtreehelper.hittest

检索指定点所在的功能区元素。

```
virtual CMFCRibbonBaseElement* HitTest(
CPoint point,
BOOL bCheckPanelCaption = FALSE);
```

### <a name="parameters"></a>parameters

*情况*<br/>
中指针的 x 和 y 坐标，相对于窗口的左上角。

*bCheckPanelCaption*<br/>
中若要测试功能区面板标题，则为 TRUE;否则为 FALSE。

### <a name="return-value"></a>返回值

指向功能区元素的指针（如果指定点位于该元素中）;否则为 NULL。

### <a name="remarks"></a>备注

仅测试功能区面板中包含的功能区元素。

##  <a name="hittestex"></a>CMFCRibbonPanel：： HitTestEx

检索具有指定点的功能区元素的从零开始的索引。

```
virtual int HitTestEx(CPoint point) const;
```

### <a name="parameters"></a>parameters

*情况*<br/>
中指针的 x 和 y 坐标，相对于窗口的左上角。

### <a name="return-value"></a>返回值

具有指定点的功能区元素的从零开始的索引;否则为-1。

### <a name="remarks"></a>备注

仅测试功能区面板中包含的功能区元素。

##  <a name="insert"></a>CMFCRibbonPanel：： Insert

在功能区面板中包含的功能区元素数组中的指定位置插入指定的功能区元素。

```
virtual BOOL Insert(
CMFCRibbonBaseElement* pElem,
int nIndex);
```

### <a name="parameters"></a>parameters

*pElem*<br/>
[in，out]指向功能区元素的指针。

*nIndex*<br/>
中从零开始的值，范围从-1 到数组中包含的功能区元素的数目。

### <a name="return-value"></a>返回值

如果功能区元素已成功插入，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

如果*nIndex*的值为-1，或者，如果*nIndex*等于数组中的功能区元素的数目，则将指定的功能区元素添加到数组的末尾。 如果*nIndex*的值超出范围，则该方法将失败。

##  <a name="insertseparator"></a>CMFCRibbonPanel：： InsertSeparator

在给定位置插入分隔符。

```
virtual BOOL InsertSeparator(int nIndex);
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中指定从零开始的索引，在此处插入分隔符。

### <a name="return-value"></a>返回值

如果已成功插入分隔符，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

调用此方法可在*nIndex*指定的位置插入分隔符。 若要在最近添加的功能区元素旁边插入分隔符，请调用[CMFCRibbonPanel：： AddSeparator](#addseparator)。

##  <a name="iscentercolumnvert"></a>CMFCRibbonPanel：： IsCenterColumnVert

指示功能区元素的垂直位置是否在其显示矩形中居中。

```
BOOL IsCenterColumnVert() const;
```

### <a name="return-value"></a>返回值

如果功能区元素的垂直位置位于其显示矩形内，则为 TRUE;否则为 FALSE。

##  <a name="iscollapsed"></a>CMFCRibbonPanel：： IsCollapsed

指示功能区面板的显示大小是否在水平方向上最小化。

```
BOOL IsCollapsed() const;
```

### <a name="return-value"></a>返回值

如果功能区面板的显示大小在水平方向上最小化，则为 TRUE; 否则为。否则为 FALSE。

### <a name="remarks"></a>备注

当功能区面板处于折叠状态时，它只显示其默认按钮、名称和下拉箭头。

##  <a name="ishighlighted"></a>CMFCRibbonPanel：： IsHighlighted

指示是否突出显示功能区面板的显示。

```
BOOL IsHighlighted() const;
```

### <a name="return-value"></a>返回值

如果突出显示功能区面板的显示，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

当指针位于功能区面板上时，将突出显示该面板。

##  <a name="isjustifycolumns"></a>CMFCRibbonPanel：： IsJustifyColumns

指示功能区面板中同一列中的功能区元素的显示尺寸是否设置为相同宽度。

```
BOOL IsJustifyColumns() const;
```

### <a name="return-value"></a>返回值

如果功能区面板中同一列中的功能区元素的显示大小设置为相同宽度，则为 TRUE;否则为 FALSE。

##  <a name="ismainpanel"></a>CMFCRibbonPanel：： IsMainPanel

指示功能区面板是否为主要功能区面板。

```
virtual BOOL IsMainPanel() const;
```

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

此方法始终返回 FALSE。 重写此方法以指示功能区面板是否为主要功能区面板。

当用户选择 "应用程序" 按钮时，将显示主功能区面板。

##  <a name="ismenumode"></a>CMFCRibbonPanel：： IsMenuMode

```
BOOL IsMenuMode() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="onkey"></a>CMFCRibbonPanel：： OnKey

```
virtual BOOL OnKey(UINT nChar);
```

### <a name="parameters"></a>parameters

中*nChar*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="recalcwidths"></a>CMFCRibbonPanel：： RecalcWidths

重新计算功能区面板的每个显示布局配置的宽度。

```
virtual void RecalcWidths(
CDC* pDC,
int nHeight);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向功能区面板的设备上下文的指针。

*nHeight*<br/>
中功能区面板的高度。

### <a name="remarks"></a>备注

功能区面板会更改其布局配置，因为可用宽度发生变化。

##  <a name="remove"></a>CMFCRibbonPanel：： Remove

删除位于指定索引处的元素，并选择性地删除该元素。

```
BOOL Remove(
int nIndex,
BOOL bDelete = TRUE);
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中指定从功能区面板中移除的元素的从零开始的索引。

*bDelete*<br/>
中若要删除要删除的元素，则为 TRUE;否则为 FALSE。

### <a name="return-value"></a>返回值

如果已删除并删除元素（如果*bDelete*为 true），则为 true;如果未移除元素，或者在*nIndex*没有功能区元素，则为 FALSE。

### <a name="remarks"></a>备注

调用此方法可从功能区面板中删除元素。

##  <a name="removeall"></a>CMFCRibbonPanel：： RemoveAll

从功能区面板中删除所有功能区元素。

```
void RemoveAll();
```

### <a name="remarks"></a>备注

所有功能区元素都将从功能区面板中删除并销毁。

##  <a name="replace"></a>CMFCRibbonPanel：： Replace

基于元素的索引值替换其中一个元素。

```
BOOL Replace(
int nIndex,
CMFCRibbonBaseElement* pElem);
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中指定要替换的元素的从零开始的索引。

*pElem*<br/>
[in，out]指向替换原始元素的元素的有效指针。

### <a name="return-value"></a>返回值

如果新的功能区元素已成功替换原始功能区元素，则为 TRUE; 否则为 false。如果未替换功能区元素或指定索引处没有元素，则为 FALSE。

### <a name="remarks"></a>备注

若要通过命令 ID 替换功能区元素，请调用[CMFCRibbonPanel：： ReplaceByID](#replacebyid)。

##  <a name="replacebyid"></a>CMFCRibbonPanel：： ReplaceByID

根据指定的命令 ID 将一个元素替换为另一个元素。

```
BOOL ReplaceByID(
UINT uiCmdID,
CMFCRibbonBaseElement* pElem);
```

### <a name="parameters"></a>parameters

*uiCmdID*<br/>
中指定要替换的元素的命令 ID。

*pElem*<br/>
[in，out]指向将替换原始元素的元素的有效指针。

### <a name="return-value"></a>返回值

如果新的功能区元素已成功替换原始功能区元素，则为 TRUE; 否则为 false。如果未替换功能区元素，或者如果不存在具有指定命令 ID 的元素，则为 FALSE。

### <a name="remarks"></a>备注

若要根据位置替换功能区元素，请调用[CMFCRibbonPanel：： replace](#replace)。

##  <a name="setcentercolumnvert"></a>CMFCRibbonPanel：： SetCenterColumnVert

启用或禁用在其显示矩形中居中显示功能区元素的垂直位置。

```
void SetCenterColumnVert(BOOL bSet = TRUE);
```

### <a name="parameters"></a>parameters

*bSet*<br/>
中若要使功能区元素的垂直位置在其显示矩形中居中，为 TRUE;若要禁用此功能，则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="setdata"></a>CMFCRibbonPanel：： SetData

将用户定义数据与功能区面板相关联。

```
void SetData(DWORD_PTR dwData);
```

### <a name="parameters"></a>parameters

*dwData*<br/>
中指定要设置的用户定义数据。

### <a name="remarks"></a>备注

调用此方法可将用户定义的数据与功能区面板相关联。

##  <a name="setelementmenu"></a>CMFCRibbonPanel：： SetElementMenu

为具有给定命令 ID 的元素分配一个弹出菜单。

```
BOOL SetElementMenu(
UINT uiCmdID,
HMENU hMenu,
BOOL bIsDefautCommand = FALSE,
BOOL bRightAlign = FALSE);

BOOL SetElementMenu(
UINT uiCmdID,
UINT uiMenuResID,
BOOL bIsDefautCommand = FALSE,
BOOL bRightAlign = FALSE);
```

### <a name="parameters"></a>parameters

*uiCmdID*<br/>
中指定添加菜单的功能区元素的命令 ID。

*hMenu*<br/>
中指定要添加到功能区面板的 Windows 菜单的句柄。

*bIsDefautCommand*<br/>
中如果为 TRUE，则指定如果单击功能区元素，则应执行与功能区元素关联的命令。 在这种情况下，仅当用户单击功能区元素旁边的箭头时，才会打开菜单。 若为 FALSE，则指定在单击功能区元素时，不应执行与功能区元素关联的命令。 在这种情况下，将显示弹出菜单，而不考虑用户在元素上单击的位置。

*bRightAlign*<br/>
中若要指定弹出菜单右对齐，则为 TRUE;否则为 FALSE。

*uiMenuResID*<br/>
中指定要添加到功能区面板的菜单的资源 ID。

### <a name="return-value"></a>返回值

如果已将菜单分配给功能区元素，则为 TRUE; 否则为。否则为 FALSE。

### <a name="remarks"></a>备注

调用此方法可将弹出菜单分配给具有给定命令 ID 的功能区元素。

##  <a name="setelementrtc"></a>CMFCRibbonPanel：： SetElementRTC

将所提供的运行时类信息指定的功能区元素添加到功能区面板。

```
CMFCRibbonBaseElement* SetElementRTC(
int nIndex,
CRuntimeClass* pRTC);
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中指定要添加的功能区元素的从零开始的索引。

*pRTC*<br/>
[in，out]指向添加到功能区面板的功能区元素的运行时类信息的指针。

### <a name="return-value"></a>返回值

使用指定的运行时类信息创建的功能区元素。

### <a name="remarks"></a>备注

如果要将自定义元素（例如，颜色按钮）添加到功能区面板，则必须指定自定义元素的运行时类信息。 功能区存储此信息，创建自定义元素，并替换找到的现有元素（由标识）指定的命令 ID。 然后功能区返回指向新创建的元素的指针。

##  <a name="setelementrtcbyid"></a>CMFCRibbonPanel：： SetElementRTCByID

将所提供的运行时类信息指定的功能区元素添加到功能区面板。

```
CMFCRibbonBaseElement* SetElementRTCByID(
UINT uiCmdID,
CRuntimeClass* pRTC);
```

### <a name="parameters"></a>parameters

*uiCmdID*<br/>
中指定要添加的功能区元素的命令 ID。

*pRTC*<br/>
[in，out]指向与添加到功能区面板的功能区元素关联的运行时类信息的指针。

### <a name="return-value"></a>返回值

使用指定的运行时类信息创建的功能区元素。

### <a name="remarks"></a>备注

如果要将自定义元素（例如，颜色按钮）添加到功能区面板，则必须指定自定义元素的运行时类信息。 功能区存储此信息，创建自定义元素，并替换指定的命令 ID 处的现有元素。 然后，它返回指向新创建的元素的指针。

### <a name="example"></a>示例

下面的示例演示如何使用 `SetElementRTCByID` 方法：

```

// Load and add toolbar with standard buttons. This toolbar
// should display a custom color button with id ID_CHAR_COLOR:

pPanel->AddToolBar(IDR_MAINFRAME,
    IDB_MAINFRAME256);

CMFCRibbonColorButton* pColorButton =
(CMFCRibbonColorButton*)pPanel->SetElementRTCByID(
ID_CHAR_COLOR,
    RUNTIME_CLASS (CMFCRibbonColorButton));

// SetElementRTCByID sets runtime class and returns a pointer
// to the newly created custom button,
    which can be set up immediately:
pColorButton->EnableAutomaticButton(_T("Automatic"),
    RGB (0,
    0,
    0));
```

##  <a name="setjustifycolumns"></a>CMFCRibbonPanel：： SetJustifyColumns

启用或禁用在同一列中调整功能区元素的宽度。

```
void SetJustifyColumns(BOOL bSet = TRUE);
```

### <a name="parameters"></a>parameters

*bSet*<br/>
中若要将同一列中的功能区元素的宽度调整为列中最大功能区元素的宽度，则为 TRUE;若要禁用此宽度调整，则为 FALSE。

### <a name="remarks"></a>备注

如果在功能区面板中启用此功能，则同一列中的功能区元素的宽度将调整为同一列中最大功能区元素的宽度。

##  <a name="setkeys"></a>CMFCRibbonPanel：： SetKeys

设置功能区面板的默认按钮的快捷键提示。

```
void SetKeys(LPCTSTR lpszKeys);
```

### <a name="parameters"></a>parameters

*lpszKeys*<br/>
中功能区面板的默认按钮的快捷键提示。

### <a name="remarks"></a>备注

当功能区面板没有足够的空间来显示其功能区元素时，将显示 "默认" 按钮。

##  <a name="showpopup"></a>CMFCRibbonPanel：： ShowPopup

创建并显示功能区面板的弹出菜单。

```
CMFCRibbonPanelMenu* ShowPopup(CMFCRibbonDefaultPanelButton* pButton = NULL);
```

### <a name="parameters"></a>parameters

*pButton*<br/>
中指向功能区面板的默认按钮的指针。

### <a name="return-value"></a>返回值

如果方法成功，则为功能区面板的弹出菜单的指针;否则为 NULL。

### <a name="remarks"></a>备注

"功能区" 面板的弹出菜单仅在 "功能区" 面板的显示处于折叠状态时才可用。

##  <a name="setfocused"></a>CMFCRibbonPanel：： SetFocused

将焦点设置到指定的功能区元素。

```
void SetFocused(CMFCRibbonBaseElement* pNewFocus);
```

### <a name="parameters"></a>parameters

*pNewFocus*<br/>
指向接收焦点的功能区元素的指针。

### <a name="remarks"></a>备注

##  <a name="makegalleryitemvisible"></a>CMFCRibbonPanel：： MakeGalleryItemVisible

滚动库以使指定的功能区元素可见。

```
void MakeGalleryItemVisible(CMFCRibbonBaseElement* pItem);
```

### <a name="parameters"></a>parameters

*pItem*<br/>
指向要显示的功能区元素的指针。

### <a name="remarks"></a>备注

##  <a name="iswindows7look"></a>CMFCRibbonPanel：： IsWindows7Look

指示父功能区是否具有 Windows 7 外观（小型矩形应用程序按钮）。

```
BOOL IsWindows7Look() const;
```

### <a name="return-value"></a>返回值

如果父功能区具有 Windows 7 外观，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="getvisibleelements"></a>CMFCRibbonPanel：： GetVisibleElements

检索可见元素的数组。

```
void GetVisibleElements(
CArray<CMFCRibbonBaseElement*,
CMFCRibbonBaseElement*>& arElements);
```

### <a name="parameters"></a>parameters

*arElements*<br/>
当函数返回时，此参数包含可见元素的数组。

### <a name="remarks"></a>备注

##  <a name="getgalleryrect"></a>CMFCRibbonPanel：： GetGalleryRect

返回库元素的边框。

```
CRect GetGalleryRect();
```

### <a name="return-value"></a>返回值

此面板中库元素的大小和位置。

### <a name="remarks"></a>备注

##  <a name="getfocused"></a>CMFCRibbonPanel：： GetFocused

返回焦点元素。

```
CMFCRibbonBaseElement* GetFocused() const;
```

### <a name="return-value"></a>返回值

指向焦点元素或 NULL 的指针。

### <a name="remarks"></a>备注

## <a name="see-also"></a>另请参阅

[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)<br/>
[CObject 类](../../mfc/reference/cobject-class.md)<br/>
[CMFCRibbonCategory 类](../../mfc/reference/cmfcribboncategory-class.md)<br/>
[CMFCRibbonBaseElement 类](../../mfc/reference/cmfcribbonbaseelement-class.md)

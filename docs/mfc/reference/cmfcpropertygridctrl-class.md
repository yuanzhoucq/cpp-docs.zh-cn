---
title: CMFCPropertyGridCtrl 类
ms.date: 11/19/2018
f1_keywords:
- CMFCPropertyGridCtrl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::CMFCPropertyGridCtrl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::accSelect
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::AddProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::AlwaysShowUserToolTip
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::CloseColorPopup
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::Create
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::DeleteProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::DrawControlBarColors
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::EnableDescriptionArea
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::EnableHeaderCtrl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::EnsureVisible
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::ExpandAll
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::FindItemByData
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::get_accChildCount
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::get_accFocus
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::get_accHelp
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::get_accHelpTopic
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::get_accKeyboardShortcut
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::get_accSelection
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetBkColor
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetBoldFont
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetCurSel
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetCustomColors
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetDescriptionHeight
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetDescriptionRows
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetHeaderCtrl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetHeaderHeight
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetLeftColumnWidth
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetListRect
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetPropertyColumnWidth
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetPropertyCount
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetRowHeight
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetScrollBarCtrl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetTextColor
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::HitTest
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::InitHeader
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::IsAlphabeticMode
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::IsAlwaysShowUserToolTip
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::IsDescriptionArea
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::IsGroupNameFullWidth
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::IsHeaderCtrl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::IsMarkModifiedProperties
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::IsShowDragContext
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::IsVSDotNetLook
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::MarkModifiedProperties
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::RemoveAll
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::ResetOriginalValues
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetAlphabeticMode
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetBoolLabels
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetCurSel
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetCustomColors
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetDescriptionRows
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetGroupNameFullWidth
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetListDelimiter
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetShowDragContext
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetVSDotNetLook
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::UpdateColor
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::AdjustLayout
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::CompareProps
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::EditItem
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::EndEditItem
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::Init
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::OnChangeSelection
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::OnClickButton
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::OnDrawBorder
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::OnDrawDescription
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::OnDrawList
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::OnDrawProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::OnPropertyChanged
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::OnSelectCombo
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::ValidateItemData
helpviewer_keywords:
- CMFCPropertyGridCtrl [MFC], CMFCPropertyGridCtrl
- CMFCPropertyGridCtrl [MFC], accSelect
- CMFCPropertyGridCtrl [MFC], AddProperty
- CMFCPropertyGridCtrl [MFC], AlwaysShowUserToolTip
- CMFCPropertyGridCtrl [MFC], CloseColorPopup
- CMFCPropertyGridCtrl [MFC], Create
- CMFCPropertyGridCtrl [MFC], DeleteProperty
- CMFCPropertyGridCtrl [MFC], DrawControlBarColors
- CMFCPropertyGridCtrl [MFC], EnableDescriptionArea
- CMFCPropertyGridCtrl [MFC], EnableHeaderCtrl
- CMFCPropertyGridCtrl [MFC], EnsureVisible
- CMFCPropertyGridCtrl [MFC], ExpandAll
- CMFCPropertyGridCtrl [MFC], FindItemByData
- CMFCPropertyGridCtrl [MFC], get_accChildCount
- CMFCPropertyGridCtrl [MFC], get_accFocus
- CMFCPropertyGridCtrl [MFC], get_accHelp
- CMFCPropertyGridCtrl [MFC], get_accHelpTopic
- CMFCPropertyGridCtrl [MFC], get_accKeyboardShortcut
- CMFCPropertyGridCtrl [MFC], get_accSelection
- CMFCPropertyGridCtrl [MFC], GetBkColor
- CMFCPropertyGridCtrl [MFC], GetBoldFont
- CMFCPropertyGridCtrl [MFC], GetCurSel
- CMFCPropertyGridCtrl [MFC], GetCustomColors
- CMFCPropertyGridCtrl [MFC], GetDescriptionHeight
- CMFCPropertyGridCtrl [MFC], GetDescriptionRows
- CMFCPropertyGridCtrl [MFC], GetHeaderCtrl
- CMFCPropertyGridCtrl [MFC], GetHeaderHeight
- CMFCPropertyGridCtrl [MFC], GetLeftColumnWidth
- CMFCPropertyGridCtrl [MFC], GetListRect
- CMFCPropertyGridCtrl [MFC], GetProperty
- CMFCPropertyGridCtrl [MFC], GetPropertyColumnWidth
- CMFCPropertyGridCtrl [MFC], GetPropertyCount
- CMFCPropertyGridCtrl [MFC], GetRowHeight
- CMFCPropertyGridCtrl [MFC], GetScrollBarCtrl
- CMFCPropertyGridCtrl [MFC], GetTextColor
- CMFCPropertyGridCtrl [MFC], HitTest
- CMFCPropertyGridCtrl [MFC], InitHeader
- CMFCPropertyGridCtrl [MFC], IsAlphabeticMode
- CMFCPropertyGridCtrl [MFC], IsAlwaysShowUserToolTip
- CMFCPropertyGridCtrl [MFC], IsDescriptionArea
- CMFCPropertyGridCtrl [MFC], IsGroupNameFullWidth
- CMFCPropertyGridCtrl [MFC], IsHeaderCtrl
- CMFCPropertyGridCtrl [MFC], IsMarkModifiedProperties
- CMFCPropertyGridCtrl [MFC], IsShowDragContext
- CMFCPropertyGridCtrl [MFC], IsVSDotNetLook
- CMFCPropertyGridCtrl [MFC], MarkModifiedProperties
- CMFCPropertyGridCtrl [MFC], RemoveAll
- CMFCPropertyGridCtrl [MFC], ResetOriginalValues
- CMFCPropertyGridCtrl [MFC], SetAlphabeticMode
- CMFCPropertyGridCtrl [MFC], SetBoolLabels
- CMFCPropertyGridCtrl [MFC], SetCurSel
- CMFCPropertyGridCtrl [MFC], SetCustomColors
- CMFCPropertyGridCtrl [MFC], SetDescriptionRows
- CMFCPropertyGridCtrl [MFC], SetGroupNameFullWidth
- CMFCPropertyGridCtrl [MFC], SetListDelimiter
- CMFCPropertyGridCtrl [MFC], SetShowDragContext
- CMFCPropertyGridCtrl [MFC], SetVSDotNetLook
- CMFCPropertyGridCtrl [MFC], UpdateColor
- CMFCPropertyGridCtrl [MFC], AdjustLayout
- CMFCPropertyGridCtrl [MFC], CompareProps
- CMFCPropertyGridCtrl [MFC], EditItem
- CMFCPropertyGridCtrl [MFC], EndEditItem
- CMFCPropertyGridCtrl [MFC], Init
- CMFCPropertyGridCtrl [MFC], OnChangeSelection
- CMFCPropertyGridCtrl [MFC], OnClickButton
- CMFCPropertyGridCtrl [MFC], OnDrawBorder
- CMFCPropertyGridCtrl [MFC], OnDrawDescription
- CMFCPropertyGridCtrl [MFC], OnDrawList
- CMFCPropertyGridCtrl [MFC], OnDrawProperty
- CMFCPropertyGridCtrl [MFC], OnPropertyChanged
- CMFCPropertyGridCtrl [MFC], OnSelectCombo
- CMFCPropertyGridCtrl [MFC], ValidateItemData
ms.assetid: 95877cae-2311-4a2a-9031-0c8c3cf0a5f9
ms.openlocfilehash: 20b3bafcdbaf02b0f7e40f0092d7f6661855114d
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/15/2019
ms.locfileid: "69505164"
---
# <a name="cmfcpropertygridctrl-class"></a>CMFCPropertyGridCtrl 类

有关更多详细信息，请参阅位于 Visual Studio 安装的**VC\\atlmfc\\src\\mfc**文件夹中的源代码。

支持可以按字母或分层顺序显示属性的可编辑属性网格控件。

## <a name="syntax"></a>语法

```
class CMFCPropertyGridCtrl : public CWnd
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|描述|
|----------|-----------------|
|[CMFCPropertyGridCtrl::CMFCPropertyGridCtrl](#cmfcpropertygridctrl)|构造 `CMFCPropertyGridCtrl` 对象。|
|`CMFCPropertyGridCtrl::~CMFCPropertyGridCtrl`|析构函数。|

### <a name="public-methods"></a>公共方法

|名称|描述|
|----------|-----------------|
|`CMFCPropertyGridCtrl::accHitTest`|由框架调用以检索屏幕上给定点处的子元素或子对象。 （重写[CWnd：： accHitTest](../../mfc/reference/cwnd-class.md#acchittest)。）|
|`CMFCPropertyGridCtrl::accLocation`|由框架调用以检索指定对象的当前屏幕位置。 （重写[CWnd：： accLocation](../../mfc/reference/cwnd-class.md#acclocation)。）|
|[CMFCPropertyGridCtrl::accSelect](#accselect)|由框架调用以修改选定内容或移动指定对象的键盘焦点。 （重写[CWnd：： accSelect](../../mfc/reference/cwnd-class.md#accselect)。）|
|[CMFCPropertyGridCtrl::AddProperty](#addproperty)|将新属性添加到属性网格控件。|
|[CMFCPropertyGridCtrl::AlwaysShowUserToolTip](#alwaysshowusertooltip)||
|[CMFCPropertyGridCtrl::CloseColorPopup](#closecolorpopup)|关闭 "颜色选择" 对话框。|
|[CMFCPropertyGridCtrl::Create](#create)|创建属性网格控件，并将其附加到属性网格控件对象。|
|[CMFCPropertyGridCtrl::DeleteProperty](#deleteproperty)|从属性网格控件中删除指定属性。|
|[CMFCPropertyGridCtrl::DrawControlBarColors](#drawcontrolbarcolors)||
|[CMFCPropertyGridCtrl::EnableDescriptionArea](#enabledescriptionarea)|启用或禁用在属性列表下方显示的说明区域。|
|[CMFCPropertyGridCtrl::EnableHeaderCtrl](#enableheaderctrl)|启用或禁用属性网格控件顶部的标头控件。|
|[CMFCPropertyGridCtrl::EnsureVisible](#ensurevisible)|滚动属性网格控件并展开属性项，直到指定属性可见。|
|[CMFCPropertyGridCtrl::ExpandAll](#expandall)|展开或折叠所有属性网格控件节点。|
|[CMFCPropertyGridCtrl::FindItemByData](#finditembydata)|检索与用户定义的 DWORD 值相关联的属性。|
|`CMFCPropertyGridCtrl::get_accChild`|由框架调用以检索指定子级的 `IDispatch` 接口地址。 （重写[CWnd：： get_accChild](../../mfc/reference/cwnd-class.md#get_accchild)。）|
|[CMFCPropertyGridCtrl::get_accChildCount](#get_accchildcount)|由框架调用调用以检索属于该对象的子级的个数。 （重写[CWnd：： get_accChildCount](../../mfc/reference/cwnd-class.md#get_accchildcount)。）|
|`CMFCPropertyGridCtrl::get_accDefaultAction`|由框架调用以检索描述对象默认操作的字符串。 （重写[CWnd：： get_accDefaultAction](../../mfc/reference/cwnd-class.md#get_accdefaultaction)。）|
|`CMFCPropertyGridCtrl::get_accDescription`|由框架调用以检索描述指定对象的可视外观的字符串。 （重写[CWnd：： get_accDescription](../../mfc/reference/cwnd-class.md#get_accdescription)。）|
|[CMFCPropertyGridCtrl::get_accFocus](#get_accfocus)|由框架调用以检索具有键盘焦点的对象。 （重写[CWnd：： get_accFocus](../../mfc/reference/cwnd-class.md#get_accfocus)。）|
|[CMFCPropertyGridCtrl::get_accHelp](#get_acchelp)|由框架调用以检索对象的`Help`属性字符串。 （重写[CWnd：： get_accHelp](../../mfc/reference/cwnd-class.md#get_acchelp)。）|
|[CMFCPropertyGridCtrl::get_accHelpTopic](#get_acchelptopic)|由框架调用以检索与指定对象关联的**WinHelp**文件的完整路径以及该文件内相应主题的标识符。 （重写[CWnd：： get_accHelpTopic](../../mfc/reference/cwnd-class.md#get_acchelptopic)。）|
|[CMFCPropertyGridCtrl::get_accKeyboardShortcut](#get_acckeyboardshortcut)|由框架调用以检索指定对象的快捷键或访问键。 （重写[CWnd：： get_accKeyboardShortcut](../../mfc/reference/cwnd-class.md#get_acckeyboardshortcut)。）|
|`CMFCPropertyGridCtrl::get_accName`|由框架调用以检索指定对象的名称。 （重写[CWnd：： get_accName](../../mfc/reference/cwnd-class.md#get_accname)。）|
|`CMFCPropertyGridCtrl::get_accRole`|由框架调用以检索描述指定对象的角色的信息。 （重写[CWnd：： get_accRole](../../mfc/reference/cwnd-class.md#get_accrole)。）|
|[CMFCPropertyGridCtrl::get_accSelection](#get_accselection)|由框架调用以检索该对象的选定子级。 （重写[CWnd：： get_accSelection](../../mfc/reference/cwnd-class.md#get_accselection)。）|
|`CMFCPropertyGridCtrl::get_accState`|由框架调用以检索指定对象的当前状态。 （重写[CWnd：： get_accState](../../mfc/reference/cwnd-class.md#get_accstate)。）|
|`CMFCPropertyGridCtrl::get_accValue`|由框架调用以检索指定对象的值。 （重写[CWnd：： get_accValue](../../mfc/reference/cwnd-class.md#get_accvalue)。）|
|[CMFCPropertyGridCtrl::GetBkColor](#getbkcolor)|检索当前属性网格控件的背景色。|
|[CMFCPropertyGridCtrl::GetBoldFont](#getboldfont)|以粗体形式检索当前属性网格控件中文本的 Windows 字体。|
|[CMFCPropertyGridCtrl::GetCurSel](#getcursel)|检索当前选定的属性。|
|[CMFCPropertyGridCtrl::GetCustomColors](#getcustomcolors)|检索当前为属性网格控件元素定义的自定义颜色。|
|[CMFCPropertyGridCtrl::GetDescriptionHeight](#getdescriptionheight)|检索位于属性网格控件底部的说明区域的高度。|
|[CMFCPropertyGridCtrl::GetDescriptionRows](#getdescriptionrows)|检索当前属性网格控件的说明区域中的行数。|
|[CMFCPropertyGridCtrl::GetHeaderCtrl](#getheaderctrl)|检索框架用于显示当前属性网格控件的内部[CMFCHeaderCtrl](../../mfc/reference/cmfcheaderctrl-class.md)对象。|
|[CMFCPropertyGridCtrl::GetHeaderHeight](#getheaderheight)|检索属性网格控件标题的高度。|
|[CMFCPropertyGridCtrl::GetLeftColumnWidth](#getleftcolumnwidth)|检索当前属性网格控件的左栏的宽度，其中包含每个属性的名称。|
|[CMFCPropertyGridCtrl::GetListRect](#getlistrect)|检索属性网格控件的边框。|
|[CMFCPropertyGridCtrl::GetProperty](#getproperty)|检索一个指针，该指针指向与属性网格控件项的指定索引相对应的属性对象。|
|[CMFCPropertyGridCtrl::GetPropertyColumnWidth](#getpropertycolumnwidth)|检索包含属性值的列的当前宽度。|
|[CMFCPropertyGridCtrl::GetPropertyCount](#getpropertycount)|检索属性网格控件中的属性数。|
|[CMFCPropertyGridCtrl::GetRowHeight](#getrowheight)|检索属性网格控件中的行的高度。|
|[CMFCPropertyGridCtrl::GetScrollBarCtrl](#getscrollbarctrl)|检索指向属性网格控件中的滚动条控件的指针。 （重写[CWnd：： GetScrollBarCtrl](../../mfc/reference/cwnd-class.md#getscrollbarctrl)。）|
|[CMFCPropertyGridCtrl::GetTextColor](#gettextcolor)|检索当前属性网格控件中属性项的文本颜色。|
|`CMFCPropertyGridCtrl::GetThisClass`|由框架用于获取指向与此类类型相关联的[CRuntimeClass](../../mfc/reference/cruntimeclass-structure.md)对象的指针。|
|[CMFCPropertyGridCtrl::HitTest](#hittest)|检索一个指针，该指针指向与属性网格控件项相对应的属性，如果在项中指定点，则为。 此方法还指示属性网格控件中包含该点的区域。|
|[CMFCPropertyGridCtrl::InitHeader](#initheader)|初始化框架用于显示当前属性网格控件的内部[CMFCHeaderCtrl](../../mfc/reference/cmfcheaderctrl-class.md)对象。|
|[CMFCPropertyGridCtrl::IsAlphabeticMode](#isalphabeticmode)|指示属性网格控件是否处于字母模式。|
|[CMFCPropertyGridCtrl::IsAlwaysShowUserToolTip](#isalwaysshowusertooltip)||
|[CMFCPropertyGridCtrl::IsDescriptionArea](#isdescriptionarea)|指示是否显示属性网格控件的说明区域。|
|[CMFCPropertyGridCtrl::IsGroupNameFullWidth](#isgroupnamefullwidth)|指示是否在当前属性网格控件的整个宽度内显示每个属性组名称。|
|[CMFCPropertyGridCtrl::IsHeaderCtrl](#isheaderctrl)|指示是否显示标头控件。|
|[CMFCPropertyGridCtrl::IsMarkModifiedProperties](#ismarkmodifiedproperties)|指示属性网格控件如何显示修改后的属性。|
|[CMFCPropertyGridCtrl::IsShowDragContext](#isshowdragcontext)|指示当用户调整列的大小时，框架是否重绘当前属性网格控件的名称和值列。|
|[CMFCPropertyGridCtrl::IsVSDotNetLook](#isvsdotnetlook)|指示属性网格控件的外观是否为 VS .NET 使用的样式。|
|[CMFCPropertyGridCtrl::MarkModifiedProperties](#markmodifiedproperties)|指定如何显示修改后的属性。|
|`CMFCPropertyGridCtrl::PreTranslateMessage`|在将窗口消息发送到 [TranslateMessage](../../mfc/reference/cwinapp-class.md) 和 [DispatchMessage](/windows/win32/api/winuser/nf-winuser-translatemessage) Windows 函数之前，由 [CWinApp](/windows/win32/api/winuser/nf-winuser-dispatchmessage) 类用于对此消息进行转换。 （重写 [CWnd::PreTranslateMessage](../../mfc/reference/cwnd-class.md#pretranslatemessage)。）|
|[CMFCPropertyGridCtrl::RemoveAll](#removeall)|从属性网格控件中移除所有属性对象。|
|[CMFCPropertyGridCtrl::ResetOriginalValues](#resetoriginalvalues)|还原所有属性的原始值。|
|[CMFCPropertyGridCtrl::SetAlphabeticMode](#setalphabeticmode)|设置或重置字母模式。|
|[CMFCPropertyGridCtrl::SetBoolLabels](#setboollabels)|指定布尔标签的文本。|
|[CMFCPropertyGridCtrl::SetCurSel](#setcursel)|选择属性网格控件中的属性。|
|[CMFCPropertyGridCtrl::SetCustomColors](#setcustomcolors)|指定各种属性网格控件元素的自定义颜色。|
|[CMFCPropertyGridCtrl::SetDescriptionRows](#setdescriptionrows)|指定在当前属性网格控件的 "描述" 部分中显示的行数。|
|[CMFCPropertyGridCtrl::SetGroupNameFullWidth](#setgroupnamefullwidth)|指定是否在当前属性网格控件中显示一组属性的整个类别名称宽度。|
|[CMFCPropertyGridCtrl::SetListDelimiter](#setlistdelimiter)|定义将用作属性值列表中的分隔符的字符。|
|[CMFCPropertyGridCtrl::SetShowDragContext](#setshowdragcontext)|指定当用户调整列的大小时，框架是否重绘当前属性网格控件的名称和值列。|
|[CMFCPropertyGridCtrl::SetVSDotNetLook](#setvsdotnetlook)|将属性网格控件的外观设置为在 VS .NET 中使用的样式。|
|[CMFCPropertyGridCtrl::UpdateColor](#updatecolor)|设置当前所选颜色属性的颜色值。|

### <a name="protected-methods"></a>受保护的方法

|名称|描述|
|----------|-----------------|
|[CMFCPropertyGridCtrl::AdjustLayout](#adjustlayout)|重绘属性网格控件及其属性。|
|[CMFCPropertyGridCtrl::CompareProps](#compareprops)|由属性网格控件调用，用于对属性进行排序。|
|[CMFCPropertyGridCtrl::EditItem](#edititem)|当用户开始修改属性时由框架调用。|
|[CMFCPropertyGridCtrl::EndEditItem](#endedititem)|当用户停止修改属性时由框架调用。|
|[CMFCPropertyGridCtrl::Init](#init)|由框架调用以初始化属性网格控件。|
|[CMFCPropertyGridCtrl::OnChangeSelection](#onchangeselection)|当当前选定内容已更改时由框架调用。|
|[CMFCPropertyGridCtrl::OnClickButton](#onclickbutton)|单击属性按钮时由框架调用。|
|[CMFCPropertyGridCtrl::OnDrawBorder](#ondrawborder)|由框架调用，以在属性网格控件周围绘制边框。|
|[CMFCPropertyGridCtrl::OnDrawDescription](#ondrawdescription)|由框架调用以绘制说明区域并显示说明文本。|
|[CMFCPropertyGridCtrl::OnDrawList](#ondrawlist)|由框架调用以显示属性网格控件中的属性列表。|
|[CMFCPropertyGridCtrl::OnDrawProperty](#ondrawproperty)|由框架调用以显示属性。|
|[CMFCPropertyGridCtrl::OnPropertyChanged](#onpropertychanged)|当属性的值更改时，由框架调用。|
|[CMFCPropertyGridCtrl::OnSelectCombo](#onselectcombo)|当选择包含组合框控件的属性时，由框架调用。|
|[CMFCPropertyGridCtrl::ValidateItemData](#validateitemdata)|由框架调用以验证属性数据。|

## <a name="remarks"></a>备注

`CMFCPropertyGridCtrl`类显示属性网格控件，该控件包含从 [CMFCPropertyGridProperty](../../mfc/reference/cmfcpropertygridproperty-class.md) 类派生的可编辑属性。 每个属性都可以表示一个类型，并且它可以包含子项。 "属性" 网格控件支持底部的可调整大小的区域，可显示所选属性的说明。

若要使用属性网格控件，请构造`CMFCPropertyGridCtrl`对象，然后调用[CMFCPropertyGridCtrl：： Create](#create)方法。 使用[CMFCPropertyGridCtrl：： AddProperty](#addproperty)方法可向列表中添加属性。

## <a name="selection-properties"></a>选择属性

属性项可以启动一个对话框，使用户能够选择颜色、文件或字体，而不是表示值。

下表列出了四个选择属性类型：

|类|描述|
|-----------|-----------------|
|[CMFCPropertyGridProperty 类](../../mfc/reference/cmfcpropertygridproperty-class.md)|用于指定字符串、布尔值、日期等的值的通用属性。|
|[CMFCPropertyGridColorProperty 类](../../mfc/reference/cmfcpropertygridcolorproperty-class.md)|用于选择颜色值的属性。|
|[CMFCPropertyGridFileProperty 类](../../mfc/reference/cmfcpropertygridfileproperty-class.md)|用于选择文件的属性。|
|[CMFCPropertyGridFontProperty 类](../../mfc/reference/cmfcpropertygridfontproperty-class.md)|用于选择字体的属性。|

## <a name="illustrations"></a>图示

下图描绘了一个属性网格控件，该控件以两种方式显示属性。 第一个插图按层次结构显示属性，第二个图例按字母顺序显示属性。

![属性列表属性表](../../mfc/reference/media/proplist.png "属性列表属性表")

## <a name="example"></a>示例

下面的示例演示如何使用类中的`CMFCPropertyGridCtrl`各种方法配置属性网格控件对象。 该示例演示如何启用标头控件，启用 "说明" 区域，以及设置属性网格控件的外观。 该示例还演示了如何为控件设置按字母模式，从而使控件按属性名对它所包含的所有属性进行排序，以及如何为属性网格控件的各种元素设置自定义颜色。 此示例是[新控件示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_NewControls#14](../../mfc/reference/codesnippet/cpp/cmfcpropertygridctrl-class_1.h)]
[!code-cpp[NVC_MFC_NewControls#16](../../mfc/reference/codesnippet/cpp/cmfcpropertygridctrl-class_2.cpp)]
[!code-cpp[NVC_MFC_NewControls#20](../../mfc/reference/codesnippet/cpp/cmfcpropertygridctrl-class_3.cpp)]
[!code-cpp[NVC_MFC_NewControls#21](../../mfc/reference/codesnippet/cpp/cmfcpropertygridctrl-class_4.cpp)]
[!code-cpp[NVC_MFC_NewControls#24](../../mfc/reference/codesnippet/cpp/cmfcpropertygridctrl-class_5.cpp)]

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CMFCPropertyGridCtrl](../../mfc/reference/cmfcpropertygridctrl-class.md)

## <a name="requirements"></a>要求

**标头：** afxpropertygridctrl

##  <a name="accselect"></a>CMFCPropertyGridCtrl：： accSelect

```
virtual HRESULT accSelect(
    long flagsSelect,
    VARIANT varChild);
```

### <a name="parameters"></a>参数

[in] *flagsSelect*<br/>
中*varChild*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="addproperty"></a>CMFCPropertyGridCtrl：： AddProperty

将新属性添加到属性网格控件。

```
int AddProperty(
    CMFCPropertyGridProperty* pProp,
    BOOL bRedraw=TRUE,
    BOOL bAdjustLayout=TRUE);
```

### <a name="parameters"></a>参数

*pProp*<br/>
中指向属性的指针。

*bRedraw*<br/>
中若要立即重绘属性，则为 TRUE;否则为 FALSE。 默认值为 TRUE。

*bAdjustLayout*<br/>
中如果要重新计算如何绘制属性的文本和值，然后绘制属性，则为 TRUE;若为 FALSE，则使用现有计算绘制属性。 默认值为 TRUE。

### <a name="return-value"></a>返回值

如果此方法成功，则为属性网格控件中添加属性的位置的从零开始的索引;否则为-1。

### <a name="remarks"></a>备注

此方法将指向指定属性的指针添加到属性网格控件中的属性列表的末尾。 不要销毁属性，或允许它们在取消网格控件之前超出范围。 完成 "属性" 网格控件后，调用[CMFCPropertyGridCtrl：： RemoveAll](#removeall)以删除所有已添加的属性。 如果指定的属性已添加到列表中，则 AddProperty 方法将失败。

##  <a name="adjustlayout"></a>CMFCPropertyGridCtrl：： AdjustLayout

重绘属性网格控件及其属性。

```
virtual void AdjustLayout();
```

### <a name="remarks"></a>备注

此方法重新计算如何绘制整个 "属性" 网格控件及其属性（包括图像、字体和控件）。

##  <a name="alwaysshowusertooltip"></a>CMFCPropertyGridCtrl：： AlwaysShowUserToolTip

```
void AlwaysShowUserToolTip(BOOL bShow = TRUE);
```

### <a name="parameters"></a>参数

中*bShow*<br/>

### <a name="remarks"></a>备注

##  <a name="closecolorpopup"></a>CMFCPropertyGridCtrl：： CloseColorPopup

关闭 "颜色选择" 对话框。

```
virtual void CloseColorPopup();
```

### <a name="remarks"></a>备注

有关 "颜色选择" 对话框的详细信息，请参阅[CMFCPropertyGridColorProperty 类](../../mfc/reference/cmfcpropertygridcolorproperty-class.md)。

##  <a name="cmfcpropertygridctrl"></a>CMFCPropertyGridCtrl：： CMFCPropertyGridCtrl

构造 `CMFCPropertyGridCtrl` 对象。

```
CMFCPropertyGridCtrl();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="compareprops"></a>CMFCPropertyGridCtrl：： CompareProps

由属性网格控件调用，用于对属性进行排序。

```
virtual int CompareProps(
    const CMFCPropertyGridProperty* pProp1,
    const CMFCPropertyGridProperty* pProp2) const;
```

### <a name="parameters"></a>参数

*pProp1*<br/>
指向属性的指针。

*pProp2*<br/>
指向属性的指针。

### <a name="return-value"></a>返回值

|返回值|描述|
|------------------|-----------------|
|< 0|*PProp1*参数的名称小于*pProp2*参数的名称。|
|0|*PProp1*参数的名称等于*pProp2*参数的名称。|
|> 0|*PProp1*对象的名称大于*pProp2*参数的名称。|

### <a name="remarks"></a>备注

默认情况下，此方法使用[CString：： compare](../../atl-mfc-shared/reference/cstringt-class.md#compare)方法来比较`CMFCPropertyGridProperty::m_strName`指定参数的成员。

##  <a name="create"></a>CMFCPropertyGridCtrl：： Create

创建属性网格控件，并将其附加到属性网格控件对象。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>参数

*dwStyle*<br/>
中[窗口样式](../../mfc/reference/styles-used-by-mfc.md#window-styles)的按位组合（OR）。

*rect*<br/>
中指定窗口的大小和位置的边框（在*pParentWnd*的工作区坐标中）。

*pParentWnd*<br/>
中指向父窗口的指针。 不得为 NULL。

*nID*<br/>
中子窗口的 ID。

### <a name="return-value"></a>返回值

如果成功创建了窗口，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

若要创建属性网格控件，请首先调用[CMFCPropertyGridCtrl：： CMFCPropertyGridCtrl](#cmfcpropertygridctrl)来构造属性网格对象。 然后调用`CMFCPropertyGridCtrl::Create`。

### <a name="example"></a>示例

下面的示例演示如何使用类中`Create` `CMFCPropertyGridCtrl`的方法。 此示例是[新控件示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_NewControls#15](../../mfc/reference/codesnippet/cpp/cmfcpropertygridctrl-class_6.cpp)]

##  <a name="deleteproperty"></a>CMFCPropertyGridCtrl：:D eleteProperty

从属性网格控件中删除指定属性。

```
BOOL DeleteProperty(
    CMFCPropertyGridProperty*& pProp,
    BOOL bRedraw=TRUE,
    BOOL bAdjustLayout=TRUE);
```

### <a name="parameters"></a>参数

*pProp*<br/>
中指向属性的指针。

*bRedraw*<br/>
中若要重绘属性网格控件，则为 TRUE;否则为 FALSE。 默认值为 TRUE。

*bAdjustLayout*<br/>
中若要重新计算如何在属性网格控件中绘制所有文本、图像和项，然后绘制控件，则为 TRUE;否则为 FALSE。 默认值为 TRUE。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

使用此方法可以从 "属性" 网格控件中删除属性和任何子项。

##  <a name="drawcontrolbarcolors"></a>CMFCPropertyGridCtrl：:D rawControlBarColors

```
BOOL DrawControlBarColors() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="edititem"></a>CMFCPropertyGridCtrl：： EditItem

当用户开始修改属性时由框架调用。

```
virtual BOOL EditItem(
    CMFCPropertyGridProperty* pProp,
    LPPOINT lptClick=NULL);
```

### <a name="parameters"></a>参数

*pProp*<br/>
中指向属性的指针。

*lptClick*<br/>
中用户单击以开始编辑操作的属性网格控件上的点。 点在控件的工作区坐标中。 默认值为 NULL。

### <a name="return-value"></a>返回值

如果方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="enabledescriptionarea"></a>CMFCPropertyGridCtrl：： EnableDescriptionArea

启用或禁用在属性网格控件的属性列表下方显示的说明区域。

```
void EnableDescriptionArea(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
中若要启用说明区域，则为 TRUE;若要禁用说明区域，则为 FALSE。 默认值为 TRUE。

### <a name="remarks"></a>备注

"说明" 区域显示在属性网格控件的底部。 默认情况下，说明区域处于禁用状态且不可见。

##  <a name="enableheaderctrl"></a>CMFCPropertyGridCtrl：： EnableHeaderCtrl

启用或禁用属性网格控件顶部的标头控件。

```
void EnableHeaderCtrl(
    BOOL bEnable=TRUE,
    LPCTSTR lpszLeftColumn=_T("Property"),
    LPCTSTR lpszRightColumn=_T("Value"));
```

### <a name="parameters"></a>参数

*bEnable*<br/>
中若要启用标题控件，则为 TRUE;若要禁用标题控件，则为 FALSE。 默认值为 TRUE。

*lpszLeftColumn*<br/>
中标题控件的左栏的标题。 默认值为 "**属性**"。

*lpszRightColumn*<br/>
中标题控件右栏的标题。 默认值为 "**值**"。

##  <a name="endedititem"></a>CMFCPropertyGridCtrl：： EndEditItem

当用户完成修改属性时由框架调用。

```
virtual BOOL EndEditItem(BOOL bUpdateData=TRUE);
```

### <a name="parameters"></a>参数

*bUpdateData*<br/>
中如果为 TRUE，则指定在编辑操作完成时必须验证修改后的属性数据;否则为 FALSE。 默认值为 TRUE。

### <a name="return-value"></a>返回值

如果编辑操作成功结束，则为 TRUE;如果修改后的属性数据无效或编辑操作应继续，则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="ensurevisible"></a>CMFCPropertyGridCtrl：： Ensurevisible\

滚动属性网格控件并展开属性项，直到指定属性可见。

```
void EnsureVisible(
    CMFCPropertyGridProperty* pProp,
    BOOL bExpandParents=FALSE);
```

### <a name="parameters"></a>参数

*pProp*<br/>
中指向属性的指针。

*bExpandParents*<br/>
中若要展开父项以使指定的属性可见，则为 TRUE;否则为 FALSE。 默认值为 FALSE。

### <a name="remarks"></a>备注

##  <a name="expandall"></a>CMFCPropertyGridCtrl：：展开

展开或折叠所有属性网格控件节点。

```
void ExpandAll(BOOL bExpand=TRUE);
```

### <a name="parameters"></a>参数

*bExpand*<br/>
中若要展开所有节点，则为 TRUE;若要折叠所有节点，则为 FALSE。 默认值为 TRUE。

### <a name="remarks"></a>备注

##  <a name="finditembydata"></a>CMFCPropertyGridCtrl：： FindItemByData

检索与用户定义的 DWORD 值相关联的属性。

```
CMFCPropertyGridProperty* FindItemByData(
    DWORD_PTR dwData,
    BOOL bSearchSubItems=TRUE) const;
```

### <a name="parameters"></a>参数

*dwData*<br/>
中DWORD 值。

*bSearchSubItems*<br/>
中若要搜索属性子项目，则为 TRUE;否则为 FALSE。 默认值为 TRUE。

### <a name="return-value"></a>返回值

如果此方法成功，则为指向关联的属性对象的指针;否则为 NULL。

### <a name="remarks"></a>备注

使用[CMFCPropertyGridCtrl：： CMFCPropertyGridCtrl](#cmfcpropertygridctrl)构造函数或[CMFCPropertyGridProperty：： SETDATA](../../mfc/reference/cmfcpropertygridproperty-class.md#setdata)方法将 DWORD 与属性关联。

##  <a name="get_accchildcount"></a>  CMFCPropertyGridCtrl::get_accChildCount

```
virtual HRESULT get_accChildCount(long* pcountChildren);
```

### <a name="parameters"></a>参数

[in] *pcountChildren*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="get_accfocus"></a>  CMFCPropertyGridCtrl::get_accFocus

```
virtual HRESULT get_accFocus(VARIANT* pvarChild);
```

### <a name="parameters"></a>参数

中*pvarChild*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="get_acchelp"></a>CMFCPropertyGridCtrl：： get_accHelp

```
virtual HRESULT get_accHelp(
    VARIANT varChild,
    BSTR* pszHelp);
```

### <a name="parameters"></a>参数

中*varChild*<br/>
[in] *pszHelp*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="get_acchelptopic"></a>CMFCPropertyGridCtrl：： get_accHelpTopic

```
virtual HRESULT get_accHelpTopic(
    BSTR* pszHelpFile,
    VARIANT varChild,
    long* pidTopic);
```

### <a name="parameters"></a>参数

[in] *pszHelpFile*<br/>
中*varChild*<br/>
[in] *pidTopic*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="get_acckeyboardshortcut"></a>CMFCPropertyGridCtrl：： get_accKeyboardShortcut

```
virtual HRESULT get_accKeyboardShortcut(
    VARIANT varChild,
    BSTR* pszKeyboardShortcut);
```

### <a name="parameters"></a>参数

中*varChild*<br/>
中*pszKeyboardShortcut*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="get_accselection"></a>  CMFCPropertyGridCtrl::get_accSelection

```
virtual HRESULT get_accSelection(VARIANT* pvarChildren);
```

### <a name="parameters"></a>参数

[in] *pvarChildren*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="getbkcolor"></a>CMFCPropertyGridCtrl：： GetBkColor

检索当前属性网格控件的背景色。

```
COLORREF GetBkColor() const;
```

### <a name="return-value"></a>返回值

RGB 颜色值。

### <a name="remarks"></a>备注

此方法检索框架用于绘制当前属性网格控件的背景的颜色。 [CMFCPropertyGridCtrl：： GetTextColor](#gettextcolor)方法检索前景色。

##  <a name="getboldfont"></a>CMFCPropertyGridCtrl：： GetBoldFont

检索用于在当前属性网格控件中以粗体形式绘制文本的 Windows 字体。

```
CFont& GetBoldFont();
```

### <a name="return-value"></a>返回值

对[CFont](../../mfc/reference/cfont-class.md)对象的引用，该对象描述粗体字的特征。

##  <a name="getcursel"></a>CMFCPropertyGridCtrl：： GetCurSel

检索当前选定的属性。

```
CMFCPropertyGridProperty* GetCurSel() const;
```

### <a name="return-value"></a>返回值

一个指针，指向与属性网格控件中的选定项相对应的属性对象。

### <a name="remarks"></a>备注

##  <a name="getcustomcolors"></a>CMFCPropertyGridCtrl：： GetCustomColors

检索当前为属性网格控件元素定义的自定义颜色。

```
void GetCustomColors(
    COLORREF& clrBackground,
    COLORREF& clrText,
    COLORREF& clrGroupBackground,
    COLORREF& clrGroupText,
    COLORREF& clrDescriptionBackground,
    COLORREF& clrDescriptionText,
    COLORREF& clrLine);
```

### <a name="parameters"></a>参数

*clrBackground*<br/>
弄属性值的背景色。

*clrText*<br/>
弄属性名称和属性值文本的颜色。

*clrGroupBackground*<br/>
弄属性组的背景色。

*clrGroupText*<br/>
弄属性组中文本的颜色。

*clrDescriptionBackground*<br/>
弄说明区域的背景色。

*clrDescriptionText*<br/>
弄"说明" 区域中文本的颜色。

*clrLine*<br/>
弄在属性之间绘制的线条的颜色。

### <a name="remarks"></a>备注

使用[CMFCPropertyGridCtrl：： SetCustomColors](#setcustomcolors)方法可设置自定义颜色。

##  <a name="getdescriptionheight"></a>CMFCPropertyGridCtrl：： GetDescriptionHeight

检索位于属性网格控件底部的说明区域的高度。

```
int GetDescriptionHeight() const;
```

### <a name="return-value"></a>返回值

说明区域的高度（以像素为单位）。

### <a name="remarks"></a>备注

将自动计算说明区域的高度，并将属性网格控件的高度设置为1/4。

使用[CMFCPropertyGridCtrl：： EnableDescriptionArea](#enabledescriptionarea)方法显示或隐藏说明区域。 使用[CMFCPropertyGridCtrl：： IsDescriptionArea](#isdescriptionarea)方法来确定是显示还是隐藏说明区域。

##  <a name="getdescriptionrows"></a>  CMFCPropertyGridCtrl::GetDescriptionRows

检索当前属性网格控件的说明区域中的行数。

```
int GetDescriptionRows() const;
```

### <a name="return-value"></a>返回值

当前属性网格控件的说明区域中的行数。

### <a name="remarks"></a>备注

[CMFCPropertyGridCtrl：： CMFCPropertyGridCtrl](#cmfcpropertygridctrl)构造函数将说明区域初始化为3行。

##  <a name="getheaderctrl"></a>CMFCPropertyGridCtrl：： GetHeaderCtrl

检索框架用于显示当前属性网格控件的内部[CMFCHeaderCtrl](../../mfc/reference/cmfcheaderctrl-class.md)对象。

```
virtual CMFCHeaderCtrl& GetHeaderCtrl();
```

### <a name="return-value"></a>返回值

对 `CMFCHeaderCtrl` 对象的引用。

##  <a name="getheaderheight"></a>CMFCPropertyGridCtrl：： GetHeaderHeight

检索属性网格控件的标头的高度。

```
int GetHeaderHeight() const;
```

### <a name="return-value"></a>返回值

标头的高度（以像素为单位）。

### <a name="remarks"></a>备注

##  <a name="getleftcolumnwidth"></a>CMFCPropertyGridCtrl：： GetLeftColumnWidth

检索当前属性网格控件的左栏的宽度，其中包含每个属性的名称。

```
int GetLeftColumnWidth() const;
```

### <a name="return-value"></a>返回值

名称列的宽度。

### <a name="remarks"></a>备注

属性网格控件的右列包含每个属性的值。

##  <a name="getlistrect"></a>CMFCPropertyGridCtrl：： GetListRect

检索属性网格控件的边框。

```
CRect GetListRect() const;
```

### <a name="return-value"></a>返回值

属性网格控件的边框。 此 rectange 不包括描述区域和标头。

### <a name="remarks"></a>备注

##  <a name="getproperty"></a>CMFCPropertyGridCtrl：： GetProperty

检索一个指针，该指针指向与属性网格控件中的项的指定索引对应的属性对象。

```
CMFCPropertyGridProperty* GetProperty(int nIndex) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
中属性网格控件项的从零开始的索引。

如果*nIndex*参数小于零或大于等于属性数，则此方法将断言。

### <a name="return-value"></a>返回值

如果此方法成功，则为与指定索引对应的属性对象的指针。否则为`NULL`。

### <a name="remarks"></a>备注

##  <a name="getpropertycolumnwidth"></a>CMFCPropertyGridCtrl：： GetPropertyColumnWidth

检索包含属性值的列的当前宽度。

```
int GetPropertyColumnWidth() const;
```

### <a name="return-value"></a>返回值

包含属性值的列的当前宽度。

### <a name="remarks"></a>备注

"属性" 网格控件右侧的列包含属性值。 客户可以使用 "属性" 网格控件的 "拆分" 框更改 "值" 列的宽度。

##  <a name="getpropertycount"></a>CMFCPropertyGridCtrl：： GetPropertyCount

检索属性网格控件中的属性数。

```
int GetPropertyCount() const;
```

### <a name="return-value"></a>返回值

属性的数目。

### <a name="remarks"></a>备注

##  <a name="getrowheight"></a>CMFCPropertyGridCtrl：： GetRowHeight

检索属性网格控件中的行的高度。

```
int GetRowHeight() const;
```

### <a name="return-value"></a>返回值

行的高度。

### <a name="remarks"></a>备注

行的高度等于当前字体高度加上4像素。

##  <a name="getscrollbarctrl"></a>CMFCPropertyGridCtrl：： GetScrollBarCtrl

检索指向属性网格控件中的滚动条控件的指针。

```
virtual CScrollBar* GetScrollBarCtrl(int nBar) const;
```

### <a name="parameters"></a>参数

*nBar*<br/>
中滚动条的方向，必须为 SB_VERT。

### <a name="return-value"></a>返回值

指向滚动条对象的指针; 如果没有滚动条或滚动条方向为 SB_HORZ，则为 NULL。

### <a name="remarks"></a>备注

使用此方法可获取对垂直滚动条控件的直接访问。

##  <a name="gettextcolor"></a>CMFCPropertyGridCtrl：： GetTextColor

检索用于在当前属性网格控件中绘制属性项文本的颜色。

```
COLORREF GetTextColor() const;
```

### <a name="return-value"></a>返回值

RGB 颜色值。

### <a name="remarks"></a>备注

此方法检索框架用于绘制当前属性网格控件的前景的颜色。 [CMFCPropertyGridCtrl：： GetBkColor](#getbkcolor)方法检索背景色。

##  <a name="hittest"></a>CMFCPropertyGridCtrl：： System.windows.media.visualtreehelper.hittest

检索一个指针，该指针指向与属性网格控件项相对应的属性，如果在项中指定点，则为。 此方法还指示属性网格控件中包含该点的区域。

```
CMFCPropertyGridProperty* HitTest(
    CPoint pt,
    CMFCPropertyGridProperty::ClickArea* pnArea=NULL,
    BOOL bPropsOnly=FALSE) const;
```

### <a name="parameters"></a>参数

*pt*<br/>
中一个点，采用工作区坐标。

*pnArea*<br/>
[in，out]指向`ClickArea`变量的指针。 此方法返回时，该变量指示包含指定点的*属性区域*。 有关属性区域的详细信息，请参阅 "备注"。

*bPropsOnly*<br/>
中如果仅测试属性区域，则为 TRUE;如果指定点不在属性区域中，则为 FALSE 以测试*说明区域*。 默认值是 FALSE。 有关说明区域的详细信息，请参阅 "备注"。

### <a name="return-value"></a>返回值

如果*bPropsOnly*参数为 TRUE，并且指定点在属性区域中，则返回值是指向相应属性对象的指针。 此外， *pnArea*参数设置为包含指定点的特定区域。 否则，返回值为 NULL，并且不修改*pnArea*参数。

如果*bPropsOnly*参数为 FALSE，则返回值始终为 NULL。 但是，如果指定点在说明区域，则将*pnArea*参数设置为`CMFCPropertyGridProperty::ClickDescription`。

### <a name="remarks"></a>备注

术语*属性区域*指的是属性网格控件项的名称、值或扩展框区域中的任何一个。 *说明区域*是属性网格控件底部的区域。 单击 "属性" 网格控件项时，"说明" 区域会显示相应属性的说明。

此方法设置*pnArea*参数指向的变量的值。 下表列出了可能的值和相应的区域。

|值|区域|
|-----------|----------|
|`ClickArea::ClickExpandBox`|属性扩展框控件。|
|`ClickArea::ClickName`|属性名称。|
|`ClickArea::ClickValue`|属性值。|
|`CMFCPropertyGridProperty::ClickDescription`|属性网格控件描述区域。|

##  <a name="init"></a>CMFCPropertyGridCtrl：： Init

由框架调用以初始化属性网格控件。

```
virtual void Init();
```

### <a name="remarks"></a>备注

##  <a name="initheader"></a>CMFCPropertyGridCtrl：： InitHeader

初始化框架用于显示当前属性网格控件的内部[CMFCHeaderCtrl](../../mfc/reference/cmfcheaderctrl-class.md)对象。

```
virtual void InitHeader();
```

##  <a name="isalphabeticmode"></a>CMFCPropertyGridCtrl：： IsAlphabeticMode

指示属性网格控件是否处于字母模式。

```
BOOL IsAlphabeticMode() const;
```

### <a name="return-value"></a>返回值

如果属性网格控件处于字母模式，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

当属性网格控件处于字母模式时，所有属性都按其名称的字母顺序排序。 否则，属性将在其父节点下进行分组。

使用[CMFCPropertyGridCtrl：： SetAlphabeticMode](#setalphabeticmode)方法启用或禁用字母模式。

##  <a name="isalwaysshowusertooltip"></a>CMFCPropertyGridCtrl：： IsAlwaysShowUserToolTip

```
BOOL IsAlwaysShowUserToolTip() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="isdescriptionarea"></a>CMFCPropertyGridCtrl：： IsDescriptionArea

指示是否显示属性网格控件的说明区域。

```
BOOL IsDescriptionArea() const;
```

### <a name="return-value"></a>返回值

如果显示 "说明" 区域，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

使用[CMFCPropertyGridCtrl：： EnableDescriptionArea](#enabledescriptionarea)方法隐藏或显示说明区域。

##  <a name="isgroupnamefullwidth"></a>CMFCPropertyGridCtrl：： IsGroupNameFullWidth

指示是否在当前属性网格控件的整个宽度内显示每个属性组名称。

```
BOOL IsGroupNameFullWidth() const;
```

### <a name="return-value"></a>返回值

如果在属性网格控件的宽度中显示组名，则为 TRUE;如果控件的右（值）列截断了组名称，则为 FALSE。

### <a name="remarks"></a>备注

*组*是属性网格控件中的相关属性的集合。 如果控件分层显示，则*组名称*将显示为组上方行中的类别标题。

##  <a name="isheaderctrl"></a>CMFCPropertyGridCtrl：： IsHeaderCtrl

指示是否显示标头控件。

```
BOOL IsHeaderCtrl() const;
```

### <a name="return-value"></a>返回值

如果显示标头控件，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

使用[CMFCPropertyGridCtrl：： EnableHeaderCtrl](#enableheaderctrl)方法隐藏或显示标头控件。

##  <a name="ismarkmodifiedproperties"></a>CMFCPropertyGridCtrl：： IsMarkModifiedProperties

指示属性网格控件如何显示修改后的属性。

```
BOOL IsMarkModifiedProperties() const;
```

### <a name="return-value"></a>返回值

如果使用粗体样式显示修改后的属性，则为 TRUE;如果使用常规样式显示修改后的属性，则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="isshowdragcontext"></a>CMFCPropertyGridCtrl：： IsShowDragContext

指示当用户调整列的大小时，框架是否重绘当前属性网格控件的名称和值列。

```
BOOL IsShowDragContext() const;
```

### <a name="return-value"></a>返回值

如果框架在调整大小操作过程中重绘名称和值列，则为 TRUE;如果框架在拖动操作完成后重绘列，则为 FALSE。

### <a name="remarks"></a>备注

用户可以通过拖动列之间的拆分栏来调整属性网格控件的 "名称" 和 "值" 列的大小。 如果显示拖动上下文，只要用户拖动拆分条，就会调整 "名称" 和 "值" 列的大小。 否则，拆分条会移动，但不会重新绘制列，直到拖动操作完成。

##  <a name="isvsdotnetlook"></a>CMFCPropertyGridCtrl：： IsVSDotNetLook

指示属性网格控件的外观是否为 Visual Studio .NET 的样式。

```
BOOL IsVSDotNetLook() const;
```

### <a name="return-value"></a>返回值

如果属性网格控件的样式为 Visual Studio .NET，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

使用[CMFCPropertyGridCtrl：： SetVSDotNetLook](#setvsdotnetlook)方法将 "属性" 网格控件设置为 Visual Studio .net 的样式。

##  <a name="markmodifiedproperties"></a>CMFCPropertyGridCtrl：： MarkModifiedProperties

指定如何显示修改后的属性。

```
void MarkModifiedProperties(
    BOOL bMark=TRUE,
    BOOL bRedraw=TRUE);
```

### <a name="parameters"></a>参数

*bMark*<br/>
中若要以粗体显示修改后的属性，则为 TRUE;若为 FALSE，则以常规样式显示已修改的属性。 默认值为 TRUE。

*bRedraw*<br/>
中若要立即重绘属性网格控件，则为 TRUE;否则为 FALSE。 默认值为 TRUE。

### <a name="remarks"></a>备注

##  <a name="onchangeselection"></a>CMFCPropertyGridCtrl：： OnChangeSelection

当当前选定内容已更改时由框架调用。

```
virtual void OnChangeSelection(
    CMFCPropertyGridProperty* pNewSel,
    CMFCPropertyGridProperty* pOldSel);
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*pNewSel*|中指向新选定属性的指针。|
|*pOldSel*|中指向先前选定的属性的指针。|

### <a name="remarks"></a>备注

此方法的默认实现不执行任何操作。

##  <a name="onclickbutton"></a>CMFCPropertyGridCtrl：： OnClickButton

单击属性按钮时由框架调用。

```
virtual void OnClickButton(CPoint point);
```

### <a name="parameters"></a>参数

*point*<br/>
中一个点，采用工作区坐标。

### <a name="remarks"></a>备注

默认情况下，此方法将更新当前属性值。

##  <a name="ondrawborder"></a>CMFCPropertyGridCtrl：： OnDrawBorder

由框架调用，以在属性网格控件周围绘制边框。

```
virtual void OnDrawBorder(CDC* pDC);
```

### <a name="parameters"></a>参数

*pDC*<br/>
中指向设备上下文的指针。

### <a name="remarks"></a>备注

##  <a name="ondrawdescription"></a>CMFCPropertyGridCtrl：： OnDrawDescription

由框架调用以绘制说明区域并显示说明文本。

```
virtual void OnDrawDescription(
    CDC* pDC,
    CRect rect);
```

### <a name="parameters"></a>参数

*pDC*<br/>
中指向设备上下文的指针。

*rect*<br/>
中指定绘制说明区域的位置的矩形。

### <a name="remarks"></a>备注

使用[CMFCPropertyGridCtrl：： EnableDescriptionArea](#enabledescriptionarea)方法显示说明区域。

##  <a name="ondrawlist"></a>CMFCPropertyGridCtrl：： OnDrawList

由框架调用以显示属性网格控件中的属性列表。

```
virtual void OnDrawList(CDC* pDC);
```

### <a name="parameters"></a>参数

*pDC*<br/>
中指向设备上下文的指针。

### <a name="remarks"></a>备注

##  <a name="ondrawproperty"></a>CMFCPropertyGridCtrl：： OnDrawProperty

由框架调用以显示属性。

```
virtual int OnDrawProperty(
    CDC* pDC,
    CMFCPropertyGridProperty* pProp) const;
```

### <a name="parameters"></a>参数

*pDC*<br/>
中指向设备上下文的指针。

*pProp*<br/>
中指向属性对象的指针。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="onpropertychanged"></a>CMFCPropertyGridCtrl：： OnPropertyChanged

当属性的值更改时，由框架调用。

```
virtual void OnPropertyChanged(CMFCPropertyGridProperty* pProp) const;
```

### <a name="parameters"></a>参数

*pProp*<br/>
中一个指针，指向其值已更改的属性对象。

### <a name="remarks"></a>备注

默认情况下，此方法将[AFX_WM_PROPERTY_CHANGED](../../mfc/reference/afx-messages.md)消息发送到属性网格控件的所有者。

##  <a name="onselectcombo"></a>CMFCPropertyGridCtrl：： OnSelectCombo

当选择包含组合框控件的属性时，由框架调用。

```
void OnSelectCombo();
```

### <a name="remarks"></a>备注

##  <a name="removeall"></a>CMFCPropertyGridCtrl：： RemoveAll

从属性网格控件中移除所有属性对象。

```
void RemoveAll();
```

### <a name="remarks"></a>备注

##  <a name="resetoriginalvalues"></a>CMFCPropertyGridCtrl：： ResetOriginalValues

还原所有属性的原始值。

```
void ResetOriginalValues(BOOL bRedraw=TRUE);
```

### <a name="parameters"></a>参数

*bRedraw*<br/>
中若要重绘属性列表，则为 TRUE;否则为 FALSE。 默认值为 TRUE。

### <a name="remarks"></a>备注

##  <a name="setalphabeticmode"></a>CMFCPropertyGridCtrl：： SetAlphabeticMode

设置或重置字母模式。

```
void SetAlphabeticMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>参数

*bSet*<br/>
中若要设置字母模式，则为 TRUE;FALSE 重置字母模式。 默认值为 TRUE。

### <a name="remarks"></a>备注

当 "属性" 网格控件处于字母模式时，控件将按属性名对它所包含的所有属性进行排序。

##  <a name="setboollabels"></a>CMFCPropertyGridCtrl：： SetBoolLabels

指定布尔标签的文本。

```
void SetBoolLabels(
    LPCTSTR lpszTrue,
    LPCTSTR lpszFalse);
```

### <a name="parameters"></a>参数

*lpszTrue*<br/>
中为 true 的布尔值显示的文本字符串。

*lpszFalse*<br/>
中为布尔值 false 显示的文本字符串。

### <a name="remarks"></a>备注

##  <a name="setcursel"></a>CMFCPropertyGridCtrl：： SetCurSel

选择属性网格控件中的属性。

```
void SetCurSel(
    CMFCPropertyGridProperty* pProp,
    BOOL bRedraw=TRUE);
```

### <a name="parameters"></a>参数

*pProp*<br/>
中指向属性对象的指针。

*bRedraw*<br/>
中若要立即重绘属性网格控件，则为 TRUE;否则为 FALSE。 默认值为 TRUE。

### <a name="remarks"></a>备注

使用此方法可取消选择属性网格控件中的当前项，然后选择对应于指定属性的项。

##  <a name="setcustomcolors"></a>CMFCPropertyGridCtrl：： SetCustomColors

指定属性网格控件的各种元素的自定义颜色。

```
void SetCustomColors(
    COLORREF clrBackground,
    COLORREF clrText,
    COLORREF clrGroupBackground,
    COLORREF clrGroupText,
    COLORREF clrDescriptionBackground,
    COLORREF clrDescriptionText,
    COLORREF clrLine);
```

### <a name="parameters"></a>参数

*clrBackground*<br/>
中属性值的背景色。

*clrText*<br/>
中属性名称和属性值文本的颜色。

*clrGroupBackground*<br/>
中属性组的背景色。

*clrGroupText*<br/>
中属性组的新文本颜色。

*clrDescriptionBackground*<br/>
中说明区域的背景色。

*clrDescriptionText*<br/>
中"说明" 区域中文本的颜色。

*clrLine*<br/>
中在属性之间绘制的线条的颜色。

### <a name="remarks"></a>备注

对于任何参数，请指定`((COLORREF)-1)`颜色值以对属性网格控件的元素使用默认颜色。

若要自定义特定属性的外观，请从[CMFCPropertyGridProperty](../../mfc/reference/cmfcpropertygridproperty-class.md)类中派生一个类，然后重写[CMFCPropertyGridProperty：： OnDrawName](../../mfc/reference/cmfcpropertygridproperty-class.md#ondrawname)、 [CMFCPropertyGridProperty：： OnDrawValue](../../mfc/reference/cmfcpropertygridproperty-class.md#ondrawvalue)、 [CMFCPropertyGridProperty：： OnDrawExpandBox](../../mfc/reference/cmfcpropertygridproperty-class.md#ondrawexpandbox)和[CMFCPropertyGridProperty：： OnDrawButton](../../mfc/reference/cmfcpropertygridproperty-class.md#ondrawbutton)方法。

##  <a name="setdescriptionrows"></a>  CMFCPropertyGridCtrl::SetDescriptionRows

指定在当前属性网格控件的 "描述" 部分中显示的行数。

```
void SetDescriptionRows(int nDescRows);
```

### <a name="parameters"></a>参数

*nDescRows*<br/>
中要在属性说明中显示的行数。

##  <a name="setgroupnamefullwidth"></a>CMFCPropertyGridCtrl：： SetGroupNameFullWidth

指定是否在当前属性网格控件中显示一组属性的整个类别名称宽度。

```
void SetGroupNameFullWidth(
    BOOL bGroupNameFullWidth = TRUE,
    BOOL bRedraw = TRUE);
```

### <a name="parameters"></a>参数

*bGroupNameFullWidth*<br/>
中如果为 TRUE，则无论属性名称列的宽度如何，都显示类别名称的完整宽度。 若为 FALSE，则将类别名称的宽度限制为 "属性名称" 列的宽度。 默认值为 TRUE。

*bRedraw*<br/>
中若要立即更新属性网格控件，则为 TRUE;若为 FALSE，则在下一次重绘事件发生时更新控件。 默认值为 TRUE。

### <a name="remarks"></a>备注

"属性" 网格控件包含可调整大小的*属性名称*列和*属性值*列。 "名称" 列的末尾也是 "值" 列的开头。 若要调整列的大小，请拖动列之间的边框。

在此方法中，术语*组名称*和*类别名称*可互换使用。 类别名称显示在标有一组相关属性和值的行上。 此方法指定 "属性名称" 列的宽度是否还指定所显示类别名称的宽度。

##  <a name="setlistdelimiter"></a>CMFCPropertyGridCtrl：： SetListDelimiter

定义在属性值列表中用作分隔符的字符。

```
void SetListDelimiter(TCHAR c);
```

### <a name="parameters"></a>参数

*c*<br/>
中用作分隔符的字符。

### <a name="remarks"></a>备注

使用此方法可以在[CMFCPropertyGridProperty：： CMFCPropertyGridProperty](../../mfc/reference/cmfcpropertygridproperty-class.md#cmfcpropertygridproperty)构造函数中使用的属性值列表中定义分隔符字符。 在该构造函数中，将*bIsValueList*参数设置为 TRUE。

默认情况下， [CMFCPropertyGridCtrl：： CMFCPropertyGridCtrl](#cmfcpropertygridctrl)构造函数将分隔符字符设置为逗号（"，"）。

##  <a name="setshowdragcontext"></a>CMFCPropertyGridCtrl：： SetShowDragContext

指定当用户调整列的大小时，框架是否重绘当前属性网格控件的名称和值列。

```
void SetShowDragContext(BOOL bShowDragContext = TRUE);
```

### <a name="parameters"></a>参数

*bShowDragContext*<br/>
中若要在调整大小操作过程中重绘名称和值列，则为 TRUE;若为 FALSE，则在拖动操作完成后重绘列。 默认值为 TRUE。

### <a name="remarks"></a>备注

用户可以通过拖动列之间的拆分栏来调整属性网格控件的 "名称" 和 "值" 列的大小。 如果显示拖动上下文，只要用户拖动拆分条，就会调整 "名称" 和 "值" 列的大小。 否则，拆分条会移动，但不会重新绘制列，直到拖动操作完成。

##  <a name="setvsdotnetlook"></a>CMFCPropertyGridCtrl：： SetVSDotNetLook

将属性网格控件的外观设置为在 Visual Studio .NET 中使用的样式。

```
void SetVSDotNetLook(BOOL bSet=TRUE);
```

### <a name="parameters"></a>参数

*bSet*<br/>
中若要将属性网格控件设置为在 Visual Studio .NET 中使用的样式，则为 TRUE;否则为 FALSE。 默认值为 TRUE。

### <a name="remarks"></a>备注

##  <a name="updatecolor"></a>CMFCPropertyGridCtrl：： UpdateColor

设置当前所选颜色属性的颜色值。

```
virtual void UpdateColor(COLORREF color);
```

### <a name="parameters"></a>参数

*color*<br/>
中RGB 颜色值。

### <a name="remarks"></a>备注

如果属性网格控件的当前选定属性不是颜色属性，则此方法将断言处于调试模式。

##  <a name="validateitemdata"></a>CMFCPropertyGridCtrl：： ValidateItemData

由框架调用以验证属性数据。

```
virtual BOOL ValidateItemData(CMFCPropertyGridProperty* pProp);
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*pProp*|中指向属性的指针。 未使用此参数。|

### <a name="return-value"></a>返回值

始终为 TRUE。

### <a name="remarks"></a>备注

[CMFCPropertyGridCtrl：： EndEditItem](#endedititem)方法调用此方法来验证数据。 默认情况下，此方法不使用其*pProp*参数，并且它的返回值始终为 TRUE。

如果重写此方法，则在指定的属性数据有效时返回 TRUE。 否则，返回 FALSE，在这种情况下，框架不会更新属性。

## <a name="see-also"></a>请参阅

[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)

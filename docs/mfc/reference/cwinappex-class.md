---
title: CWinAppEx 类
ms.date: 11/04/2016
f1_keywords:
- CWinAppEx
- AFXWINAPPEX/CWinAppEx
- AFXWINAPPEX/CWinAppEx::CWinAppEx
- AFXWINAPPEX/CWinAppEx::CleanState
- AFXWINAPPEX/CWinAppEx::EnableLoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::EnableTearOffMenus
- AFXWINAPPEX/CWinAppEx::EnableUserTools
- AFXWINAPPEX/CWinAppEx::ExitInstance
- AFXWINAPPEX/CWinAppEx::GetBinary
- AFXWINAPPEX/CWinAppEx::GetContextMenuManager
- AFXWINAPPEX/CWinAppEx::GetDataVersion
- AFXWINAPPEX/CWinAppEx::GetDataVersionMajor
- AFXWINAPPEX/CWinAppEx::GetDataVersionMinor
- AFXWINAPPEX/CWinAppEx::GetInt
- AFXWINAPPEX/CWinAppEx::GetKeyboardManager
- AFXWINAPPEX/CWinAppEx::GetMouseManager
- AFXWINAPPEX/CWinAppEx::GetObject
- AFXWINAPPEX/CWinAppEx::GetRegSectionPath
- AFXWINAPPEX/CWinAppEx::GetRegistryBase
- AFXWINAPPEX/CWinAppEx::GetSectionBinary
- AFXWINAPPEX/CWinAppEx::GetSectionInt
- AFXWINAPPEX/CWinAppEx::GetSectionObject
- AFXWINAPPEX/CWinAppEx::GetSectionString
- AFXWINAPPEX/CWinAppEx::GetShellManager
- AFXWINAPPEX/CWinAppEx::GetString
- AFXWINAPPEX/CWinAppEx::GetTooltipManager
- AFXWINAPPEX/CWinAppEx::GetUserToolsManager
- AFXWINAPPEX/CWinAppEx::InitContextMenuManager
- AFXWINAPPEX/CWinAppEx::InitKeyboardManager
- AFXWINAPPEX/CWinAppEx::InitMouseManager
- AFXWINAPPEX/CWinAppEx::InitShellManager
- AFXWINAPPEX/CWinAppEx::InitTooltipManager
- AFXWINAPPEX/CWinAppEx::IsResourceSmartUpdate
- AFXWINAPPEX/CWinAppEx::IsStateExists
- AFXWINAPPEX/CWinAppEx::LoadState
- AFXWINAPPEX/CWinAppEx::OnAppContextHelp
- AFXWINAPPEX/CWinAppEx::OnViewDoubleClick
- AFXWINAPPEX/CWinAppEx::OnWorkspaceIdle
- AFXWINAPPEX/CWinAppEx::SaveState
- AFXWINAPPEX/CWinAppEx::SetRegistryBase
- AFXWINAPPEX/CWinAppEx::ShowPopupMenu
- AFXWINAPPEX/CWinAppEx::WriteBinary
- AFXWINAPPEX/CWinAppEx::WriteInt
- AFXWINAPPEX/CWinAppEx::WriteObject
- AFXWINAPPEX/CWinAppEx::WriteSectionBinary
- AFXWINAPPEX/CWinAppEx::WriteSectionInt
- AFXWINAPPEX/CWinAppEx::WriteSectionObject
- AFXWINAPPEX/CWinAppEx::WriteSectionString
- AFXWINAPPEX/CWinAppEx::WriteString
- AFXWINAPPEX/CWinAppEx::LoadCustomState
- AFXWINAPPEX/CWinAppEx::LoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::OnClosingMainFrame
- AFXWINAPPEX/CWinAppEx::PreLoadState
- AFXWINAPPEX/CWinAppEx::PreSaveState
- AFXWINAPPEX/CWinAppEx::ReloadWindowPlacement
- AFXWINAPPEX/CWinAppEx::SaveCustomState
- AFXWINAPPEX/CWinAppEx::StoreWindowPlacement
- AFXWINAPPEX/CWinAppEx::m_bForceImageReset
helpviewer_keywords:
- CWinAppEx [MFC], CWinAppEx
- CWinAppEx [MFC], CleanState
- CWinAppEx [MFC], EnableLoadWindowPlacement
- CWinAppEx [MFC], EnableTearOffMenus
- CWinAppEx [MFC], EnableUserTools
- CWinAppEx [MFC], ExitInstance
- CWinAppEx [MFC], GetBinary
- CWinAppEx [MFC], GetContextMenuManager
- CWinAppEx [MFC], GetDataVersion
- CWinAppEx [MFC], GetDataVersionMajor
- CWinAppEx [MFC], GetDataVersionMinor
- CWinAppEx [MFC], GetInt
- CWinAppEx [MFC], GetKeyboardManager
- CWinAppEx [MFC], GetMouseManager
- CWinAppEx [MFC], GetObject
- CWinAppEx [MFC], GetRegSectionPath
- CWinAppEx [MFC], GetRegistryBase
- CWinAppEx [MFC], GetSectionBinary
- CWinAppEx [MFC], GetSectionInt
- CWinAppEx [MFC], GetSectionObject
- CWinAppEx [MFC], GetSectionString
- CWinAppEx [MFC], GetShellManager
- CWinAppEx [MFC], GetString
- CWinAppEx [MFC], GetTooltipManager
- CWinAppEx [MFC], GetUserToolsManager
- CWinAppEx [MFC], InitContextMenuManager
- CWinAppEx [MFC], InitKeyboardManager
- CWinAppEx [MFC], InitMouseManager
- CWinAppEx [MFC], InitShellManager
- CWinAppEx [MFC], InitTooltipManager
- CWinAppEx [MFC], IsResourceSmartUpdate
- CWinAppEx [MFC], IsStateExists
- CWinAppEx [MFC], LoadState
- CWinAppEx [MFC], OnAppContextHelp
- CWinAppEx [MFC], OnViewDoubleClick
- CWinAppEx [MFC], OnWorkspaceIdle
- CWinAppEx [MFC], SaveState
- CWinAppEx [MFC], SetRegistryBase
- CWinAppEx [MFC], ShowPopupMenu
- CWinAppEx [MFC], WriteBinary
- CWinAppEx [MFC], WriteInt
- CWinAppEx [MFC], WriteObject
- CWinAppEx [MFC], WriteSectionBinary
- CWinAppEx [MFC], WriteSectionInt
- CWinAppEx [MFC], WriteSectionObject
- CWinAppEx [MFC], WriteSectionString
- CWinAppEx [MFC], WriteString
- CWinAppEx [MFC], LoadCustomState
- CWinAppEx [MFC], LoadWindowPlacement
- CWinAppEx [MFC], OnClosingMainFrame
- CWinAppEx [MFC], PreLoadState
- CWinAppEx [MFC], PreSaveState
- CWinAppEx [MFC], ReloadWindowPlacement
- CWinAppEx [MFC], SaveCustomState
- CWinAppEx [MFC], StoreWindowPlacement
- CWinAppEx [MFC], m_bForceImageReset
ms.assetid: a3d3e053-3e22-463f-9444-c73abb1bb9d7
ms.openlocfilehash: c222567703d0e57480c00f6f2bf9e78f16979150
ms.sourcegitcommit: 3e8fa01f323bc5043a48a0c18b855d38af3648d4
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/06/2020
ms.locfileid: "78869925"
---
# <a name="cwinappex-class"></a>CWinAppEx 类

`CWinAppEx` 处理应用程序状态，将状态保存到注册表，从注册表加载状态，初始化应用程序管理器，并提供指向相同应用程序管理器的链接。

   有关更多详细信息，请参阅位于你的 Visual Studio 安装的**VC\\atlmfc\\src\\mfc**文件夹中的源代码。
## <a name="syntax"></a>语法

```
class CWinAppEx : public CWinApp
```

## <a name="members"></a>Members

### <a name="public-constructors"></a>公共构造函数

|名称|说明|
|----------|-----------------|
|[CWinAppEx：： CWinAppEx](#cwinappex)|构造 `CWinAppEx` 对象。|

### <a name="public-methods"></a>公共方法

|名称|说明|
|----------|-----------------|
|[CWinAppEx：： CleanState](#cleanstate)|从 Windows 注册表中删除有关应用程序的信息。|
|[CWinAppEx：： EnableLoadWindowPlacement](#enableloadwindowplacement)|指定应用程序是否将从注册表加载主框架窗口的初始大小和位置。|
|[CWinAppEx：： EnableTearOffMenus](#enabletearoffmenus)|为应用程序启用脱离菜单。|
|[CWinAppEx：： EnableUserTools](#enableusertools)|使用户能够在应用程序中创建自定义菜单命令。|
|[CWinAppEx：： ExitInstance](#exitinstance)|由框架从 `Run` 成员函数中调用以退出应用程序实例。 （重写[CWinApp：： ExitInstance](../../mfc/reference/cwinapp-class.md#exitinstance)。）|
|[CWinAppEx：： GetBinary](#getbinary)|读取与指定的注册表值相关联的二进制数据。|
|[CWinAppEx：： GetContextMenuManager](#getcontextmenumanager)|返回一个指向全局[CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)对象的指针。|
|[CWinAppEx：： GetDataVersion](#getdataversion)||
|[CWinAppEx：： GetDataVersionMajor](#getdataversionmajor)|返回保存在 Windows 注册表中的应用程序的主版本。|
|[CWinAppEx：： GetDataVersionMinor](#getdataversionminor)|返回保存在 Windows 注册表中的应用程序的次版本。|
|[CWinAppEx：： GetInt](#getint)|从注册表读取与指定值关联的数值数据。|
|[CWinAppEx：： GetKeyboardManager](#getkeyboardmanager)|返回一个指向全局[CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)对象的指针。|
|[CWinAppEx：： GetMouseManager](#getmousemanager)|返回一个指向全局[CMouseManager](../../mfc/reference/cmousemanager-class.md)对象的指针。|
|[CWinAppEx：： GetObject](#getobject)|从注册表读取与指定的值相关联 `CObject`派生的数据。|
|[CWinAppEx：： GetRegSectionPath](#getregsectionpath)|返回一个字符串，它是注册表项的路径。 此路径将提供的相对路径连接到应用程序路径。|
|[CWinAppEx：： GetRegistryBase](#getregistrybase)|返回应用程序的注册表路径。|
|[CWinAppEx：： GetSectionBinary](#getsectionbinary)|从注册表读取与指定的键和值相关联的二进制数据。|
|[CWinAppEx：： GetSectionInt](#getsectionint)|从与指定的键和值相关联的注册表读取数值数据。|
|[CWinAppEx：： GetSectionObject](#getsectionobject)|从注册表读取与指定的键和值相关联 `CObject` 数据。|
|[CWinAppEx：： GetSectionString](#getsectionstring)|从注册表读取与指定的键和值相关联的字符串数据。|
|[CWinAppEx：： GetShellManager](#getshellmanager)|返回一个指向全局[CShellManager](../../mfc/reference/cshellmanager-class.md)对象的指针。|
|[CWinAppEx：： GetString](#getstring)|从注册表读取与指定值关联的字符串数据。|
|[CWinAppEx：： GetTooltipManager](#gettooltipmanager)|返回一个指向全局[CTooltipManager](../../mfc/reference/ctooltipmanager-class.md)对象的指针。|
|[CWinAppEx：： GetUserToolsManager](#getusertoolsmanager)|返回一个指向全局[CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)对象的指针。|
|[CWinAppEx：： InitContextMenuManager](#initcontextmenumanager)|初始化 `CContextMenuManager` 对象。|
|[CWinAppEx：： InitKeyboardManager](#initkeyboardmanager)|初始化 `CKeyboardManager` 对象。|
|[CWinAppEx：： InitMouseManager](#initmousemanager)|初始化 `CMouseManager` 对象。|
|[CWinAppEx：： InitShellManager](#initshellmanager)|初始化 `CShellManager` 类|
|[CWinAppEx：： InitTooltipManager](#inittooltipmanager)|初始化 `CTooltipManager` 类。|
|[CWinAppEx：： IsResourceSmartUpdate](#isresourcesmartupdate)||
|[CWinAppEx：： IsStateExists](#isstateexists)|指示指定键是否在注册表中。|
|[CWinAppEx：： LoadState](#loadstate)|从注册表加载应用程序状态。|
|[CWinAppEx：： OnAppContextHelp](#onappcontexthelp)|当用户请求**自定义**对话框的上下文帮助时由框架调用。|
|[CWinAppEx：： OnViewDoubleClick](#onviewdoubleclick)|当用户双击应用程序中的任意位置时，调用用户定义的命令。|
|[CWinAppEx：： OnWorkspaceIdle](#onworkspaceidle)||
|[CWinAppEx：： SaveState](#savestate)|将应用程序框架的状态写入 Windows 注册表。|
|[CWinAppEx：： SetRegistryBase](#setregistrybase)|设置默认注册表项的路径。 此密钥将用作所有后续注册表调用的根。|
|[CWinAppEx：： ShowPopupMenu](#showpopupmenu)|显示弹出菜单。|
|[CWinAppEx：： WriteBinary](#writebinary)|将二进制数据写入指定的注册表值。|
|[CWinAppEx：： WriteInt](#writeint)|将数值数据写入指定的注册表值。|
|[CWinAppEx：： WriteObject](#writeobject)|将派生自[CObject 类](../../mfc/reference/cobject-class.md)的数据写入指定的注册表值。|
|[CWinAppEx：： WriteSectionBinary](#writesectionbinary)|将二进制数据写入指定注册表项的值。|
|[CWinAppEx：： WriteSectionInt](#writesectionint)|将数值数据写入指定注册表项的值。|
|[CWinAppEx：： WriteSectionObject](#writesectionobject)|将派生自 `CObject` 类的数据写入指定注册表项的值。|
|[CWinAppEx：： WriteSectionString](#writesectionstring)|将字符串数据写入指定注册表项的值。|
|[CWinAppEx：： WriteString](#writestring)|将字符串数据写入指定的注册表值。|

### <a name="protected-methods"></a>受保护方法

|名称|说明|
|----------|-----------------|
|[CWinAppEx：： LoadCustomState](#loadcustomstate)|当应用程序状态已加载时由框架调用。|
|[CWinAppEx：： LoadWindowPlacement](#loadwindowplacement)|在从注册表加载应用程序的大小和位置时由框架调用。 加载的数据包括应用程序上次关闭时的主框架的大小和位置。|
|[CWinAppEx：： OnClosingMainFrame](#onclosingmainframe)|当主框架窗口正在处理 WM_CLOSE 时由框架调用。|
|[CWinAppEx：:P reLoadState](#preloadstate)|在加载应用程序状态之前由框架调用。|
|[CWinAppEx：:P reSaveState](#presavestate)|在保存应用程序状态之前由框架调用。|
|[CWinAppEx：： ReloadWindowPlacement](#reloadwindowplacement)|从注册表重新加载提供的窗口的大小和位置|
|[CWinAppEx：： SaveCustomState](#savecustomstate)|在将应用程序状态写入注册表后，由框架调用。|
|[CWinAppEx：： StoreWindowPlacement](#storewindowplacement)|由框架调用以将主框架的大小和位置写入注册表。|

### <a name="data-members"></a>数据成员

|名称|说明|
|----------|-----------------|
|[CWinAppEx：： m_bForceImageReset](#m_bforceimagereset)|指定在加载包含工具栏的框架窗口时框架是否将重置所有工具栏图像。|

## <a name="remarks"></a>备注

MFC 框架提供的很多功能取决于 `CWinAppEx` 类。 您可以通过以下两种方式之一将 `CWinAppEx` 类合并到您的应用程序中：

- 在主线程中构造 `CWinAppEx` 类。

- 从 `CWinAppEx`派生主应用程序类。

将 `CWinAppEx` 合并到应用程序中后，你可以初始化任何一个应用程序管理器。 使用应用程序管理器之前，必须通过调用相应的 initialize 方法对其进行初始化。 若要获取指向特定管理器的指针，请调用关联的 get 方法。 `CWinAppEx` 类管理以下应用程序管理器： [CMouseManager 类](../../mfc/reference/cmousemanager-class.md)、 [CContextMenuManager 类](../../mfc/reference/ccontextmenumanager-class.md)、 [CKeyboardManager 类](../../mfc/reference/ckeyboardmanager-class.md)、 [CUserToolsManager 类](../../mfc/reference/cusertoolsmanager-class.md)和[CMenuTearOffManager 类](../../mfc/reference/cmenutearoffmanager-class.md)。

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWinThread](../../mfc/reference/cwinthread-class.md)

[CWinApp](../../mfc/reference/cwinapp-class.md)

[CWinAppEx](../../mfc/reference/cwinappex-class.md)

## <a name="requirements"></a>要求

**标头：** afxwinappex

##  <a name="cleanstate"></a>CWinAppEx：： CleanState

从 Windows 注册表中删除有关应用程序的所有信息。

```
virtual BOOL CleanState(LPCTSTR lpszSectionName=NULL);
```

### <a name="parameters"></a>参数

*lpszSectionName*<br/>
中包含注册表项的路径的字符串。

### <a name="return-value"></a>返回值

如果方法成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

此方法清除注册表的特定部分中的应用程序数据。 您可以使用参数*lpszSectionName*指定要清除的部分。 如果*lpszSectionName*为 NULL，则此方法将使用 `CWinAppEx` 对象中存储的默认注册表路径。 若要获取默认的注册表路径，请使用[CWinAppEx：： GetRegistryBase](#getregistrybase)。

##  <a name="cwinappex"></a>CWinAppEx：： CWinAppEx

构造 `CWinAppEx` 对象。

```
CWinAppEx(BOOL bResourceSmartUpdate = FALSE);
```

### <a name="parameters"></a>参数

*bResourceSmartUpdate*<br/>
中一个布尔参数，指定工作区对象是否应检测并处理资源更新。

### <a name="remarks"></a>备注

`CWinAppEx` 类具有初始化方法，提供用于将应用程序信息保存和加载到注册表并控制全局应用程序设置的功能。 它还使你能够使用全局管理器，如[CKeyboardManager 类](../../mfc/reference/ckeyboardmanager-class.md)和[CUserToolsManager 类](../../mfc/reference/cusertoolsmanager-class.md)。 每个应用程序只能有一个 `CWinAppEx` 类的实例。

##  <a name="enableloadwindowplacement"></a>CWinAppEx：： EnableLoadWindowPlacement

指定应用程序是否将从注册表加载主框架窗口的初始大小和位置。

```
void EnableLoadWindowPlacement(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
中指定应用程序是否从注册表加载主框架窗口的初始大小和位置。

### <a name="remarks"></a>备注

默认情况下，主框架的大小和位置将与其他应用程序设置一起从注册表加载。 这会在[CWinAppEx：： LoadState](#loadstate)期间发生。 如果你不想从注册表加载初始窗口位置，则在*bEnable*设置为 FALSE 的情况下调用此方法。

##  <a name="enabletearoffmenus"></a>CWinAppEx：： EnableTearOffMenus

创建并初始化[CMenuTearOffManager](../../mfc/reference/cmenutearoffmanager-class.md)对象。

```
BOOL EnableTearOffMenus(
    LPCTSTR lpszRegEntry,
    const UINT uiCmdFirst,
    const UINT uiCmdLast);
```

### <a name="parameters"></a>参数

*lpszRegEntry*<br/>
中一个字符串，其中包含注册表项的路径。 应用程序使用此注册表项来存储可拆卸菜单的信息。

*uiCmdFirst*<br/>
中第一个脱离菜单 ID。

*uiCmdLast*<br/>
中最后一个脱离菜单 ID。

### <a name="return-value"></a>返回值

如果成功创建并初始化了 `CMenuTearOffManager`，则为 TRUE;如果发生错误或 `CMenuTearOffManager` 已存在，则为 FALSE。

### <a name="remarks"></a>备注

使用此函数可在应用程序中启用脱离菜单。 应 `InitInstance`调用此函数。

##  <a name="enableusertools"></a>CWinAppEx：： EnableUserTools

允许用户创建可减少应用程序中击键的自定义菜单命令。 此方法创建一个[CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)对象。

```
BOOL EnableUserTools(
    const UINT uiCmdToolsDummy,
    const UINT uiCmdFirst,
    const UINT uiCmdLast,
    CRuntimeClass* pToolRTC = RUNTIME_CLASS(CUserTool),
    UINT uArgMenuID = 0,
    UINT uInitDirMenuID = 0);
```

### <a name="parameters"></a>参数

*uiCmdToolsDummy*<br/>
中一个无符号整数，框架使用该整数作为 "用户工具" 菜单的命令 ID 占位符。

*uiCmdFirst*<br/>
中第一个用户工具命令的命令 ID。

*uiCmdLast*<br/>
中最后一个用户工具命令的命令 ID。

*pToolRTC*<br/>
中一个类，`CUserToolsManager` 对象使用该类来创建新的用户工具。

*uArgMenuID*<br/>
中参数菜单 ID。

*uInitDirMenuID*<br/>
中初始工具目录的菜单 ID。

### <a name="return-value"></a>返回值

如果该方法创建并初始化一个 `CUserToolsManager` 对象，则为 TRUE; 否则为。如果方法失败或者 `CUserToolsManager` 对象已存在，则为 FALSE。

### <a name="remarks"></a>备注

当你启用用户定义的工具时，框架将自动支持可在自定义期间扩展的动态菜单。 框架将每个新项与外部命令相关联。 当用户从 "**工具**" 菜单中选择相应的项时，框架将调用这些命令。

用户每次添加新项时，框架都会创建一个新的对象。 新对象的类类型由*pToolRTC*定义。 *PToolRTC*类类型必须派生自[CUserTool 类](../../mfc/reference/cusertool-class.md)。

有关用户工具以及如何将它们合并到应用程序中的详细信息，请参阅[用户定义的工具](../../mfc/user-defined-tools.md)。

##  <a name="exitinstance"></a>CWinAppEx：： ExitInstance

```
virtual int ExitInstance();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="getbinary"></a>CWinAppEx：： GetBinary

读取指定注册表项中的二进制数据。

```
BOOL GetBinary(
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>参数

*lpszEntry*<br/>
中包含注册表项名称的字符串。

*ppData*<br/>
弄一个指针，指向该方法用二进制数据填充的缓冲区。

*pBytes*<br/>
弄指向方法用来写入读取的字节数的无符号整数的指针。

### <a name="return-value"></a>返回值

如果成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

此方法读取写入注册表的二进制数据。 若要将数据写入注册表，请使用方法[CWinAppEx：： WriteBinary](#writebinary)和[CWinAppEx：： WriteSectionBinary](#writesectionbinary)。

*LpszEntry*参数是应用程序的默认注册表项下的注册表项的名称。 若要获取或设置默认的注册表项，请分别使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase) 。

##  <a name="getcontextmenumanager"></a>CWinAppEx：： GetContextMenuManager

返回一个指向全局[CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)对象的指针。

```
CContextMenuManager* GetContextMenuManager();
```

### <a name="return-value"></a>返回值

指向全局 `CContextMenuManager` 对象的指针。

### <a name="remarks"></a>备注

如果未初始化 CContextMenuManager 对象，则此函数将在返回指针之前调用[CWinAppEx：： InitContextMenuManager](#initcontextmenumanager) 。

##  <a name="getdataversion"></a>CWinAppEx：： GetDataVersion

```
int GetDataVersion() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="getdataversionmajor"></a>CWinAppEx：： GetDataVersionMajor

返回在调用[CWinAppEx：： SaveState](#savestate)时保存在 Windows 注册表中的应用程序的主版本。

```
int GetDataVersionMajor() const;
```

### <a name="return-value"></a>返回值

一个包含主要版本号的整数值。

##  <a name="getdataversionminor"></a>CWinAppEx：： GetDataVersionMinor

返回在调用[CWinAppEx：： SaveState](#savestate)时保存在 Windows 注册表中的应用程序的次版本。

```
int GetDataVersionMinor() const;
```

### <a name="return-value"></a>返回值

一个包含次版本号的整数值。

##  <a name="getint"></a>CWinAppEx：： GetInt

读取指定注册表项中的整数数据。

```
int GetInt(
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>参数

*lpszEntry*<br/>
中一个字符串，其中包含注册表项的名称。

*nDefault*<br/>
中如果指定的注册表项不存在，则该方法返回的默认值。

### <a name="return-value"></a>返回值

如果方法成功，则为注册表数据;否则为*nDefault*。

### <a name="remarks"></a>备注

此方法从注册表中读取整数数据。 如果没有与*lpszEntry*指示的注册表项关联的整数数据，则此方法将返回*nDefault*。 若要将数据写入注册表，请使用方法[CWinAppEx：： WriteSectionInt](#writesectionint)和[CWinAppEx：： WriteInt](#writeint)。

*LpszEntry*参数是应用程序的默认注册表项下的注册表项的名称。 若要获取或设置默认的注册表项，请分别使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase) 。

##  <a name="getkeyboardmanager"></a>CWinAppEx：： GetKeyboardManager

返回一个指向全局[CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)对象的指针。

```
CKeyboardManager* GetKeyboardManager();
```

### <a name="return-value"></a>返回值

指向全局 `CKeyboardManager` 对象的指针。

### <a name="remarks"></a>备注

如果键盘管理器未初始化，则此函数将在返回指针之前调用[CWinAppEx：： InitKeyboardManager](#initkeyboardmanager) 。

##  <a name="getmousemanager"></a>CWinAppEx：： GetMouseManager

返回一个指向全局[CMouseManager](../../mfc/reference/cmousemanager-class.md)对象的指针。

```
CMouseManager* GetMouseManager();
```

### <a name="return-value"></a>返回值

指向全局 `CMouseManager` 对象的指针。

### <a name="remarks"></a>备注

如果鼠标管理器未初始化，则此函数将在返回指针之前调用[CWinAppEx：： InitMouseManager](#initmousemanager) 。

##  <a name="getobject"></a>CWinAppEx：： GetObject

读取[注册表中的派生](../../mfc/reference/cobject-class.md)数据。

```
BOOL GetObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>参数

*lpszEntry*<br/>
中包含注册表项的相对路径的字符串。

*obj*<br/>
弄对 `CObject`的引用。 方法使用此引用存储注册表数据。

### <a name="return-value"></a>返回值

如果方法成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

此方法从派生自 `CObject`的注册表读取数据。 若要将 `CObject` 数据写入注册表，请使用[CWinAppEx：： WriteObject](#writeobject)或[CWinAppEx：： WriteSectionObject](#writesectionobject)。

*LpszEntry*参数是位于应用程序的默认注册表项下的注册表项的名称。 若要获取或设置默认的注册表项，请分别使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase) 。

##  <a name="getregistrybase"></a>CWinAppEx：： GetRegistryBase

检索应用程序的默认注册表路径。

```
LPCTSTR GetRegistryBase();
```

### <a name="return-value"></a>返回值

一个字符串，其中包含默认注册表位置的路径。

### <a name="remarks"></a>备注

访问注册表的[CWinAppEx 类](../../mfc/reference/cwinappex-class.md)的所有方法都在默认位置启动。 使用此方法可检索默认注册表位置的路径。 使用[CWinAppEx：： SetRegistryBase](#setregistrybase)可更改默认注册表位置。

##  <a name="getregsectionpath"></a>CWinAppEx：： GetRegSectionPath

创建并返回注册表项的绝对路径。

```
CString GetRegSectionPath(LPCTSTR szSectionAdd = _T(""));
```

### <a name="parameters"></a>参数

*szSectionAdd*<br/>
中包含注册表项的相对路径的字符串。

### <a name="return-value"></a>返回值

包含注册表项的绝对路径的 `CString`。

### <a name="remarks"></a>备注

此方法通过将*szSectionAdd*中的相对路径附加到应用程序的默认注册表位置来定义注册表项的绝对路径。 若要获取默认的注册表项，请使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)。

##  <a name="getsectionbinary"></a>CWinAppEx：： GetSectionBinary

从注册表读取二进制数据。

```
BOOL GetSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>参数

*lpszSubSection*<br/>
中包含注册表项的相对路径的字符串。

*lpszEntry*<br/>
中一个字符串，其中包含要读取的值。

*ppData*<br/>
弄一个指针，指向方法用于存储数据的缓冲区。

*pBytes*<br/>
弄指向无符号整数的指针。 方法将*ppData*的大小写入此参数。

### <a name="return-value"></a>返回值

若成功，则为 TRUE；否则为 FALSE。

### <a name="remarks"></a>备注

此方法使用[CWinAppEx：： WriteBinary](#writebinary)和[CWinAppEx：： WriteSectionBinary](#writesectionbinary)方法读取写入注册表的二进制数据。

*LpszSubSection*参数不是注册表项的绝对路径。 它是附加到应用程序的默认注册表项末尾的相对路径。 若要获取或设置默认的注册表项，请分别使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase) 。

##  <a name="getsectionint"></a>CWinAppEx：： GetSectionInt

读取注册表中的整数数据。

```
int GetSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>参数

*lpszSubSection*<br/>
中包含注册表项的相对路径的字符串。

*lpszEntry*<br/>
中一个字符串，其中包含要读取的值。

*nDefault*<br/>
中如果指定的值不存在，则返回默认值。

### <a name="return-value"></a>返回值

存储在指定的注册表值中的整数数据;如果数据不存在，则为*nDefault* 。

### <a name="remarks"></a>备注

使用方法[CWinAppEx：： WriteInt](#writeint)和[CWinAppEx：： WriteSectionInt](#writesectionint)向注册表中写入整数数据。

*LpszSubSection*参数不是注册表项的绝对路径。 它是添加到应用程序的默认注册表项末尾的相对路径。 若要获取或设置默认的注册表项，请分别使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase) 。

##  <a name="getsectionobject"></a>CWinAppEx：： GetSectionObject

从注册表读取[CObject](../../mfc/reference/cobject-class.md)的注册表数据。

```
BOOL GetSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>参数

*lpszSubSection*<br/>
中包含注册表项的相对路径的字符串。

*lpszEntry*<br/>
中一个字符串，其中包含要读取的值。

*obj*<br/>
弄对 `CObject`的引用。 方法使用此 `CObject` 存储注册表数据。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

此方法从注册表读取数据。 读取的数据是 `CObject` 数据或派生自 `CObject`的类的数据。 若要将 `CObject` 数据写入注册表，请使用[CWinAppEx：： WriteObject](#writeobject)或[CWinAppEx：： WriteSectionObject](#writesectionobject)。

*LpszSubSection*参数不是注册表项的绝对路径。 它是附加到应用程序的默认注册表项末尾的相对路径。 若要获取或设置默认的注册表项，请分别使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase) 。

##  <a name="getsectionstring"></a>CWinAppEx：： GetSectionString

从注册表读取字符串数据。

```
CString GetSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszDefault = _T(""));
```

### <a name="parameters"></a>参数

*lpszSubSection*<br/>
中包含注册表项的相对路径的字符串。

*lpszEntry*<br/>
中一个字符串，其中包含要读取的值。

*lpszDefault*<br/>
中如果指定的值不存在，则返回默认值。

### <a name="return-value"></a>返回值

如果数据存在，则为指定注册表值中存储的字符串数据;否则为*lpszDefault*。

### <a name="remarks"></a>备注

此方法读取写入注册表的字符串数据。 使用[CWinAppEx：： WriteString](#writestring)和[CWinAppEx：： WriteSectionString](#writesectionstring)将字符串数据写入注册表。

*LpszSubSection*参数不是注册表项的绝对路径。 它是附加到应用程序的默认注册表项末尾的相对路径。 若要获取或设置默认的注册表项，请分别使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase) 。

##  <a name="getshellmanager"></a>CWinAppEx：： GetShellManager

返回一个指向全局[CShellManager](../../mfc/reference/cshellmanager-class.md)对象的指针。

```
CShellManager* GetShellManager();
```

### <a name="return-value"></a>返回值

指向全局 `CShellManager` 对象的指针。

### <a name="remarks"></a>备注

如果 `CShellManager` 对象未初始化，则此函数将在返回指针之前调用[CWinAppEx：： InitShellManager](#initshellmanager) 。

##  <a name="getstring"></a>CWinAppEx：： GetString

从指定的注册表项读取字符串数据。

```
CString GetString(
    LPCTSTR lpszEntry,
    LPCTSTR lpzDefault= _T(""));
```

### <a name="parameters"></a>参数

*lpszEntry*<br/>
中包含注册表项名称的字符串

*lpzDefault*<br/>
中如果指定的注册表项不存在，则该方法返回的默认值。

### <a name="return-value"></a>返回值

如果成功，则为注册表中存储的字符串数据;否则为*lpszDefault* 。

### <a name="remarks"></a>备注

此方法读取写入注册表的字符串数据。 若要将数据写入注册表，请使用方法[CWinAppEx：： WriteString](#writestring)或[CWinAppEx：： WriteSectionString](#writesectionstring)。

*LpszEntry*参数是应用程序的默认注册表项下的注册表项的名称。 若要获取或设置默认的注册表项，请分别使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase) 。

##  <a name="gettooltipmanager"></a>CWinAppEx：： GetTooltipManager

返回一个指向全局[CTooltipManager](../../mfc/reference/ctooltipmanager-class.md)对象的指针。

```
CTooltipManager* GetTooltipManager();
```

### <a name="return-value"></a>返回值

指向全局 `CTooltipManager` 对象的指针。

### <a name="remarks"></a>备注

如果 `CTooltipManager` 对象未初始化，则此函数将在返回指针之前调用[CWinAppEx：： InitTooltipManager](#inittooltipmanager) 。

##  <a name="getusertoolsmanager"></a>CWinAppEx：： GetUserToolsManager

返回一个指向全局[CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)对象的指针。

```
CUserToolsManager* GetUserToolsManager();
```

### <a name="return-value"></a>返回值

指向全局 `CUserToolsManager` 对象的指针;如果没有为应用程序启用用户工具管理，则为 NULL。

### <a name="remarks"></a>备注

检索指向 `CUserToolsManager` 对象的指针之前，必须通过调用[CWinAppEx：： EnableUserTools](#enableusertools)初始化管理器。

##  <a name="initcontextmenumanager"></a>CWinAppEx：： InitContextMenuManager

初始化[CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)对象。

```
BOOL InitContextMenuManager();
```

### <a name="return-value"></a>返回值

如果方法创建 CContextMenuManager 对象，则为非零值;如果 `CContextMenuManager` 对象已存在，则为0。

### <a name="remarks"></a>备注

如果调用[CWinAppEx：： GetContextMenuManager](#getcontextmenumanager)，则该方法的默认实现将调用 `InitContextMenuManager`。

如果你的应用程序已具有上下文菜单管理器并调用 `InitContextMenuManager`，则你的应用程序将有一个[断言](diagnostic-services.md#assert)失败。 因此，如果直接创建 `CContextMenuManager` 对象，则不应调用 `InitContextMenuManager`。 如果使用的不是自定义 `CContextMenuManager`，则应使用 `GetContextMenuManager` 创建 `CContextMenuManager` 对象。

##  <a name="initkeyboardmanager"></a>CWinAppEx：： InitKeyboardManager

初始化[CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)对象。

```
BOOL InitKeyboardManager();
```

### <a name="return-value"></a>返回值

如果方法创建 `CKeyboardManager` 对象，则为非零值;如果 `CKeyboardManager` 对象已存在，则为0。

### <a name="remarks"></a>备注

如果调用[CWinAppEx：： GetKeyboardManager](#getkeyboardmanager)，则该方法的默认实现将调用 `InitKeyboardManager`。

如果你的应用程序已经有一个键盘管理器，但你调用了 `InitKeyboardManager`，则你的应用程序将有一个[断言](diagnostic-services.md#assert)失败。 因此，如果直接创建 `CKeyboardManager` 对象，则不应调用 `InitKeyboardManager`。 如果使用的不是自定义 `CKeyboardManager`，则应使用 `GetKeyboardManager` 创建 `CKeyboardManager` 对象。

##  <a name="initmousemanager"></a>CWinAppEx：： InitMouseManager

初始化[CMouseManager](../../mfc/reference/cmousemanager-class.md)对象。

```
BOOL InitMouseManager();
```

### <a name="return-value"></a>返回值

如果方法创建 `CMouseManager` 对象，则为非零值;如果 `CMouseManager` 对象已存在，则为0。

### <a name="remarks"></a>备注

如果调用[CWinAppEx：： GetMouseManager](#getmousemanager)，则该方法的默认实现将调用 `InitMouseManager`。

如果你的应用程序已有一个鼠标管理器，但你调用了 `InitMouseManager`，则你的应用程序将有一个[断言](diagnostic-services.md#assert)失败。 因此，如果直接创建 `CMouseManager` 对象，则不应调用 `InitMouseManager`。 如果使用的不是自定义 `CMouseManager`，则应使用 `GetMouseManager` 创建 `CMouseManager` 对象。

##  <a name="initshellmanager"></a>CWinAppEx：： InitShellManager

初始化[CShellManager](../../mfc/reference/cshellmanager-class.md)对象。

```
BOOL InitShellManager();
```

### <a name="return-value"></a>返回值

如果方法创建 `CShellManager` 对象，则为非零值;如果 `CShellManager` 对象已存在，则为0。

### <a name="remarks"></a>备注

如果调用[CWinAppEx：： GetShellManager](#getshellmanager)，则该方法的默认实现将调用 `InitShellManager`。

如果你的应用程序已具有 shell 管理器，但你调用了 `InitShellManager`，则你的应用程序将引发[断言](diagnostic-services.md#assert)失败。 因此，当您直接创建 `CShellManager` 对象时，请不要调用 `InitShellManager`。 如果使用的不是自定义 `CShellManager`，请使用 `GetShellManager` 创建 `CShellManager` 对象。

##  <a name="inittooltipmanager"></a>CWinAppEx：： InitTooltipManager

初始化[CTooltipManager](../../mfc/reference/ctooltipmanager-class.md)对象。

```
BOOL InitTooltipManager();
```

### <a name="return-value"></a>返回值

如果方法创建 `CTooltipManager` 对象，则为非零值;如果 `CTooltipManager` 对象已存在，则为0。

### <a name="remarks"></a>备注

如果调用[CWinAppEx：： GetTooltipManager](#gettooltipmanager)，则该方法的默认实现将调用 `InitTooltipManager`。

如果你的应用程序已具有工具提示管理器，但你调用了 `InitTooltipManager`，则你的应用程序将有一个[断言](diagnostic-services.md#assert)失败。 因此，如果直接创建 `CTooltipManager` 对象，则不应调用 `InitTooltipManager`。 如果使用的不是自定义 `CTooltipManager`，则应使用 `GetTooltipManager` 创建 `CTooltipManager` 对象。

##  <a name="isresourcesmartupdate"></a>CWinAppEx：： IsResourceSmartUpdate

```
BOOL IsResourceSmartUpdate() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="isstateexists"></a>CWinAppEx：： IsStateExists

指示指定键是否在注册表中。

```
BOOL IsStateExists(LPCTSTR lpszSectionName);
```

### <a name="parameters"></a>参数

*lpszSectionName*<br/>
中包含注册表项的路径的字符串。

### <a name="return-value"></a>返回值

如果注册表项在注册表中，则为非零值;否则为0。

##  <a name="loadcustomstate"></a>CWinAppEx：： LoadCustomState

在从注册表加载应用程序的状态后，框架会调用此方法。

```
virtual void LoadCustomState();
```

### <a name="remarks"></a>备注

如果要在应用程序从注册表加载状态之后进行任何处理，请重写此方法。 默认情况下，此方法不执行任何操作。

若要从注册表加载自定义状态信息，必须先使用[CWinAppEx：： SaveCustomState](#savecustomstate)保存此信息。

##  <a name="loadstate"></a>CWinAppEx：： LoadState

从 Windows 注册表读取应用程序状态。

```
BOOL LoadState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

virtual BOOL LoadState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);
```

### <a name="parameters"></a>参数

*pFrame*<br/>
中指向框架窗口对象的指针。 方法将注册表中的状态信息应用于此框架窗口。

*lpszSectionName*<br/>
中包含注册表项的相对路径的字符串。

*pFrameImpl*<br/>
中指向 `CFrameImpl` 对象的指针。 方法将注册表中的状态信息应用于此框架窗口。

### <a name="return-value"></a>返回值

如果成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

此方法加载应用程序的状态和框架窗口的任何状态信息。 框架窗口的加载信息将应用于提供的框架窗口。 如果未提供框架窗口，则只加载应用程序状态信息。 应用程序信息包括[CMouseManager 类](../../mfc/reference/cmousemanager-class.md)的状态、 [CContextMenuManager 类](../../mfc/reference/ccontextmenumanager-class.md)、 [CKeyboardManager 类](../../mfc/reference/ckeyboardmanager-class.md)和[CUserToolsManager 类](../../mfc/reference/cusertoolsmanager-class.md)。

`CFrameImpl::OnLoadFrame` 的默认实现 `LoadState`调用。

*LpszSectionName*参数不是注册表项的绝对路径。 它是添加到应用程序的默认注册表项末尾的相对路径。 若要获取或设置默认的注册表项，请分别使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase) 。

##  <a name="loadwindowplacement"></a>CWinAppEx：： LoadWindowPlacement

在从注册表加载主框架窗口的大小和位置时由框架调用。

```
virtual BOOL LoadWindowPlacement(
    CRect& rectNormalPosition,
    int& nFlags,
    int& nShowCmd);
```

### <a name="parameters"></a>参数

*rectNormalPosition*<br/>
弄一个矩形，其中包含当主框架窗口处于还原位置时的坐标。

*nFlags*<br/>
弄用于控制最小化窗口的位置以及操作系统如何在最小化的窗口和已还原的窗口之间切换的标志。

*nShowCmd*<br/>
弄一个整数，指定窗口的显示状态。 有关可能值的详细信息，请参阅[CWnd：： ShowWindow](../../mfc/reference/cwnd-class.md#showwindow)。

### <a name="return-value"></a>返回值

如果成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

默认情况下，当应用程序启动时，MFC 会自动加载主框架窗口的先前位置和状态。 有关如何在注册表中存储此信息的详细信息，请参阅[CWinAppEx：： StoreWindowPlacement](#storewindowplacement)。

如果要加载有关主框架窗口的其他信息，请重写此方法。

##  <a name="m_bforceimagereset"></a>CWinAppEx：： m_bForceImageReset

指定框架在重新加载包含工具栏的框架窗口时是否重置所有工具栏图像。

```
BOOL m_bForceImageReset;
```

### <a name="remarks"></a>备注

`m_bForceImageReset` 数据成员是受保护的变量。

##  <a name="onappcontexthelp"></a>CWinAppEx：： OnAppContextHelp

当用户请求**自定义**对话框的上下文帮助时，框架会调用此方法。

```
virtual void OnAppContextHelp(
    CWnd* pWndControl,
    const DWORD dwHelpIDArray[]);
```

### <a name="parameters"></a>参数

*pWndControl*<br/>
中一个指针，指向用户为其调用上下文帮助的窗口对象。

*dwHelpIDArray[]*<br/>
中保留值。

### <a name="remarks"></a>备注

此方法当前保留供将来使用。 默认实现不执行任何操作，并且框架当前不会调用它。

##  <a name="onclosingmainframe"></a>CWinAppEx：： OnClosingMainFrame

框架窗口处理 WM_CLOSE 时，框架会调用此方法。

```
virtual void OnClosingMainFrame(CFrameImpl* pFrameImpl);
```

### <a name="parameters"></a>参数

*pFrameImpl*<br/>
中指向 `CFrameImpl` 对象的指针。

### <a name="remarks"></a>备注

此方法的默认实现保存*pFrameImpl*的状态。

##  <a name="onviewdoubleclick"></a>CWinAppEx：： OnViewDoubleClick

当用户双击视图中的任意位置时，调用与视图关联的用户定义命令。

```
virtual BOOL OnViewDoubleClick(
    CWnd* pWnd,
    int iViewId);
```

### <a name="parameters"></a>参数

*pWnd*<br/>
中指向派生自[CView 类](../../mfc/reference/cview-class.md)的对象的指针。

*iViewId*<br/>
中视图 ID。

### <a name="return-value"></a>返回值

如果框架找到命令，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

若要支持自定义鼠标行为，必须在处理 WM_LBUTTONDBLCLK 消息时调用此函数。 此方法将执行与*iViewId*提供的视图 ID 相关联的命令。 有关自定义鼠标行为的详细信息，请参阅[键盘和鼠标自定义](../../mfc/keyboard-and-mouse-customization.md)。

##  <a name="onworkspaceidle"></a>CWinAppEx：： OnWorkspaceIdle

```
virtual BOOL OnWorkspaceIdle(CWnd*);
```

### <a name="parameters"></a>参数

中*CWnd&#38;*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="preloadstate"></a>CWinAppEx：:P reLoadState

框架在从注册表加载应用程序状态之前立即调用此方法。

```
virtual void PreLoadState();
```

### <a name="remarks"></a>备注

如果要在框架加载应用程序状态之前立即执行任何处理，请重写此方法。

##  <a name="presavestate"></a>CWinAppEx：:P reSaveState

框架在保存应用程序状态之前立即调用此方法。

```
virtual void PreSaveState();
```

### <a name="remarks"></a>备注

如果要在框架保存应用程序状态之前立即执行任何处理，请重写此方法。

##  <a name="reloadwindowplacement"></a>CWinAppEx：： ReloadWindowPlacement

从注册表重新加载窗口的大小和位置。

```
virtual BOOL ReloadWindowPlacement(CFrameWnd* pFrame);
```

### <a name="parameters"></a>参数

*pFrame*<br/>
中指向框架窗口的指针。

### <a name="return-value"></a>返回值

如果方法成功，则为非零值;如果加载失败或没有要加载的数据，则为0。

### <a name="remarks"></a>备注

使用函数[CWinAppEx：： StoreWindowPlacement](#storewindowplacement)将窗口的大小和位置写入注册表。

##  <a name="savecustomstate"></a>CWinAppEx：： SaveCustomState

在将应用程序的状态保存到注册表后，框架会调用此方法。

```
virtual void SaveCustomState();
```

### <a name="remarks"></a>备注

如果要在应用程序将状态保存到注册表后进行任何处理，请重写此方法。 默认情况下，此方法不执行任何操作。

##  <a name="savestate"></a>CWinAppEx：： SaveState

将应用程序状态写入 Windows 注册表。

```
virtual BOOL SaveState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);

BOOL SaveState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>参数

*lpszSectionName*<br/>
中包含注册表项的相对路径的字符串。

*pFrameImpl*<br/>
中指向 `CFrameImpl` 对象的指针。 此帧将保存到 Windows 注册表中。

*pFrame*<br/>
中指向框架窗口对象的指针。 此帧将保存到 Windows 注册表中。

### <a name="return-value"></a>返回值

如果成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

此方法保存提供的框架窗口的应用程序状态和任何状态信息。 如果未提供框架窗口，则方法仅保存应用程序状态。 应用程序信息包括[CMouseManager 类](../../mfc/reference/cmousemanager-class.md)的状态、 [CContextMenuManager 类](../../mfc/reference/ccontextmenumanager-class.md)、 [CKeyboardManager 类](../../mfc/reference/ckeyboardmanager-class.md)和[CUserToolsManager 类](../../mfc/reference/cusertoolsmanager-class.md)。

*LpszSectionName*参数不是注册表项的绝对路径。 它是附加到应用程序的默认注册表项末尾的相对路径。 若要获取或设置默认的注册表项，请分别使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase) 。

##  <a name="setregistrybase"></a>CWinAppEx：： SetRegistryBase

设置应用程序的默认注册表路径。

```
LPCTSTR SetRegistryBase(LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>参数

*lpszSectionName*<br/>
中一个字符串，其中包含注册表项的路径。

### <a name="return-value"></a>返回值

一个字符串，其中包含默认注册表位置的路径。

### <a name="remarks"></a>备注

访问注册表的[CWinAppEx 类](../../mfc/reference/cwinappex-class.md)的所有方法都在默认位置启动。 使用此方法可以更改该默认注册表位置。 使用[CWinAppEx：： GetRegistryBase](#getregistrybase)检索默认注册表位置。

##  <a name="showpopupmenu"></a>CWinAppEx：： ShowPopupMenu

显示弹出菜单。

```
virtual BOOL ShowPopupMenu(
    UINT uiMenuResId,
    const CPoint& point,
    CWnd* pWnd);
```

### <a name="parameters"></a>参数

*uiMenuResId*<br/>
中菜单资源 ID。

*情况*<br/>
中一个[CPoint](../../atl-mfc-shared/reference/cpoint-class.md) ，它指定菜单在屏幕坐标中的位置。

*pWnd*<br/>
中指向拥有弹出菜单的窗口的指针。

### <a name="return-value"></a>返回值

如果成功显示弹出菜单，则为非零;否则为0。

### <a name="remarks"></a>备注

此方法显示与*uiMenuResId*关联的菜单。

若要支持弹出菜单，必须有一个[CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)对象。 如果尚未初始化 `CContextMenuManager` 对象，`ShowPopupMenu` 会失败。

##  <a name="storewindowplacement"></a>CWinAppEx：： StoreWindowPlacement

由框架调用，以将主框架窗口的大小和位置写入注册表。

```
virtual BOOL StoreWindowPlacement(
    const CRect& rectNormalPosition,
    int nFlags,
    int nShowCmd);
```

### <a name="parameters"></a>参数

*nFlags*<br/>
中用于控制最小化窗口的位置以及操作系统如何在最小化的窗口和已还原的窗口之间切换的标志。

*nShowCmd*<br/>
中一个整数，指定窗口的显示状态。 有关可能值的详细信息，请参阅[CWnd：： ShowWindow](../../mfc/reference/cwnd-class.md#showwindow)。

*rectNormalPosition*<br/>
中一个矩形，其中包含当主框架窗口处于还原状态时的坐标。

### <a name="return-value"></a>返回值

如果成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

默认情况下，MFC 会在应用程序退出之前自动保存主框架窗口的位置和状态。 此信息存储在应用程序默认注册表位置的 WindowPlacement 项下的 Windows 注册表中。 有关应用程序的默认注册表位置的详细信息，请参阅[CWinAppEx：： GetRegistryBase](#getregistrybase)。

如果要存储有关主框架窗口的其他信息，请重写此方法。

##  <a name="writebinary"></a>CWinAppEx：： WriteBinary

将二进制数据写入注册表。

```
BOOL WriteBinary(
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>参数

*lpszEntry*<br/>
中包含注册表项名称的字符串。

*pData*<br/>
中要存储的数据。

*nBytes*<br/>
中*PData*的大小（以字节为单位）。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

*LpszEntry*参数是位于应用程序的默认注册表项下的注册表项的名称。 若要获取或设置默认的注册表项，请分别使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase) 。

如果*lpszEntry*指定的密钥不存在，此方法将创建它。

##  <a name="writeint"></a>CWinAppEx：： WriteInt

将数值数据写入注册表。

```
BOOL WriteInt(
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>参数

*lpszEntry*<br/>
中包含注册表项名称的字符串。

*N 值*<br/>
中要存储的数据。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

*LpszEntry*参数是应用程序的默认注册表项下的注册表项的名称。 若要获取或设置默认的注册表项，请分别使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase) 。

如果*lpszEntry*指定的密钥不存在，此方法将创建它。

##  <a name="writeobject"></a>CWinAppEx：： WriteObject

将从[CObject 类](../../mfc/reference/cobject-class.md)派生的数据写入注册表。

```
BOOL WriteObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>参数

*lpszEntry*<br/>
中包含要设置的值的字符串。

*obj*<br/>
中对方法将存储 `CObject` 数据的引用。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

此方法将*obj*数据写入默认注册表项下的指定值。 使用[CWinAppEx：： GetRegistryBase](#getregistrybase)确定当前注册表项。

##  <a name="writesectionbinary"></a>CWinAppEx：： WriteSectionBinary

将二进制数据写入注册表中的值。

```
BOOL WriteSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>参数

*lpszSubSection*<br/>
中包含注册表项名称的字符串

*lpszEntry*<br/>
中包含要设置的值的字符串。

*pData*<br/>
中要写入到注册表中的数据。

*nBytes*<br/>
中*PData*的大小（以字节为单位）。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

*LpszSubSection*参数不是注册表项的绝对路径。 它是附加到应用程序的默认注册表项末尾的相对路径。 若要获取或设置默认的注册表项，请分别使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase) 。

如果*lpszEntry*指定的密钥不存在，此方法将创建它。

##  <a name="writesectionint"></a>CWinAppEx：： WriteSectionInt

将数值数据写入注册表。

```
BOOL WriteSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>参数

*lpszSubSection*<br/>
中包含注册表项的相对路径的字符串。

*lpszEntry*<br/>
中包含要设置的值的字符串。

*N 值*<br/>
中要写入到注册表中的数据。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

*LpszSubSection*参数不是注册表项的绝对路径。 它是附加到应用程序的默认注册表项的相对路径。 若要获取或设置默认的注册表项，请分别使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase) 。

如果*lpszEntry*指定的密钥不存在，此方法将创建它。

##  <a name="writesectionobject"></a>CWinAppEx：： WriteSectionObject

将从[CObject 类](../../mfc/reference/cobject-class.md)派生的数据写入特定注册表值。

```
BOOL WriteSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>参数

*lpszSubSection*<br/>
中包含注册表项名称的字符串。

*lpszEntry*<br/>
中一个字符串，其中包含要设置的值的名称。

*obj*<br/>
中要存储的数据。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

*LpszSubSection*参数不是注册表项的绝对路径。 它是附加到应用程序的默认注册表项末尾的相对路径。 若要获取或设置默认的注册表项，请分别使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)。

如果由*lpszSubSection*指定的注册表项下的*lpszEntry*指定的值不存在，则此方法将创建该值。

##  <a name="writesectionstring"></a>CWinAppEx：： WriteSectionString

将字符串数据写入注册表中的值。

```
BOOL WriteSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>参数

*lpszSubSection*<br/>
中包含注册表项名称的字符串。

*lpszEntry*<br/>
中包含要设置的值的字符串。

*lpszValue*<br/>
中要写入注册表的字符串数据。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

*LpszSubSection*参数不是注册表项的绝对路径。 它是附加到应用程序的默认注册表项末尾的相对路径。 若要获取或设置默认的注册表项，请分别使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)。

如果*lpszEntry*指定的值不存在于*lpszSubSection*下，此方法将创建它。

##  <a name="writestring"></a>CWinAppEx：： WriteString

将字符串数据写入注册表。

```
BOOL WriteString(
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>参数

*lpszEntry*<br/>
中包含注册表项名称的字符串。

*lpszValue*<br/>
中要存储的数据。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

*LpszEntry*参数是应用程序的默认注册表项下的注册表项的名称。 若要获取或设置默认的注册表项，请分别使用方法[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase) 。

如果*lspzEntry*指定的密钥不存在，此方法将创建它。

## <a name="see-also"></a>另请参阅

[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)<br/>
[CWinApp 类](../../mfc/reference/cwinapp-class.md)<br/>
[CMouseManager 类](../../mfc/reference/cmousemanager-class.md)<br/>
[CContextMenuManager 类](../../mfc/reference/ccontextmenumanager-class.md)<br/>
[CKeyboardManager 类](../../mfc/reference/ckeyboardmanager-class.md)<br/>
[CUserToolsManager 类](../../mfc/reference/cusertoolsmanager-class.md)
